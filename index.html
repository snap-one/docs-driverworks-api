
<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
    <meta content="IE=edge,chrome=1" http-equiv="X-UA-Compatible">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <title>Driverworks Reference</title>

    <style>
      .highlight table td { padding: 5px; }
.highlight table pre { margin: 0; }
.highlight .gh {
  color: #999999;
}
.highlight .sr {
  color: #f6aa11;
}
.highlight .go {
  color: #888888;
}
.highlight .gp {
  color: #555555;
}
.highlight .gs {
}
.highlight .gu {
  color: #aaaaaa;
}
.highlight .nb {
  color: #f6aa11;
}
.highlight .cm {
  color: #75715e;
}
.highlight .cp {
  color: #75715e;
}
.highlight .c1 {
  color: #75715e;
}
.highlight .cs {
  color: #75715e;
}
.highlight .c, .highlight .ch, .highlight .cd, .highlight .cpf {
  color: #75715e;
}
.highlight .err {
  color: #960050;
}
.highlight .gr {
  color: #960050;
}
.highlight .gt {
  color: #960050;
}
.highlight .gd {
  color: #49483e;
}
.highlight .gi {
  color: #49483e;
}
.highlight .ge {
  color: #49483e;
}
.highlight .kc {
  color: #66d9ef;
}
.highlight .kd {
  color: #66d9ef;
}
.highlight .kr {
  color: #66d9ef;
}
.highlight .no {
  color: #66d9ef;
}
.highlight .kt {
  color: #66d9ef;
}
.highlight .mf {
  color: #ae81ff;
}
.highlight .mh {
  color: #ae81ff;
}
.highlight .il {
  color: #ae81ff;
}
.highlight .mi {
  color: #ae81ff;
}
.highlight .mo {
  color: #ae81ff;
}
.highlight .m, .highlight .mb, .highlight .mx {
  color: #ae81ff;
}
.highlight .sc {
  color: #ae81ff;
}
.highlight .se {
  color: #ae81ff;
}
.highlight .ss {
  color: #ae81ff;
}
.highlight .sd {
  color: #e6db74;
}
.highlight .s2 {
  color: #e6db74;
}
.highlight .sb {
  color: #e6db74;
}
.highlight .sh {
  color: #e6db74;
}
.highlight .si {
  color: #e6db74;
}
.highlight .sx {
  color: #e6db74;
}
.highlight .s1 {
  color: #e6db74;
}
.highlight .s, .highlight .sa, .highlight .dl {
  color: #e6db74;
}
.highlight .na {
  color: #a6e22e;
}
.highlight .nc {
  color: #a6e22e;
}
.highlight .nd {
  color: #a6e22e;
}
.highlight .ne {
  color: #a6e22e;
}
.highlight .nf, .highlight .fm {
  color: #a6e22e;
}
.highlight .vc {
  color: #ffffff;
}
.highlight .nn {
  color: #ffffff;
}
.highlight .ni {
  color: #ffffff;
}
.highlight .bp {
  color: #ffffff;
}
.highlight .vg {
  color: #ffffff;
}
.highlight .vi {
  color: #ffffff;
}
.highlight .nv, .highlight .vm {
  color: #ffffff;
}
.highlight .w {
  color: #ffffff;
}
.highlight {
  color: #ffffff;
}
.highlight .n, .highlight .py, .highlight .nx {
  color: #ffffff;
}
.highlight .nl {
  color: #f92672;
}
.highlight .ow {
  color: #f92672;
}
.highlight .nt {
  color: #f92672;
}
.highlight .k, .highlight .kv {
  color: #f92672;
}
.highlight .kn {
  color: #f92672;
}
.highlight .kp {
  color: #f92672;
}
.highlight .o {
  color: #f92672;
}
    </style>
    <link href="stylesheets/screen-0a7c4629.css" rel="stylesheet" media="screen" />
    <link href="stylesheets/print-c427a123.css" rel="stylesheet" media="print" />
      <script src="javascripts/all-c5541673.js"></script>
  </head>

  <body class="index" data-languages="[&quot;lua&quot;]">
    <a href="#" id="nav-button">
      <span>
        NAV
        <img src="images/navbar-cad8cdcb.png" alt="Navbar" />
      </span>
    </a>
    <div class="toc-wrapper">
      <img src="images/logo-3056e635.png" class="logo" alt="Logo" />
        <div class="lang-selector">
              <a href="#" data-language-name="lua">lua</a>
        </div>
        <div class="search">
          <input type="text" class="search" id="input-search" placeholder="Search">
        </div>
        <ul class="search-results"></ul>
      <ul id="toc" class="toc-list-h1">
          <li>
            <a href="#license-copyright-and-trademark" class="toc-h1 toc-link" data-title="License, Copyright, and Trademark">License, Copyright, and Trademark</a>
          </li>
          <li>
            <a href="#introduction" class="toc-h1 toc-link" data-title="Introduction">Introduction</a>
          </li>
          <li>
            <a href="#what-39-s-new" class="toc-h1 toc-link" data-title="What's New">What's New</a>
              <ul class="toc-list-h2">
                  <li>
                    <a href="#what-s-new-in-3-3-0" class="toc-h2 toc-link" data-title="What’s New in 3.3.0">What’s New in 3.3.0</a>
                  </li>
                  <li>
                    <a href="#what-s-new-in-3-2-3" class="toc-h2 toc-link" data-title="What’s New in 3.2.3">What’s New in 3.2.3</a>
                  </li>
                  <li>
                    <a href="#what-s-new-in-3-2-2" class="toc-h2 toc-link" data-title="What’s New in 3.2.2">What’s New in 3.2.2</a>
                  </li>
                  <li>
                    <a href="#what-s-new-in-3-2-1" class="toc-h2 toc-link" data-title="What’s New in 3.2.1">What’s New in 3.2.1</a>
                  </li>
                  <li>
                    <a href="#what-s-new-in-3-2-0" class="toc-h2 toc-link" data-title="What’s New in 3.2.0">What’s New in 3.2.0</a>
                  </li>
                  <li>
                    <a href="#what-was-new-in-3-1-0" class="toc-h2 toc-link" data-title="What was New in 3.1.0">What was New in 3.1.0</a>
                  </li>
                  <li>
                    <a href="#what-was-new-in-o-s-3" class="toc-h2 toc-link" data-title="What was New in O.S.3">What was New in O.S.3</a>
                  </li>
              </ul>
          </li>
          <li>
            <a href="#c4ssh-interface" class="toc-h1 toc-link" data-title="C4SSH Interface">C4SSH Interface</a>
              <ul class="toc-list-h2">
                  <li>
                    <a href="#createsshclient" class="toc-h2 toc-link" data-title="CreateSSHClient">CreateSSHClient</a>
                  </li>
                  <li>
                    <a href="#connect" class="toc-h2 toc-link" data-title="Connect">Connect</a>
                  </li>
                  <li>
                    <a href="#send" class="toc-h2 toc-link" data-title="Send">Send</a>
                  </li>
                  <li>
                    <a href="#disconnect" class="toc-h2 toc-link" data-title="Disconnect">Disconnect</a>
                  </li>
                  <li>
                    <a href="#setconnecttimeout" class="toc-h2 toc-link" data-title="SetConnectTimeout">SetConnectTimeout</a>
                  </li>
                  <li>
                    <a href="#setonconnected" class="toc-h2 toc-link" data-title="SetOnConnected">SetOnConnected</a>
                  </li>
                  <li>
                    <a href="#setondata" class="toc-h2 toc-link" data-title="SetOnData">SetOnData</a>
                  </li>
                  <li>
                    <a href="#setondisconnected" class="toc-h2 toc-link" data-title="SetOnDisconnected">SetOnDisconnected</a>
                  </li>
                  <li>
                    <a href="#onconnected" class="toc-h2 toc-link" data-title="OnConnected">OnConnected</a>
                  </li>
                  <li>
                    <a href="#ondata" class="toc-h2 toc-link" data-title="OnData">OnData</a>
                  </li>
                  <li>
                    <a href="#ondisconnected" class="toc-h2 toc-link" data-title="OnDisconnected">OnDisconnected</a>
                  </li>
              </ul>
          </li>
          <li>
            <a href="#controller-registry-interface" class="toc-h1 toc-link" data-title="Controller Registry Interface">Controller Registry Interface</a>
              <ul class="toc-list-h2">
                  <li>
                    <a href="#registrydeletevalue" class="toc-h2 toc-link" data-title="RegistryDeleteValue">RegistryDeleteValue</a>
                  </li>
                  <li>
                    <a href="#registrygetvalue" class="toc-h2 toc-link" data-title="RegistryGetValue">RegistryGetValue</a>
                  </li>
                  <li>
                    <a href="#registrysetvalue" class="toc-h2 toc-link" data-title="RegistrySetValue">RegistrySetValue</a>
                  </li>
              </ul>
          </li>
          <li>
            <a href="#director-command-interface" class="toc-h1 toc-link" data-title="Director Command Interface">Director Command Interface</a>
              <ul class="toc-list-h2">
                  <li>
                    <a href="#executecommand" class="toc-h2 toc-link" data-title="ExecuteCommand">ExecuteCommand</a>
                  </li>
                  <li>
                    <a href="#getversioninfo" class="toc-h2 toc-link" data-title="GetVersionInfo">GetVersionInfo</a>
                  </li>
                  <li>
                    <a href="#invalidatestate" class="toc-h2 toc-link" data-title="InvalidateState">InvalidateState</a>
                  </li>
              </ul>
          </li>
          <li>
            <a href="#encryption-interface" class="toc-h1 toc-link" data-title="Encryption Interface">Encryption Interface</a>
              <ul class="toc-list-h2">
                  <li>
                    <a href="#encode" class="toc-h2 toc-link" data-title="Encode">Encode</a>
                  </li>
                  <li>
                    <a href="#encrypt" class="toc-h2 toc-link" data-title="Encrypt">Encrypt</a>
                  </li>
                  <li>
                    <a href="#decode" class="toc-h2 toc-link" data-title="Decode">Decode</a>
                  </li>
                  <li>
                    <a href="#decrypt" class="toc-h2 toc-link" data-title="Decrypt">Decrypt</a>
                  </li>
                  <li>
                    <a href="#generatecsr-ecc" class="toc-h2 toc-link" data-title="GenerateCSR ECC">GenerateCSR ECC</a>
                  </li>
                  <li>
                    <a href="#generatecsr-rsa" class="toc-h2 toc-link" data-title="GenerateCSR RSA">GenerateCSR RSA</a>
                  </li>
                  <li>
                    <a href="#getsupportedciphers" class="toc-h2 toc-link" data-title="GetSupportedCiphers">GetSupportedCiphers</a>
                  </li>
                  <li>
                    <a href="#getsupporteddigests" class="toc-h2 toc-link" data-title="GetSupportedDigests">GetSupportedDigests</a>
                  </li>
                  <li>
                    <a href="#hash" class="toc-h2 toc-link" data-title="Hash">Hash</a>
                  </li>
                  <li>
                    <a href="#hmac" class="toc-h2 toc-link" data-title="HMAC">HMAC</a>
                  </li>
                  <li>
                    <a href="#loadpkcs12" class="toc-h2 toc-link" data-title="LoadPKCS12">LoadPKCS12</a>
                  </li>
                  <li>
                    <a href="#pbkdf2" class="toc-h2 toc-link" data-title="PBKDF2">PBKDF2</a>
                  </li>
                  <li>
                    <a href="#sign" class="toc-h2 toc-link" data-title="Sign">Sign</a>
                  </li>
                  <li>
                    <a href="#writepkcs12" class="toc-h2 toc-link" data-title="WritePKCS12">WritePKCS12</a>
                  </li>
              </ul>
          </li>
          <li>
            <a href="#event-interface" class="toc-h1 toc-link" data-title="Event Interface">Event Interface</a>
              <ul class="toc-list-h2">
                  <li>
                    <a href="#registering-for-system-events" class="toc-h2 toc-link" data-title="Registering for System Events">Registering for System Events</a>
                  </li>
                  <li>
                    <a href="#addevent" class="toc-h2 toc-link" data-title="AddEvent">AddEvent</a>
                  </li>
                  <li>
                    <a href="#deleteevent" class="toc-h2 toc-link" data-title="DeleteEvent">DeleteEvent</a>
                  </li>
                  <li>
                    <a href="#fireevent" class="toc-h2 toc-link" data-title="FireEvent">FireEvent</a>
                  </li>
                  <li>
                    <a href="#fireeventbyid" class="toc-h2 toc-link" data-title="FireEventByID">FireEventByID</a>
                  </li>
                  <li>
                    <a href="#ondeviceevent" class="toc-h2 toc-link" data-title="OnDeviceEvent">OnDeviceEvent</a>
                  </li>
                  <li>
                    <a href="#onsystemevent" class="toc-h2 toc-link" data-title="OnSystemEvent">OnSystemEvent</a>
                  </li>
                  <li>
                    <a href="#registerdeviceevent" class="toc-h2 toc-link" data-title="RegisterDeviceEvent">RegisterDeviceEvent</a>
                  </li>
                  <li>
                    <a href="#registersystemevent" class="toc-h2 toc-link" data-title="RegisterSystemEvent">RegisterSystemEvent</a>
                  </li>
                  <li>
                    <a href="#unregisteralldeviceevents" class="toc-h2 toc-link" data-title="UnregisterAllDeviceEvents">UnregisterAllDeviceEvents</a>
                  </li>
                  <li>
                    <a href="#unregisterallsystemevents" class="toc-h2 toc-link" data-title="UnregisterAllSystemEvents">UnregisterAllSystemEvents</a>
                  </li>
                  <li>
                    <a href="#unregistersystemevent" class="toc-h2 toc-link" data-title="UnregisterSystemEvent">UnregisterSystemEvent</a>
                  </li>
                  <li>
                    <a href="#unregisterdeviceevent" class="toc-h2 toc-link" data-title="UnregisterDeviceEvent">UnregisterDeviceEvent</a>
                  </li>
                  <li>
                    <a href="#suppressing-system-events" class="toc-h2 toc-link" data-title="Suppressing System Events">Suppressing System Events</a>
                  </li>
              </ul>
          </li>
          <li>
            <a href="#file-interface" class="toc-h1 toc-link" data-title="File Interface">File Interface</a>
              <ul class="toc-list-h2">
                  <li>
                    <a href="#fileclose" class="toc-h2 toc-link" data-title="FileClose">FileClose</a>
                  </li>
                  <li>
                    <a href="#filecreatedir" class="toc-h2 toc-link" data-title="FileCreateDir">FileCreateDir</a>
                  </li>
                  <li>
                    <a href="#filedelete" class="toc-h2 toc-link" data-title="FileDelete">FileDelete</a>
                  </li>
                  <li>
                    <a href="#fileexists" class="toc-h2 toc-link" data-title="FileExists">FileExists</a>
                  </li>
                  <li>
                    <a href="#filefreespace" class="toc-h2 toc-link" data-title="FileFreeSpace">FileFreeSpace</a>
                  </li>
                  <li>
                    <a href="#fileisvalid" class="toc-h2 toc-link" data-title="FileIsValid">FileIsValid</a>
                  </li>
                  <li>
                    <a href="#filegetname" class="toc-h2 toc-link" data-title="FileGetName">FileGetName</a>
                  </li>
                  <li>
                    <a href="#filegetpos" class="toc-h2 toc-link" data-title="FileGetPos">FileGetPos</a>
                  </li>
                  <li>
                    <a href="#filegetsize" class="toc-h2 toc-link" data-title="FileGetSize">FileGetSize</a>
                  </li>
                  <li>
                    <a href="#fileopen" class="toc-h2 toc-link" data-title="FileOpen">FileOpen</a>
                  </li>
                  <li>
                    <a href="#filegetopenedhandles" class="toc-h2 toc-link" data-title="FileGetOpenedHandles">FileGetOpenedHandles</a>
                  </li>
                  <li>
                    <a href="#filelist" class="toc-h2 toc-link" data-title="FileList">FileList</a>
                  </li>
                  <li>
                    <a href="#filemove" class="toc-h2 toc-link" data-title="FileMove">FileMove</a>
                  </li>
                  <li>
                    <a href="#fileread" class="toc-h2 toc-link" data-title="FileRead">FileRead</a>
                  </li>
                  <li>
                    <a href="#filesetdir" class="toc-h2 toc-link" data-title="FileSetDir">FileSetDir</a>
                  </li>
                  <li>
                    <a href="#filesetpos" class="toc-h2 toc-link" data-title="FileSetPos">FileSetPos</a>
                  </li>
                  <li>
                    <a href="#filewrite" class="toc-h2 toc-link" data-title="FileWrite">FileWrite</a>
                  </li>
                  <li>
                    <a href="#filewritestring" class="toc-h2 toc-link" data-title="FileWriteString">FileWriteString</a>
                  </li>
                  <li>
                    <a href="#unzip" class="toc-h2 toc-link" data-title="UnZip">UnZip</a>
                  </li>
              </ul>
          </li>
          <li>
            <a href="#helper-interface" class="toc-h1 toc-link" data-title="Helper Interface">Helper Interface</a>
              <ul class="toc-list-h2">
                  <li>
                    <a href="#adddevice" class="toc-h2 toc-link" data-title="AddDevice">AddDevice</a>
                  </li>
                  <li>
                    <a href="#addlocation" class="toc-h2 toc-link" data-title="AddLocation">AddLocation</a>
                  </li>
                  <li>
                    <a href="#bind" class="toc-h2 toc-link" data-title="Bind">Bind</a>
                  </li>
                  <li>
                    <a href="#blowfishecbdecrypt" class="toc-h2 toc-link" data-title="blowfishEcbDecrypt">blowfishEcbDecrypt</a>
                  </li>
                  <li>
                    <a href="#blowfishecbencrypt" class="toc-h2 toc-link" data-title="blowfishEcbEncrypt">blowfishEcbEncrypt</a>
                  </li>
                  <li>
                    <a href="#callasync" class="toc-h2 toc-link" data-title="CallAsync">CallAsync</a>
                  </li>
              </ul>
          </li>
          <li>
            <a href="#createtlsserver" class="toc-h1 toc-link" data-title="CreateTLSServer">CreateTLSServer</a>
              <ul class="toc-list-h2">
                  <li>
                    <a href="#signature" class="toc-h2 toc-link" data-title="Signature">Signature</a>
                  </li>
                  <li>
                    <a href="#returns" class="toc-h2 toc-link" data-title="Returns">Returns</a>
                  </li>
                  <li>
                    <a href="#evaluateexpression" class="toc-h2 toc-link" data-title="EvaluateExpression">EvaluateExpression</a>
                  </li>
                  <li>
                    <a href="#getallcodeitems" class="toc-h2 toc-link" data-title="GetAllCodeItems">GetAllCodeItems</a>
                  </li>
                  <li>
                    <a href="#getbootid" class="toc-h2 toc-link" data-title="GetBootID">GetBootID</a>
                  </li>
                  <li>
                    <a href="#getcodeitems" class="toc-h2 toc-link" data-title="GetCodeItems">GetCodeItems</a>
                  </li>
                  <li>
                    <a href="#getc4idir" class="toc-h2 toc-link" data-title="GetC4iDir">GetC4iDir</a>
                  </li>
                  <li>
                    <a href="#getc4zdir" class="toc-h2 toc-link" data-title="GetC4zDir">GetC4zDir</a>
                  </li>
                  <li>
                    <a href="#getlogdir" class="toc-h2 toc-link" data-title="GetLogDir">GetLogDir</a>
                  </li>
                  <li>
                    <a href="#getpushsettings" class="toc-h2 toc-link" data-title="getPushSettings">getPushSettings</a>
                  </li>
                  <li>
                    <a href="#getsandboxdir" class="toc-h2 toc-link" data-title="GetSandboxDir">GetSandboxDir</a>
                  </li>
                  <li>
                    <a href="#gettimezone" class="toc-h2 toc-link" data-title="GetTimeZone">GetTimeZone</a>
                  </li>
                  <li>
                    <a href="#hexdump" class="toc-h2 toc-link" data-title="hexdump">hexdump</a>
                  </li>
                  <li>
                    <a href="#onbindingchanged" class="toc-h2 toc-link" data-title="OnBindingChanged">OnBindingChanged</a>
                  </li>
                  <li>
                    <a href="#parsexml" class="toc-h2 toc-link" data-title="ParseXML">ParseXML</a>
                  </li>
                  <li>
                    <a href="#print" class="toc-h2 toc-link" data-title="print">print</a>
                  </li>
                  <li>
                    <a href="#recordhistory" class="toc-h2 toc-link" data-title="RecordHistory">RecordHistory</a>
                  </li>
                  <li>
                    <a href="#tohex" class="toc-h2 toc-link" data-title="tohex">tohex</a>
                  </li>
                  <li>
                    <a href="#tonumberloc" class="toc-h2 toc-link" data-title="tonumberloc">tonumberloc</a>
                  </li>
                  <li>
                    <a href="#tostringlocalec" class="toc-h2 toc-link" data-title="ToStringLocaleC">ToStringLocaleC</a>
                  </li>
                  <li>
                    <a href="#unbind" class="toc-h2 toc-link" data-title="unbind">unbind</a>
                  </li>
                  <li>
                    <a href="#uuid" class="toc-h2 toc-link" data-title="UUID">UUID</a>
                  </li>
                  <li>
                    <a href="#xmlescapestring" class="toc-h2 toc-link" data-title="XmlEscapeString">XmlEscapeString</a>
                  </li>
              </ul>
          </li>
          <li>
            <a href="#inbound-driver-interface" class="toc-h1 toc-link" data-title="Inbound Driver Interface">Inbound Driver Interface</a>
              <ul class="toc-list-h2">
                  <li>
                    <a href="#inbound-driver-interface" class="toc-h2 toc-link" data-title="InBound Driver Interface">InBound Driver Interface</a>
                  </li>
              </ul>
          </li>
          <li>
            <a href="#ir-interface" class="toc-h1 toc-link" data-title="IR Interface">IR Interface</a>
              <ul class="toc-list-h2">
                  <li>
                    <a href="#sendir" class="toc-h2 toc-link" data-title="SendIR">SendIR</a>
                  </li>
                  <li>
                    <a href="#sendirstart" class="toc-h2 toc-link" data-title="SendIRStart">SendIRStart</a>
                  </li>
                  <li>
                    <a href="#sendirstop" class="toc-h2 toc-link" data-title="SendIRStop">SendIRStop</a>
                  </li>
              </ul>
          </li>
          <li>
            <a href="#json-interface" class="toc-h1 toc-link" data-title="JSON Interface">JSON Interface</a>
              <ul class="toc-list-h2">
                  <li>
                    <a href="#c4json-null" class="toc-h2 toc-link" data-title="c4json.null">c4json.null</a>
                  </li>
                  <li>
                    <a href="#json-encode" class="toc-h2 toc-link" data-title="Json:Encode">Json:Encode</a>
                  </li>
                  <li>
                    <a href="#json-decode" class="toc-h2 toc-link" data-title="Json:Decode">Json:Decode</a>
                  </li>
              </ul>
          </li>
          <li>
            <a href="#log-interface" class="toc-h1 toc-link" data-title="Log Interface">Log Interface</a>
          </li>
          <li>
            <a href="#debuglog" class="toc-h1 toc-link" data-title="DebugLog">DebugLog</a>
              <ul class="toc-list-h2">
                  <li>
                    <a href="#signature" class="toc-h2 toc-link" data-title="Signature">Signature</a>
                  </li>
                  <li>
                    <a href="#returns" class="toc-h2 toc-link" data-title="Returns">Returns</a>
                  </li>
                  <li>
                    <a href="#examples" class="toc-h2 toc-link" data-title="Examples">Examples</a>
                  </li>
                  <li>
                    <a href="#errorlog" class="toc-h2 toc-link" data-title="ErrorLog">ErrorLog</a>
                  </li>
              </ul>
          </li>
          <li>
            <a href="#tcpclient-interface" class="toc-h1 toc-link" data-title="TCPClient Interface">TCPClient Interface</a>
              <ul class="toc-list-h2">
                  <li>
                    <a href="#createtcpclient" class="toc-h2 toc-link" data-title="CreateTCPClient">CreateTCPClient</a>
                  </li>
                  <li>
                    <a href="#close" class="toc-h2 toc-link" data-title="Close">Close</a>
                  </li>
                  <li>
                    <a href="#connect" class="toc-h2 toc-link" data-title="Connect">Connect</a>
                  </li>
                  <li>
                    <a href="#getlocaladdress" class="toc-h2 toc-link" data-title="GetLocalAddress">GetLocalAddress</a>
                  </li>
                  <li>
                    <a href="#getremoteaddress" class="toc-h2 toc-link" data-title="GetRemoteAddress">GetRemoteAddress</a>
                  </li>
                  <li>
                    <a href="#onconnect" class="toc-h2 toc-link" data-title="OnConnect">OnConnect</a>
                  </li>
                  <li>
                    <a href="#ondisconnect" class="toc-h2 toc-link" data-title="OnDisconnect">OnDisconnect</a>
                  </li>
                  <li>
                    <a href="#onerror" class="toc-h2 toc-link" data-title="OnError">OnError</a>
                  </li>
                  <li>
                    <a href="#onread" class="toc-h2 toc-link" data-title="OnRead">OnRead</a>
                  </li>
                  <li>
                    <a href="#onresolve" class="toc-h2 toc-link" data-title="OnResolve">OnResolve</a>
                  </li>
                  <li>
                    <a href="#option" class="toc-h2 toc-link" data-title="Option">Option</a>
                  </li>
                  <li>
                    <a href="#readatleast" class="toc-h2 toc-link" data-title="ReadAtLeast">ReadAtLeast</a>
                  </li>
                  <li>
                    <a href="#readuntil" class="toc-h2 toc-link" data-title="ReadUntil">ReadUntil</a>
                  </li>
                  <li>
                    <a href="#readuntiloneof" class="toc-h2 toc-link" data-title="ReadUntilOneOf">ReadUntilOneOf</a>
                  </li>
                  <li>
                    <a href="#readuntilonenotof" class="toc-h2 toc-link" data-title="ReadUntilOneNotOf">ReadUntilOneNotOf</a>
                  </li>
                  <li>
                    <a href="#readupto" class="toc-h2 toc-link" data-title="ReadUpTo">ReadUpTo</a>
                  </li>
              </ul>
          </li>
          <li>
            <a href="#tcpserver-interface" class="toc-h1 toc-link" data-title="TCPServer Interface">TCPServer Interface</a>
              <ul class="toc-list-h2">
                  <li>
                    <a href="#createtcpserver" class="toc-h2 toc-link" data-title="CreateTCPServer">CreateTCPServer</a>
                  </li>
                  <li>
                    <a href="#close" class="toc-h2 toc-link" data-title="Close">Close</a>
                  </li>
                  <li>
                    <a href="#getlocaladdress" class="toc-h2 toc-link" data-title="GetLocalAddress">GetLocalAddress</a>
                  </li>
                  <li>
                    <a href="#listen" class="toc-h2 toc-link" data-title="Listen">Listen</a>
                  </li>
                  <li>
                    <a href="#onaccept" class="toc-h2 toc-link" data-title="OnAccept">OnAccept</a>
                  </li>
                  <li>
                    <a href="#onerror" class="toc-h2 toc-link" data-title="OnError">OnError</a>
                  </li>
                  <li>
                    <a href="#onlisten" class="toc-h2 toc-link" data-title="OnListen">OnListen</a>
                  </li>
                  <li>
                    <a href="#onresolve" class="toc-h2 toc-link" data-title="OnResolve">OnResolve</a>
                  </li>
                  <li>
                    <a href="#option" class="toc-h2 toc-link" data-title="Option">Option</a>
                  </li>
              </ul>
          </li>
          <li>
            <a href="#media-management-albums-interface" class="toc-h1 toc-link" data-title="Media Management - Albums Interface">Media Management - Albums Interface</a>
              <ul class="toc-list-h2">
                  <li>
                    <a href="#overview" class="toc-h2 toc-link" data-title="Overview">Overview</a>
                  </li>
                  <li>
                    <a href="#mediaaddalbuminfo" class="toc-h2 toc-link" data-title="MediaAddAlbumInfo">MediaAddAlbumInfo</a>
                  </li>
                  <li>
                    <a href="#mediagetalbuminfo" class="toc-h2 toc-link" data-title="MediaGetAlbumInfo">MediaGetAlbumInfo</a>
                  </li>
                  <li>
                    <a href="#mediagetalbumlocation" class="toc-h2 toc-link" data-title="MediaGetAlbumLocation">MediaGetAlbumLocation</a>
                  </li>
                  <li>
                    <a href="#mediagetallalbums" class="toc-h2 toc-link" data-title="MediaGetAllAlbums">MediaGetAllAlbums</a>
                  </li>
                  <li>
                    <a href="#mediaremovealbum" class="toc-h2 toc-link" data-title="MediaRemoveAlbum">MediaRemoveAlbum</a>
                  </li>
                  <li>
                    <a href="#mediaremoveallalbums" class="toc-h2 toc-link" data-title="MediaRemoveAllAlbums">MediaRemoveAllAlbums</a>
                  </li>
                  <li>
                    <a href="#mediamodifyalbuminfo" class="toc-h2 toc-link" data-title="MediaModifyAlbumInfo">MediaModifyAlbumInfo</a>
                  </li>
              </ul>
          </li>
          <li>
            <a href="#media-management-broadcast-video-interface" class="toc-h1 toc-link" data-title="Media Management - Broadcast Video Interface">Media Management - Broadcast Video Interface</a>
              <ul class="toc-list-h2">
                  <li>
                    <a href="#mediaaddbroadcastvideoinfo" class="toc-h2 toc-link" data-title="MediaAddBroadcastVideoInfo">MediaAddBroadcastVideoInfo</a>
                  </li>
                  <li>
                    <a href="#mediagetallbroadcastvideo" class="toc-h2 toc-link" data-title="MediaGetAllBroadcastVideo">MediaGetAllBroadcastVideo</a>
                  </li>
                  <li>
                    <a href="#mediagetbroadcastvideoinfo" class="toc-h2 toc-link" data-title="MediaGetBroadcastVideoInfo">MediaGetBroadcastVideoInfo</a>
                  </li>
                  <li>
                    <a href="#mediamodifybroadcastvideoinfo" class="toc-h2 toc-link" data-title="MediaModifyBroadcastVideoInfo">MediaModifyBroadcastVideoInfo</a>
                  </li>
                  <li>
                    <a href="#mediaremovebroadcastvideo" class="toc-h2 toc-link" data-title="MediaRemoveBroadcastVideo">MediaRemoveBroadcastVideo</a>
                  </li>
              </ul>
          </li>
          <li>
            <a href="#media-management-generic-interface" class="toc-h1 toc-link" data-title="Media Management - Generic Interface">Media Management - Generic Interface</a>
              <ul class="toc-list-h2">
                  <li>
                    <a href="#mediagetdevicecontext" class="toc-h2 toc-link" data-title="MediaGetDeviceContext">MediaGetDeviceContext</a>
                  </li>
                  <li>
                    <a href="#mediaremoveallmedia" class="toc-h2 toc-link" data-title="MediaRemoveAllMedia">MediaRemoveAllMedia</a>
                  </li>
                  <li>
                    <a href="#mediasetdevicecontext" class="toc-h2 toc-link" data-title="MediaSetDeviceContext">MediaSetDeviceContext</a>
                  </li>
              </ul>
          </li>
          <li>
            <a href="#media-management-miscellaneous-interface" class="toc-h1 toc-link" data-title="Media Management - Miscellaneous Interface">Media Management - Miscellaneous Interface</a>
              <ul class="toc-list-h2">
                  <li>
                    <a href="#receiver-with-onscreen-binding" class="toc-h2 toc-link" data-title="Receiver with Onscreen Binding">Receiver with Onscreen Binding</a>
                  </li>
                  <li>
                    <a href="#sending-room-keypress-commands-from-receiver-driver" class="toc-h2 toc-link" data-title="Sending Room Keypress Commands from Receiver Driver">Sending Room Keypress Commands from Receiver Driver</a>
                  </li>
              </ul>
          </li>
          <li>
            <a href="#media-management-movies-interface" class="toc-h1 toc-link" data-title="Media Management - Movies Interface">Media Management - Movies Interface</a>
              <ul class="toc-list-h2">
                  <li>
                    <a href="#overview" class="toc-h2 toc-link" data-title="Overview">Overview</a>
                  </li>
                  <li>
                    <a href="#mediaaddmovieinfo" class="toc-h2 toc-link" data-title="MediaAddMovieInfo">MediaAddMovieInfo</a>
                  </li>
                  <li>
                    <a href="#mediagetallmovies" class="toc-h2 toc-link" data-title="MediaGetAllMovies">MediaGetAllMovies</a>
                  </li>
                  <li>
                    <a href="#mediagetmovieinfo" class="toc-h2 toc-link" data-title="MediaGetMovieInfo">MediaGetMovieInfo</a>
                  </li>
                  <li>
                    <a href="#mediagetmovielocation" class="toc-h2 toc-link" data-title="MediaGetMovieLocation">MediaGetMovieLocation</a>
                  </li>
                  <li>
                    <a href="#mediaremovemovie" class="toc-h2 toc-link" data-title="MediaRemoveMovie">MediaRemoveMovie</a>
                  </li>
                  <li>
                    <a href="#mediaremoveallmovies" class="toc-h2 toc-link" data-title="MediaRemoveAllMovies">MediaRemoveAllMovies</a>
                  </li>
                  <li>
                    <a href="#mediamodifymovieinfo" class="toc-h2 toc-link" data-title="MediaModifyMovieInfo">MediaModifyMovieInfo</a>
                  </li>
              </ul>
          </li>
          <li>
            <a href="#media-management-songs-interface" class="toc-h1 toc-link" data-title="Media Management - Songs Interface">Media Management - Songs Interface</a>
              <ul class="toc-list-h2">
                  <li>
                    <a href="#mediaaddsonginfo" class="toc-h2 toc-link" data-title="MediaAddSongInfo">MediaAddSongInfo</a>
                  </li>
                  <li>
                    <a href="#mediagetsonglocation" class="toc-h2 toc-link" data-title="MediaGetSongLocation">MediaGetSongLocation</a>
                  </li>
                  <li>
                    <a href="#mediaremovesong" class="toc-h2 toc-link" data-title="MediaRemoveSong">MediaRemoveSong</a>
                  </li>
                  <li>
                    <a href="#medialinksongtoalbum" class="toc-h2 toc-link" data-title="MediaLinkSongToAlbum">MediaLinkSongToAlbum</a>
                  </li>
                  <li>
                    <a href="#mediagetsongsforalbum" class="toc-h2 toc-link" data-title="MediaGetSongsforAlbum">MediaGetSongsforAlbum</a>
                  </li>
                  <li>
                    <a href="#mediamodifysonginfo" class="toc-h2 toc-link" data-title="MediaModifySongInfo">MediaModifySongInfo</a>
                  </li>
              </ul>
          </li>
          <li>
            <a href="#miscellaneous-interface" class="toc-h1 toc-link" data-title="Miscellaneous Interface">Miscellaneous Interface</a>
              <ul class="toc-list-h2">
                  <li>
                    <a href="#adddynamicbinding" class="toc-h2 toc-link" data-title="AddDynamicBinding">AddDynamicBinding</a>
                  </li>
                  <li>
                    <a href="#allowexecute" class="toc-h2 toc-link" data-title="AllowExecute">AllowExecute</a>
                  </li>
                  <li>
                    <a href="#base64encode" class="toc-h2 toc-link" data-title="Base64Encode">Base64Encode</a>
                  </li>
                  <li>
                    <a href="#base64decode" class="toc-h2 toc-link" data-title="Base64Decode">Base64Decode</a>
                  </li>
                  <li>
                    <a href="#persistdata" class="toc-h2 toc-link" data-title="PersistData">PersistData</a>
                  </li>
                  <li>
                    <a href="#exit-navigation" class="toc-h2 toc-link" data-title="Exit Navigation">Exit Navigation</a>
                  </li>
                  <li>
                    <a href="#getcapability" class="toc-h2 toc-link" data-title="GetCapability">GetCapability</a>
                  </li>
                  <li>
                    <a href="#getdevicedata" class="toc-h2 toc-link" data-title="GetDeviceData">GetDeviceData</a>
                  </li>
                  <li>
                    <a href="#getdevices" class="toc-h2 toc-link" data-title="GetDevices">GetDevices</a>
                  </li>
                  <li>
                    <a href="#getdevicesbyname" class="toc-h2 toc-link" data-title="GetDevicesByName">GetDevicesByName</a>
                  </li>
                  <li>
                    <a href="#getdeviceid" class="toc-h2 toc-link" data-title="GetDeviceID">GetDeviceID</a>
                  </li>
                  <li>
                    <a href="#getdevicevariables" class="toc-h2 toc-link" data-title="GetDeviceVariables">GetDeviceVariables</a>
                  </li>
                  <li>
                    <a href="#getdriverconfiginfo" class="toc-h2 toc-link" data-title="GetDriverConfigInfo">GetDriverConfigInfo</a>
                  </li>
                  <li>
                    <a href="#getdriverfilename" class="toc-h2 toc-link" data-title="GetDriverFileName">GetDriverFileName</a>
                  </li>
                  <li>
                    <a href="#getlocale" class="toc-h2 toc-link" data-title="GetLocale">GetLocale</a>
                  </li>
                  <li>
                    <a href="#getprojecthierarchy" class="toc-h2 toc-link" data-title="GetProjectHierarchy">GetProjectHierarchy</a>
                  </li>
                  <li>
                    <a href="#getprivatekeypassword" class="toc-h2 toc-link" data-title="GetPrivateKeyPassword">GetPrivateKeyPassword</a>
                  </li>
                  <li>
                    <a href="#getprojectitems" class="toc-h2 toc-link" data-title="GetProjectItems">GetProjectItems</a>
                  </li>
                  <li>
                    <a href="#getsystemtype" class="toc-h2 toc-link" data-title="GetSystemType">GetSystemType</a>
                  </li>
                  <li>
                    <a href="#gettext" class="toc-h2 toc-link" data-title="GetText">GetText</a>
                  </li>
                  <li>
                    <a href="#getuniquemac" class="toc-h2 toc-link" data-title="GetUniqueMAC">GetUniqueMAC</a>
                  </li>
                  <li>
                    <a href="#ntoh-1" class="toc-h2 toc-link" data-title="ntoh  1">ntoh  1</a>
                  </li>
                  <li>
                    <a href="#htoh-2" class="toc-h2 toc-link" data-title="htoh  2">htoh  2</a>
                  </li>
                  <li>
                    <a href="#onbindingchanged" class="toc-h2 toc-link" data-title="OnBindingChanged">OnBindingChanged</a>
                  </li>
                  <li>
                    <a href="#ondriverdestroyed" class="toc-h2 toc-link" data-title="OnDriverDestroyed">OnDriverDestroyed</a>
                  </li>
                  <li>
                    <a href="#ondriverinit" class="toc-h2 toc-link" data-title="OnDriverInit">OnDriverInit</a>
                  </li>
                  <li>
                    <a href="#ondriverlateinit" class="toc-h2 toc-link" data-title="OnDriverLateInit">OnDriverLateInit</a>
                  </li>
                  <li>
                    <a href="#safe-usage-of-ondriverinit-and-ondriverlateinit" class="toc-h2 toc-link" data-title="Safe Usage of OnDriverInit and OnDriverLateInit">Safe Usage of OnDriverInit and OnDriverLateInit</a>
                  </li>
                  <li>
                    <a href="#ondriver-removedfromproject" class="toc-h2 toc-link" data-title="OnDriver RemovedFromProject">OnDriver RemovedFromProject</a>
                  </li>
                  <li>
                    <a href="#parseiso8601datetime" class="toc-h2 toc-link" data-title="ParseIso8601DateTime">ParseIso8601DateTime</a>
                  </li>
                  <li>
                    <a href="#persistdeleteall" class="toc-h2 toc-link" data-title="PersistDeleteAll">PersistDeleteAll</a>
                  </li>
                  <li>
                    <a href="#persistgetvalue" class="toc-h2 toc-link" data-title="PersistGetValue">PersistGetValue</a>
                  </li>
                  <li>
                    <a href="#persistsetvalue" class="toc-h2 toc-link" data-title="PersistSetValue">PersistSetValue</a>
                  </li>
                  <li>
                    <a href="#removedynamicbinding" class="toc-h2 toc-link" data-title="RemoveDynamicBinding">RemoveDynamicBinding</a>
                  </li>
                  <li>
                    <a href="#renamedevice" class="toc-h2 toc-link" data-title="RenameDevice">RenameDevice</a>
                  </li>
                  <li>
                    <a href="#roomgetid" class="toc-h2 toc-link" data-title="RoomGetId">RoomGetId</a>
                  </li>
                  <li>
                    <a href="#roomselectnav" class="toc-h2 toc-link" data-title="RoomSelectNav">RoomSelectNav</a>
                  </li>
                  <li>
                    <a href="#senddatatoui" class="toc-h2 toc-link" data-title="SendDataToUI">SendDataToUI</a>
                  </li>
                  <li>
                    <a href="#senduirequest" class="toc-h2 toc-link" data-title="SendUIRequest">SendUIRequest</a>
                  </li>
                  <li>
                    <a href="#setpropertyattribs" class="toc-h2 toc-link" data-title="SetPropertyAttribs">SetPropertyAttribs</a>
                  </li>
                  <li>
                    <a href="#teadecrypt" class="toc-h2 toc-link" data-title="TEADecrypt">TEADecrypt</a>
                  </li>
                  <li>
                    <a href="#teaencrypt" class="toc-h2 toc-link" data-title="TEAEncrypt">TEAEncrypt</a>
                  </li>
              </ul>
          </li>
          <li>
            <a href="#notification-interface" class="toc-h1 toc-link" data-title="Notification Interface">Notification Interface</a>
              <ul class="toc-list-h2">
                  <li>
                    <a href="#notification-interface" class="toc-h2 toc-link" data-title="Notification Interface">Notification Interface</a>
                  </li>
                  <li>
                    <a href="#getnotificationattachmenturl" class="toc-h2 toc-link" data-title="GetNotificationAttachmentURL">GetNotificationAttachmentURL</a>
                  </li>
                  <li>
                    <a href="#getnotificationattachmentfile" class="toc-h2 toc-link" data-title="GetNotificationAttachmentFile">GetNotificationAttachmentFile</a>
                  </li>
                  <li>
                    <a href="#getnotificationattachmentbytes" class="toc-h2 toc-link" data-title="GetNotificationAttachmentBytes">GetNotificationAttachmentBytes</a>
                  </li>
                  <li>
                    <a href="#finishedwithnotificationattachment" class="toc-h2 toc-link" data-title="FinishedWithNotificationAttachment">FinishedWithNotificationAttachment</a>
                  </li>
                  <li>
                    <a href="#refresh-navigator" class="toc-h2 toc-link" data-title="Refresh Navigator">Refresh Navigator</a>
                  </li>
              </ul>
          </li>
          <li>
            <a href="#properties-interface" class="toc-h1 toc-link" data-title="Properties Interface">Properties Interface</a>
              <ul class="toc-list-h2">
                  <li>
                    <a href="#properties-table" class="toc-h2 toc-link" data-title="Properties Table">Properties Table</a>
                  </li>
                  <li>
                    <a href="#getprojectproperty" class="toc-h2 toc-link" data-title="GetProjectProperty">GetProjectProperty</a>
                  </li>
                  <li>
                    <a href="#onpropertychanged" class="toc-h2 toc-link" data-title="OnPropertyChanged">OnPropertyChanged</a>
                  </li>
                  <li>
                    <a href="#setpropertyattribs" class="toc-h2 toc-link" data-title="SetPropertyAttribs">SetPropertyAttribs</a>
                  </li>
                  <li>
                    <a href="#updateproperty" class="toc-h2 toc-link" data-title="UpdateProperty">UpdateProperty</a>
                  </li>
                  <li>
                    <a href="#updatepropertylist" class="toc-h2 toc-link" data-title="UpdatePropertyList">UpdatePropertyList</a>
                  </li>
              </ul>
          </li>
          <li>
            <a href="#proxy-interface" class="toc-h1 toc-link" data-title="Proxy Interface">Proxy Interface</a>
              <ul class="toc-list-h2">
                  <li>
                    <a href="#getproxydevices" class="toc-h2 toc-link" data-title="GetProxyDevices">GetProxyDevices</a>
                  </li>
                  <li>
                    <a href="#getproxydevicesbyid" class="toc-h2 toc-link" data-title="GetProxyDevicesById">GetProxyDevicesById</a>
                  </li>
                  <li>
                    <a href="#getproxydevicesbyname" class="toc-h2 toc-link" data-title="GetProxyDevicesByName">GetProxyDevicesByName</a>
                  </li>
                  <li>
                    <a href="#getdevicesbyc4iname" class="toc-h2 toc-link" data-title="GetDevicesByC4iName">GetDevicesByC4iName</a>
                  </li>
                  <li>
                    <a href="#receivedfromproxy" class="toc-h2 toc-link" data-title="ReceivedFromProxy">ReceivedFromProxy</a>
                  </li>
                  <li>
                    <a href="#sendtoproxy" class="toc-h2 toc-link" data-title="SendToProxy">SendToProxy</a>
                  </li>
              </ul>
          </li>
          <li>
            <a href="#registry-interface" class="toc-h1 toc-link" data-title="Registry Interface">Registry Interface</a>
              <ul class="toc-list-h2">
                  <li>
                    <a href="#introduction" class="toc-h2 toc-link" data-title="Introduction">Introduction</a>
                  </li>
                  <li>
                    <a href="#registrydeletevalue" class="toc-h2 toc-link" data-title="RegistryDeleteValue">RegistryDeleteValue</a>
                  </li>
                  <li>
                    <a href="#registrygetvalue" class="toc-h2 toc-link" data-title="RegistryGetValue">RegistryGetValue</a>
                  </li>
                  <li>
                    <a href="#registrysetvalue" class="toc-h2 toc-link" data-title="RegistrySetValue">RegistrySetValue</a>
                  </li>
              </ul>
          </li>
          <li>
            <a href="#scheduler-agent-interface" class="toc-h1 toc-link" data-title="Scheduler Agent Interface">Scheduler Agent Interface</a>
              <ul class="toc-list-h2">
                  <li>
                    <a href="#overview" class="toc-h2 toc-link" data-title="Overview">Overview</a>
                  </li>
              </ul>
          </li>
          <li>
            <a href="#schedule-agent-add-event-interface" class="toc-h1 toc-link" data-title="Schedule Agent - Add Event Interface">Schedule Agent - Add Event Interface</a>
              <ul class="toc-list-h2">
                  <li>
                    <a href="#addsingledayentry" class="toc-h2 toc-link" data-title="AddSingleDayEntry">AddSingleDayEntry</a>
                  </li>
                  <li>
                    <a href="#adddailyrepeatentry" class="toc-h2 toc-link" data-title="AddDailyRepeatEntry">AddDailyRepeatEntry</a>
                  </li>
                  <li>
                    <a href="#adddailyrepeatrandomoffsetentry" class="toc-h2 toc-link" data-title="AddDailyRepeatRandomOffsetEntry">AddDailyRepeatRandomOffsetEntry</a>
                  </li>
                  <li>
                    <a href="#adddailyrepeatxdaysentry" class="toc-h2 toc-link" data-title="AddDailyRepeatXDaysEntry">AddDailyRepeatXDaysEntry</a>
                  </li>
                  <li>
                    <a href="#adddailysunriseentry" class="toc-h2 toc-link" data-title="AddDailySunriseEntry">AddDailySunriseEntry</a>
                  </li>
                  <li>
                    <a href="#adddailysunriseoffsetentry" class="toc-h2 toc-link" data-title="AddDailySunriseOffsetEntry">AddDailySunriseOffsetEntry</a>
                  </li>
                  <li>
                    <a href="#adddailysunriserandomoffsetentry" class="toc-h2 toc-link" data-title="AddDailySunriseRandomOffsetEntry">AddDailySunriseRandomOffsetEntry</a>
                  </li>
                  <li>
                    <a href="#adddailysunsetentry" class="toc-h2 toc-link" data-title="AddDailySunsetEntry">AddDailySunsetEntry</a>
                  </li>
                  <li>
                    <a href="#adddailysunsetoffsetentry" class="toc-h2 toc-link" data-title="AddDailySunsetOffsetEntry">AddDailySunsetOffsetEntry</a>
                  </li>
                  <li>
                    <a href="#adddailysunsetrandomoffsetentry" class="toc-h2 toc-link" data-title="AddDailySunsetRandomOffsetEntry">AddDailySunsetRandomOffsetEntry</a>
                  </li>
                  <li>
                    <a href="#addendofmonthentry" class="toc-h2 toc-link" data-title="AddEndOfMonthEntry">AddEndOfMonthEntry</a>
                  </li>
                  <li>
                    <a href="#addendofmonthrepeatentry" class="toc-h2 toc-link" data-title="AddEndOfMonthRepeatEntry">AddEndOfMonthRepeatEntry</a>
                  </li>
                  <li>
                    <a href="#addnthweekdayofmonthentry" class="toc-h2 toc-link" data-title="AddNthWeekdayOfMonthEntry">AddNthWeekdayOfMonthEntry</a>
                  </li>
                  <li>
                    <a href="#addnthweekdayofmonthrepeatentry" class="toc-h2 toc-link" data-title="AddNthWeekdayOfMonthRepeatEntry">AddNthWeekdayOfMonthRepeatEntry</a>
                  </li>
                  <li>
                    <a href="#adddaysoftheweekentry" class="toc-h2 toc-link" data-title="AddDaysOfTheWeekEntry">AddDaysOfTheWeekEntry</a>
                  </li>
                  <li>
                    <a href="#addeveryxmonthsentry" class="toc-h2 toc-link" data-title="AddEveryXMonthsEntry">AddEveryXMonthsEntry</a>
                  </li>
                  <li>
                    <a href="#addsetdayseveryxweeksentry" class="toc-h2 toc-link" data-title="AddSetDaysEveryXWeeksEntry">AddSetDaysEveryXWeeksEntry</a>
                  </li>
                  <li>
                    <a href="#addsetdayseveryxyearsentry" class="toc-h2 toc-link" data-title="AddSetDaysEveryXYearsEntry">AddSetDaysEveryXYearsEntry</a>
                  </li>
              </ul>
          </li>
          <li>
            <a href="#schedule-agent-delete-event-interface" class="toc-h1 toc-link" data-title="Schedule Agent - Delete Event Interface">Schedule Agent - Delete Event Interface</a>
              <ul class="toc-list-h2">
                  <li>
                    <a href="#deleteentrybyid" class="toc-h2 toc-link" data-title="DeleteEntryByID">DeleteEntryByID</a>
                  </li>
                  <li>
                    <a href="#deleteentrybyname" class="toc-h2 toc-link" data-title="DeleteEntryByName">DeleteEntryByName</a>
                  </li>
              </ul>
          </li>
          <li>
            <a href="#schedule-agent-get-event-interface" class="toc-h1 toc-link" data-title="Schedule Agent - Get Event Interface">Schedule Agent - Get Event Interface</a>
              <ul class="toc-list-h2">
                  <li>
                    <a href="#getentries" class="toc-h2 toc-link" data-title="GetEntries">GetEntries</a>
                  </li>
                  <li>
                    <a href="#getentry" class="toc-h2 toc-link" data-title="GetEntry">GetEntry</a>
                  </li>
              </ul>
          </li>
          <li>
            <a href="#schedule-agent-modify-event-interface" class="toc-h1 toc-link" data-title="Schedule Agent - Modify Event Interface">Schedule Agent - Modify Event Interface</a>
              <ul class="toc-list-h2">
                  <li>
                    <a href="#modifysingledayentry" class="toc-h2 toc-link" data-title="ModifySingleDayEntry">ModifySingleDayEntry</a>
                  </li>
                  <li>
                    <a href="#modifydailyrepeatentry" class="toc-h2 toc-link" data-title="ModifyDailyRepeatEntry">ModifyDailyRepeatEntry</a>
                  </li>
                  <li>
                    <a href="#modifydailyrepeatrandomoffsetentry" class="toc-h2 toc-link" data-title="ModifyDailyRepeatRandomOffsetEntry">ModifyDailyRepeatRandomOffsetEntry</a>
                  </li>
                  <li>
                    <a href="#modifydailyrepeatxdaysentry" class="toc-h2 toc-link" data-title="ModifyDailyRepeatXDaysEntry">ModifyDailyRepeatXDaysEntry</a>
                  </li>
                  <li>
                    <a href="#modifydailysunriseentry" class="toc-h2 toc-link" data-title="ModifyDailySunriseEntry">ModifyDailySunriseEntry</a>
                  </li>
                  <li>
                    <a href="#modifydailysunriseoffsetentry" class="toc-h2 toc-link" data-title="ModifyDailySunriseOffsetEntry">ModifyDailySunriseOffsetEntry</a>
                  </li>
                  <li>
                    <a href="#modifydailysunriserandomoffsetentry" class="toc-h2 toc-link" data-title="ModifyDailySunriseRandomOffsetEntry">ModifyDailySunriseRandomOffsetEntry</a>
                  </li>
                  <li>
                    <a href="#modifydailysunsetentry" class="toc-h2 toc-link" data-title="ModifyDailySunsetEntry">ModifyDailySunsetEntry</a>
                  </li>
                  <li>
                    <a href="#modifydailysunsetoffsetentry" class="toc-h2 toc-link" data-title="ModifyDailySunsetOffsetEntry">ModifyDailySunsetOffsetEntry</a>
                  </li>
                  <li>
                    <a href="#modifydailysunsetrandomoffsetentry" class="toc-h2 toc-link" data-title="ModifyDailySunsetRandomOffsetEntry">ModifyDailySunsetRandomOffsetEntry</a>
                  </li>
                  <li>
                    <a href="#modifyendofmonthentry" class="toc-h2 toc-link" data-title="ModifyEndOfMonthEntry">ModifyEndOfMonthEntry</a>
                  </li>
                  <li>
                    <a href="#modifyendofmonthrepeatentry" class="toc-h2 toc-link" data-title="ModifyEndOfMonthRepeatEntry">ModifyEndOfMonthRepeatEntry</a>
                  </li>
                  <li>
                    <a href="#modifynthweekdayofmonthentry" class="toc-h2 toc-link" data-title="ModifyNthWeekdayOfMonthEntry">ModifyNthWeekdayOfMonthEntry</a>
                  </li>
                  <li>
                    <a href="#modifynthweekdayofmonthrepeatentry" class="toc-h2 toc-link" data-title="ModifyNthWeekdayOfMonthRepeatEntry">ModifyNthWeekdayOfMonthRepeatEntry</a>
                  </li>
                  <li>
                    <a href="#modifydaysoftheweekentry" class="toc-h2 toc-link" data-title="ModifyDaysOfTheWeekEntry">ModifyDaysOfTheWeekEntry</a>
                  </li>
                  <li>
                    <a href="#modifyeveryxmonthsentry" class="toc-h2 toc-link" data-title="ModifyEveryXMonthsEntry">ModifyEveryXMonthsEntry</a>
                  </li>
                  <li>
                    <a href="#modifyeveryxyearsentry" class="toc-h2 toc-link" data-title="ModifyEveryXYearsEntry">ModifyEveryXYearsEntry</a>
                  </li>
                  <li>
                    <a href="#modifysetdayseveryxweeksentry" class="toc-h2 toc-link" data-title="ModifySetDaysEveryXWeeksEntry">ModifySetDaysEveryXWeeksEntry</a>
                  </li>
                  <li>
                    <a href="#modifyname" class="toc-h2 toc-link" data-title="ModifyName">ModifyName</a>
                  </li>
                  <li>
                    <a href="#modifyoptions" class="toc-h2 toc-link" data-title="ModifyOptions">ModifyOptions</a>
                  </li>
                  <li>
                    <a href="#modifystartdate" class="toc-h2 toc-link" data-title="ModifyStartDate">ModifyStartDate</a>
                  </li>
                  <li>
                    <a href="#modifystarttime" class="toc-h2 toc-link" data-title="ModifyStartTime">ModifyStartTime</a>
                  </li>
              </ul>
          </li>
          <li>
            <a href="#serial-and-network-interface" class="toc-h1 toc-link" data-title="Serial and Network Interface">Serial and Network Interface</a>
              <ul class="toc-list-h2">
                  <li>
                    <a href="#createnetworkconnection" class="toc-h2 toc-link" data-title="CreateNetworkConnection">CreateNetworkConnection</a>
                  </li>
                  <li>
                    <a href="#getbindingaddress" class="toc-h2 toc-link" data-title="GetBindingAddress">GetBindingAddress</a>
                  </li>
                  <li>
                    <a href="#getboundconsumerdevices" class="toc-h2 toc-link" data-title="GetBoundConsumerDevices">GetBoundConsumerDevices</a>
                  </li>
                  <li>
                    <a href="#getboundproviderdevice" class="toc-h2 toc-link" data-title="GetBoundProviderDevice">GetBoundProviderDevice</a>
                  </li>
                  <li>
                    <a href="#getcontrollernetworkaddress" class="toc-h2 toc-link" data-title="GetControllerNetworkAddress">GetControllerNetworkAddress</a>
                  </li>
                  <li>
                    <a href="#getdevicedisplayname" class="toc-h2 toc-link" data-title="GetDeviceDisplayName">GetDeviceDisplayName</a>
                  </li>
                  <li>
                    <a href="#getdevicemac" class="toc-h2 toc-link" data-title="GetDeviceMAC">GetDeviceMAC</a>
                  </li>
                  <li>
                    <a href="#getdiscoveryinfo" class="toc-h2 toc-link" data-title="GetDiscoveryInfo">GetDiscoveryInfo</a>
                  </li>
                  <li>
                    <a href="#getmynetworkaddress" class="toc-h2 toc-link" data-title="GetMyNetworkAddress">GetMyNetworkAddress</a>
                  </li>
                  <li>
                    <a href="#getnetworkbindingsbydevice" class="toc-h2 toc-link" data-title="GetNetworkBindingsByDevice">GetNetworkBindingsByDevice</a>
                  </li>
                  <li>
                    <a href="#getnetworkconnections" class="toc-h2 toc-link" data-title="GetNetworkConnections">GetNetworkConnections</a>
                  </li>
                  <li>
                    <a href="#getproxydevicesbyid" class="toc-h2 toc-link" data-title="GetProxyDevicesbyID">GetProxyDevicesbyID</a>
                  </li>
                  <li>
                    <a href="#getserialsettings" class="toc-h2 toc-link" data-title="GetSerialSettings">GetSerialSettings</a>
                  </li>
                  <li>
                    <a href="#receivedfromserial" class="toc-h2 toc-link" data-title="ReceivedFromSerial">ReceivedFromSerial</a>
                  </li>
                  <li>
                    <a href="#receivedfromnetwork" class="toc-h2 toc-link" data-title="ReceivedFromNetwork">ReceivedFromNetwork</a>
                  </li>
                  <li>
                    <a href="#setbindingaddress" class="toc-h2 toc-link" data-title="SetBindingAddress">SetBindingAddress</a>
                  </li>
                  <li>
                    <a href="#setbindingstatus" class="toc-h2 toc-link" data-title="SetBindingStatus">SetBindingStatus</a>
                  </li>
                  <li>
                    <a href="#sendbroadcast" class="toc-h2 toc-link" data-title="SendBroadcast">SendBroadcast</a>
                  </li>
                  <li>
                    <a href="#sendtodevice" class="toc-h2 toc-link" data-title="SendToDevice">SendToDevice</a>
                  </li>
                  <li>
                    <a href="#sendtonetwork" class="toc-h2 toc-link" data-title="SendToNetwork">SendToNetwork</a>
                  </li>
                  <li>
                    <a href="#sendtoserial" class="toc-h2 toc-link" data-title="SendToSerial">SendToSerial</a>
                  </li>
                  <li>
                    <a href="#sendwol" class="toc-h2 toc-link" data-title="SendWOL">SendWOL</a>
                  </li>
                  <li>
                    <a href="#netconnect" class="toc-h2 toc-link" data-title="NetConnect">NetConnect</a>
                  </li>
                  <li>
                    <a href="#netdisconnect" class="toc-h2 toc-link" data-title="NetDisconnect">NetDisconnect</a>
                  </li>
                  <li>
                    <a href="#netportoptions" class="toc-h2 toc-link" data-title="NetPortOptions">NetPortOptions</a>
                  </li>
                  <li>
                    <a href="#onbindingvalidate" class="toc-h2 toc-link" data-title="OnBindingValidate">OnBindingValidate</a>
                  </li>
                  <li>
                    <a href="#onconnectionstatuschanged" class="toc-h2 toc-link" data-title="OnConnectionStatusChanged">OnConnectionStatusChanged</a>
                  </li>
                  <li>
                    <a href="#onnetworkbindingchanged" class="toc-h2 toc-link" data-title="OnNetworkBindingChanged">OnNetworkBindingChanged</a>
                  </li>
                  <li>
                    <a href="#sample-tcp-connection" class="toc-h2 toc-link" data-title="Sample TCP Connection">Sample TCP Connection</a>
                  </li>
                  <li>
                    <a href="#sample-ssl-multi-port-connection" class="toc-h2 toc-link" data-title="Sample SSL (Multi-Port) Connection">Sample SSL (Multi-Port) Connection</a>
                  </li>
              </ul>
          </li>
          <li>
            <a href="#server-socket-interface" class="toc-h1 toc-link" data-title="Server Socket Interface">Server Socket Interface</a>
              <ul class="toc-list-h2">
                  <li>
                    <a href="#overview" class="toc-h2 toc-link" data-title="Overview">Overview</a>
                  </li>
                  <li>
                    <a href="#createserver" class="toc-h2 toc-link" data-title="CreateServer">CreateServer</a>
                  </li>
                  <li>
                    <a href="#destroyserver" class="toc-h2 toc-link" data-title="DestroyServer">DestroyServer</a>
                  </li>
                  <li>
                    <a href="#onserverconnectionstatuschanged" class="toc-h2 toc-link" data-title="OnServerConnectionStatusChanged">OnServerConnectionStatusChanged</a>
                  </li>
                  <li>
                    <a href="#onserverdatain" class="toc-h2 toc-link" data-title="OnServerDataIn">OnServerDataIn</a>
                  </li>
                  <li>
                    <a href="#serversend" class="toc-h2 toc-link" data-title="ServerSend">ServerSend</a>
                  </li>
                  <li>
                    <a href="#servercloseclient" class="toc-h2 toc-link" data-title="ServerCloseClient">ServerCloseClient</a>
                  </li>
              </ul>
          </li>
          <li>
            <a href="#timer-interface" class="toc-h1 toc-link" data-title="Timer Interface">Timer Interface</a>
              <ul class="toc-list-h2">
                  <li>
                    <a href="#settimer" class="toc-h2 toc-link" data-title="SetTimer">SetTimer</a>
                  </li>
                  <li>
                    <a href="#gettime" class="toc-h2 toc-link" data-title="GetTime">GetTime</a>
                  </li>
              </ul>
          </li>
          <li>
            <a href="#url-interface" class="toc-h1 toc-link" data-title="URL Interface">URL Interface</a>
              <ul class="toc-list-h2">
                  <li>
                    <a href="#overview" class="toc-h2 toc-link" data-title="Overview">Overview</a>
                  </li>
                  <li>
                    <a href="#cancel" class="toc-h2 toc-link" data-title="Cancel">Cancel</a>
                  </li>
                  <li>
                    <a href="#custom" class="toc-h2 toc-link" data-title="Custom">Custom</a>
                  </li>
                  <li>
                    <a href="#delete" class="toc-h2 toc-link" data-title="Delete">Delete</a>
                  </li>
                  <li>
                    <a href="#get" class="toc-h2 toc-link" data-title="Get">Get</a>
                  </li>
                  <li>
                    <a href="#onbody" class="toc-h2 toc-link" data-title="OnBody">OnBody</a>
                  </li>
                  <li>
                    <a href="#onbodychunk" class="toc-h2 toc-link" data-title="OnBodychunk">OnBodychunk</a>
                  </li>
                  <li>
                    <a href="#ondone" class="toc-h2 toc-link" data-title="OnDone">OnDone</a>
                  </li>
                  <li>
                    <a href="#onheaders" class="toc-h2 toc-link" data-title="OnHeaders">OnHeaders</a>
                  </li>
                  <li>
                    <a href="#post" class="toc-h2 toc-link" data-title="Post">Post</a>
                  </li>
                  <li>
                    <a href="#put" class="toc-h2 toc-link" data-title="Put">Put</a>
                  </li>
                  <li>
                    <a href="#setoption" class="toc-h2 toc-link" data-title="SetOption">SetOption</a>
                  </li>
                  <li>
                    <a href="#setoptions" class="toc-h2 toc-link" data-title="SetOptions">SetOptions</a>
                  </li>
                  <li>
                    <a href="#ticketid" class="toc-h2 toc-link" data-title="TicketId">TicketId</a>
                  </li>
              </ul>
          </li>
          <li>
            <a href="#variable-interface" class="toc-h1 toc-link" data-title="Variable Interface">Variable Interface</a>
              <ul class="toc-list-h2">
                  <li>
                    <a href="#addvariable" class="toc-h2 toc-link" data-title="AddVariable">AddVariable</a>
                  </li>
                  <li>
                    <a href="#deletevariable" class="toc-h2 toc-link" data-title="DeleteVariable">DeleteVariable</a>
                  </li>
                  <li>
                    <a href="#driverworks-variable-table" class="toc-h2 toc-link" data-title="DriverWorks Variable Table">DriverWorks Variable Table</a>
                  </li>
                  <li>
                    <a href="#getvariable" class="toc-h2 toc-link" data-title="GetVariable">GetVariable</a>
                  </li>
                  <li>
                    <a href="#getdevicevariable" class="toc-h2 toc-link" data-title="GetDeviceVariable">GetDeviceVariable</a>
                  </li>
                  <li>
                    <a href="#setdevicevariable" class="toc-h2 toc-link" data-title="SetDeviceVariable">SetDeviceVariable</a>
                  </li>
                  <li>
                    <a href="#setvariable" class="toc-h2 toc-link" data-title="SetVariable">SetVariable</a>
                  </li>
                  <li>
                    <a href="#onvariablechanged" class="toc-h2 toc-link" data-title="OnVariableChanged">OnVariableChanged</a>
                  </li>
                  <li>
                    <a href="#onwatchedvariablechanged" class="toc-h2 toc-link" data-title="OnWatchedVariableChanged">OnWatchedVariableChanged</a>
                  </li>
                  <li>
                    <a href="#registervariablelistener" class="toc-h2 toc-link" data-title="RegisterVariableListener">RegisterVariableListener</a>
                  </li>
                  <li>
                    <a href="#unregisterallvariablelisteners" class="toc-h2 toc-link" data-title="UnRegisterAllVariableListeners">UnRegisterAllVariableListeners</a>
                  </li>
                  <li>
                    <a href="#unregistervariablelistener" class="toc-h2 toc-link" data-title="UnregisterVariableListener">UnregisterVariableListener</a>
                  </li>
                  <li>
                    <a href="#list-of-room-variables" class="toc-h2 toc-link" data-title="List of Room Variables">List of Room Variables</a>
                  </li>
              </ul>
          </li>
          <li>
            <a href="#web-service-interface" class="toc-h1 toc-link" data-title="Web Service Interface">Web Service Interface</a>
              <ul class="toc-list-h2">
                  <li>
                    <a href="#overview" class="toc-h2 toc-link" data-title="Overview">Overview</a>
                  </li>
                  <li>
                    <a href="#receivedasync" class="toc-h2 toc-link" data-title="ReceivedAsync">ReceivedAsync</a>
                  </li>
                  <li>
                    <a href="#urlcancel" class="toc-h2 toc-link" data-title="urlCancel">urlCancel</a>
                  </li>
                  <li>
                    <a href="#urlcancelall" class="toc-h2 toc-link" data-title="urlCancelAll">urlCancelAll</a>
                  </li>
                  <li>
                    <a href="#urlclearcookies" class="toc-h2 toc-link" data-title="urlClearCookies">urlClearCookies</a>
                  </li>
                  <li>
                    <a href="#urlclearsessioncookies" class="toc-h2 toc-link" data-title="urlClearSessionCookies">urlClearSessionCookies</a>
                  </li>
                  <li>
                    <a href="#urlgetcookies" class="toc-h2 toc-link" data-title="urlGetCookies">urlGetCookies</a>
                  </li>
                  <li>
                    <a href="#urlgetcookiesfordomain" class="toc-h2 toc-link" data-title="urlGetCookiesForDomain">urlGetCookiesForDomain</a>
                  </li>
                  <li>
                    <a href="#urlgetoption" class="toc-h2 toc-link" data-title="urlGetOption">urlGetOption</a>
                  </li>
                  <li>
                    <a href="#urlgettickets" class="toc-h2 toc-link" data-title="urlGetTickets">urlGetTickets</a>
                  </li>
                  <li>
                    <a href="#urlsetoption" class="toc-h2 toc-link" data-title="urlSetOption">urlSetOption</a>
                  </li>
                  <li>
                    <a href="#urlsetproxy" class="toc-h2 toc-link" data-title="urlSetProxy">urlSetProxy</a>
                  </li>
                  <li>
                    <a href="#usage-note" class="toc-h2 toc-link" data-title="Usage Note">Usage Note</a>
                  </li>
                  <li>
                    <a href="#urlsettimeout" class="toc-h2 toc-link" data-title="urlSetTimeout">urlSetTimeout</a>
                  </li>
                  <li>
                    <a href="#usage-notes" class="toc-h2 toc-link" data-title="Usage Notes">Usage Notes</a>
                  </li>
              </ul>
          </li>
          <li>
            <a href="#zigbee-interface" class="toc-h1 toc-link" data-title="Zigbee Interface">Zigbee Interface</a>
              <ul class="toc-list-h2">
                  <li>
                    <a href="#overview" class="toc-h2 toc-link" data-title="Overview">Overview</a>
                  </li>
                  <li>
                    <a href="#updating-zigbee-device-firmware-using-driverworks" class="toc-h2 toc-link" data-title="Updating Zigbee Device firmware Using DriverWorks">Updating Zigbee Device firmware Using DriverWorks</a>
                  </li>
                  <li>
                    <a href="#getblobbyname" class="toc-h2 toc-link" data-title="GetBlobByName">GetBlobByName</a>
                  </li>
                  <li>
                    <a href="#getzigbeeeuid" class="toc-h2 toc-link" data-title="GetZigbeeEUID">GetZigbeeEUID</a>
                  </li>
                  <li>
                    <a href="#keepreflashlock" class="toc-h2 toc-link" data-title="KeepReflashLock">KeepReflashLock</a>
                  </li>
                  <li>
                    <a href="#onreflashlockgranted" class="toc-h2 toc-link" data-title="OnReflashLockGranted">OnReflashLockGranted</a>
                  </li>
                  <li>
                    <a href="#onreflashlockrevoked" class="toc-h2 toc-link" data-title="OnReflashLockRevoked">OnReflashLockRevoked</a>
                  </li>
                  <li>
                    <a href="#onzigbeeonlinestatuschanged" class="toc-h2 toc-link" data-title="OnZigbeeOnlineStatusChanged">OnZigbeeOnlineStatusChanged</a>
                  </li>
                  <li>
                    <a href="#sendzigbeepacket" class="toc-h2 toc-link" data-title="SendZigbeePacket">SendZigbeePacket</a>
                  </li>
                  <li>
                    <a href="#onzigbeepacketin" class="toc-h2 toc-link" data-title="OnZigbeePacketIn">OnZigbeePacketIn</a>
                  </li>
                  <li>
                    <a href="#onzigbeepacketfailed" class="toc-h2 toc-link" data-title="OnZigbeePacketFailed">OnZigbeePacketFailed</a>
                  </li>
                  <li>
                    <a href="#onzigbeepacketsuccess" class="toc-h2 toc-link" data-title="OnZigbeePacketSuccess">OnZigbeePacketSuccess</a>
                  </li>
                  <li>
                    <a href="#releasereflashlock" class="toc-h2 toc-link" data-title="ReleaseReflashLock">ReleaseReflashLock</a>
                  </li>
                  <li>
                    <a href="#requestreflashlock" class="toc-h2 toc-link" data-title="RequestReflashLock">RequestReflashLock</a>
                  </li>
              </ul>
          </li>
      </ul>
        <ul class="toc-footer">
            <li><a href='https://github.com/lord/slate'>Documentation Powered by Slate</a></li>
        </ul>
    </div>
    <div class="page-wrapper">
      <div class="dark-box"></div>
      <div class="content">
        <h1 id='license-copyright-and-trademark'>License, Copyright, and Trademark</h1>

<p>The content contained in this repository is the intellectual property of Snap One, LLC, (formerly known as Wirepath Home Systems, LLC), and use without a valid license from Snap One is strictly prohibited. The user of this repository shall keep all content contained herein confidential and shall protect this content in whole or in part from disclosure to any and all third parties except as specifically authorized in writing by Snap One.</p>

<p><strong>License and Intellectual Property Disclaimer</strong></p>

<p>The content in this repository is provided in connection with Snap One products. No license, express or implied, by estoppal or otherwise, to any intellectual property rights is granted by this document or in this repository. Except as provided in Snap Oneʼs terms and conditions for the license of such products, Snap One and its affiliates assume no liability whatsoever and disclaim any express or implied warranty, relating to the sale and/or use of Snap One products including liability or warranties relating to fitness for a particular purpose, merchantability, or infringement of any patent, copyright or other intellectual property right. Snap One products are not intended for use in medical, lifesaving, or life sustaining applications.</p>

<p>Information regarding third-party products is provided solely for educational purposes. Snap One is not responsible for the performance or support of third-party products and does not make any representations or warranties whatsoever regarding the quality, reliability, functionality or compatibility of these products. The reader is advised that third parties can have intellectual property rights that can be relevant to this repository and the technologies discussed herein, and is advised to seek the advice of competent legal counsel regarding the intellectual property rights of third parties, without obligation of Snap One.</p>

<p>Snap One retains the right to make changes to this repository or related product specifications and descriptions in this repository, at any time, without notice. Snap One makes no warranty for the use of this repository and assumes no responsibility for any errors that can appear in the repository nor does it make a commitment to update the content contained herein.</p>

<p><strong>Copyright</strong></p>

<p>Copyright 2022 Snap One, LLC. All rights reserved.</p>

<p>The above copyright notice applies to all content in this repository unless otherwise stated explicitly herein that a third-party’s copyright applies.</p>

<p>No part of this publication may be reproduced, photocopied, stored on a retrieval system, or transmitted without the express written consent of the publisher.</p>

<p><strong>Trademarks</strong></p>

<p>Snap One and Snap One Logo, Control4 and the Control4 logo, and DriverWorks are trademarks or registered trademarks of  Snap One, LLC. Other product and company names mentioned in this repository may be the trademarks or registered trademarks of their respective owners.</p>

<p><strong> Derivative Works</strong></p>

<p>To the extent that you create any “Derivative Work” (meaning any work that is based upon one or more preexisting versions of the work provided to you in this repository, such as an enhancement or modification, revision, translation, abridgement, condensation, expansion, collection, compilation or any other form in which such preexisting works may be recast, modified, transformed or adapted, explicitly including without limitation, any updates or changes to Snap One, LLC’s software code or intellectual property) such Derivative Work shall be owned by Snap One, LLC and all right, title and interest in and to each such Derivative Work shall automatically vest in Snap One, LLC. To the extent any Derivative Work does not automatically vest in Snap One, LLC by operation of law, you hereby assign such Derivative Work to Snap One, LLC with full title guarantee. Snap One, LLC shall have no obligation to grant you any right in any such Derivative Work.</p>

<p><strong>Contact Us</strong></p>

<p>Snap One, LLC
11734 S. Election Road
Salt Lake City, UT 84020 USA</p>

<p><a href="www.control4.com">http://www.control4.com</a></p>
<h1 id='introduction'>Introduction</h1>

<p>Effective communication between your driver and Control4 System is paramount to a successful end user experience. The API Reference Guide details each of the Interfaces supported through the DriverWorksSDK. These Interfaces include numerous APIs that can be leveraged by your driver to  facilitate communication between the driver and the Control4 O.S.</p>
<h1 id='what-39-s-new'>What&#39;s New</h1>

<h2 id='what-s-new-in-3-3-0'>What’s New in 3.3.0</h2>

<p><strong>C4SSH Interface</strong></p>

<p>The DriverWorks API has been expanded with the addition of the new C4SSH API. This API enables Lua drivers to establish an SSH client connection to a remote device and execute a series of commands. A driver creates an instance of a C4SSH object by calling the<a href="https://snap-one.github.io/docs-driverworks-api/#createsshclient"> C4:CreateSSHClient</a> function.</p>

<p><strong>File Interface</strong></p>

<p>As part of Control4’s plan to tighten driver security, the io.popen() call has bee removed. In doing this, driver developers need to use C4:File commands to accomplish what they previously did with io.popen (). The following APIs have been added or modified in support of this effort:</p>

<p>A new API: <a href="https://snap-one.github.io/docs-driverworks-api/#filecreatedir">FileCreateDir</a> has been added. This function has been added to create a new file directory. </p>

<p>The <a href="https://snap-one.github.io/docs-driverworks-api/#filedelete">FileDelete</a> function has been modified in conjunction with O.S. release 3.3.0.  </p>

<p>A new API: <a href="https://snap-one.github.io/docs-driverworks-api/#filemove">FileMove</a> has been added. This function moves files within certain restrictions.  </p>

<p>The <a href="https://snap-one.github.io/docs-driverworks-api/#filesetdir">FileSetDir</a> has been modified In conjunction with O.S. release 3.3.0. This function is being restricted to allowed locations whereas previously it had full root access.</p>

<p>Additionally, a new API: <a href="https://snap-one.github.io/docs-driverworks-api/#unzip">UnZip</a> has been added. This API enables Lua drivers to extract one, or more, files from a .zip archive.</p>

<p><strong>Helper Interface</strong></p>

<p>A new API: <a href="https://snap-one.github.io/docs-driverworks-api/#getcodeitems">GetCodeItems</a> has been added. This function returns Code Items for a specified device and event.</p>

<p>A new API: <a href="https://snap-one.github.io/docs-driverworks-api/#getallcodeitems">GetAllCodeItems</a> has been added. This function returns all Code Items within the project.</p>

<p>A new API: <a href="https://snap-one.github.io/docs-driverworks-api/#getbootid">GetBootID</a> has been added. This function returns a string that contains an ID which is unique for the current kernel instance.  When the controller is re-booted, the ID will change.</p>

<p>A new API: <a href="https://snap-one.github.io/docs-driverworks-api/#uuid">UUID</a> has been added. This function generates a UUID (Universally Unique IDentifier). This function has also been added to tighten driver security and support the removal of the the io.popen() call.</p>

<p>A new API: CreateTLSServer has been added. This function enables a Lua driver to create a new secure SSL/TLS server that listens for incoming connections on a specified port.</p>

<h2 id='what-s-new-in-3-2-3'>What’s New in 3.2.3</h2>

<p><strong>Timer Interface</strong></p>

<p>A new API: <a href="https://snap-one.github.io/docs-driverworks-api/#gettime">GetTime</a> has been added to the Timer Interface in this version of the SDK. This API enables Lua drivers to retrieve the number of milliseconds since the epoch.</p>

<h2 id='what-s-new-in-3-2-2'>What’s New in 3.2.2</h2>

<p><strong>Variable Interface</strong></p>

<p>A new API: <a href="https://snap-one.github.io/docs-driverworks-api/#unregisteredallvariablelisteners">UnRegisterAllVariableListeners</a> has been added to this version of the SDK.</p>

<h2 id='what-s-new-in-3-2-1'>What’s New in 3.2.1</h2>

<p><strong>Variable Interface</strong></p>

<p>A new API: <a href="https://snap-one.github.io/docs-driverworks-api/#unregisteredallvariablelisteners">UnRegisteredAllVariableListeners</a> has been added to this version of the SDK.</p>

<h2 id='what-s-new-in-3-2-0'>What’s New in 3.2.0</h2>

<p><strong>Driver Initialization and Destruction</strong></p>

<p>New parameters have been added to <a href="https://snap-one.github.io/docs-driverworks-api/#ondriverinit">OnDriverInit</a>, <a href="https://snap-one.github.io/docs-driverworks-api/#ondriverlateinit">OnDriverLateInit</a> and <a href="https://snap-one.github.io/docs-driverworks-api/#ondriverdestroyed">OnDriver Destroyed</a>. These parameters support instances when driver needs to know under what condition or event caused the Initialization or Destroyed functions to be called. OS Release 3.2.0 introduces a new string parameter for these functions to identify the reason for the call. This parameter, driverInitType (DIT) provides this information.</p>

<p><strong>Driver Add Driver</strong></p>

<p>Two new APIs have been delivered with O.S. 3.2.0 to facilitate the ability of driver to add another driver to a project as well as the ability to add a location within the project. See the <a href="https://snap-one.github.io/docs-driverworks-api/#adddevice">AddDevice</a> and <a href="https://snap-one.github.io/docs-driverworks-api/#addlocation">AddLocation</a> APIs for more information.</p>

<h2 id='what-was-new-in-3-1-0'>What was New in 3.1.0</h2>

<p><strong>New APIs that were Added</strong></p>

<p>ToStringLocaleC - A new helper function which converts a number to a string using the ‘C’ locale regardless of the locale setting of the Control4 Operating System.</p>

<p><strong>Interfaces that were Modified</strong></p>

<h3 id='zigbee-interface'>Zigbee Interface</h3>

<p>Future Changes to Zigbee Server-Side Cluster Management</p>

<h3 id='encryption-interface'>Encryption Interface</h3>

<p>A new Lua Signing API has been added to the SDK. C4:Sign enables drivers to crypto-graphically sign an arbitrary payload using a specified key. The API currently supports both HMAC &amp; RSA signing. Control4 strongly recommends that driver developers implement this new API as soon as possible.</p>

<p><strong>New Sample Drivers that were Added</strong></p>

<p>A client side websocket driver has been added to the SDK to assist with websocket support. Sample drivers can be found in the Sample Driver folder at the root level of the SDK.zip.</p>

<h2 id='what-was-new-in-o-s-3'>What was New in O.S.3</h2>

<p><strong>New Interfaces that  were Added</strong></p>

<p>The Notification Interface allows device drivers to include .jpeg files within notifications. These images are displayed as part of the notification. The .jpeg file can be retrieved from a cloud service that supports the device, from the device itself or from a location on a Control4 Controller.</p>

<p>The Scheduler Agent Interface has been added which supports a driver&#39;s ability to create scheduled events that can be used in Programming in ComposerPro.</p>

<p><strong>New APIs that were Added</strong></p>

<p>The GetBindingsByDevice API returns all of the Binding information for a device.
The GetNetworkBindingsByDevice API return all of the Network Binding information for a device.
The GetNetworkConnections API returns connection information based on connection type.
The GetProjectProperty API uses a single string parameter from a list of property names and returns the value of that property, if it exists. </p>

<p><strong>Interfaces that were Modified</strong></p>

<p>The Media Management Interface has been enhanced with content supporting Device Level Context and Broadcast Video APIs</p>

<p>The Timer Interface has been updated to identify legacy APIs that, while still valid, are not recommenced for new driver development. Additionally, a sample driver using the (recommended) SetTimer API has been included with the SDK.</p>

<p>The WebService Interface has been updated with a new sample driver that demonstrates how to perform basic C4:url calls.</p>

<p><strong>Interfaces that were Modified</strong></p>

<p>The AddVariable API has been enhanced with additional Parameter Types.</p>

<p>The JsonDecode API has been enhanced with a new optional parameter: decodeNull which indicates how null values are decoded. Additionally, c4json.null has been added. This can can be used to insert a null value into a JSON document or to test for a null value that was encountered in a JSON document.</p>

<p>The OnBindingChanged API has been updated to include missing parameters.</p>

<p>The PersistGetValue API has been updated with an option third parameter: encrypted.</p>

<p>The PersistSetValue API has been updated with an option third parameter: encrypted.</p>

<p>The RenameDevice API has updated content regarding passing a ProxyID or DeviceId value.</p>

<p>The UpdatePropertyList API has been modified with a parameter re-name and an additional, optional parameter.</p>

<p><strong>APIs that were Deprecated</strong></p>

<p>The Debug Interface content has been removed from the DriverWords SDK. The APIs that were defined in the Debug Interface were used in conjunction with an executable that supported remote debugging. Support for the debugging utility was discontinued several years ago. As a result, the following APIs have been removed:</p>

<ul>
<li>Attach</li>
<li>DisableremoteDebugging</li>
<li>EnableRemoteDebugging</li>
<li>OnEndDebugSession</li>
</ul>
<p><h1 id='c4ssh-interface'>C4SSH Interface</h1><h2 id='createsshclient'>CreateSSHClient</h2>
<p>The C4SSH API enables Lua drivers to establish an SSH client connection to a remote device and execute a series of commands. A driver creates an instance of a C4SSH object by calling the C4:CreateSSHClient function.</p></p>

<p><em>This interface was released in conjunction with O.S. 3.3.0</em></p>

<h3 id='signature'>Signature</h3>

<p><code>C4:CreateSShClient ()</code></p>

<h3 id='parameters'>Parameters</h3>

<p>None</p>

<h3 id='returns'>Returns</h3>

<p>An instance of a C4SSH object that can be used to establish an SSH client connection to a remote device. The C4SSH object enables a Lua driver to establish an SSH client connection to a device, and then to interact with that device by executing a series of commands. The C4SSH object API provides the following methods: </p>

<ul>
<li>Connect</li>
<li>Send</li>
<li>Disconnect</li>
<li>SetConnectTimeout</li>
<li>SetOnConnected</li>
<li>SetOnData</li>
<li>SetOnDisconnected</li>
</ul>

<p>These methods are defined below:</p>

<h2 id='connect'>Connect</h2>

<p>The Connect method attempts to establish a connection to a remote device. There are three methods that set callback functions which enable a driver to receive various notifications about the connection. These are:</p>

<p>SetOnConnected: Provides notification when a connection is established.
SetOnData: Provides notification when data is read from the connection.
SetOnDisconnected: Provides notification when the connection is disconnected, or has otherwise failed.</p>

<p>Additionally, a driver may control how long the C4SSH object waits before determining that the connection has failed. This is accomplished with: SetConnectTimeout which specifies the amount of time to wait when attempting to connect to an endpoint.</p>

<h3 id='signature-2'>Signature</h3>

<p><code>Connect(endpoint, username, password, string)</code></p>

<table><thead>
<tr>
<th>Parameters</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>Endpoint</td>
<td>string. The endpoint to which the SSH connection is to be established. This can be either a host name or an IP address. If the caller specifies a host name, the C4SSH object will attempt to resolve the IP address of the endpoint before connecting.</td>
</tr>
<tr>
<td>Username</td>
<td>string. The username with which to log in to the remote device.</td>
</tr>
<tr>
<td>Password</td>
<td>string. The password to use when logging in to the remote device. This value can be empty if no password is required.</td>
</tr>
<tr>
<td>Port</td>
<td>Integer. The port to use when establishing a connection to the remote device. If omitted, then the default port of 22 is used.</td>
</tr>
</tbody></table>

<h3 id='returns-2'>Returns</h3>

<p>The Connect method may return multiple values. On success, Connect returns the following:</p>

<ul>
<li>The instance of the C4SSH object on which Connect was invoked.</li>
</ul>

<p>On failure, Connect returns the following:</p>

<ul>
<li>nil</li>
<li>A string describing the failure</li>
</ul>

<h4 id='see-also'>See Also:</h4>

<ul>
<li>SetOnConnected</li>
<li>SetOnData</li>
<li>SetOnDisconnected</li>
<li>SetConnectTimeout</li>
<li>OnConnected</li>
<li>OnData</li>
<li>OnDisconnected</li>
</ul>

<h2 id='send'>Send</h2>

<p>Sends a command to a remote device. A driver may set a callback function to receive notification when data has been read from the connection by calling the SetOnData method.</p>

<h3 id='signature-3'>Signature</h3>

<p><code>Send(command)</code></p>

<table><thead>
<tr>
<th>Parameters</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>Command</td>
<td>string. The command to be sent to the remote device.</td>
</tr>
</tbody></table>

<h3 id='returns-3'>Returns</h3>

<p>The Send method may return multiple values. On success, Send returns the following:</p>

<ul>
<li>The instance of the C4SSH object on which the Send method was invoked.</li>
</ul>

<p>On Failure, Send returns the following:</p>

<ul>
<li>nil</li>
<li>A string describing the failure</li>
</ul>

<h3 id='usage-note'>Usage Note</h3>

<p>Due to the asynchronous nature of the C4SSH API, a driver must wait for a connection to be established before calling Send. A driver can be notified that a connection has been established successfully by calling SetOnConnected to register an OnConnected callback function.</p>

<h4 id='see-also-2'>See Also:</h4>

<ul>
<li>SetOnData</li>
<li>OnData</li>
</ul>

<h2 id='disconnect'>Disconnect</h2>

<p>Closes the connection. A driver may set a callback function to receive notification when the connection has been disconnected by calling the SetOnDisconnected method.</p>

<h3 id='signature-4'>Signature</h3>

<p><code>Disconnect()</code></p>

<h3 id='parameters-2'>Parameters</h3>

<p>None</p>

<h3 id='returns-4'>Returns</h3>

<p>The Disconnect method returns a single value which is the instance of the C4SSH object on which the Disconnect method was invoked.</p>

<h4 id='set-also'>Set Also</h4>

<ul>
<li>SetOnDisconnected</li>
<li>OnDisconnected</li>
</ul>

<h2 id='setconnecttimeout'>SetConnectTimeout</h2>

<p>Sets the amount of time the C4SSH object waits before determining that an attempt to establish a connection to an endpoint has failed. The C4SSH object notifies a driver that a connection has timed out by invoking the OnDisconnected callback function. A driver may set the OnDisconnected callback function by calling SetOnDisconnected.</p>

<h3 id='signature-5'>Signature</h3>

<p><code>SetConnectTimeout(Timeout)</code></p>

<table><thead>
<tr>
<th>Parameters</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>Timeout</td>
<td>integer.The number of seconds to wait before determining that an attempt to establish a connection has failed. The default is 30 seconds.</td>
</tr>
</tbody></table>

<h3 id='returns-5'>Returns</h3>

<p>The SetConnectTimeout method may return multiple values. On Success, SetConnectTimeout returns the following:</p>

<ul>
<li>The instance of the C4SSH object on which SetConnectTimeout was invoked.</li>
</ul>

<p>On failure, SetConnectTimeout returns the following:</p>

<ul>
<li>nil</li>
<li>A string describing the failure.</li>
</ul>

<h4 id='see-also-3'>See Also</h4>

<ul>
<li>Connect</li>
<li>SetOnDisconnected</li>
<li>OnDisconnected</li>
</ul>

<h2 id='setonconnected'>SetOnConnected</h2>

<p>Sets the callback function that is invoked when a client connection has been established. See OnConnected for specific details about the function signature of this callback.</p>

<h3 id='signature-6'>Signature</h3>

<p><code>SetOnConnected(Callback)</code></p>

<table><thead>
<tr>
<th>Parameters</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>Callback</td>
<td>function. A callback function to be invoked when a connection has been established.</td>
</tr>
</tbody></table>

<h3 id='returns-6'>Returns</h3>

<p>The SetOnConnected method returns a single value which is the instance of the C4SSH object on which SetOnConnected was invoked.</p>

<h4 id='see-also-4'>See Also</h4>

<ul>
<li>OnConnected</li>
</ul>

<h2 id='setondata'>SetOnData</h2>

<p>Sets the callback function that is invoked when data has been read from a connection. See OnData for specific details about the function signature of this callback.</p>

<h3 id='signature-7'>Signature</h3>

<p><code>SetOnData(Callback)</code></p>

<table><thead>
<tr>
<th>Parameters</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>Callback</td>
<td>function.A callback function to be invoked when data has been read from a connection.</td>
</tr>
</tbody></table>

<h3 id='returns-7'>Returns</h3>

<p>The SetOnData method returns a single value which is the instance of the C4SSH object on which the SetOnData method was invoked.</p>

<h4 id='see-also-5'>See Also</h4>

<ul>
<li>OnData</li>
</ul>

<h2 id='setondisconnected'>SetOnDisconnected</h2>

<p>Sets the callback function that is invoked when a connection is disconnected or has otherwise failed. Note that the C4SSH object invokes the OnDisconnected callback to notify a driver when an error has forced the closure of a connection. See OnDisconnected for specific details about the function signature of this callback.</p>

<h3 id='signature-8'>Signature</h3>

<p><code>SetOnDisconnected(Callback)</code></p>

<table><thead>
<tr>
<th>Parameters</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>Callback</td>
<td>function. A callback function to be invoked when a connection is disconnected or has otherwise failed.</td>
</tr>
</tbody></table>

<h3 id='returns-8'>Returns</h3>

<p>The SetOnDisconnected method returns a single value which is the instance of the C4SSH object on which SetOnDisconnected was invoked.</p>

<h4 id='see-also-6'>See Also</h4>

<ul>
<li>OnDisconnected</li>
</ul>

<p><strong>C4SSH Callbacks</strong></p>

<p>The C4SSH object provides the following callback functions that enable a driver to receive various notifications about the connection. These include the following:</p>

<ul>
<li>OnConnected</li>
<li>OnData</li>
<li>OnDisconnected</li>
</ul>

<h2 id='onconnected'>OnConnected</h2>

<p>The OnConnected callback is invoked to notify a driver that a connection has been established.</p>

<h3 id='signature-9'>Signature</h3>

<p><code>OnConnected(client)</code></p>

<h3 id='parameters-3'>Parameters</h3>

<table><thead>
<tr>
<th>Parameters</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>client</td>
<td><code>[C4SSH]</code>: The instance of the C4SSH object that connected successfully.</td>
</tr>
</tbody></table>

<h4 id='see-also-7'>See Also</h4>

<ul>
<li>SetOnConnected</li>
</ul>

<h3 id='example'>Example</h3><div class="highlight"><pre class="highlight javascript"><code><span class="kd">function</span> <span class="nx">OnData</span><span class="p">(</span><span class="nx">client</span><span class="p">,</span> <span class="nx">data</span><span class="p">)</span>
    <span class="nx">print</span><span class="p">(</span><span class="nx">client</span><span class="p">,</span> <span class="dl">"</span><span class="s2">OnData</span><span class="dl">"</span><span class="p">)</span>
    <span class="nx">print</span><span class="p">(</span><span class="nx">data</span><span class="p">)</span>
    <span class="nx">client</span><span class="p">:</span><span class="nx">Disconnect</span><span class="p">()</span>
<span class="nx">end</span>

<span class="kd">function</span> <span class="nx">OnConnected</span><span class="p">(</span><span class="nx">client</span><span class="p">)</span>
    <span class="nx">print</span><span class="p">(</span><span class="nx">client</span><span class="p">,</span> <span class="dl">"</span><span class="s2">OnConnected</span><span class="dl">"</span><span class="p">)</span>
    <span class="nx">client</span><span class="p">:</span><span class="nx">Send</span><span class="p">(</span><span class="dl">"</span><span class="s2">ls</span><span class="dl">"</span><span class="p">)</span>
<span class="nx">end</span>

<span class="kd">function</span> <span class="nx">OnDisconnected</span><span class="p">(</span><span class="nx">client</span><span class="p">,</span> <span class="nx">error</span><span class="p">)</span>
    <span class="nx">print</span><span class="p">(</span><span class="nx">client</span><span class="p">,</span> <span class="dl">"</span><span class="s2">OnDisconnected</span><span class="dl">"</span><span class="p">,</span> <span class="nx">error</span><span class="p">)</span>
<span class="nx">end</span>

<span class="nx">sshclient</span> <span class="o">=</span> <span class="nx">C4</span><span class="p">:</span><span class="nx">CreateSSHClient</span><span class="p">()</span>

<span class="nx">sshclient</span><span class="p">:</span><span class="nx">SetOnDisconnected</span><span class="p">(</span><span class="nx">OnDisconnected</span><span class="p">)</span>
<span class="nx">sshclient</span><span class="p">:</span><span class="nx">SetOnConnected</span><span class="p">(</span><span class="nx">OnConnected</span><span class="p">)</span>
<span class="nx">sshclient</span><span class="p">:</span><span class="nx">SetOnData</span><span class="p">(</span><span class="nx">OnData</span><span class="p">)</span>

<span class="nx">sshclient</span><span class="p">:</span><span class="nx">Connect</span><span class="p">(</span><span class="dl">"</span><span class="s2">192.168.1.42</span><span class="dl">"</span><span class="p">,</span> <span class="dl">"</span><span class="s2">username</span><span class="dl">"</span><span class="p">,</span> <span class="dl">"</span><span class="s2">password</span><span class="dl">"</span><span class="p">)</span>
</code></pre></div><h2 id='ondata'>OnData</h2>
<p>The OnData callback is invoked to notify a driver when data has been read from a connection.</p>
<h3 id='signature-10'>Signature</h3>

<p><code>OnData(Client, Data)</code></p>

<table><thead>
<tr>
<th>Parameters</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>client</td>
<td><code>[C4SSH]</code>: The instance of the C4SSH object that received the data.</td>
</tr>
<tr>
<td>Data</td>
<td>string. A string containing the data that was read from the connection.</td>
</tr>
</tbody></table>

<h4 id='see-also-8'>See Also</h4>

<ul>
<li>SetOnData</li>
</ul>

<h3 id='example-2'>Example</h3><div class="highlight"><pre class="highlight javascript"><code><span class="kd">function</span> <span class="nx">OnData</span><span class="p">(</span><span class="nx">client</span><span class="p">,</span> <span class="nx">data</span><span class="p">)</span>
    <span class="nx">print</span><span class="p">(</span><span class="nx">client</span><span class="p">,</span> <span class="dl">"</span><span class="s2">OnData</span><span class="dl">"</span><span class="p">)</span>
    <span class="nx">print</span><span class="p">(</span><span class="nx">data</span><span class="p">)</span>
    <span class="nx">client</span><span class="p">:</span><span class="nx">Disconnect</span><span class="p">()</span>
<span class="nx">end</span>

<span class="kd">function</span> <span class="nx">OnConnected</span><span class="p">(</span><span class="nx">client</span><span class="p">)</span>
    <span class="nx">print</span><span class="p">(</span><span class="nx">client</span><span class="p">,</span> <span class="dl">"</span><span class="s2">OnConnected</span><span class="dl">"</span><span class="p">)</span>
    <span class="nx">client</span><span class="p">:</span><span class="nx">Send</span><span class="p">(</span><span class="dl">"</span><span class="s2">ls</span><span class="dl">"</span><span class="p">)</span>
<span class="nx">end</span>

<span class="kd">function</span> <span class="nx">OnDisconnected</span><span class="p">(</span><span class="nx">client</span><span class="p">,</span> <span class="nx">error</span><span class="p">)</span>
    <span class="nx">print</span><span class="p">(</span><span class="nx">client</span><span class="p">,</span> <span class="dl">"</span><span class="s2">OnDisconnected</span><span class="dl">"</span><span class="p">,</span> <span class="nx">error</span><span class="p">)</span>
<span class="nx">end</span>

<span class="nx">sshclient</span> <span class="o">=</span> <span class="nx">C4</span><span class="p">:</span><span class="nx">CreateSSHClient</span><span class="p">()</span>

<span class="nx">sshclient</span><span class="p">:</span><span class="nx">SetOnDisconnected</span><span class="p">(</span><span class="nx">OnDisconnected</span><span class="p">)</span>
<span class="nx">sshclient</span><span class="p">:</span><span class="nx">SetOnConnected</span><span class="p">(</span><span class="nx">OnConnected</span><span class="p">)</span>
<span class="nx">sshclient</span><span class="p">:</span><span class="nx">SetOnData</span><span class="p">(</span><span class="nx">OnData</span><span class="p">)</span>

<span class="nx">sshclient</span><span class="p">:</span><span class="nx">Connect</span><span class="p">(</span><span class="dl">"</span><span class="s2">192.168.1.42</span><span class="dl">"</span><span class="p">,</span> <span class="dl">"</span><span class="s2">username</span><span class="dl">"</span><span class="p">,</span> <span class="dl">"</span><span class="s2">password</span><span class="dl">"</span><span class="p">)</span>
</code></pre></div><h2 id='ondisconnected'>OnDisconnected</h2>
<p>The OnDisconnected callback is invoked to notify a driver that a connection has been disconnected. If an error forced the closure of the connection, then the Error argument provides a string describing the error.</p>
<h3 id='signature-11'>Signature</h3>

<p><code>OnDisconnected(client Error)</code></p>

<table><thead>
<tr>
<th>Parameters</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>client</td>
<td><code>[C4SSH]</code>: The instance of the C4SSH object that was disconnected.</td>
</tr>
<tr>
<td>Error</td>
<td>string. A string describing the failure if an error forced the closure of the connection. If no error occurred, then the value of the Error argument is nil.</td>
</tr>
</tbody></table>

<h4 id='see-also-9'>See Also</h4>

<ul>
<li>SetOnDisconnected</li>
</ul>

<p><h3 id='example-3'>Example</h3><div class="highlight"><pre class="highlight javascript"><code><span class="kd">function</span> <span class="nx">OnData</span><span class="p">(</span><span class="nx">client</span><span class="p">,</span> <span class="nx">data</span><span class="p">)</span>
    <span class="nx">print</span><span class="p">(</span><span class="nx">client</span><span class="p">,</span> <span class="dl">&quot;</span><span class="s2">OnData</span><span class="dl">&quot;</span><span class="p">)</span>
    <span class="nx">print</span><span class="p">(</span><span class="nx">data</span><span class="p">)</span>
    <span class="nx">client</span><span class="p">:</span><span class="nx">Disconnect</span><span class="p">()</span>
<span class="nx">end</span></p>

<p><span class="kd">function</span> <span class="nx">OnConnected</span><span class="p">(</span><span class="nx">client</span><span class="p">)</span>
    <span class="nx">print</span><span class="p">(</span><span class="nx">client</span><span class="p">,</span> <span class="dl">&quot;</span><span class="s2">OnConnected</span><span class="dl">&quot;</span><span class="p">)</span>
    <span class="nx">client</span><span class="p">:</span><span class="nx">Send</span><span class="p">(</span><span class="dl">&quot;</span><span class="s2">ls</span><span class="dl">&quot;</span><span class="p">)</span>
<span class="nx">end</span></p>

<p><span class="kd">function</span> <span class="nx">OnDisconnected</span><span class="p">(</span><span class="nx">client</span><span class="p">,</span> <span class="nx">error</span><span class="p">)</span>
    <span class="nx">print</span><span class="p">(</span><span class="nx">client</span><span class="p">,</span> <span class="dl">&quot;</span><span class="s2">OnDisconnected</span><span class="dl">&quot;</span><span class="p">,</span> <span class="nx">error</span><span class="p">)</span>
<span class="nx">end</span></p>

<p><span class="nx">sshclient</span> <span class="o">=</span> <span class="nx">C4</span><span class="p">:</span><span class="nx">CreateSSHClient</span><span class="p">()</span></p>

<p><span class="nx">sshclient</span><span class="p">:</span><span class="nx">SetOnDisconnected</span><span class="p">(</span><span class="nx">OnDisconnected</span><span class="p">)</span>
<span class="nx">sshclient</span><span class="p">:</span><span class="nx">SetOnConnected</span><span class="p">(</span><span class="nx">OnConnected</span><span class="p">)</span>
<span class="nx">sshclient</span><span class="p">:</span><span class="nx">SetOnData</span><span class="p">(</span><span class="nx">OnData</span><span class="p">)</span></p>

<p><span class="nx">sshclient</span><span class="p">:</span><span class="nx">Connect</span><span class="p">(</span><span class="dl">&quot;</span><span class="s2">192.168.1.42</span><span class="dl">&quot;</span><span class="p">,</span> <span class="dl">&quot;</span><span class="s2">username</span><span class="dl">&quot;</span><span class="p">,</span> <span class="dl">&quot;</span><span class="s2">password</span><span class="dl">&quot;</span><span class="p">)</span>
</code></pre></div></p>
<h1 id='controller-registry-interface'>Controller Registry Interface</h1>

<h2 id='registrydeletevalue'>RegistryDeleteValue</h2>

<p>Removes a key/value pair from the Registry.</p>

<p><h6 id='available-from-2-10-4'>Available from 2.10.4</h6><h3 id='signature'>Signature</h3>
<p><code>C4:RegistryDeleteValue(key)</code></p></p>

<table><thead>
<tr>
<th>Parameter</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>num</td>
<td>The key to be removed from the Registry</td>
</tr>
</tbody></table>

<h3 id='returns'>Returns</h3>

<p><code>None</code></p>

<h2 id='registrygetvalue'>RegistryGetValue</h2>

<p>Retrieves a value from the Registry.</p>

<p><h6 id='available-from-2-10-4'>Available from 2.10.4</h6><h3 id='signature'>Signature</h3>
<p><code>C4:RegistryGetValue(key)&#39;
</code>
|Parameters | Description|
| --- | --- |
| num | The key applicable to the value being retrieved. |</p>
<h3 id='returns'>Returns</h3>
<p>Upon success, the API returns the value that was decoded from the Registry. The value can be any of the following: number, string ,boolean, table. Upon failure, the API returns nil.</p></p>

<h2 id='registrysetvalue'>RegistrySetValue</h2>

<p>Sets the value of a Registry key/value pair. The value is updated if the specified key/value pair exists. A
key/value pair is created by the API if it does not exist. </p>

<p><h5 id='available-from-2-10-4'>Available from 2.10.4</h5><h3 id='signature'>Signature</h3>
<p><code>C4:RegistrySetValue(key, value)</code></p></p>

<table><thead>
<tr>
<th>Parameters</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>num</td>
<td>The name of the key to which the specified value is associated.</td>
</tr>
<tr>
<td>value</td>
<td>The value of the key to which the specified value is associated.</td>
</tr>
</tbody></table>

<h3 id='returns'>Returns</h3>

<p>Upon success, the API returns the value that was decoded from the Registry. The value can be any of the following: number, string ,boolean, table. Upon failure, the API returns nil.</p>
<h1 id='director-command-interface'>Director Command Interface</h1>

<h2 id='executecommand'>ExecuteCommand</h2>

<p>Function called by Director when a command is received for this DriverWorks driver. This includes commands created in Composer programming. This API should not be invoked during OnDriverInit. </p>

<p><h6 id='available-in-1-6-0'>Available in 1.6.0.</h6><h3 id='signature'>Signature</h3>
<p><code>ExecuteCommand(strCommand, tParams)</code></p></p>

<table><thead>
<tr>
<th>Parameter</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>str</td>
<td>Command to be sent</td>
</tr>
<tr>
<td>table</td>
<td>Lua table of parameters for the sent command</td>
</tr>
</tbody></table>

<h3 id='returns'>Returns</h3>

<p><code>None</code></p>

<h3 id='usage-note'>Usage Note</h3>

<p>Prior to Operating System 2.10, overuse of C4:InvalidateState()was an issue as persisting extraneous data through a driver had performance implications. Beginning with Operating System 2.10, it is no longer necessary to cause driver data to be persisted. Drivers should use the PersistSetValue and PersistGetValue functions to store data that will be required across system restarts.</p>

<h3 id='examples'>Examples:</h3>

<p>Print all commands received for this protocol driver, including all parameters:</p>

<div class="highlight"><pre class="highlight lua tab-lua"><code><span class="k">function</span> <span class="nf">ExecuteCommand</span> <span class="p">(</span><span class="n">strCommand</span><span class="p">,</span> <span class="n">tParams</span><span class="p">)</span>
 <span class="nb">print</span><span class="p">(</span><span class="s2">"ExecuteCommand: "</span> <span class="o">..</span> <span class="n">strCommand</span><span class="p">)</span>
 <span class="k">if</span> <span class="p">(</span><span class="n">tParams</span> <span class="err">\</span><span class="o">~=</span> <span class="kc">nil</span><span class="p">)</span> <span class="k">then</span>
   <span class="k">for</span> <span class="n">ParamName</span><span class="p">,</span> <span class="n">ParamValue</span> <span class="k">in</span> <span class="nb">pairs</span><span class="p">(</span><span class="n">tParams</span><span class="p">)</span> <span class="k">do</span> 
     <span class="nb">print</span><span class="p">(</span><span class="n">ParamName</span><span class="p">,</span> <span class="n">ParamValue</span><span class="p">)</span> 
   <span class="k">end</span>
 <span class="k">end</span>
<span class="k">end</span>
</code></pre></div>

<p>This sample function evaluates the commands received from Director and calls the correct function. It also looks for LUA_ACTION commands, which are sent from Composer’s Actions tab and processes them:</p>

<div class="highlight"><pre class="highlight lua tab-lua"><code><span class="k">function</span> <span class="nf">ExecuteCommand</span><span class="p">(</span><span class="n">strCommand</span><span class="p">,</span> <span class="n">tParams</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">"ExecuteCommand function called with : "</span> <span class="o">..</span> <span class="n">strCommand</span><span class="p">)</span>
  <span class="k">if</span> <span class="p">(</span><span class="n">tParams</span> <span class="o">==</span> <span class="kc">nil</span><span class="p">)</span> <span class="k">then</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">strCommand</span> <span class="o">==</span><span class="s2">"GET\_PROPERTIES"</span><span class="p">)</span> <span class="k">then</span>
      <span class="n">GET</span><span class="err">\</span><span class="n">_PROPERTIES</span><span class="p">()</span>
    <span class="k">else</span>
      <span class="nb">print</span> <span class="p">(</span><span class="s2">"From ExecuteCommand Function - Unutilized command: "</span> <span class="o">..</span> <span class="n">strCommand</span><span class="p">)</span>
    <span class="k">end</span>
  <span class="k">end</span>
  <span class="k">if</span> <span class="p">(</span><span class="n">strCommand</span> <span class="o">==</span> <span class="s2">"LUA\_ACTION"</span><span class="p">)</span> <span class="k">then</span>
    <span class="k">if</span> <span class="n">tParams</span> <span class="err">\</span><span class="o">~=</span> <span class="kc">nil</span> <span class="k">then</span>
      <span class="k">for</span> <span class="n">cmd</span><span class="p">,</span><span class="n">cmdv</span> <span class="k">in</span> <span class="nb">pairs</span><span class="p">(</span><span class="n">tParams</span><span class="p">)</span> <span class="k">do</span> 
        <span class="nb">print</span> <span class="p">(</span><span class="n">cmd</span><span class="p">,</span><span class="n">cmdv</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">cmd</span> <span class="o">==</span> <span class="s2">"ACTION"</span> <span class="k">then</span>
          <span class="k">if</span> <span class="n">cmdv</span> <span class="o">==</span> <span class="s2">"Reset Security System"</span> <span class="k">then</span>
            <span class="n">ResetSecuritySystem</span><span class="p">()</span>
          <span class="k">else</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">"From ExecuteCommand Function - Undefined Action"</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">"Key: "</span> <span class="o">..</span> <span class="n">cmd</span> <span class="o">..</span> <span class="s2">"  Value: "</span> <span class="o">..</span> <span class="n">cmdv</span><span class="p">)</span>
          <span class="k">end</span>
        <span class="k">else</span>
          <span class="nb">print</span><span class="p">(</span><span class="s2">"From ExecuteCommand Function - Undefined Command"</span><span class="p">)</span>
          <span class="nb">print</span><span class="p">(</span><span class="s2">"Key: "</span> <span class="o">..</span> <span class="n">cmd</span> <span class="o">..</span> <span class="s2">"  Value: "</span> <span class="o">..</span> <span class="n">cmdv</span><span class="p">)</span>
        <span class="k">end</span>
      <span class="k">end</span>
    <span class="k">end</span>
  <span class="k">end</span>
<span class="k">end</span>
</code></pre></div>

<h2 id='getversioninfo'>GetVersionInfo</h2>

<p>Function that returns the version of Director that is currently running. This API can be invoked during OnDriverInit.</p>

<p><h6 id='available-in-1-60'>Available in 1.60.</h6><h3 id='signature'>Signature</h3>
<p><code>C4:GetVersionInfo()</code></p>
<h3 id='parameters'>Parameters</h3>
<p><code>None</code></p>
<h3 id='returns'>Returns</h3>
<table><thead>
<tr>
<th>Value</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>buildtime</td>
<td>HH:MM:SS</td>
</tr>
<tr>
<td>builddate</td>
<td>mm  dd yyyy</td>
</tr>
<tr>
<td>version</td>
<td>1.7.0.222</td>
</tr>
<tr>
<td>buildtype</td>
<td>DEBUG</td>
</tr>
</tbody></table>
<h3 id='example'>Example</h3><div class="highlight"><pre class="highlight lua tab-lua"><code>
<span class="kd">local</span> <span class="n">tVers</span> <span class="o">=</span> <span class="n">C4</span><span class="p">:</span><span class="n">GetVersionInfo</span><span class="p">()</span>
<span class="kd">local</span> <span class="n">strVers</span> <span class="o">=</span> <span class="n">tVers</span><span class="p">[</span><span class="s2">&quot;version&quot;</span><span class="p">]</span></p>

<p><span class="kd">local</span> <span class="n">major</span><span class="p">,</span> <span class="n">minor</span><span class="p">,</span> <span class="n">rev</span><span class="p">,</span> <span class="n">build</span> <span class="o">=</span> <span class="nb">string.match</span><span class="p">(</span><span class="n">strVers</span><span class="p">,</span> <span class="s2">&quot;(%d+).(%d+).(%d+).(%d+)&quot;</span><span class="p">)</span></p>

<p><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Major: &quot;</span> <span class="o">..</span> <span class="n">major</span> <span class="o">..</span> <span class="s2">&quot; Minor: &quot;</span> <span class="o">..</span> <span class="n">minor</span> <span class="o">..</span> <span class="s2">&quot; Rev: &quot;</span> <span class="o">..</span> <span class="n">rev</span> <span class="o">..</span> <span class="s2">&quot; Build: &quot;</span> <span class="o">..</span> <span class="n">build</span><span class="p">)</span></p>

<p><span class="k">if</span> <span class="p">(</span><span class="nb">tonumber</span><span class="p">(</span><span class="n">major</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">2</span><span class="p">)</span> <span class="k">then</span>
  <span class="k">if</span> <span class="p">(</span><span class="nb">tonumber</span><span class="p">(</span><span class="n">minor</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">8</span><span class="p">)</span> <span class="k">then</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;This Code requires at least version 1.8 to operate properly.  You are currently running version &quot;</span> <span class="o">..</span> <span class="n">strVers</span><span class="p">)</span>
  <span class="k">end</span>
<span class="k">end</span> <span class="n">GetVersionInfo</span>
</code></pre></div>
<h2 id='invalidatestate'>InvalidateState</h2>
<p>Function to notify director that data from this driver has been modified and needs to be persisted. This API should not be invoked during OnDriverInit.</p>
<h3 id='signature'>Signature</h3>
<p><code>C4:InvalidateState()</code></p>
<h3 id='usage-note'>Usage Note</h3>
<p>Prior to Operating System 2.10, overuse of C4:InvalidateState() was an issue as persisting extraneous data through a driver had performance implications. Beginning with Operating System 2.10, it is no longer necessary to cause driver data to be persisted. Drivers should use the <a href="https://snap-one.github.io/docs-driverworks-api/#persistsetvalue">PersistSetValue</a> and <a href="https://snap-one.github.io/docs-driverworks-api/#persistgetvalue">PersistGetValue</a> functions to store data that will be required across system restarts.</p></p>
<h1 id='encryption-interface'>Encryption Interface</h1>

<h2 id='encode'>Encode</h2><div class="highlight"><pre class="highlight lua tab-lua"><code><span class="kd">local</span> <span class="n">data</span> <span class="o">=</span> <span class="s1">'Hello World This Is London Calling'</span>
<span class="kd">local</span> <span class="n">data_encoding</span> <span class="o">=</span> <span class="s1">'BASE64'</span>
<span class="kd">local</span> <span class="n">encoded_data</span><span class="p">,</span> <span class="n">err</span> <span class="o">=</span> <span class="n">C4</span><span class="p">:</span><span class="n">Encode</span> <span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">data_encoding</span><span class="p">)</span>
<span class="nb">print</span> <span class="p">(</span><span class="nb">type</span> <span class="p">(</span><span class="n">encoded_data</span><span class="p">),</span> <span class="n">encoded_data</span><span class="p">)</span>
</code></pre></div>
<blockquote>
<p>Output:</p>
</blockquote>
<div class="highlight"><pre class="highlight lua tab-lua"><code><span class="n">string</span>  <span class="n">SGVsbG8gd29ybGQ</span><span class="o">=</span>
</code></pre></div>
<p>Encodes a given string with the specified data encoding.</p>
<h6 id='available-in-1-6-0'>Available in 1.6.0.</h6><h3 id='signature'>Signature</h3>
<p><code>C4:Encode (data, data_encoding)</code></p>

<table><thead>
<tr>
<th>Parameter</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>str data</td>
<td>Data to encode.</td>
</tr>
<tr>
<td>str</td>
<td>data_encoding: &#39;NONE&#39; / ‘HEX&#39; / ‘BASE64&#39;</td>
</tr>
</tbody></table>
<h3 id='returns'>Returns</h3>
<p><code>result, err</code></p>

<p>A successful operation will return <code>nil</code> for <em>err</em>.  If an error occurs, then <em>result</em> will be nil and <em>err</em> will contain the description of the error.</p>

<table><thead>
<tr>
<th>Value</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>str</td>
<td>result: Encoded data</td>
</tr>
<tr>
<td>str</td>
<td>err: Description of any error that occurred</td>
</tr>
</tbody></table>

<h2 id='encrypt'>Encrypt</h2><div class="highlight"><pre class="highlight lua tab-lua"><code><span class="kd">local</span> <span class="n">cipher</span> <span class="o">=</span> <span class="s1">'AES-256-CBC'</span>
<span class="kd">local</span> <span class="n">key</span> <span class="o">=</span> <span class="s1">'Super Secret Key'</span>
<span class="kd">local</span> <span class="n">iv</span> <span class="o">=</span> <span class="s1">'IV For C4'</span>
<span class="kd">local</span> <span class="n">data</span> <span class="o">=</span> <span class="s1">'Hello World, this is London calling'</span>
<span class="kd">local</span> <span class="n">options</span> <span class="o">=</span> <span class="p">{</span>
    <span class="n">return_encoding</span> <span class="o">=</span> <span class="s1">'BASE64'</span><span class="p">,</span>
    <span class="n">key_encoding</span> <span class="o">=</span> <span class="s1">'NONE'</span><span class="p">,</span>
    <span class="n">iv_encoding</span> <span class="o">=</span> <span class="s1">'NONE'</span><span class="p">,</span>
    <span class="n">data_encoding</span> <span class="o">=</span> <span class="s1">'NONE'</span><span class="p">,</span>
    <span class="n">padding</span> <span class="o">=</span> <span class="kc">true</span><span class="p">,</span>
<span class="p">}</span>
<span class="kd">local</span> <span class="n">encrypted_data</span><span class="p">,</span> <span class="n">err</span> <span class="o">=</span> <span class="n">C4</span><span class="p">:</span><span class="n">Encrypt</span> <span class="p">(</span><span class="n">cipher</span><span class="p">,</span> <span class="n">key</span><span class="p">,</span> <span class="n">iv</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">options</span><span class="p">)</span>
<span class="nb">print</span> <span class="p">(</span><span class="nb">type</span> <span class="p">(</span><span class="n">encrypted_data</span><span class="p">),</span> <span class="n">encrypted_data</span><span class="p">)</span>
</code></pre></div>
<blockquote>
<p>Output:</p>
</blockquote>
<div class="highlight"><pre class="highlight lua tab-lua"><code><span class="n">string</span>  <span class="n">HMQ9QXyBFUBnTAXBl2zi6k6abipQYQjpc37B0nA3WaxK9vBNrqKKAEzIglxWkA46</span>
</code></pre></div>
<p>Encrypts a given string with the specified cipher, using the specified key and IV.</p>
<h6 id='available-in-1-6-0'>Available in 1.6.0.</h6><h3 id='signature'>Signature</h3>
<p><code>C4:Encrypt (cipher, key, iv, data, options)</code></p>

<table><thead>
<tr>
<th>Parameter</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>str</td>
<td>cipher: Valid cipher (see <a href="#getsupportedciphers">GetSupportedCiphers</a>).</td>
</tr>
<tr>
<td>str</td>
<td>key : Valid key for specified cipher. Short keys will be padded, long keys will be rejected.</td>
</tr>
<tr>
<td>str</td>
<td>iv: Valid IV for specified cipher. Short IVs will be padded (including empty/nil IVs), long IVs will be rejected</td>
</tr>
<tr>
<td>str</td>
<td>data: Data to encrypt.</td>
</tr>
<tr>
<td>table</td>
<td>Options: (Optional) Options to specify encoding of inputs and outputs</td>
</tr>
</tbody></table>

<p>Valid key/value pairs for options parameter:</p>

<table><thead>
<tr>
<th>Key</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>str</td>
<td>return_encoding:  return_encoding: &#39;NONE&#39; / &#39;HEX&#39; / &#39;BASE64&#39;</td>
</tr>
<tr>
<td>str</td>
<td>key_encoding:  &#39;NONE&#39; / &#39;HEX&#39; / &#39;BASE64&#39;</td>
</tr>
<tr>
<td>str</td>
<td>iv_encoding : &#39;NONE&#39; / &#39;HEX&#39; / &#39;BASE64’</td>
</tr>
<tr>
<td>str</td>
<td>data_encoding: &#39;NONE&#39; / &#39;HEX&#39; / &#39;BASE64&#39;</td>
</tr>
<tr>
<td>bool</td>
<td>padding: True. Controls the padding requirements for the cipher used</td>
</tr>
</tbody></table>
<h3 id='returns'>Returns</h3>
<p><code>result, err</code></p>

<p>A successful operation will return <code>nil</code> for <em>err</em>.  If an error occurs, then <em>result</em> will be nil and <em>err</em> will contain the description of the error.</p>

<table><thead>
<tr>
<th>Value</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>str</td>
<td>result: Encrypted data</td>
</tr>
<tr>
<td>str</td>
<td>err : Description of any error that occurred</td>
</tr>
</tbody></table>

<h2 id='decode'>Decode</h2><div class="highlight"><pre class="highlight lua tab-lua"><code><span class="kd">local</span> <span class="n">data</span> <span class="o">=</span> <span class="s1">'SGVsbG8gd29ybGQ='</span>
<span class="kd">local</span> <span class="n">data_encoding</span> <span class="o">=</span> <span class="s1">'BASE64'</span>
<span class="kd">local</span> <span class="n">decoded_data</span><span class="p">,</span> <span class="n">err</span> <span class="o">=</span> <span class="n">C4</span><span class="p">:</span><span class="n">Decode</span> <span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">data_encoding</span><span class="p">)</span>
<span class="nb">print</span> <span class="p">(</span><span class="nb">type</span> <span class="p">(</span><span class="n">decoded_data</span><span class="p">),</span> <span class="n">decoded_data</span><span class="p">)</span>
</code></pre></div>
<blockquote>
<p>Output:</p>
</blockquote>
<div class="highlight"><pre class="highlight lua tab-lua"><code><span class="n">string</span>  <span class="n">Hello</span> <span class="n">World</span>
</code></pre></div>
<p>Decodes a given string that was previously encoded with the specified data encoding.</p>
<h6 id='available-in-1-6-0'>Available in 1.6.0.</h6><h3 id='signature'>Signature</h3>
<p><code>C4:Decode (data, data_encoding)</code></p>

<table><thead>
<tr>
<th>Parameter</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>str</td>
<td>Data to decode</td>
</tr>
<tr>
<td>str</td>
<td>data_encoding:  <code>string</code>: &#39;NONE&#39; / &#39;HEX&#39; / &#39;BASE64’</td>
</tr>
</tbody></table>
<h3 id='returns'>Returns</h3>
<p><code>result, err</code></p>

<p>A successful operation will return <code>nil</code> for <em>err</em>.  If an error occurs, then <em>result</em> will be nil and <em>err</em> will contain the description of the error.</p>

<table><thead>
<tr>
<th>Value</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>str</td>
<td>result: Decoded data</td>
</tr>
<tr>
<td>str</td>
<td>err: Description of any error that occurred</td>
</tr>
</tbody></table>

<h2 id='decrypt'>Decrypt</h2><div class="highlight"><pre class="highlight lua tab-lua"><code><span class="kd">local</span> <span class="n">cipher</span> <span class="o">=</span> <span class="s1">'AES-256-CBC'</span>
<span class="kd">local</span> <span class="n">key</span> <span class="o">=</span> <span class="s1">'Super Secret Key'</span>
<span class="kd">local</span> <span class="n">iv</span> <span class="o">=</span> <span class="s1">'IV For C4'</span>
<span class="kd">local</span> <span class="n">data</span> <span class="o">=</span> <span class="s1">'HMQ9QXyBFUBnTAXBl2zi6k6abipQYQjpc37B0nA3WaxK9vBNrqKKAEzIglxWkA46'</span>
<span class="kd">local</span> <span class="n">options</span> <span class="o">=</span> <span class="p">{</span>
    <span class="n">return_encoding</span> <span class="o">=</span> <span class="s1">'NONE'</span><span class="p">,</span>
    <span class="n">key_encoding</span> <span class="o">=</span> <span class="s1">'NONE'</span><span class="p">,</span>
    <span class="n">iv_encoding</span> <span class="o">=</span> <span class="s1">'NONE'</span><span class="p">,</span>
    <span class="n">data_encoding</span> <span class="o">=</span> <span class="s1">'BASE64'</span><span class="p">,</span>
    <span class="n">padding</span> <span class="o">=</span> <span class="kc">true</span><span class="p">,</span>
<span class="p">}</span>
<span class="kd">local</span> <span class="n">decrypted_data</span><span class="p">,</span> <span class="n">err</span> <span class="o">=</span> <span class="n">C4</span><span class="p">:</span><span class="n">Decrypt</span> <span class="p">(</span><span class="n">cipher</span><span class="p">,</span> <span class="n">key</span><span class="p">,</span> <span class="n">iv</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">options</span><span class="p">)</span>
<span class="nb">print</span> <span class="p">(</span><span class="nb">type</span> <span class="p">(</span><span class="n">decrypted_data</span><span class="p">),</span> <span class="n">decrypted_data</span><span class="p">)</span>
</code></pre></div>
<blockquote>
<p>Output:</p>
</blockquote>
<div class="highlight"><pre class="highlight lua tab-lua"><code><span class="n">string</span>  <span class="n">Hello</span> <span class="n">World</span><span class="p">,</span> <span class="n">this</span> <span class="n">is</span> <span class="n">London</span> <span class="n">calling</span>
</code></pre></div>
<p>Encrypts a given string with the specified cipher, using the specified key and IV.</p>
<h6 id='available-in-1-6-0'>Available in 1.6.0.</h6><h3 id='signature'>Signature</h3>
<p><code>C4:Decrypt (cipher, key, iv, data, options)</code></p>

<table><thead>
<tr>
<th>Parameter</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>str</td>
<td>Valid cipher (see <a href="#getsupportedciphers">GetSupportedCiphers</a>).</td>
</tr>
<tr>
<td>str</td>
<td>Valid key for specified cipher. Short keys will be padded, long keys will be rejected.</td>
</tr>
<tr>
<td>str</td>
<td>Valid IV for specified cipher. Short IVs will be padded (including empty/nil IVs), long IVs will be rejected</td>
</tr>
<tr>
<td>str</td>
<td>Data to decrypt.</td>
</tr>
<tr>
<td>table</td>
<td>Optional. Options to specify encoding of inputs and outputs:</td>
</tr>
</tbody></table>

<p>Valid key/value pairs for options parameter:</p>

<table><thead>
<tr>
<th>Key</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>str</td>
<td>return_encoding: &#39;NONE&#39; / &#39;HEX&#39; / &#39;BASE64&#39;</td>
</tr>
<tr>
<td>str</td>
<td>key_encoding: &#39;NONE&#39; / &#39;HEX&#39; / &#39;BASE64&#39;</td>
</tr>
<tr>
<td>str</td>
<td>iv_encoding</td>
</tr>
<tr>
<td>str</td>
<td>data_encoding: &#39;NONE&#39; / &#39;HEX&#39; / &#39;BASE64&#39;</td>
</tr>
<tr>
<td>bool</td>
<td>padding: <code>true</code> Controls the padding requirements for the cipher used</td>
</tr>
</tbody></table>
<h3 id='returns'>Returns</h3>
<p><code>result, err</code></p>

<p>A successful operation will return <code>nil</code> for <em>err</em>.  If an error occurs, then <em>result</em> will be nil and <em>err</em> will contain the description of the error.</p>

<table><thead>
<tr>
<th>Value</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>str</td>
<td>Decrypted data</td>
</tr>
<tr>
<td>str</td>
<td>err: Description of any error that occurred</td>
</tr>
</tbody></table>

<h2 id='generatecsr-ecc'>GenerateCSR ECC</h2>

<p>This API will generate a certificate signing request (CSR) which, when sent to a certificate authority, will return a digital identity certificate that meets the encryption criteria defined by Elliptic-curve cryptography (ECC) standard. The use of this API assumes a thorough knowledge of public-key cryptosystems and the ECC cryptosystem definition.</p>

<p><h6 id='available-in-3-1-2'>Available in 3.1.2.</h6><h3 id='signature'>Signature</h3>
<p><code>C4:GenerateCSP_ECC(digest, curve, subject, tx509_exts) </code></p></p>

<table><thead>
<tr>
<th>Parameter</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>digest</td>
<td>The algorithm used by the certificate. For example, SHA256. See the <a href="https://snap-one.github.io/docs-driverworks-api/#getsupporteddigests">C4:GetSupportedDigests</a>()API for information on retrieving digests.</td>
</tr>
<tr>
<td>curve</td>
<td>The elliptical curve encoding format for the certificate.</td>
</tr>
<tr>
<td>subject</td>
<td>The person, organization or device required by the certificate. For example: <code>&quot;/C=US/ST=Utah/L=SLC/O=Foo/OU=Controller Certificates/CN=foo.bar.com</code></td>
</tr>
<tr>
<td><code>tx509_exts</code></td>
<td>Optional  table of key/value pairs. Used in the event that the desired certificate contains X.509 encryption data.</td>
</tr>
</tbody></table>

<h3 id='returns'>Returns</h3>

<p><code>None</code></p>

<h3 id='examples'>Examples</h3>

<p>Generate a CSR using ECC requirements:</p>

<p><code>local csr = C4:GenerateCSR_ECC(&quot;SHA256&quot;, &quot;secp256k1&quot;, &quot;/C=US/ST=Utah/L=Draper/O=Control4/OU=Controller Certificates/CN=foo.bar.com&quot;)</code></p>

<p>The resulting CSR to the right is generated:</p>

<div class="highlight"><pre class="highlight lua tab-lua"><code> <span class="c1">-----BEGIN CERTIFICATE REQUEST-----</span>
<span class="n">MIIB0TCCAXcCAQAweDELMAkGA1UEBhMCVVMxDTALBgNVBAgMBFV0YWgxDzANBgNV</span>
<span class="err">`</span><span class="n">BAcMBkRyYXBlcjERMA8GA1UECgwIQ29udHJvbDQxIDAeBgNVBAsMF0NvbnRyb2xs</span><span class="err">`</span>
<span class="err">`</span><span class="n">ZXIgQ2VydGlmaWNhdGVzMRQwEgYDVQQDDAtmb28uYmFyLmNvbTCB9TCBrgYHKoZI</span><span class="err">`</span>
<span class="n">zj0CATCBogIBATAsBgcqhkjOPQEBAiEA</span><span class="o">////////////////////////////////</span>
<span class="o">/////</span><span class="n">v</span><span class="o">///</span><span class="n">C8wBgQBAAQBBwRBBHm</span><span class="o">+</span><span class="n">Zn753LusVaBilc6HCwcCm</span><span class="o">/</span><span class="n">zbLc4o2VnygVsW</span>
<span class="err">`</span><span class="o">+</span><span class="n">BeYSDradyajxGVdpPv8DhEIqP0XtEimhVQZnEfQj</span><span class="o">/</span><span class="n">sQ1LgCIQD</span><span class="o">/////////////</span><span class="err">`</span>
<span class="err">`</span><span class="o">///////+</span><span class="n">uq7c5q9IoDu</span><span class="o">/</span><span class="mi">0</span><span class="n">l6M0DZBQQIBAQNCAAQXXbHNU5r5vYzZRYhPZGKFcSBe</span><span class="err">`</span>
<span class="n">I</span><span class="o">+</span><span class="n">D0y0pvyw</span><span class="o">+</span><span class="n">tUo8eGO9QjHqmw6A0vm5OyRR3C9qDH8msuDO1ZgieUkCfnfYSoAAw</span>
<span class="n">CgYIKoZIzj0EAwIDSAAwRQIgMvJKuHT2E</span><span class="o">+</span><span class="n">um</span><span class="o">/</span><span class="n">iXdUNhJK61jSI1ygcjR77lCZM2E</span>
<span class="err">`</span><span class="n">aRkCIQCcZLJvubYxdGxB0q7ApSBujF</span><span class="o">/</span><span class="n">L6</span><span class="o">/</span><span class="n">UtL</span><span class="o">/</span><span class="n">gjuolLE6JUaw</span><span class="o">==</span><span class="err">`</span>
 <span class="err"> </span><span class="c1">-----END CERTIFICATE REQUEST-----</span>
</code></pre></div>

<p>Generate a CSR using ECC requirements with the optional X.509 parameter:</p>

<p><code>local csr = C4:GenerateCSR_ECC(&quot;SHA256&quot;, &quot;secp256k1&quot;, &quot;/C=US/ST=Utah/L=Draper/O=Control4/OU=Controller Certificates/CN=foo.bar.com&quot;, {subjectKeyIdentifier = &quot;hash&quot;, subjectAltName = &quot;DNS:acs.qacafe.com, DNS:www.acs.qacafe.com&quot;})</code></p>

<p>The resulting CSR is generated:</p>

<div class="highlight"><pre class="highlight lua tab-lua"><code><span class="c1">--- X.509 Example</span>

<span class="c1">-----BEGIN CERTIFICATE REQUEST-----</span>
<span class="n">MIICIzCCAcgCAQAweDELMAkGA1UEBhMCVVMxDTALBgNVBAgMBFV0YWgxDzANBgNV</span><span class="err">`</span>
<span class="n">BAcMBkRyYXBlcjERMA8GA1UECgwIQ29udHJvbDQxIDAeBgNVBAsMF0NvbnRyb2xs</span>
<span class="n">ZXIgQ2VydGlmaWNhdGVzMRQwEgYDVQQDDAtmb28uYmFyLmNvbTCB9TCBrgYHKoZI</span><span class="err">`</span>
<span class="n">zj0CATCBogIBATAsBgcqhkjOPQEBAiEA</span><span class="o">////////////////////////////////</span>
<span class="o">/////</span><span class="n">v</span><span class="o">///</span><span class="n">C8wBgQBAAQBBwRBBHm</span><span class="o">+</span><span class="n">Zn753LusVaBilc6HCwcCm</span><span class="o">/</span><span class="n">zbLc4o2VnygVsW</span>
<span class="o">+</span><span class="n">BeYSDradyajxGVdpPv8DhEIqP0XtEimhVQZnEfQj</span><span class="o">/</span><span class="n">sQ1LgCIQD</span><span class="o">/////////////</span>
<span class="o">///////+</span><span class="n">uq7c5q9IoDu</span><span class="o">/</span><span class="mi">0</span><span class="n">l6M0DZBQQIBAQNCAASu8</span><span class="o">/</span><span class="mi">6</span><span class="n">lwqmnPbMLCvXIIU38ZmAo</span>
<span class="n">LjjaMLNhzAgAnWYz</span><span class="o">/</span><span class="n">lzg3h8FXcuC</span><span class="o">/</span><span class="n">W6jv83inkfgu</span><span class="o">/</span><span class="mi">4</span><span class="n">Zutp</span><span class="o">/</span><span class="n">GxAQLBqA</span><span class="o">+</span><span class="n">lkeoFEw</span>
<span class="n">TwYJKoZIhvcNAQkOMUIwQDALBgNVHQ4EBGhhc2gwMQYDVR0RBCpETlM6YWNzLnFh</span>
<span class="n">Y2FmZS5jb20sIEROUzp3d3cuYWNzLnFhY2FmZS5jb20wCgYIKoZIzj0EAwIDSQAw</span>
<span class="n">RgIhAI78Y9z3cIlRinJVmyx7I</span><span class="o">+</span><span class="mi">7</span><span class="n">uA37HEfofzdSktra4Lm5nAiEAxTep97UadRb1</span>
<span class="n">phLqvILbPqe2Lsm8JyCg</span><span class="o">/</span><span class="n">yEn5JlfncA</span><span class="o">=</span>
 <span class="c1">-----END CERTIFICATE REQUEST-----</span>
</code></pre></div>

<h2 id='generatecsr-rsa'>GenerateCSR RSA</h2>

<p>This API will generate a certificate signing request (CSR) which, when sent to a certificate authority, will return a digital identity certificate that meets the encryption criteria defined by the Rivest–Shamir–Adleman (RSA) standard. The use of this API assumes a thorough knowledge of public-key cryptosystems and the RSA cryptosystem definition.</p>

<p><h6 id='available-in-3-1-2'>Available in 3.1.2.</h6><h3 id='signature'>Signature</h3>
<p><code>C4:GenerateCSP_RSA(digest, sizeCert, subject, tx509_exts)</code></p></p>

<table><thead>
<tr>
<th>Parameter</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>digest</td>
<td>The algorithm used by the certificate. For example, SHA256. See the <a href="https://snap-one.github.io/docs-driverworks-api/#getsupporteddigests">C4:GetSupportedDigests</a>()API for information on retrieving digests.</td>
</tr>
<tr>
<td>sizeCert</td>
<td>The Key size of the certificate. For example, 2048.</td>
</tr>
<tr>
<td>subject</td>
<td>The person, organization or device required by the certificate.</td>
</tr>
<tr>
<td><code>tx509_exts</code></td>
<td>Optional  table of key/value pairs. Used in the event that the desired certificate contains X.509 encryption data.</td>
</tr>
</tbody></table>

<h3 id='returns'>Returns</h3>

<p><code>None</code></p>

<h3 id='examples'>Examples</h3>

<p>Generate a CSR using RSA requirements:</p>

<p><code>local csr = C4:GenerateCSR_RSA(&quot;SHA256&quot;, 2048, &quot;/C=US/ST=Utah/L=Draper/O=Control4/OU=Controller Certificates/CN=foo.bar.com&quot;)</code></p>

<p>The resulting CSR to the right is generated:</p>

<div class="highlight"><pre class="highlight lua tab-lua"><code><span class="n">BEGIN</span> <span class="n">CERTIFICATE</span> <span class="n">REQUEST</span><span class="c1">-----</span>
<span class="n">MIICvTCCAaUCAQAweDELMAkGA1UEBhMCVVMxDTALBgNVBAgMBFV0YWgxDzANBgNV</span>
<span class="n">BAcMBkRyYXBlcjERMA8GA1UECgwIQ29udHJvbDQxIDAeBgNVBAsMF0NvbnRyb2x</span><span class="err">~~</span><span class="n">s</span>
<span class="n">ZXIgQ2VydGlmaWNhdGVzMRQwEgYDVQQDDAtmb28uYmFyLmNvbTCCASIwDQYJKoZI</span>
<span class="n">hvcNAQEBBQADggEPADCCAQoCggEBALzSLHvRT8QcVbfFlxCCUkGEL2irn8r6DxBM</span>
<span class="o">+</span><span class="n">XEK6</span><span class="o">/</span><span class="n">xXeAVZ</span><span class="o">/</span><span class="n">oWRAiGOHBNeqmdaUz0ib4ANdTHn8jEUB2t38cDVEJ88o4BiE</span><span class="o">+/</span><span class="n">D</span>
<span class="n">rpmUphIKXh3Hp57PwyC0EKHQ2POq6e75AxOMouCdtbbLgBDxmD6WWM6ojEwphEQ2</span>
<span class="n">M6JM6ZJA9pDQ</span><span class="o">/</span><span class="n">UanbGWruvKFEm9AUdo</span><span class="o">+</span><span class="n">hAjoFgObDqhWLLIwXFeSyz6y</span><span class="o">/</span><span class="mi">0</span><span class="n">aymBam</span>
<span class="n">jtO</span><span class="o">/</span><span class="n">ovOS</span><span class="o">/</span><span class="mi">5</span><span class="n">moNy</span><span class="o">+</span><span class="n">ENBeOsLC2ayCn4Fquj77Y825Ye9kYPkiVkkcEtawAEEFebZJY</span>
<span class="n">pUE8SwBOYjjHYJoWFDv</span><span class="o">+</span><span class="n">vcxWBFlc0ECTFKeB9Bd4vi2TF</span><span class="o">+</span><span class="n">IlwpsCAwEAAaAAMA0G</span>
<span class="n">CSqGSIb3DQEBCwUAA4IBAQBv4Z7e1cD1gbNy0PXYyugQpbG19umTcZkQN</span><span class="o">+</span><span class="n">BlK5TY</span>
<span class="o">+</span><span class="n">VcNLKK</span><span class="o">/</span><span class="mi">56</span><span class="n">IPaxX7ZeHpe3DQPOXnTmc</span><span class="o">/+</span><span class="n">wVremZ6h7TwSxUOBFY9DjVUuh0thWsB</span>
<span class="n">t</span><span class="o">+</span><span class="n">xUzWt4Oae0ymP8JF83b9RZl1EGGsAsQopB</span><span class="o">+</span><span class="n">Uu4P9VgwjHm9PTXVBheofbZ</span><span class="o">/</span><span class="n">yXp</span>
<span class="n">oeom</span><span class="o">+</span><span class="n">w0fl</span><span class="o">+/</span><span class="n">qCcIjvDAGh8ODz4gfk6Mjl1iiQykOyWeGhZiGyd6G80IAF1pjciVS</span>
<span class="n">O94cvy6o9EAAgujSCmCZFOgx3kwOfLZ</span><span class="o">/</span><span class="n">r1rq5jRvyyjK7wzL7bZHHjBJBLpe</span><span class="o">/</span><span class="n">tx0</span>
<span class="n">AV</span><span class="o">+</span><span class="n">GeKVQe0nHme1tt1n</span><span class="o">+</span><span class="n">ZC5mIZ0q7qjKL3wwl4ckwTg</span><span class="o">/</span>
      <span class="c1">-----END CERTIFICATE REQUEST—</span>
</code></pre></div>

<p>Generate a CSR using RSA requirements with the optional X.509 parameter:</p>

<p><code>local csr = C4:GenerateCSR_RSA(&quot;SHA256&quot;, 1024, &quot;/C=US/ST=Utah/L=Draper/O=Control4/OU=Controller Certificates/CN=foo.bar.com&quot;, {subjectKeyIdentifier = &quot;hash&quot;, subjectAltName = &quot;DNS:acs.qacafe.com, DNS:www.acs.qacafe.com&quot;})</code></p>

<p>The resulting CSR to the right is generated:</p>

<div class="highlight"><pre class="highlight lua tab-lua"><code><span class="err">—</span> <span class="n">X</span><span class="p">.</span><span class="mi">509</span> <span class="n">Example</span>

 <span class="c1">-----BEGIN CERTIFICATE REQUEST-----</span>
<span class="n">MIICCTCCAXICAQAweDELMAkGA1UEBhMCVVMxDTALBgNVBAgMBFV0YWgxDzANBgNV</span>
<span class="n">BZXIgQ2VydGlmaWNhdGVzMRQwEgYDVQQDDAtmb28uYmFyLmNvbTCBnzANBgkqhkiG</span>
<span class="mi">9</span><span class="n">w0BAQEFAAOBjQAwgYkCgYEA3djqm4PIBftyev9W0W4U</span><span class="o">+</span><span class="mi">2</span><span class="n">XlwKHepq2o</span><span class="o">+</span><span class="n">dWPSk5s</span>
<span class="o">/</span><span class="n">UzNd0TCeYoM02r</span><span class="o">+</span><span class="n">sTzQN2lkiGMYoPoKvP6qvQFWBzprtkS40z11S8AYGLqwKvxy</span>
<span class="o">/</span><span class="n">MC8YcWjgGgvZB0h51TdW1OFdFT</span><span class="o">+</span><span class="n">yL68jnO9rGGIlfHx5DMyYypZf3tJKLczLVrh</span>
<span class="n">rY0CAwEAAaBRME8GCSqGSIb3DQEJDjFCMEAwCwYDVR0OBARoYXNoMDEGA1UdEQQq</span>
<span class="n">RE5TOmFjcy5xYWNhZmUuY29tLCBETlM6d3d3LmFjcy5xYWNhZmUuY29tMA0GCSqG</span>
<span class="n">SIb3DQEBCwUAA4GBAA8Rz0fl6ue23HBENNV151uF0mQ9aT6</span><span class="o">/</span><span class="n">Z5S</span><span class="o">+</span><span class="mi">8</span><span class="n">w8XTXXmf76B</span>
<span class="n">OtTWXwPsxfsfxtZgRyKIGS4evUFN9jQIyEJNDj1</span><span class="o">+</span><span class="n">gvN2YFcm7bZFnPgq1m2vA3R1</span>
<span class="n">TI9W6D463RicdNwjO92RYUgSm58Q1tCpyvlQqnedzvihQw1JFRgcIGNhbqI5</span>
 <span class="c1">-----END CERTIFICATE REQUEST-----</span>
</code></pre></div>

<h2 id='getsupportedciphers'>GetSupportedCiphers</h2>

<p>Returns the list of ciphers supported by the <a href="#encrypt">Encrypt</a> and <a href="#decrypt">Decrypt</a> functions.</p>

<p><h6 id='available-in-1-6-0'>Available in 1.6.0.</h6><h3 id='signature'>Signature</h3>
<p><code>C4:GetSupportedCiphers ()</code></p>
<h3 id='returns'>Returns</h3>
<p><code>ciphers</code></p></p>

<table><thead>
<tr>
<th>Value</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>table</td>
<td>ciphers: Table of supported ciphers.  Each element is a key/value pair, where the key is the cipher name and the value is  the list of parameters for that cipher.</td>
</tr>
</tbody></table>

<p>Valid key/value pairs for <em>ciphers</em> element value:</p>

<table><thead>
<tr>
<th>Value</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>num</td>
<td>BlockSize: The size (in bytes) of each block for this cipher</td>
</tr>
<tr>
<td>num</td>
<td>KeyLength: The maximum size (in bytes) of the key for this cipher (shorter keys will be padded)</td>
</tr>
<tr>
<td>num</td>
<td>IVLength: The maximum size (in bytes) of the IV for this cipher (shorter IVs will be padded)</td>
</tr>
</tbody></table>

<h3 id='example'>Example</h3><div class="highlight"><pre class="highlight lua tab-lua"><code><span class="kd">local</span> <span class="n">supportedCiphers</span> <span class="o">=</span> <span class="n">C4</span><span class="p">:</span><span class="n">GetSupportedCiphers</span> <span class="p">()</span>
<span class="k">for</span> <span class="n">k</span><span class="p">,</span><span class="n">v</span> <span class="k">in</span> <span class="nb">pairs</span> <span class="p">(</span><span class="n">supportedCiphers</span> <span class="p">[</span><span class="s1">'AES-256-CBC'</span><span class="p">])</span> <span class="k">do</span>
    <span class="nb">print</span> <span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="n">v</span><span class="p">)</span>
<span class="k">end</span>

<span class="o">&gt;</span> <span class="n">Output</span><span class="p">:</span>

<span class="n">BlockSize</span>   <span class="mi">16</span>
<span class="n">KeyLength</span>   <span class="mi">32</span>
<span class="n">IVLength</span>    <span class="mi">16</span>
</code></pre></div>
<h2 id='getsupporteddigests'>GetSupportedDigests</h2>
<p>Returns the list of digests supported by the <a href="#hash">Hash</a>, <a href="#hmac">HMAC</a> and <a href="#pbkdf2">PBKDF2</a> functions.</p>
<h6 id='available-in-1-6-0'>Available in 1.6.0.</h6><h3 id='signature'>Signature</h3>

<p><code>C4:GetSupportedDigests ()</code></p>

<h3 id='returns'>Returns</h3>

<table><thead>
<tr>
<th>Value</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>table</td>
<td>digests: Table of supported digests.  Each element is a key/value pair, where the key is the digest name and the value is the list of parameters for that digest.</td>
</tr>
</tbody></table>

<p>Valid key/value pairs for digest element value:</p>

<table><thead>
<tr>
<th>Value</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>num</td>
<td>Size: The size (in bytes) of the output of this digest</td>
</tr>
</tbody></table>

<h3 id='example'>Example</h3><div class="highlight"><pre class="highlight lua tab-lua"><code><span class="kd">local</span> <span class="n">supportedDigests</span> <span class="o">=</span> <span class="n">C4</span><span class="p">:</span><span class="n">GetSupportedDigests</span> <span class="p">()</span>
<span class="k">for</span> <span class="n">k</span><span class="p">,</span><span class="n">v</span> <span class="k">in</span> <span class="nb">pairs</span> <span class="p">(</span><span class="n">supportedDigests</span> <span class="p">[</span><span class="s1">'SHA256'</span><span class="p">])</span> <span class="k">do</span>
    <span class="nb">print</span> <span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="n">v</span><span class="p">)</span>
<span class="k">end</span>

<span class="o">&gt;</span> <span class="n">Output</span><span class="p">:</span>

<span class="n">Size</span>    <span class="mi">32</span>
</code></pre></div>
<h2 id='hash'>Hash</h2>
<p>Hashes a given string with the specified digest.</p>
<h6 id='available-in-1-6-0'>Available in 1.6.0.</h6><h3 id='signature'>Signature</h3>

<p><code>C4:Hash (digest, data, options)</code></p>

<table><thead>
<tr>
<th>Parameter</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>str</td>
<td>digest: Valid digest (see <a href="#getsupporteddigests">GetSupportedDigests</a>).</td>
</tr>
<tr>
<td>str</td>
<td>data: Data to hash.</td>
</tr>
<tr>
<td>table</td>
<td>options: (Optional) Options to specify encoding of inputs and outputs:</td>
</tr>
</tbody></table>

<p>Valid key/value pairs for options parameter:</p>

<table><thead>
<tr>
<th>Key</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>str</td>
<td>return encoding: &#39;NONE&#39; / &#39;HEX&#39; / &#39;BASE64&#39;</td>
</tr>
<tr>
<td>str</td>
<td>data encoding:  &#39;NONE&#39; / &#39;HEX&#39; / &#39;BASE64&#39;</td>
</tr>
</tbody></table>

<h3 id='returns'>Returns</h3>

<p>A successful operation will return <code>nil</code> for <em>err</em>.  If an error occurs, then <em>result</em> will be nil and <em>err</em> will contain the description of the error.</p>

<table><thead>
<tr>
<th>Value</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>str</td>
<td>result: Encrypted data</td>
</tr>
<tr>
<td>str</td>
<td>err : Description of any error that occurred</td>
</tr>
</tbody></table>

<h3 id='example'>Example</h3><div class="highlight"><pre class="highlight lua tab-lua"><code><span class="kd">local</span> <span class="n">digest</span> <span class="o">=</span> <span class="s1">'SHA256'</span>
<span class="kd">local</span> <span class="n">data</span> <span class="o">=</span> <span class="s1">'Hello World, this is London calling'</span>
<span class="kd">local</span> <span class="n">options</span> <span class="o">=</span> <span class="p">{</span>
    <span class="n">return_encoding</span> <span class="o">=</span> <span class="s1">'HEX'</span><span class="p">,</span>
    <span class="n">data_encoding</span> <span class="o">=</span> <span class="s1">'NONE'</span><span class="p">,</span>
<span class="p">}</span>
<span class="kd">local</span> <span class="n">digest_output</span><span class="p">,</span> <span class="n">err</span> <span class="o">=</span> <span class="n">C4</span><span class="p">:</span><span class="n">Hash</span> <span class="p">(</span><span class="n">digest</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">options</span><span class="p">)</span>
<span class="nb">print</span> <span class="p">(</span><span class="nb">type</span> <span class="p">(</span><span class="n">digest_output</span><span class="p">),</span> <span class="n">digest_output</span><span class="p">)</span>

<span class="o">&gt;</span> <span class="n">Output</span><span class="p">:</span>

<span class="n">string</span>  <span class="mi">3</span><span class="n">fa83003c1c41282cac40d71b680d85f981f1517e5ac4941bd871955aeecbfec</span>
</code></pre></div>
<h2 id='hmac'>HMAC</h2>
<p>Computes a hash-based message authentication code (<a href="https://en.wikipedia.org/wiki/HMAC">HMAC</a>) for a given string using the specified key.</p>
<h6 id='available-in-1-6-0'>Available in 1.6.0.</h6><h3 id='signature'>Signature</h3>

<p><code>C4:HMAC (digest, key, data, options)</code></p>

<table><thead>
<tr>
<th>Parameter</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>str</td>
<td>digest: Valid digest (see <a href="#getsupporteddigests">GetSupportedDigests</a>).</td>
</tr>
<tr>
<td>str</td>
<td>key: Key to use for computing HMAC.</td>
</tr>
<tr>
<td>str</td>
<td>data:    Data to compute HMAC for.</td>
</tr>
<tr>
<td>table</td>
<td>options: (Optional) Options to specify encoding of inputs and outputs:</td>
</tr>
</tbody></table>

<p>Valid key/value pairs for options parameter:</p>

<table><thead>
<tr>
<th>Key</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>str</td>
<td>return_encoding: &#39;NONE&#39; / &#39;HEX&#39; / &#39;BASE64&#39;</td>
</tr>
<tr>
<td>str</td>
<td>ey_encoding: ‘NONE&#39; / &#39;HEX&#39; / &#39;BASE64&#39;</td>
</tr>
<tr>
<td>str</td>
<td>data_encoding’: ‘NONE&#39; / &#39;HEX&#39; / &#39;BASE64&#39;</td>
</tr>
</tbody></table>

<h3 id='returns'>Returns</h3>

<p>A successful operation will return <code>nil</code> for <em>err</em>.  If an error occurs, then <em>result</em> will be nil and <em>err</em> will contain the description of the error.</p>

<table><thead>
<tr>
<th>Value</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>str</td>
<td>result: Computed HMAC value</td>
</tr>
<tr>
<td>str</td>
<td>err: Description of any error that occurred</td>
</tr>
</tbody></table>

<h3 id='example'>Example</h3><div class="highlight"><pre class="highlight lua tab-lua"><code><span class="kd">local</span> <span class="n">digest</span> <span class="o">=</span> <span class="s1">'SHA256'</span>
<span class="kd">local</span> <span class="n">key</span> <span class="o">=</span> <span class="s1">'Super Secret Key'</span>
<span class="kd">local</span> <span class="n">data</span> <span class="o">=</span> <span class="s1">'Hello World, this is London calling'</span>
<span class="kd">local</span> <span class="n">options</span> <span class="o">=</span> <span class="p">{</span>
    <span class="n">return_encoding</span> <span class="o">=</span> <span class="s1">'HEX'</span><span class="p">,</span>
    <span class="n">key_encoding</span> <span class="o">=</span> <span class="s1">'NONE'</span><span class="p">,</span>
    <span class="n">data_encoding</span> <span class="o">=</span> <span class="s1">'NONE'</span><span class="p">,</span>
<span class="p">}</span>
<span class="kd">local</span> <span class="n">hmac_output</span><span class="p">,</span> <span class="n">err</span> <span class="o">=</span> <span class="n">C4</span><span class="p">:</span><span class="n">HMAC</span> <span class="p">(</span><span class="n">digest</span><span class="p">,</span> <span class="n">key</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">options</span><span class="p">)</span>
<span class="nb">print</span> <span class="p">(</span><span class="nb">type</span> <span class="p">(</span><span class="n">hmac_output</span><span class="p">),</span> <span class="n">hmac_output</span><span class="p">)</span>

<span class="o">&gt;</span> <span class="n">Output</span><span class="p">:</span>

<span class="n">string</span>  <span class="mi">6402</span><span class="n">b5430d06db90c84e91a3ed605ba12964ff29e7bbd197b54109ac72aa58ce</span>
</code></pre></div>
<h2 id='loadpkcs12'>LoadPKCS12</h2>
<p>Load a certificate and private key from a #PKCS12 file.</p>

<p>The Lua PKCS #12 interface enables drivers to manage certificates and private keys using the PKCS #12 file format. These files are encrypted and protected by a password. This ensures that cryptographic assets are secure and are not easily recovered.</p>
<h6 id='available-in-3-1-2'>Available in 3.1.2.</h6><h3 id='signature'>Signature</h3>

<p><code>C4:LoadPKCS12(filename, password) </code></p>

<table><thead>
<tr>
<th>Parameter</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>str</td>
<td>Path to the #PKCS12 file to load</td>
</tr>
<tr>
<td>str</td>
<td>The password for unlocking the file.</td>
</tr>
</tbody></table>

<h3 id='returns'>Returns</h3>

<p>Success returns multiple values consisting of: true, string, string.</p>

<table><thead>
<tr>
<th>Value</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>true</td>
<td>Indicates that the load operation was successful.</td>
</tr>
<tr>
<td>string</td>
<td>The PEM-encoded certificate.</td>
</tr>
<tr>
<td>string</td>
<td>The PEM-encoded private key.</td>
</tr>
</tbody></table>

<p>Failure returns multiple values consisting of: false, string</p>

<table><thead>
<tr>
<th>Value</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>false</td>
<td>Indicates that the load operation failed</td>
</tr>
<tr>
<td>str</td>
<td>A description of the error that occurred</td>
</tr>
</tbody></table>

<h3 id='example'>Example</h3><div class="highlight"><pre class="highlight lua tab-lua"><code><span class="kd">local</span> <span class="n">filename</span> <span class="o">=</span><span class="err"> </span><span class="s2">"Foo.p12"</span>
<span class="kd">local</span> <span class="n">password</span> <span class="o">=</span><span class="err"> </span><span class="s2">"PaSsWoRd"</span>

<span class="n">result</span><span class="p">,</span> <span class="n">cert</span><span class="p">,</span> <span class="n">key</span> <span class="o">=</span><span class="err"> </span><span class="n">C4</span><span class="p">:</span><span class="n">LoadPKCS12</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="n">password</span><span class="p">)</span>
   <span class="k">if</span><span class="err"> </span><span class="p">(</span><span class="n">result</span><span class="p">)</span><span class="err"> </span><span class="k">then</span>
   <span class="nb">print</span><span class="p">(</span><span class="s2">"Success!"</span><span class="p">)</span>
 <span class="k">else</span>
   <span class="nb">print</span><span class="p">(</span><span class="s2">"Something horrible has happened: "</span><span class="p">,</span> <span class="n">cert</span><span class="p">)</span>
<span class="k">end</span>
</code></pre></div>
<h2 id='pbkdf2'>PBKDF2</h2>
<p>Performs a Password-Based Key Derivation Function 2 (PKCS#5) (<a href="https://en.wikipedia.org/wiki/PBKDF2">PBKDF2</a>) for a given password using the specified digest, salt, number of iterations and desired output key length.</p>
<h6 id='available-in-1-6-0'>Available in 1.6.0.</h6><h3 id='signature'>Signature</h3>

<p><code>C4:PBKDF2 (digest, password, salt, iterations, key_length, options)</code></p>

<table><thead>
<tr>
<th>Parameter</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>str</td>
<td>digest: Valid digest (see <a href="#getsupporteddigests">GetSupportedDigests</a>).</td>
</tr>
<tr>
<td>str</td>
<td>password: Input password to generate PBKDF2 output for</td>
</tr>
<tr>
<td>str</td>
<td>salt: Cryptographic salt to use</td>
</tr>
<tr>
<td>num</td>
<td>iterations: Number of iterations to run</td>
</tr>
<tr>
<td>num</td>
<td>key_length:  Number of bytes to generate as output</td>
</tr>
<tr>
<td>table</td>
<td>options: (Optional) Options to specify encoding of inputs and outputs:</td>
</tr>
</tbody></table>

<p>Valid key/value pairs for options parameter:</p>

<table><thead>
<tr>
<th>Key</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>str</td>
<td>return_encoding: &#39;NONE&#39; / &#39;HEX&#39; / &#39;BASE64&#39;</td>
</tr>
<tr>
<td>str</td>
<td>salt_encoding: ‘NONE&#39; / &#39;HEX&#39; / &#39;BASE64&#39;</td>
</tr>
</tbody></table>

<h3 id='returns'>Returns</h3>

<p><code>result, err</code></p>

<p>A successful operation will return <code>nil</code> for <em>err</em>.  If an error occurs, then <em>result</em> will be nil and <em>err</em> will contain the description of the error.</p>

<table><thead>
<tr>
<th>Value</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>str</td>
<td>result: Computed HMAC value</td>
</tr>
<tr>
<td>str</td>
<td>err : Description of any error that occurred</td>
</tr>
</tbody></table>

<h3 id='example'>Example</h3><div class="highlight"><pre class="highlight lua tab-lua"><code><span class="kd">local</span> <span class="n">digest</span> <span class="o">=</span> <span class="s1">'SHA256'</span>
<span class="kd">local</span> <span class="n">password</span> <span class="o">=</span> <span class="s1">'My Voice Is My Passport'</span>
<span class="kd">local</span> <span class="n">salt</span> <span class="o">=</span> <span class="s1">'NaCl is one of many'</span>
<span class="kd">local</span> <span class="n">iterations</span> <span class="o">=</span> <span class="mi">100000</span>
<span class="kd">local</span> <span class="n">keyLen</span> <span class="o">=</span> <span class="mi">32</span>
<span class="kd">local</span> <span class="n">options</span> <span class="o">=</span> <span class="p">{</span>
    <span class="n">return_encoding</span> <span class="o">=</span> <span class="s1">'HEX'</span><span class="p">,</span>
    <span class="n">salt_encoding</span> <span class="o">=</span> <span class="s1">'NONE'</span><span class="p">,</span>
<span class="p">}</span>
<span class="kd">local</span> <span class="n">pbkdf2_output</span><span class="p">,</span> <span class="n">err</span> <span class="o">=</span> <span class="n">C4</span><span class="p">:</span><span class="n">PBKDF2</span> <span class="p">(</span><span class="n">digest</span><span class="p">,</span> <span class="n">password</span><span class="p">,</span> <span class="n">salt</span><span class="p">,</span> <span class="n">iterations</span><span class="p">,</span> <span class="n">keyLen</span><span class="p">,</span> <span class="n">options</span><span class="p">)</span>
<span class="nb">print</span> <span class="p">(</span><span class="nb">type</span> <span class="p">(</span><span class="n">pbkdf2_output</span><span class="p">),</span> <span class="n">pbkdf2_output</span><span class="p">)</span>

<span class="o">&gt;</span> <span class="n">Output</span><span class="p">:</span>

<span class="n">string</span>  <span class="mi">12675672222506</span><span class="n">b342f05c0406f43e2af944bcb4ba592bf45e1c7cebad0fcdee</span>
</code></pre></div>
<h2 id='sign'>Sign</h2>
<p>Sign enables drivers to crypto-graphically sign an arbitrary payload using a specified key.  The API currently supports both HMAC &amp; RSA signing. Control4 strongly recommends that driver developers implement this new API beginning with OS Release 3.1.0. This API is the best solution to cryptographically sign a payload. Control4 recommends its use rather than other Lua libraries.</p>
<h6 id='available-in-3-1-0'>Available in 3.1.0.</h6><h3 id='signature'>Signature</h3>

<p><code>C4:Sign(operation, digest, key, data, [options])</code></p>

<table><thead>
<tr>
<th>Parameter</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>str</td>
<td>Specifies which signing operation to perform. Valid values are: <strong>HMAC:</strong> Use the HMAC (hash-based message authentication code) signing algorithm. <strong>RSA:</strong> Use the RSA (Rivest-Shamir-Adleman) signing algorithm.</td>
</tr>
<tr>
<td>str</td>
<td>Identifies which digest to use when signing. This can be one of the following values: <strong>HMAC:</strong> Any supported hashing digest can be used. <strong>RSA:</strong> Must be one of <code>SHA1, SHA224, SHA256, SHA384, SHA512, MD5, MD5_SHA1, MD2, MD4, MDC2, or RIPEMD160.</code></td>
</tr>
<tr>
<td>key</td>
<td>The key to use for signing. The <code>key_encoding</code> option identifies the format of the key (see options below). <strong>HMAC:</strong> The key can be of any length, but cannot be empty.  Control4 recommends that the size of the key be the same as the digest. For example, a 256-bit key for SHA256 or a 160-bit key for RIPEMD160. <strong>RSA:</strong> The key must be an RSA key that is valid for signing. Note that RSA public keys are typically not valid for signing.</td>
</tr>
<tr>
<td>data</td>
<td>The data to be signed. The <code>data_encoding</code> option identifies the format of the data (see options below).</td>
</tr>
</tbody></table>

<p>Options:</p>

<p><code>key_encoding</code></p>

<p>Identifies the format of the key. Valid values for this option are:</p>

<ul>
<li>NONE: The key is not encoded.</li>
<li>HEX: The key is hex encoded.</li>
<li>Base64: The key is base64 encoded.</li>
<li>PEM: The key a PEM encoded private key.
- </li>
</ul>

<p><code>data_encoding</code></p>

<p>Identifies the format of the data. Valid values for this option are:</p>

<ul>
<li>NONE: The data is not encoded.</li>
<li>HEX: The data is hex encoded.</li>
<li>BASE64: The data is base64 encoded.
- </li>
</ul>

<p><code>return_encoding</code></p>

<p>Identifies the format of the result (signature). Valid values for this option are:</p>

<ul>
<li>NONE: Do not encode the result.</li>
<li>HEX (default): Hex (lowercase) encoding.</li>
<li><code>HEX_UPPER</code>: Hex (uppercase) encoding.</li>
<li>BASE64: Base64 encoding.</li>
</ul>

<h3 id='returns'>Returns</h3>

<p>Success: Returns a string containing the signature.</p>

<p>Failure: Returns the following multiple results:</p>

<table><thead>
<tr>
<th>Value</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>nil</td>
<td>A value of nil indicates that an error occurred.</td>
</tr>
<tr>
<td>str</td>
<td>A string containing a description of the error.</td>
</tr>
</tbody></table>

<h3 id='examples'>Examples</h3><div class="highlight"><pre class="highlight lua tab-lua"><code><span class="n">options</span> <span class="o">=</span> <span class="p">{}</span>
<span class="n">options</span><span class="p">[</span><span class="s2">"key_encoding"</span><span class="p">]</span> <span class="o">=</span><span class="err"> </span><span class="s2">"PEM"</span>
<span class="n">options</span><span class="p">[</span><span class="s2">"return_encoding"</span><span class="p">]</span> <span class="o">=</span><span class="err"> </span><span class="s2">"BASE64"</span>
<span class="n">key</span> <span class="o">=</span> <span class="s">[[-----BEGIN RSA PRIVATE KEY-----
MIICXAIBAAKBgQC8cDObD4DjL3TnUR7JxObq+pwb4XX6UYjXuM1zzl/4gvQ8KzA4
CDl8S5FQeaPe4vdrLHEJudxSJc7JWehMwcS+jP6xO1pRA68SBphq9I5G/itBw5zx
RSGi26NDTiu7XczTRTPGRyBRNxBiln4hWg3ordY5gn0PYe30Fem9vTyZ1QIDAQAB
AoGAPTNfv1uwq5iNKleRXUyjBuwv6Wo3a/4xKIbvy03ao5a8hhIszfX13aWZY36u
N0SVwOwlJliD8vYui/y0UsGYCRCKrBFh5iBlL4bd4bOg/3uD9EXqiZQiT/BeYAD5
TYozqtsBU8DhZytdX3OcmLlKwhX+fzKMC2/UWPkEQ2TlSX0CQQDd/DgdI6WbCn3f
sIJo6yEA98ZivayuoePfRP8CHaIAOVO6KOa1wYwR/nmrUmPSFZDUpvwB7mvel4WN
3VqNO9sXAkEA2VAKopLmgdL+KNZdpg2BB3eVMMDefhXC04tBmUpWX6qaFEVsw+gl
DYnDel3gv43iq3xqszaKEJy+1T+bR9tV8wJAc4ecvK2ctsATGqQGewxENPi/KwyE
Hq7qpXyHK1a4xV0QkkZPLDD68TJ7qApNIT1QDxyI84heY46AV4Doa7DHKQJBAMj0
l6EXL0nGj3m8IgW4XyVElBXthNIb1XpCQHs8nvsAjFNKj/Xp6rnGN5okzfzVfFMQ
TqtDOBF8oYwZscKVNbkCQFolrfE1I7DMTuQNHmF6kMXr/0gjhDTbUOOP3kzCSK14
iSpRAwom9R5BWUMFoRCn0j0TWFsTIBNSuOcMrw5n6NU=
-----END RSA PRIVATE KEY-----]]</span>
<span class="n">signature</span><span class="o">=</span><span class="n">C4</span><span class="p">:</span><span class="n">Sign</span><span class="p">(</span><span class="s2">"RSA"</span><span class="p">,</span><span class="err"> </span><span class="s2">"SHA256"</span><span class="p">,</span> <span class="n">key</span><span class="p">,</span><span class="err"> </span><span class="s2">"Walla Walla Washington"</span><span class="p">,</span> <span class="n">options</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">signature</span><span class="p">)</span>

<span class="err">﻿</span>
<span class="n">options</span> <span class="o">=</span> <span class="p">{}</span>
<span class="n">options</span><span class="p">[</span><span class="s2">"key_encoding"</span><span class="p">]</span> <span class="o">=</span><span class="err"> </span><span class="s2">"BASE64"</span>
<span class="n">options</span><span class="p">[</span><span class="s2">"return_encoding"</span><span class="p">]</span> <span class="o">=</span><span class="err"> </span><span class="s2">"HEX"</span>
<span class="n">key</span> <span class="o">=</span><span class="err"> </span><span class="s2">"VGhlIHF1aWNrIGJyb3duIGZveCBqdW1wZWQgb3ZlciB0aGUgbGF6eSBkb2cu"</span>
<span class="n">signature</span> <span class="o">=</span> <span class="n">C4</span><span class="p">:</span><span class="n">Sign</span><span class="p">(</span><span class="s2">"HMAC"</span><span class="p">,</span><span class="err"> </span><span class="s2">"SHA256"</span><span class="p">,</span> <span class="n">key</span><span class="p">,</span><span class="err"> </span><span class="s2">"Walla Walla Washington"</span><span class="p">,</span> <span class="n">options</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">signature</span><span class="p">)</span>

<span class="err">﻿</span>
<span class="n">options</span> <span class="o">=</span> <span class="p">{}</span>
<span class="n">options</span><span class="p">[</span><span class="s2">"key_encoding"</span><span class="p">]</span> <span class="o">=</span><span class="err"> </span><span class="s2">"BASE64"</span>
<span class="n">options</span><span class="p">[</span><span class="s2">"return_encoding"</span><span class="p">]</span> <span class="o">=</span><span class="err"> </span><span class="s2">"HEX"</span>
<span class="n">key</span> <span class="o">=</span><span class="err"> </span><span class="s2">"VGhlIHF1aWNrIGJyb3duIGZveCBqdW1wZWQgb3ZlciB0aGUgbGF6eSBkb2cu"</span>
<span class="n">signature</span> <span class="o">=</span> <span class="n">C4</span><span class="p">:</span><span class="n">Sign</span><span class="p">(</span><span class="s2">"HMAC"</span><span class="p">,</span><span class="err"> </span><span class="s2">"SHA256"</span><span class="p">,</span> <span class="n">key</span><span class="p">,</span><span class="err"> </span><span class="s2">"Walla Walla Washington"</span><span class="p">,</span> <span class="n">options</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">signature</span><span class="p">)</span>
</code></pre></div>
<h2 id='writepkcs12'>WritePKCS12</h2>
<p>Writes a certificate and private key to a specified #PKCS12 file.</p>

<p>The Lua PKCS #12 interface enables drivers to manage certificates and private keys using the PKCS #12 file format. These files are encrypted and protected by a password. This ensures that cryptographic assets are secure and are not easily recovered.</p>
<h6 id='available-in-3-1-2'>Available in 3.1.2.</h6><h3 id='signature'>Signature</h3>

<p><code>C4:WritePKCS12(filename, password, certificate, key, label, options)</code></p>

<table><thead>
<tr>
<th>Parameter</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>str</td>
<td>Path to the #PKCS12 file that will be created</td>
</tr>
<tr>
<td>str</td>
<td>The password for securing the file.</td>
</tr>
<tr>
<td>str</td>
<td>The PEM-encoded certificate to be stored in the file.</td>
</tr>
<tr>
<td>key</td>
<td>The PEM-encoded private key to be stored in the file.</td>
</tr>
<tr>
<td>str</td>
<td>An optional string containing the label, or &quot;friendly name&quot;.</td>
</tr>
</tbody></table>

<h3 id='returns'>Returns</h3>

<p>Success returns <code>true</code>.</p>

<p>Failure: Returns multiple values consisting of false and string.</p>

<table><thead>
<tr>
<th>Value</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>false</td>
<td>Indicates that the write operation failed</td>
</tr>
<tr>
<td>string</td>
<td>A description of the error that occurred.</td>
</tr>
<tr>
<td></td>
<td></td>
</tr>
</tbody></table>

<p><h3 id='example'>Example</h3><div class="highlight"><pre class="highlight lua tab-lua"><code><span class="kd">local</span> <span class="n">filename</span> <span class="o">=</span><span class="err"> </span><span class="s2">&quot;Foo.p12&quot;</span>
<span class="kd">local</span> <span class="n">password</span> <span class="o">=</span><span class="err"> </span><span class="s2">&quot;PaSsWoRd&quot;</span>
<span class="kd">local</span> <span class="n">label</span> <span class="o">=</span><span class="err"> </span><span class="s2">&quot;This is my excellent certificate&quot;</span></p>

<p><span class="kd">local</span> <span class="n">certificate</span> <span class="o">=</span> <span class="p">[[</span><span class="err">`</span>
     <span class="c1">-----BEGIN CERTIFICATE-----</span>
<span class="n">MIIDLTCCAhUCCQC5eca</span><span class="o">/</span><span class="n">KJpLETANBgkqhkiG9w0BAQsFADCBkTEVMBMGA1UEAwwM</span>
<span class="n">Y29udHJvbDQuY29tMQ0wCwYDVQQIDARVdGFoMQswCQYDVQQGEwJVUzEdMBsGA1UE</span>
<span class="n">CgwUQ29udHJvbDQgQ29ycG9yYXRpb24xFDASBgNVBAsMC0VuZ2luZWVyaW5nMScw</span>
<span class="n">JQYJKoZIhvcNAQkBFhhlbmdpbmVlcmluZ0Bjb250cm9sNC5jb20wHhcNMTQwNzA3</span>
<span class="n">MjEzMTA4WhcNNDExMTIyMjEzMTA4WjCBojELMAkGA1UEBhMCVVMxDTALBgNVBAgM</span>
<span class="n">BFV0YWgxDzANBgNVBAcMBkRyYXBlcjEdMBsGA1UECgwUQ29udHJvbDQgQ29ycG9y</span>
<span class="n">YXRpb24xFDASBgNVBAsMC0VuZ2luZWVyaW5nMRUwEwYDVQQDDAxjb250cm9sNC5j</span>
<span class="n">b20xJzAlBgkqhkiG9w0BCQEWGGVuZ2luZWVyaW5nQGNvbnRyb2w0LmNvbTCBnzAN</span>
<span class="n">BgkqhkiG9w0BAQEFAAOBjQAwgYkCgYEAvHAzmw</span><span class="o">+</span><span class="n">A4y9051EeycTm6vqcG</span><span class="o">+</span><span class="n">F1</span><span class="o">+</span><span class="n">lGI</span>
<span class="mi">17</span><span class="n">jNc85f</span><span class="o">+</span><span class="n">IL0PCswOAg5fEuRUHmj3uL3ayxxCbncUiXOyVnoTMHEvoz</span><span class="o">+</span><span class="n">sTtaUQOv</span>
<span class="n">EgaYavSORv4rQcOc8UUhotujQ04ru13M00UzxkcgUTcQYpZ</span><span class="o">+</span><span class="n">IVoN6K3WOYJ9D2Ht</span>
<span class="mi">9</span><span class="n">BXpvb08mdUCAwEAATANBgkqhkiG9w0BAQsFAAOCAQEAmMloM</span><span class="o">/</span><span class="n">SyJoC4JwZx6o3p</span>
<span class="n">NfRBmtXZNK7GaHUe49d1o68IGzwhEg9lOYC9oD6krRonN80AczSW0igN</span><span class="o">/</span><span class="n">gHxYtti</span>
<span class="mi">1</span><span class="n">Rf</span><span class="o">/</span><span class="n">YhYH</span><span class="o">/</span><span class="n">GW</span><span class="o">+</span><span class="n">n4p5tCOVRYhJxuqGSaycK5</span><span class="o">+</span><span class="n">t1Bs4BibYN2p7</span><span class="o">+</span><span class="n">p1PI2kpEGPCb</span><span class="o">+</span><span class="n">tp</span>
<span class="n">HpM2wX1TUrI01VeB94roVAhkhNRO4xsgsgcaQPvBNFHJylbn2vmFEIwlJLB4G</span><span class="o">+</span><span class="n">sr</span>
<span class="n">VNTlaC7uANjuBoFjopyQNLhxl</span><span class="o">/</span><span class="n">oPahI1k2z8ccGQjRjxKp5T</span><span class="o">/</span><span class="n">S8hKVniGr47m9eu</span>
<span class="n">WSFPDl5gqSkPwHE1RGqh2i8axBaJ97Y0MhAbRmNY2sDv7kxhC</span><span class="o">+</span><span class="n">qCKn4Xm1yEi1Mn</span>
<span class="n">Lw</span><span class="o">==</span>
     <span class="c1">-----END CERTIFICATE-----</span>
</code></pre></div></p>
<h1 id='event-interface'>Event Interface</h1>

<h2 id='registering-for-system-events'>Registering for System Events</h2>

<p>The management of registering for notifications which occur when system events are fired is made possible through several APIs and callback functions. The following is an example of how to be notified when the “Refresh Navigator” call is made. When bindings, device names, or device media has changed, a “Refresh Navigator” call is is fired. This event is an alert for the Navigators that any cached data about the project or media may now be invalid.</p>

<p>Specifically the event for “Refresh Navigator” is the “OnPIP” event.  To get this event,  we make use of the following generic event registration calls:</p>

<p><a href="https://snap-one.github.io/docs-driverworks-api/#registersystemevent">RegisterSystemEvent</a></p>

<p><code>C4:RegisterSystemEvent(eventId, deviceId)</code></p>

<p>Creates a registration for a notification when a system event fires.</p>

<table><thead>
<tr>
<th>Parameter</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>eventID (num)</td>
<td>ID value of the event. See list below.</td>
</tr>
<tr>
<td>deviceID (num)</td>
<td>ID value of the device.</td>
</tr>
</tbody></table>

<h3 id='example'>Example</h3>

<p><code>C4:RegisterSystemEvent(C4SystemEvents[&quot;OnPIP&quot;], 0)</code></p>

<p>The C4SystemEvents variable is the array of all event name to ID’s. Use deviceId 0 to register for device specific events for all devices. Some events are system wide and will be sent regardless of the device id that was registered, others use the device id to filter who gets what events.</p>

<p>Additionally, your driver will need to implement the <a href="https://snap-one.github.io/docs-driverworks-api/#onsystemevent">OnSystemEvent </a>method.</p>

<p><strong>Useful System Event ID Values</strong></p>

<table><thead>
<tr>
<th>Value</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>00 through 05</td>
<td>Internal System Events</td>
</tr>
<tr>
<td>06</td>
<td>DE_PIP, OnPIP</td>
</tr>
<tr>
<td>07 through 16</td>
<td>Internal System Events</td>
</tr>
<tr>
<td>17</td>
<td>DE_NETWORK_BINDING_ADDED, OnNetworkBindingAdded</td>
</tr>
<tr>
<td>18</td>
<td>DE_NETWORK_BINDING_REMOVED, OnNetworkBindingRemoved</td>
</tr>
<tr>
<td>19</td>
<td>DE_NETWORK_BINDING_REGISTERED, OnNetworkBindingRegistered</td>
</tr>
<tr>
<td>20</td>
<td>DE_NETWORK_BINDING_UNREGISTERED, OnNetworkBindingUnregistered</td>
</tr>
<tr>
<td>21 through 47</td>
<td>Internal System Events</td>
</tr>
<tr>
<td>48</td>
<td>DE_DEVICE_ONLINE, OnDeviceOnline</td>
</tr>
<tr>
<td>49</td>
<td>DE_DEVICE_OFFLINE, OnDeviceOffline</td>
</tr>
<tr>
<td>50 and 51</td>
<td>Internal System Events</td>
</tr>
<tr>
<td>52</td>
<td>DE_ZIPCODE_CHANGED, OnZipcodeChanged</td>
</tr>
<tr>
<td>53</td>
<td>DE_LATITUDE_CHANGED, OnLatitudeChanged</td>
</tr>
<tr>
<td>54</td>
<td>DE_LONGITUDE_CHANGED, OnLongitudeChanged</td>
</tr>
<tr>
<td>55 through 57</td>
<td>Internal System Events</td>
</tr>
<tr>
<td>58</td>
<td>DE_LOCALE_CHANGED, OnLocaleChanged</td>
</tr>
<tr>
<td>59</td>
<td>through 86</td>
</tr>
<tr>
<td>90</td>
<td>DE_DIRECTOR_IP_ADDRESS_CHANGED, OnDirectorIPAddressChanged</td>
</tr>
</tbody></table>

<p>Note that the OnProjectChanged event was deprecated in 2.10.X due to the architectural change of using a database for persistence.  There are specific events available for things such as device add, remove, and rename. These are:</p>

<ul>
<li>OnItemAdded</li>
<li>OnItemRemoved</li>
<li>OnItemNameChanged</li>
</ul>

<h2 id='addevent'>AddEvent</h2>

<p>Function called from DriverWorks driver to add a new Event.  This API should not be invoked during OnDriverInit.</p>

<p><h6 id='available-in-2-8-0'>Available in  2.8.0.</h6><h3 id='signature'>Signature</h3>
<p><code>C4:AddEvent(num,str,str)</code></p></p>

<table><thead>
<tr>
<th>Parameter</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>number</td>
<td>ID value of the Event</td>
</tr>
<tr>
<td>str</td>
<td>Event Name</td>
</tr>
<tr>
<td>str</td>
<td>Event Description where NAME is replaced by the driver name. See Event Description example below.</td>
</tr>
</tbody></table>

<h3 id='returns'>Returns</h3>

<p><code>True or False</code></p>

<p>True on successful addition of the Event</p>

<h3 id='example'>Example</h3>

<p>The example below would be displayed in Composer Pro Programming as: &quot;When the Theater-&gt;AV Switch TEST DYNAMIC 3 Event Changes&quot; This example assumes a room of Theater and a driver named AV Switch. </p>

<p><code>C4:AddEvent(3, &quot;TEST_DYNAMIC_3&quot;, &quot;When the NAME TEST_DYNAMIC_3 Event Changes&quot;)</code></p>

<h3 id='usage-note'>Usage Note</h3>

<p>The AddEvent function will update an event if the event ID passed in the function is already in the driver.</p>

<h2 id='deleteevent'>DeleteEvent</h2>

<p>Function called from DriverWorks driver to delete an Event. This API should not be invoked during OnDriverInit.</p>

<p><h6 id='available-in-2-8-0'>Available in  2.8.0.</h6><h3 id='signature'>Signature</h3>
<p><code>C4:DeleteEvent(num)</code></p></p>

<table><thead>
<tr>
<th>Parametr</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>num</td>
<td>ID value of the Event</td>
</tr>
</tbody></table>

<h3 id='returns'>Returns</h3>

<p><code>None</code></p>

<h3 id='usage-note'>Usage Note</h3>

<p>The DeleteEvent API should not be used to remove Events which are defined in the driver&#39;s XML. Events defined in the XML are intended to be static. If an Event in the XMl needs to be deleted, it should be removed manually from the XML and the driver re-compiled and a new version assigned to it.</p>

<p>Events can be deleted regardless of their location within a set of Events. Empty Event IDs that result from this are acceptable.</p>

<h2 id='fireevent'>FireEvent</h2>

<p>Function called from DriverWorks driver to Fire a static or Dynamic Event on the driver. This API should not be invoked during OnDriverInit.</p>

<p><h6 id='available-in-2-8-0'>Available in  2.8.0.</h6><h3 id='signature'>Signature</h3>
<p><code>C4:FireEvent(strEvent)</code></p></p>

<table><thead>
<tr>
<th>Parameter</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>str</td>
<td>ID value of the Event Name</td>
</tr>
</tbody></table>

<h3 id='returns'>Returns</h3>

<p><code>None</code></p>

<h2 id='fireeventbyid'>FireEventByID</h2>

<p>Function called from DriverWorks driver to Fire a static or Dynamic Event (using the Event&#39;s ID Value) on the driver. This API should not be invoked during OnDriverInit.</p>

<p><h6 id='available-in-2-8-0'>Available in  2.8.0.</h6><h3 id='signature'>Signature</h3>
<p><code>C4:FireEventByID(num)</code></p></p>

<table><thead>
<tr>
<th>Parameter</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>num</td>
<td>Event ID value of the Event</td>
</tr>
</tbody></table>

<h3 id='returns'>Returns</h3>

<p><code>None</code></p>

<h2 id='ondeviceevent'>OnDeviceEvent</h2>

<p>This is a callback function that is sent to a driver when a device event is fired. The function delivers the Device ID for the device that fired the event and the Event&#39;s ID value. </p>

<p><h6 id='available-in-2-9-0'>Available in  2.9.0.</h6><h3 id='signature'>Signature</h3>
<p><code>OnDeviceEvent(firingDeviceId, eventId) </code></p></p>

<table><thead>
<tr>
<th>Parameter</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>num</td>
<td>The device ID value of the device firing the event.</td>
</tr>
<tr>
<td>num</td>
<td>The fired event&#39;s ID value.</td>
</tr>
</tbody></table>

<h3 id='returns'>Returns</h3>

<p><code>None</code></p>

<h3 id='example'>Example</h3>

<p><code>OnDeviceEvent(80,2)</code></p>

<h2 id='onsystemevent'>OnSystemEvent</h2>

<p>This is a callback function that is sent to a driver when a system event is fired. The function delivers Event specific data. </p>

<h3 id='signature'>Signature</h3>

<p><code>OnSystemEvent(data)</code></p>

<table><thead>
<tr>
<th>Parameter</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>data</td>
<td>The “data” passed to this callback function is event specific and can be provided on an event by event basis as needed.  In most cases, it can be ignored.</td>
</tr>
</tbody></table>

<h3 id='example'>Example</h3><div class="highlight"><pre class="highlight lua tab-lua"><code><span class="k">function</span> <span class="nf">OnSystemEvent</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
   <span class="nb">print</span><span class="p">(</span><span class="s2">"System Event occurred - data: "</span> <span class="o">..</span> <span class="n">data</span><span class="p">)</span>
<span class="k">end</span>
</code></pre></div>
<h2 id='registerdeviceevent'>RegisterDeviceEvent</h2>
<p>This API allows for a driver to register for another driver&#39;s event. The device ID passed is the ID of the device that is firing the event of interest. This is followed by the event ID.</p>
<h6 id='available-in-2-9-0'>Available in  2.9.0</h6><h3 id='signature'>Signature</h3>

<p><code>C4:RegisterDeviceEvent(deviceID,eventID)</code></p>

<table><thead>
<tr>
<th>Parameter</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>num</td>
<td>Device ID value of the device firing the event</td>
</tr>
<tr>
<td>num</td>
<td>ID value of the Event</td>
</tr>
</tbody></table>

<h3 id='returns'>Returns</h3>

<p><code>None</code></p>

<h3 id='usage-note'>Usage Note</h3>

<p>Knowledge of device event ID values are required to use this API in a driver. For this reason, the use of this API is intended for event registration between two drivers which have been created in support of one another. For example, this API would be useful in a network driver that wishes to know events fired by one of its module drivers.</p>

<h2 id='registersystemevent'>RegisterSystemEvent</h2>

<p>Creates a registration for a notification when a system event fires.</p>

<h3 id='signature'>Signature</h3>

<p><code>C4:RegisterSystemEvent()</code></p>

<table><thead>
<tr>
<th>Parameter</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>eventID (num)</td>
<td>ID value of the event. See table below.</td>
</tr>
<tr>
<td>deviceID (num)</td>
<td>ID value of the device.</td>
</tr>
</tbody></table>

<h3 id='example'>Example</h3>

<p><code>C4:RegisterSystemEvent(C4SystemEvents[&quot;OnPIP&quot;], 0)</code></p>

<h3 id='usage-note'>Usage Note</h3>

<p><strong>Useful System Event ID Values</strong></p>

<table><thead>
<tr>
<th>Value</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>00 through 05</td>
<td>Internal System Events</td>
</tr>
<tr>
<td>06</td>
<td>DE_PIP, OnPIP</td>
</tr>
<tr>
<td>07 through 16</td>
<td>Internal System Events</td>
</tr>
<tr>
<td>17</td>
<td>DE_NETWORK_BINDING_ADDED, OnNetworkBindingAdded</td>
</tr>
<tr>
<td>18</td>
<td>DE_NETWORK_BINDING_REMOVED, OnNetworkBindingRemoved</td>
</tr>
<tr>
<td>19</td>
<td>DE_NETWORK_BINDING_REGISTERED, OnNetworkBindingRegistered</td>
</tr>
<tr>
<td>20</td>
<td>DE_NETWORK_BINDING_UNREGISTERED, OnNetworkBindingUnregistered</td>
</tr>
<tr>
<td>21 through 47</td>
<td>Internal System Events</td>
</tr>
<tr>
<td>48</td>
<td>DE_DEVICE_ONLINE, OnDeviceOnline</td>
</tr>
<tr>
<td>49</td>
<td>DE_DEVICE_OFFLINE, OnDeviceOffline</td>
</tr>
<tr>
<td>50 and 51</td>
<td>Internal System Events</td>
</tr>
<tr>
<td>52</td>
<td>DE_ZIPCODE_CHANGED, OnZipcodeChanged</td>
</tr>
<tr>
<td>53</td>
<td>DE_LATITUDE_CHANGED, OnLatitudeChanged</td>
</tr>
<tr>
<td>54</td>
<td>DE_LONGITUDE_CHANGED, OnLongitudeChanged</td>
</tr>
<tr>
<td>55 through 57</td>
<td>Internal System Events</td>
</tr>
<tr>
<td>58</td>
<td>DE_LOCALE_CHANGED, OnLocaleChanged</td>
</tr>
<tr>
<td>59 through 86</td>
<td>Internal System Event</td>
</tr>
<tr>
<td>90</td>
<td>DE_DIRECTOR_IP_ADDRESS_CHANGED, OnDirectorIPAddressChanged</td>
</tr>
</tbody></table>

<h2 id='unregisteralldeviceevents'>UnregisterAllDeviceEvents</h2>

<p>This API unregisters all prior event registrations created by the <a href="https://snap-one.github.io/docs-driverworks-api/#registerdeviceevent">RegisterDeviceEvent</a> API.</p>

<p><h6 id='available-in-2-9-0'>Available in  2.9.0</h6><h3 id='signature'>Signature</h3>
<p><code>C4:UnregisterAllDeviceEvents()</code></p>
<h3 id='parameter'>Parameter</h3>
<p><code>None</code></p>
<h3 id='returns'>Returns</h3>
<p><code>None</code></p></p>

<h2 id='unregisterallsystemevents'>UnregisterAllSystemEvents</h2>

<p>Un-registers from all notification of all system events.</p>

<h3 id='signature'>Signature</h3>

<p><code>C4:UnregisterAllSystemEvents()</code></p>

<h3 id='parameters'>Parameters</h3>

<p><code>None</code></p>

<h3 id='example'>Example</h3>

<p><code>C4:UnRegisterSystemEvent()</code></p>

<h2 id='unregistersystemevent'>UnregisterSystemEvent</h2>

<p>Un-registers a notification when a system event fires.</p>

<h3 id='signature'>Signature</h3>

<p><code>C4:UnregisterSystemEvent(eventId, deviceId)</code></p>

<table><thead>
<tr>
<th>Parameter</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>eventID (num) - ID value of the event. See list below.</td>
<td></td>
</tr>
<tr>
<td>deviceID (num) - ID value of the device.</td>
<td></td>
</tr>
</tbody></table>

<h3 id='example'>Example</h3>

<p><code>C4:UnregisterSystemEvent()</code></p>

<h2 id='unregisterdeviceevent'>UnregisterDeviceEvent</h2>

<p>This API unregisters prior event registration created by the <a href="https://snap-one.github.io/docs-driverworks-api/#registerdeviceevent">RegisterDeviceEvent</a> API. The device ID passed is the ID of the device that is firing the registered event. This is followed by the event ID.</p>

<p><h6 id='available-in-2-9-0'>Available in  2.9.0</h6><h3 id='signature'>Signature</h3>
<p><code>C4:UnregisterDeviceEvent(deviceId, eventId)</code></p></p>

<table><thead>
<tr>
<th>Parameter</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>num</td>
<td>Device ID value of the device firing the registered event.</td>
</tr>
<tr>
<td>num</td>
<td>ID value of the Event</td>
</tr>
</tbody></table>

<h3 id='returns'>Returns</h3>

<p><code>None</code></p>

<h2 id='suppressing-system-events'>Suppressing System Events</h2>

<p>The <code>suppress_connection_events</code> is an optionally used device driver property that dictates whether or not Director will fire the OnDeviceOnline and OnDeviceOffline system events. While these events are not specifically handled within a driver, they can impact system performance. This is especially true when a large amount of media is present or media availability (regardless of a device’s online status) is a requirement. When these events are fired, the Room Driver clears its media cache. The media cache then must be rebuilt when a device comes back online. Unless the exercise of clearing and rebuilding the cache is needed, setting the<code>suppress_connection_events</code> property to “True” is recommended.</p>

<p>There are two ways to implement <code>suppress_connection_event</code>. First, a driver developer can add the <code>suppress_connection_events</code> tag to the port section in the connections area of their driver. For example, to the right is an entry for an HC-250 that defines Director’s connection to Navigator:</p>

<p><port>
     <name>Navigator</name>
     <number>5115</number>
     <auto_connect>True</auto_connect>
     <monitor_connection>False</monitor_connection>
     <keep_connection>True</keep_connection>
     <keep_alive>True</keep_alive>
     <suppress_connection_events>True</suppress_connection_events>
     <delimiter>0d0a</delimiter>
    </port></p>

<p>The second way to use the <code>suppress_connection_events</code> option is in Lua drivers. The NetConnect() function has an optional parameter that specifies whether Director should suppress OnDeviceOnline and OnDeviceOffline events for the connection. By default, Director does suppress events for all connections created this way. The events can be enabled by passing “false” for this parameter.</p>

<p>See the following APIs in the Serial Network Device Interface:</p>

<p><a href="https://snap-one.github.io/docs-driverworks-api/#netconnect">NetConnect</a></p>

<p><a href="https://snap-one.github.io/docs-driverworks-api/#onconnectionstatuschanged">OnConnectionStatusChanged</a></p>
<h1 id='file-interface'>File Interface</h1>

<h2 id='fileclose'>FileClose</h2>

<p>Used to close an opened file handle. This API can be invoked during OnDriverInit.</p>

<p><h6 id='available-from-1-6-0'>Available from 1.6.0.</h6><h3 id='signature'>Signature</h3>
<p><code>C4:FileClose</code></p></p>

<table><thead>
<tr>
<th>Parameter</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>string</td>
<td>File handle</td>
</tr>
</tbody></table>

<h2 id='filecreatedir'>FileCreateDir</h2>

<p>Function to create a new directory. As part of Control4’s plan to tighten driver security, the io.popen() call has bee removed. In doing this, driver developers need to use C4:File commands to accomplish what they previously did with io.popen (). This API provides the ability to create anew directory as previously done with io.popen. </p>

<p><em>This API was introduced in O.S. Release 3.3.0</em></p>

<h3 id='signature'>Signature</h3>

<p><code>C4:FileCreateDir()</code></p>

<table><thead>
<tr>
<th>Parameters</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>string</td>
<td>PATH_ALIAS: Path alias to an allowed location where a directory may be created.</td>
</tr>
<tr>
<td>string</td>
<td>DirCreate: A path relative to PATH_ALIAS and the directory name for the directory to create.</td>
</tr>
</tbody></table>

<table><thead>
<tr>
<th>Path Alias</th>
<th>Path</th>
</tr>
</thead><tbody>
<tr>
<td>SANDBOX</td>
<td>/lua/sandbox/15  (location for driver with device id 15)</td>
</tr>
<tr>
<td>LOGGING</td>
<td>/var/log/debug</td>
</tr>
<tr>
<td>MEDIA</td>
<td>/media</td>
</tr>
<tr>
<td>C4Z</td>
<td>/opt/control4/var/drivers/c4z/&lt;driver_name&gt;</td>
</tr>
</tbody></table>

<p>Note that path aliases are required and cannot be replaced with the actual path. </p>

<h3 id='example'>Example</h3>

<p>Assuming that the device id of the driver is 15, the following command will create directory &quot;data&quot; in /lua/sandbox/15/.</p>

<p><code>C4:FileCreateDir(&quot;SANDBOX&quot;, &quot;data&quot;)</code></p>

<p>Assuming the device id of the driver is 15, the following command will create directory &quot;backup&quot; in /lua/sandbox/15/data/.</p>

<p><code>C4:FileCreateDir(&quot;SANDBOX&quot;, &quot;data/backup&quot;)</code></p>

<h2 id='filedelete'>FileDelete</h2>

<p>This function has been modified in conjuction with O.S. release 3.3.0.  As part of Control4’s plan to tighten driver security, the io.popen() call ihas been removed. In doing this, driver developers need to use C4:File commands to accomplish what they previously did with io.popen (). Two new parameters have been added to specify an allowed Alias and a sub path and file name to a file to delete. </p>

<h3 id='signature'>Signature</h3>

<p><code>C4:FileDelete()</code></p>

<table><thead>
<tr>
<th>Parameters</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>string</td>
<td>filename</td>
</tr>
<tr>
<td>string</td>
<td>PATH_ALIAS: Path representation/alias to an allowed location as to where a file may deleted.</td>
</tr>
<tr>
<td>string</td>
<td>SubPath: A path relative to PATH_ALIAS and the file name for the file to delete.</td>
</tr>
</tbody></table>

<table><thead>
<tr>
<th>Path Alias</th>
<th>Path</th>
</tr>
</thead><tbody>
<tr>
<td>SANDBOX</td>
<td>/lua/sandbox/15  (location for driver with device id 15)</td>
</tr>
<tr>
<td>LOGGING</td>
<td>/var/log/debug</td>
</tr>
<tr>
<td>MEDIA</td>
<td>/media</td>
</tr>
<tr>
<td>C4Z</td>
<td>/opt/control4/var/drivers/c4z/&lt;driver_name&gt;</td>
</tr>
</tbody></table>

<p>Note that path aliases are required and cannot be replaced with the actual path. </p>

<h3 id='example'>Example</h3>

<p>Assuming that the device id of the driver is 15, the following command will delete /lua/sandbox/15/data/datafile.dat. </p>

<p><code>C4:FileDelete(SANDBOX, &quot;data/datafile.dat&quot;)</code></p>

<h3 id='example-2'>Example</h3>

<p><code>C4:FileDelete(&quot;1.txt&quot;)</code></p>

<h2 id='fileexists'>FileExists</h2>

<p>Used to see if a file exists on the file system.  This function takes a file name and returns a bool if the file exists. This API can be invoked during OnDriverInit.</p>

<p><h6 id='available-from-1-6-0'>Available from 1.6.0.</h6><h3 id='signature'>Signature</h3>
<p><code>C4:FileExists()</code></p></p>

<table><thead>
<tr>
<th>Parameter</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>string</td>
<td>File name</td>
</tr>
</tbody></table>

<h3 id='returns'>Returns</h3>

<table><thead>
<tr>
<th>Value</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>bool</td>
<td>True/False</td>
</tr>
</tbody></table>

<h3 id='example'>Example</h3><div class="highlight"><pre class="highlight lua tab-lua"><code><span class="err">   </span> <span class="n">bexist</span> <span class="o">=</span> <span class="n">C4</span><span class="p">:</span><span class="n">FileExists</span><span class="p">(</span><span class="s2">"1.txt"</span><span class="p">)</span>
<span class="err">   </span> <span class="k">if</span> <span class="p">(</span><span class="n">bexist</span><span class="p">)</span> <span class="k">then</span>
    <span class="c1">-- the file is already present on the file system</span>
<span class="err">   </span> <span class="k">end</span>
</code></pre></div>
<h2 id='filefreespace'>FileFreeSpace</h2>
<p>Used to see how much free space exists on the file system in bytes. This API can be invoked during OnDriverInit.</p>
<h6 id='available-from-1-6-0'>Available from 1.6.0.</h6><h3 id='signature'>Signature</h3>

<p><code>C4:FileFreeSpace</code></p>

<h3 id='example'>Example</h3>

<p><code>freeSpace = C4:FileFreeSpace()</code></p>

<h2 id='fileisvalid'>FileIsValid</h2>

<p>Used to see if a file is still valid to be written or read from. This is useful to check before or after reading to see if an end of file condition has been reached. This function returns a bool of the file status. This API can be invoked during OnDriverInit.</p>

<p><h6 id='available-from-1-6-0'>Available from 1.6.0.</h6><h3 id='signature'>Signature</h3>
<p><code>C4:FileIsValid</code></p>
<h3 id='example'>Example</h3>
<p><code>isOkay = C4:FileIsValid(fh)</code>   </p></p>

<h2 id='filegetname'>FileGetName</h2>

<p>Used to get the name of an opened file handle.  This function takes a file handle and returns a string of the file name. An empty string is returned if the file handle is not valid. This API can be invoked during OnDriverInit.</p>

<p><h6 id='available-from-1-6-0'>Available from 1.6.0.</h6><h3 id='signature'>Signature</h3>
<p><code>C4:FileGetName</code></p>
<h3 id='example'>Example</h3>
<p>name = C4:FileGetName(fh)
    print(“Name is “ .. name)</p></p>

<h2 id='filegetpos'>FileGetPos</h2>

<p>Used to get the current read or write position for the file.  This function takes a file handle and returns the current position. This API can be invoked during OnDriverInit.</p>

<p><h6 id='available-from-1-6-0'>Available from 1.6.0.</h6><h3 id='signature'>Signature</h3>
<p><code>C4:FileGetPos</code></p>
<h3 id='example'>Example</h3>
<p><code>pos = C4:FileGetPos(fh)</code></p></p>

<h2 id='filegetsize'>FileGetSize</h2>

<p>File to get the current size of an opened file handle. This API can be invoked during OnDriverInit.</p>

<p><h6 id='available-from-1-6-0'>Available from 1.6.0.</h6><h3 id='signature'>Signature</h3>
<p><code>C4:FileGetSize</code></p></p>

<table><thead>
<tr>
<th>Parameter</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>int</td>
<td>File handle</td>
</tr>
</tbody></table>

<h3 id='return'>Return</h3>

<table><thead>
<tr>
<th>Value</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>int</td>
<td>Size of the file in byte size.</td>
</tr>
</tbody></table>

<h3 id='usage-note'>Usage Note</h3>

<p>Use the <code>c4:FileOpen()</code> call to obtain a valid file handle</p>

<h3 id='example'>Example</h3><div class="highlight"><pre class="highlight lua tab-lua"><code><span class="n">fh</span> <span class="o">=</span> <span class="n">C4</span><span class="p">:</span><span class="n">FileOpen</span><span class="p">(</span><span class="s2">"test.txt"</span><span class="p">)</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">fh</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="k">then</span>
<span class="err"> </span>  <span class="c1">-- the file failed to open</span>
<span class="err"> </span> <span class="k">return</span>
<span class="k">end</span>

<span class="n">fileSize</span> <span class="o">=</span> <span class="n">C4</span><span class="p">:</span><span class="n">FileGetSize</span><span class="p">(</span><span class="n">fh</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">"File size is "</span> <span class="o">..</span> <span class="n">fileSize</span><span class="p">)</span>

<span class="n">C4</span><span class="p">:</span><span class="n">FileClose</span><span class="p">(</span><span class="n">fh</span><span class="p">)</span>
</code></pre></div>
<h2 id='fileopen'>FileOpen</h2>
<p>Used to open (if file exists) or create a new file.  This function takes a file name, returns a handle. A value
of -1 is returned if an error.  This API can be invoked during OnDriverInit.</p>
<h6 id='available-from-1-6-0'>Available from 1.6.0.</h6><h3 id='signature'>Signature</h3>

<p><code>C4:FileOpen</code></p>

<table><thead>
<tr>
<th>Parameter</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>str</td>
<td>File name</td>
</tr>
</tbody></table>

<h3 id='returns'>Returns</h3>

<table><thead>
<tr>
<th>Value</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>int</td>
<td>File handle</td>
</tr>
</tbody></table>

<h3 id='example'>Example</h3>

<p><em>See example to the right.</em></p>

<div class="highlight"><pre class="highlight lua tab-lua"><code><span class="n">fh</span> <span class="o">=</span> <span class="n">C4</span><span class="p">:</span><span class="n">FileOpen</span><span class="p">(</span><span class="err">“</span><span class="n">somefile</span><span class="p">.</span><span class="n">ext</span><span class="err">”</span><span class="p">)</span>
<span class="k">if</span> <span class="p">(</span><span class="n">fh</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="k">then</span>
    <span class="c1">-- the file failed to open</span>
<span class="k">end</span>
</code></pre></div><h3 id='usage-note'>Usage Note</h3>
<p>The <code>C4:FileOpen()</code> function always opens a file so that the position is at end-of-file. For example:</p>

<p><code>local f = io.open(fullfilePath, &quot;rba&quot;)</code></p>

<p>Opening the file as illustrated above opens the file for read, binary, and append (rba). This means that anything written to the file occurs at the end of the file. This ensures that writes don&#39;t overwrite existing data.</p>

<p>However, this also means that attempts to read the file will not return any data because the current read position is at end-of-file.</p>

<p>The example given above can be corrected by using the <a href="https://snap-one.github.io/docs-driverworks-api/#filesetpos">C4:FileSetPos()</a> function to reset the position to the beginning of the file before reading. See the example to the right.</p>
<div class="highlight"><pre class="highlight lua tab-lua"><code><span class="n">C4</span><span class="p">:</span><span class="n">FileSetDir</span><span class="p">(</span><span class="n">parentdir</span><span class="p">)</span>
<span class="kd">local</span> <span class="n">fh</span> <span class="o">=</span> <span class="n">C4</span><span class="p">:</span><span class="n">FileOpen</span><span class="p">(</span><span class="n">fileName</span> <span class="n">without</span> <span class="n">path</span><span class="p">)</span>
<span class="k">if</span> <span class="p">(</span><span class="n">fh</span> <span class="o">~=</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="k">then</span>
    <span class="n">C4</span><span class="p">:</span><span class="n">FileSetPos</span><span class="p">(</span><span class="n">fh</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
    <span class="kd">local</span> <span class="n">fileSize</span> <span class="o">=</span> <span class="n">C4</span><span class="p">:</span><span class="n">FileGetSize</span><span class="p">(</span><span class="n">fh</span><span class="p">)</span>
    <span class="kd">local</span> <span class="n">fileContents</span> <span class="o">=</span> <span class="n">C4</span><span class="p">:</span><span class="n">FileRead</span><span class="p">(</span><span class="n">fh</span><span class="p">,</span><span class="n">fileSize</span><span class="p">)</span>
    <span class="n">C4</span><span class="p">:</span><span class="n">FileClose</span><span class="p">(</span><span class="n">fh</span><span class="p">)</span>
<span class="k">end</span>
</code></pre></div>

<h2 id='filegetopenedhandles'>FileGetOpenedHandles</h2>

<p>Used to retrieve a table of all the opened file handles in your sandbox or nil if none are opened. The table is index = file handle and value=file name. This API can be invoked during OnDriverInit.</p>

<p><h6 id='available-from-1-6-0'>Available from 1.6.0.</h6><h3 id='signature'>Signature</h3>
<p><code>C4:FileGetOpenedHandles()</code></p>
<h3 id='parameters'>Parameters</h3>
<p><code>None</code></p>
<h3 id='returns'>Returns</h3>
<table><thead>
<tr>
<th>Value</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>table</td>
<td>Index= File handle</td>
</tr>
<tr>
<td></td>
<td>Value = File Name</td>
</tr>
</tbody></table>
<h3 id='example'>Example</h3>
<p>Closing all opened handles:</p>
<div class="highlight"><pre class="highlight lua tab-lua"><code><span class="err"> </span> <span class="n">fileHandles</span> <span class="o">=</span> <span class="n">C4</span><span class="p">:</span><span class="n">FileGetOpenedHandles</span><span class="p">()</span>
<span class="err">  </span><span class="k">if</span> <span class="p">(</span><span class="n">fileHandles</span><span class="p">)</span> <span class="k">then</span>
<span class="err">    </span> <span class="k">for</span> <span class="n">index</span><span class="p">,</span><span class="n">value</span> <span class="k">in</span> <span class="nb">pairs</span><span class="p">(</span><span class="n">fileHandles</span><span class="p">)</span> <span class="k">do</span>
<span class="err">      </span> <span class="n">C4</span><span class="p">:</span><span class="n">FileClose</span><span class="p">(</span><span class="n">index</span><span class="p">)</span>
<span class="err">    </span> <span class="k">end</span>
<span class="err"> </span> <span class="k">end</span>
</code></pre></div>
<h2 id='filelist'>FileList</h2>
<p>Used to retrieve a table of all the files that are present or nil if none exist. This API can be invoked during
OnDriverInit.</p>
<h6 id='available-from-1-6-0'>Available from 1.6.0.</h6><h3 id='signature'>Signature</h3>
<p><code>C4:FileList</code></p>
<h3 id='example'>Example</h3>
<p>Deleting all files:</p>
<div class="highlight"><pre class="highlight lua tab-lua"><code><span class="err"> </span> <span class="n">fileNames</span> <span class="o">=</span> <span class="n">C4</span><span class="p">:</span><span class="n">FileList</span><span class="p">()</span>
<span class="err"> </span> <span class="k">if</span> <span class="p">(</span><span class="n">fileNames</span><span class="p">)</span> <span class="k">then</span>
<span class="err">    </span> <span class="k">for</span> <span class="n">index</span><span class="p">,</span><span class="n">value</span> <span class="k">in</span> <span class="nb">pairs</span><span class="p">(</span><span class="n">fileNames</span><span class="p">)</span> <span class="k">do</span>
<span class="err">      </span> <span class="n">C4</span><span class="p">:</span><span class="n">FileDelete</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
<span class="err">    </span> <span class="k">end</span>
<span class="err"> </span> <span class="k">end</span>
</code></pre></div>
<h2 id='filemove'>FileMove</h2>
<p>Function for or moving files within certain restrictions.  As part of Control4’s plan to tighten driver security, the io.popen() call has been removed. In doing this, driver developers need to use C4:File commands to accomplish what they previously did with io.popen () This API provides the ability to move files as previously done with io.popen. </p></p>

<p><em>This API was introduced in O.S. Release 3.3.0</em></p>

<h3 id='signature'>Signature</h3>

<p><code>C4:FileMove()</code></p>

<table><thead>
<tr>
<th>Parameters</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>string</td>
<td>PATH_ALIAS_FROM: is a path representation/alias to an allowed location as to where a file may be moved from.</td>
</tr>
<tr>
<td>string</td>
<td>PATH_ALIAS_TO: A path representation/alias to an allowed location as to where it will be moved to. The following table is a list of allowed aliases.</td>
</tr>
<tr>
<td>string</td>
<td>From: A path relative to PATH_ALIAS_FROM  and the file name to be moved.</td>
</tr>
<tr>
<td>string</td>
<td>To: A path relative to PATH_ALIAS_TO and the file name for the destination of the file. If the file name is the same then the file name does not need to be included.</td>
</tr>
</tbody></table>

<table><thead>
<tr>
<th>Path Alias</th>
<th>Path</th>
</tr>
</thead><tbody>
<tr>
<td>SANDBOX</td>
<td>/lua/sandbox/15  (location for driver with device id 15)</td>
</tr>
<tr>
<td>LOGGING</td>
<td>/var/log/debug</td>
</tr>
<tr>
<td>MEDIA</td>
<td>/media</td>
</tr>
<tr>
<td>C4Z</td>
<td>/opt/control4/var/drivers/c4z/&lt;driver_name&gt;</td>
</tr>
</tbody></table>

<p>Note that path aliases are required and cannot be replaced with the actual path. </p>

<h3 id='example'>Example</h3>

<p>Assuming that the device id of the driver is 15, the following command will move /lua/sandbox/15/tmp/tmpFile.dat to /lua/sandbox/15/data/dataFile.dat</p>

<p>C4:FileMove(&quot;SANDBOX&quot;, &quot;/tmp/tmpFile.dat&quot;, &quot;SANDBOX&quot;, &quot;/data/dataFile.dat&quot;)</p>

<h2 id='fileread'>FileRead</h2>

<p>Used to read data from a file.  Returns an empty string if no bytes are read. This function takes a file handle and number of bytes to be read. If an end of file is reached with this read operation, a string of what data was read is returned and any subsequent calls to FileRead will return an empty string. Use the <a href="https://snap-one.github.io/docs-driverworks-api/#fileisvalid">FileIsValid</a> call to see if and end of file condition has been reached. This API can be invoked during OnDriverInit.</p>

<p><h6 id='available-from-1-6-0'>Available from 1.6.0.</h6><h3 id='signature'>Signature</h3>
<p><code>C4:FileRead</code></p></p>

<table><thead>
<tr>
<th>Parameter</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>int</td>
<td>File handle</td>
</tr>
<tr>
<td>num</td>
<td>Number of bytes to be read.</td>
</tr>
</tbody></table>

<h3 id='returns'>Returns</h3>

<table><thead>
<tr>
<th>Value</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>string</td>
<td>Read data or empty string</td>
</tr>
</tbody></table>

<h3 id='example'>Example</h3>

<p><code>fileData = C4:FileRead(fh, 10)</code></p>

<h2 id='filesetdir'>FileSetDir</h2>

<p>In conjunction with O.S. release 3.3.0, this function is being restricted to allowed locations whereas previously it had full root access. As part of Control4’s plan to tighten driver security, the io.popen() call has been removed. In doing this, driver developers need to use C4:File commands to accomplish what they previously did with io.popen (). Prior to O.S. release 3.3.0, C4:FileSetDir had root access which would allow driver developers to modify anything on the file system. </p>

<h3 id='signature'>Signature</h3>

<p><code>C4:FileSetDir()</code></p>

<h3 id='examples'>Examples</h3>

<p>C4:FileSetDir(full_path) - Provided for backwards compatibility using allowed paths only.</p>

<p>C4:FileSetDir(PATH_ALIAS) - Specifying alias only.</p>

<p>C4:FileSetDir(PATH_ALIAS, sub_dir) - Specifying alias with a subdirectory of PATH_ALIAS</p>

<p>PATH_ALIAS: The path aliases are defined in the table below. When specifying a PATH_ALIAS, the alias will be replaced by the &quot;Path&quot; as described in the table.</p>

<table><thead>
<tr>
<th>Path Alias</th>
<th>Path</th>
</tr>
</thead><tbody>
<tr>
<td>SANDBOX</td>
<td>/lua/sandbox/15  (location for driver with device id 15)</td>
</tr>
<tr>
<td>LOGGING</td>
<td>/var/log/debug</td>
</tr>
<tr>
<td>MEDIA</td>
<td>/media</td>
</tr>
<tr>
<td>C4Z</td>
<td>/opt/control4/var/drivers/c4z/&lt;driver_name&gt;</td>
</tr>
</tbody></table>

<h2 id='filesetpos'>FileSetPos</h2>

<p>Used to set the position within the file to read or write from. This function takes a file handle and number for the new position. This API can be invoked during OnDriverInit.</p>

<p><h6 id='available-from-1-6-0'>Available from 1.6.0.</h6><h3 id='signature'>Signature</h3>
<p><code>C4:FileSetPos</code></p></p>

<table><thead>
<tr>
<th>Parameter</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>int</td>
<td>File handle</td>
</tr>
<tr>
<td>num</td>
<td>Number of position.</td>
</tr>
</tbody></table>

<h3 id='example'>Example</h3>

<p><code>C4:FileSetPos(fh, 50)</code></p>

<h2 id='filewrite'>FileWrite</h2>

<p>Used to write data to a file.  This function returns the number of bytes written or -1 if file is not valid (example file has been closed). This function takes a file handle, the number of bytes of the string to be written, and a string of data to be written. This API can be invoked during OnDriverInit.</p>

<p><h6 id='available-from-1-6-0'>Available from 1.6.0.</h6><h3 id='signature'>Signature</h3>
<p><code>C4:FileWrite</code></p></p>

<table><thead>
<tr>
<th>Parameter</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>int</td>
<td>File handle</td>
</tr>
<tr>
<td>num</td>
<td>Number of bytes to be written.</td>
</tr>
<tr>
<td>str</td>
<td>Data to be written</td>
</tr>
</tbody></table>

<h3 id='returns'>Returns</h3>

<table><thead>
<tr>
<th>Value</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>num</td>
<td>Number of bytes written or -1 if file is not valid.</td>
</tr>
</tbody></table>

<h3 id='example'>Example</h3><div class="highlight"><pre class="highlight lua tab-lua"><code><span class="n">foo</span> <span class="o">=</span> <span class="s2">"</span><span class="se">\000\001\002\003\004\005\006\007\008\009</span><span class="s2">"</span>
<span class="n">bytesWritten</span> <span class="o">=</span> <span class="n">C4</span><span class="p">:</span><span class="n">FileWrite</span><span class="p">(</span><span class="n">fh</span><span class="p">,</span> <span class="nb">string.len</span><span class="p">(</span><span class="n">foo</span><span class="p">),</span> <span class="n">foo</span><span class="p">)</span>
</code></pre></div>
<h2 id='filewritestring'>FileWriteString</h2>
<p>Function to write a string to an opened file handle.</p>
<h6 id='available-from-1-6-0'>Available from 1.6.0.</h6><h3 id='signature'>Signature</h3>

<p><code>C4:FileWriteString</code></p>

<table><thead>
<tr>
<th>Parameter</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>int</td>
<td>File handle</td>
</tr>
<tr>
<td>str</td>
<td>String to be written</td>
</tr>
</tbody></table>

<h3 id='returns'>Returns</h3>

<table><thead>
<tr>
<th>Value</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>int</td>
<td>Number of bytes written or -1 if there is an error.</td>
</tr>
</tbody></table>

<h3 id='usage-note'>Usage Note</h3>

<p>Use the <code>C4:FileOpen()</code> call to obtain a valid file handle.</p>

<h3 id='example'>Example</h3><div class="highlight"><pre class="highlight lua tab-lua"><code><span class="n">fh</span> <span class="o">=</span> <span class="n">C4</span><span class="p">:</span><span class="n">FileOpen</span><span class="p">(</span><span class="s2">"test.txt"</span><span class="p">)</span>
<span class="k">if</span> <span class="p">(</span><span class="n">fh</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="k">then</span>
<span class="err"> </span>  <span class="c1">-- the file failed to open</span>
 <span class="k">return</span>
 <span class="k">end</span>

<span class="n">numWritten</span> <span class="o">=</span> <span class="n">C4</span><span class="p">:</span><span class="n">FileWriteString</span><span class="p">(</span><span class="n">fh</span><span class="p">,</span> <span class="s2">"test1234"</span><span class="p">)</span>
 <span class="nb">print</span><span class="p">(</span><span class="s2">"Bytes written "</span> <span class="o">..</span> <span class="n">numWritten</span><span class="p">)</span>

<span class="n">C4</span><span class="p">:</span><span class="n">FileClose</span><span class="p">(</span><span class="n">fh</span><span class="p">)</span>
<span class="n">Output</span><span class="p">:</span> <span class="n">Bytes</span> <span class="n">written</span>
</code></pre></div>
<h2 id='unzip'>UnZip</h2>
<p>Function for extracting files from a .zip archive. This API enables Lua drivers to extract one, or more, files from a .zip archive. </p>

<p><em>This API was introduced in O.S. Release 3.3.0.</em></p>
<h3 id='signature'>Signature</h3>

<p><code>C4:UnZip()</code></p>

<table><thead>
<tr>
<th>Parameters</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>string</td>
<td>zipfile: A string containing the file path to the ZIP archive to be extracted.</td>
</tr>
<tr>
<td>string</td>
<td>filespec: A string containing a file specification that identifies the file, or files, to be extracted. For example, the file specification &quot;<em>&quot; matches all files in the archive. The file specification &quot;</em>.lua&quot; indicates that only Lua files are extracted.</td>
</tr>
<tr>
<td>string</td>
<td>destination: A string containing the path (directory) into which the archive is extracted. Directories within the archive are created relative to the specified destination.</td>
</tr>
</tbody></table>

<table><thead>
<tr>
<th>Returns</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>boolean</td>
<td>status: Boolean indicating whether all files were successfully extracted. true: All files were successfully extracted and no errors occurred. false: One, or more, errors occurred during extraction.</td>
</tr>
<tr>
<td>array</td>
<td>fileset: An array containing a list of files that were successfully extracted. The path for each file is relative to the archive.</td>
</tr>
<tr>
<td>table</td>
<td>errors: A two-dimensional table containing a list of files that failed to be extracted. Each file is associated with a string describing the error that occurred.</td>
</tr>
</tbody></table>

<h3 id='examples'>Examples</h3>

<p>The examples to the right illustrate the usage of the C4:Unzip function. Note that each sample utilizes a generic Lua function called printTable that dumps the contents of a specified table. This is done to illustrate how to interpret the return values of the function. There are numerous examples of printTable online.</p>

<div class="highlight"><pre class="highlight xml tab-xml"><code>Example 1

result, fileset, errors = C4:Unzip("/opt/control4/var/drivers/c4z/TuneIn.c4z", "*", "/opt/control4/var/drivers/c4z/TuneIn")
print(result)
printTable(fileset)
printTable(errors)

Executing this sample produces the following output.

true
table: 0xa42c380 {
[1] =&gt; "driver.xml"
[2] =&gt; "driver.lua"
.
.
.
[287] =&gt; "www/icons/device/experience_80.png"
[288] =&gt; "www/icons/device/experience_90.png"
}
table: 0xa186b60 {
}

The output can be interpreted as follows:
The result is true, indicating that all files were extracted successfully.
The fileset array contains 288 files (truncated for display purposes) that were extracted successfully. Note that the path to each file is relative to the archive.
The errors table is empty because no errors occurred.
</code></pre></div>

<p>Example 2
```xml
result, fileset, errors = C4:Unzip(&quot;/opt/control4/var/drivers/c4z/TuneIn.c4z&quot;, &quot;*.lua&quot;, &quot;/opt/control4/var/drivers/c4z/TuneIn&quot;)
print(result)
printTable(fileset)
printTable(errors)</p>

<p>Executing this sample produces the following output.</p>

<p>true
table: 0xb68c5e0 {
[1] =&gt; &quot;driver.lua&quot;
}
table: 0xb5cc640 {
}</p>

<p>The output can be interpreted as follows.
The result is true, indicating that all files were extracted successfully.
The fileset array contains a single entry because only one file matched the file specification: &quot;*.lua&quot;.
The errors table is empty because no errors occurred.
```</p>

<div class="highlight"><pre class="highlight xml tab-xml"><code>Example 3

result, fileset, errors = C4:Unzip("/opt/control4/var/drivers/c4z/TuneIn.c4z", "*.gif", "/opt/control4/var/drivers/c4z/TuneIn")
print(result)
printTable(fileset)
printTable(errors)

Executing this sample produces the following output.
</code></pre></div><div class="highlight"><pre class="highlight xml tab-xml"><code>false
table: 0xb5cc600 {
}
table: 0xb68ab00 {
[www/composer/ico_16_tunein.gif] =&gt; "Could not open file "/opt/control4/var/drivers/c4z/TuneIn/www/composer/ico_16_tunein.gif": Not a directory"
[www/composer/ico_32_tunein.gif] =&gt; "Could not open file "/opt/control4/var/drivers/c4z/TuneIn/www/composer/ico_32_tunein.gif": Not a directory"
}
</code></pre></div><div class="highlight"><pre class="highlight xml tab-xml"><code>The output can be interpreted as follows.
The result is false, indicating that one, ore more, errors occurred during extraction.
The fileset array is empty because no files were extracted.
The errors table contains two entries, one for each file matching the file specification: "*.gif". Each file is associated with a string describing the error that occurred.
</code></pre></div><div class="highlight"><pre class="highlight xml tab-xml"><code>Example 4
</code></pre></div><div class="highlight"><pre class="highlight xml tab-xml"><code>result, fileset, errors = C4:Unzip("/opt/control4/var/drivers/c4z/Bogus.c4z", "*", "/opt/control4/var/drivers/c4z/Bogus")
print(result)
printTable(fileset)
printTable(errors)

Executing this sample produces the following output.

false
table: 0xb1285e0 {
}
table: 0xb652200 {
[/opt/control4/var/drivers/c4z/Bogus.c4z] =&gt; "The specified zip file does not exist"
}

The output can be interpreted as follows:
• The result is false, indicating that one, ore more, errors occurred during extraction.
• The fileset array is empty because no files were extracted.
• The errors table contains a single entry containing the zip file itself. The associated error message indicates that the specified file does not exist.
</code></pre></div>
<h1 id='helper-interface'>Helper Interface</h1>

<h2 id='adddevice'>AddDevice</h2>

<p>The AddDevice API provides the ability for a driver to add a device driver to a project. The ability to specify the location of the driver within the project as well as naming the device is also supported by the API. Execution of the AddDevice/AddLocation APIs should only be initiated through user interaction from the Dealer or end user. Inadvertent use of these APIs can result in drivers or locations recursively adding themselves to a project. </p>

<h6 id='available-from-3-2-0'>Available from 3.2.0.</h6><h3 id='signature'>Signature</h3>
<p><code>C4:AddDevice ()</code></p>

<table><thead>
<tr>
<th>Parameters</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>str</td>
<td>Driver Name - Required. String of the driver name including the driver extension of .c4i or.c4z.</td>
</tr>
<tr>
<td>num</td>
<td>Room ID - Optional. ID value of the room where the driver will reside.</td>
</tr>
<tr>
<td>str</td>
<td>New Driver Name - Optional. String of the new name of the driver.</td>
</tr>
<tr>
<td>func</td>
<td>Callback Function - Required. A callback function must be passed as the last parameter. The callback function can be any valid function name. In the example below, a function named OnDeviceAdded has been created. In order to receive data from the AddDevice API, this function  must reside in the driver. The callback function takes two parameters: deviceId and, in the case of a Proxy Device, a table to contain all of the IDs of the Proxy devices and the Protocol Driver&#39;s ID. See the example to the right.</td>
</tr>
</tbody></table>
<div class="highlight"><pre class="highlight lua tab-lua"><code><span class="n">Callback</span> <span class="n">Function</span> <span class="n">Example</span>

<span class="k">function</span> <span class="nf">OnDeviceAdded</span><span class="p">(</span><span class="n">deviceId</span><span class="p">,</span> <span class="n">tDeviceInfo</span><span class="p">)</span>
       <span class="n">LogTrace</span> <span class="p">(</span><span class="s2">"Device Added"</span><span class="p">)</span>
       <span class="n">LogTrace</span><span class="p">(</span><span class="n">deviceId</span><span class="p">)</span>
       <span class="n">LogTrace</span><span class="p">(</span><span class="n">tDeviceInfo</span> <span class="p">)</span>
<span class="k">end</span>
</code></pre></div><h3 id='returns'>Returns</h3>
<p>The API itself returns nothing. However, the callback function returns the Device ID value of the driver that was added. It will return a value of 0 upon failure.</p>
<h3 id='examples'>Examples</h3>
<p>The Inter-Device Comms suite (controller and client) in the sample_drivers directory of the SDK has been updated to show a live usage of <code>AddDevice</code></p>

<p>1: <strong>Adding a Device to a Project without providing a Room ID.</strong></p>

<p><code>C4:AddDevice(&quot;driver_properties.c4z&quot;, OnDeviceAdded)</code></p>

<p>In the example above, the AddDevice API will add the driver named <code>driver_properties.c4z</code> to the project in the same room where the driver exists.</p>

<p>2: <strong>Adding a Device to a Room within a Project.</strong></p>

<p><code>C4:AddDevice(&quot;driver_properties.c4z&quot;, 38, OnDeviceAdded)</code></p>

<p>In the example above, the AddDevice API will add the driver named <code>driver_properties</code> to the Room in the project which has an ID value of 38.</p>

<p>3: <strong>Adding a Device to a Room within a Project and re-naming the driver:</strong></p>

<p><code>C4:AddDevice(&quot;driver_properties.c4z&quot;, 38, “My New Driver”, OnDeviceAdded)</code></p>

<p>In the example above, the AddDevice API will add the driver named <code>driver_properties</code> to the Room in the project which has an ID value of 38. It will also rename the driver in the project to &quot;My New Driver&quot;.</p>

<p>For further reference, the idc_client and idc_controller sample drivers delivered with the SDK both include auto-add functionality in their Driver Actions. See the sample_drivers directory on the SDK landing page for more information.</p>

<h2 id='addlocation'>AddLocation</h2>
<p>The AddLocation API provides the ability for a driver to add a location to a project. The locations that can be added are those available in a Control4 project. This includes:</p>

<ul>
<li>Site - A new site can be added to a project at the highest level of the project including Home, Work or Corporate.</li>
<li>Buildings - Buildings can be added to a project including: House, Building or Office.</li>
<li>Floors - Floors can added to a project including: Main, First, Second and Basement.</li>
<li>Rooms - Rooms can added to a project including: Theater, Foyer, Living, Dining, Kitchen, Laundry, Bathroom, Master, Bedroom, Front, Garage and Room.</li>
</ul>

<p>Execution of the AddDevice/AddLocation APIs should only be initiated through user interaction from the Dealer or end user. Inadvertent use of these APIs can result in drivers or locations recursively adding themselves to a project.</p>
<h6 id='available-from-3-2-0'>Available from 3.2.0.</h6><h3 id='signature'>Signature</h3>
<p><code>C4:AddLocation ()</code></p>

<table><thead>
<tr>
<th>Parameters</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>num</td>
<td>ParentID Number -  This parameter is the device id of the location (Site, Building, Floor) where the new location is to be added. For example, if adding a new building to a project, this parameter would be the Site ID. If adding a new room to a project, this parameter would be the Floor ID.</td>
</tr>
<tr>
<td>str</td>
<td>Name of Location - This parameter is a string value representing the name that will be used for the newly added location. For example: &quot;New Main Floor&quot; or &quot;Master Bathroom&quot;. The string passed in this parameter will be displayed in the ComposerPro project tree.</td>
</tr>
<tr>
<td>str</td>
<td>Type of Location - This parameter is a string value that defines the type of location being added. Acceptable values include: SITE, BUILDING, FLOOR or ROOM.</td>
</tr>
<tr>
<td>str</td>
<td>Image - This is an optional parameter that provides the ability to use a different image for the location. Valid images are based on the Type of Location. Available images are those images visible in ComposerPro. See Example 4. below for more information.</td>
</tr>
</tbody></table>
<h3 id='returns'>Returns</h3>
<p>The API returns the new Location ID of the location that was added. It will return a value of 0 upon failure.</p>
<h3 id='examples'>Examples</h3>
<p>1: <strong>Adding a Site named Home to a Project:</strong></p>

<p><code>C4:AddLocation(1, &quot;HOME&quot;, &quot;SITE&quot;)</code></p>

<p>In the example above, note that the AddLocation API will add the Site, “HOME” to the project. Note the use of the SITE parameter. This is the highest level available in a Control4 system. In this example, the ParentID must be the ID of the Project, which is always 1</p>

<p>2: <strong> Adding a Building named &quot;Office Building&quot; to the Project.</strong></p>

<p><code>C4:AddLocation(2, &quot;Office Building&quot;, &quot;BUILDING&quot;)</code></p>

<p>In the example above, the ParentID must be the ID of a Site</p>

<p>3:  <strong>Adding a Floor named First Level to the Project</strong></p>

<p><code>C4:AddLocation(3, &quot;First Level&quot;, &quot;FLOOR&quot;)</code></p>

<p>In the example above, the ParentID must be the ID of a Building</p>

<p>4:  <strong>Adding a Room named Master Bathroom to the Project while using an image named &quot;Bathroom&quot;:</strong></p>

<p><code>C4:AddLocation(1, &quot;Master Bathroom&quot;, &quot;ROOM&quot;, &quot;Bathroom&quot;)</code></p>

<p>In the example above, the room named Master Bathroom is not supported by a &quot;Master Bathroom&quot; image in a Control4 project. In this case, the image for Bathroom is used as it most closely matches the room being added.</p>

<p>For further reference, the idc_client and idc_controller sample drivers delivered with the SDK both include auto-add functionality in their Driver Actions. See the sample_drivers directory on the SDK landing page for further information.</p>

<h2 id='bind'>Bind</h2>
<p>Note the order of the parameters passed in the Bind API. Each has a &quot;Provider&quot; and &quot;Consumer&quot; designation. The Provider designation represents the Device ID value of the device providing the data within the binding. To verify if a device driver is a Provider, go to the driver&#39;s <code>&lt;Connections&gt;</code> XML.This API provides the ability to create a binding between two devices: a &quot;Provider Device&quot; and a &quot;Consumer Device.&quot; The binding creation through this API is the same as manually creating a binding in ComposerPro&#39;s The <code>&lt;consumer&gt;</code> XML tag for this device&#39;s driver will be False or:  <code>&lt;consumer&gt;False&lt;/consumer&gt;</code>. Subsequently, the Provider Binding ID value is the Provider device&#39;s binding value.</p>
<h6 id='available-from-2-9-0'>Available from 2.9.0.</h6><h3 id='signature'>Signature</h3>
<p><code>C4:Bind(idDeviceProvider, idBindingProvider, idDeviceConsumer, idBindingConsumer, strClass)</code></p>

<table><thead>
<tr>
<th>Parameter</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>idDeviceProvider</td>
<td>ID value of the device providing data.</td>
</tr>
<tr>
<td>idBindingProvider</td>
<td>Binding ID value of the binding for the Provider Device</td>
</tr>
<tr>
<td>idDeviceConsumer</td>
<td>ID value of the device consuming data.</td>
</tr>
<tr>
<td>Class</td>
<td>String. The binding connection class.</td>
</tr>
</tbody></table>

<p>The Parameters with the Consumer designation represent the device that consumes data from the Provider device.
The <code>&lt;consumer&gt;</code> XML tag for this device&#39;s driver will be True or:  <code>&lt;consumer&gt;True&lt;/consumer&gt;</code>. Subsequently, the
Consumer Binding ID value is the Consumer device&#39;s binding value.</p>
<h3 id='returns'>Returns</h3>
<p><code>None</code></p>

<h2 id='blowfishecbdecrypt'>blowfishEcbDecrypt</h2>
<p>Function to decrypt using Blowfish in ECB mode. ECB mode operates on exactly 64 bits (8 bytes) of data. This
API can be invoked during OnDriverInit.</p>
<h6 id='available-from-1-6-0'>Available from 1.6.0.</h6><h3 id='signature'>Signature</h3>
<p><code>C4:blowfishEcbEncrypt()</code></p>

<table><thead>
<tr>
<th>Parameter</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>str</td>
<td>Encrypted data</td>
</tr>
</tbody></table>
<h3 id='returns'>Returns</h3>
<table><thead>
<tr>
<th>Value</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>str</td>
<td>De-encrypted data.</td>
</tr>
</tbody></table>

<h2 id='blowfishecbencrypt'>blowfishEcbEncrypt</h2>
<p>Function to encrypt using Blowfish in ECB mode. ECB mode operates on exactly 64 bits (8 bytes) of data. This
API can be invoked during OnDriverInit.</p>
<h6 id='available-from-1-6-0'>Available from 1.6.0.</h6><h3 id='signature'>Signature</h3>
<p><code>C4:blowfishEcbEncrypt()</code></p>

<table><thead>
<tr>
<th>Parameter</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>str</td>
<td>De-encrypted data.</td>
</tr>
</tbody></table>
<h3 id='returns'>Returns</h3>
<table><thead>
<tr>
<th>Value</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>str</td>
<td>Encrypted data.</td>
</tr>
</tbody></table>

<h2 id='callasync'>CallAsync</h2>
<p>API that makes calling functions asynchronously much easier. This API should not be invoked during
OnDriverInit.</p>
<h6 id='available-from-1-6-0'>Available from 1.6.0.</h6><h3 id='signature'>Signature</h3>
<p><code>C4:CallAsync()</code></p>

<table><thead>
<tr>
<th>Parameter</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>str</td>
<td>Function to be called asynchronously.</td>
</tr>
</tbody></table>
<h3 id='example'>Example</h3><div class="highlight"><pre class="highlight lua tab-lua"><code><span class="nb">print</span><span class="p">(</span><span class="s2">"Calling CallAsync()..."</span><span class="p">)</span>
 <span class="n">C4</span><span class="p">:</span><span class="n">CallAsync</span><span class="p">(</span><span class="k">function</span><span class="p">()</span>
       <span class="nb">print</span><span class="p">(</span><span class="s2">"Callback was executed."</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">"Called CallAsync()."</span><span class="p">)</span>

<span class="c1">-- Example Output:</span>
<span class="n">Calling</span> <span class="n">CallAsync</span><span class="p">()</span><span class="o">...</span>
<span class="n">Called</span> <span class="n">CallAsync</span><span class="p">().</span>
<span class="n">Callback</span> <span class="n">was</span> <span class="n">executed</span><span class="p">.</span>
</code></pre></div>
<h1 id='createtlsserver'>CreateTLSServer</h1>
<p>This function enables a Lua driver to create a secure SSL/TLS server that listens for incoming connections on a specified port.</p>
<h6 id='available-from-3-3-0'>Available from 3.3.0</h6><h3 id='signature'>Signature</h3>
<p><code>C4:CreateTLSServer(port, delimiter, options, verifyMode, cipherList, certificate, privateKey, password, chain)</code></p>

<table><thead>
<tr>
<th>Parameter</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>int</td>
<td>port. The network port to which the new server is bound.</td>
</tr>
<tr>
<td>str</td>
<td>delimiter. A sequence of one or more characters that specify the boundary between network payloads. When specified, the server socket will read from the network until it encounters the delimiter. The entire payload, including the delimiter, is then delivered to the driver. If the value of the delimiter argument is empty (no delimiter specified), then incoming network traffic is delivered to the driver as it is read from the network.</td>
</tr>
<tr>
<td>int</td>
<td>options. A numeric value that specifies the TLS options to be applied to the server. The various bits in the number identify the options that are set for the server. This number can be constructed by bitwise ORing values together. The <a href="https://snap-one.github.io/docs-driverworks-fundamentals/#operating-system-3-and-binary-data">BitOp library</a> (which is available to drivers) can perform these operations. Alternatively, if the options are known beforehand, then this value can be computed ahead of time and hardcoded. The following table identifies the options that can be set:</td>
</tr>
</tbody></table>

<table><thead>
<tr>
<th>Options</th>
<th>Value</th>
<th>Bitwise Position</th>
</tr>
</thead><tbody>
<tr>
<td>DEFAULT_WORKAROUNDS: Enables various SSL/TLS bug workarounds</td>
<td>0x0001</td>
<td>000000001</td>
</tr>
<tr>
<td>NO_COMPRESSION: Disables SSL compression (disabled by default)</td>
<td>0x0002</td>
<td>000000010</td>
</tr>
<tr>
<td>SSL_OP_NO_SSLv2: Disables the SSL version 2 protocol</td>
<td>0x0004</td>
<td>000000100</td>
</tr>
<tr>
<td>SSL_OP_NO_SSLv3: Disables the SSL version 3 protocol</td>
<td>0x0008</td>
<td>000001000</td>
</tr>
<tr>
<td>SSL_OP_NO_TLSv1: Disable the TLS version 1 protocol</td>
<td>0x0010</td>
<td>000010000</td>
</tr>
<tr>
<td>SSL_OP_NO_TLSv1_1: Disables the TLS version 1.1 protocol</td>
<td>0x0020</td>
<td>000100000</td>
</tr>
<tr>
<td>SSL_OP_NO_TLSv1_2: Disables the TLS version 1.2 protocol</td>
<td>0x0040</td>
<td>001000000</td>
</tr>
<tr>
<td>SSL_OP_NO_TLSv1_3: Disables the TLS version 1.3 protocol</td>
<td>0x0080</td>
<td>010000000</td>
</tr>
</tbody></table>

<p>If the value is zero, then the following default value is used: 0x003D, which consists of the following options ORed together:</p>

<table><thead>
<tr>
<th>Options</th>
</tr>
</thead><tbody>
<tr>
<td>DEFAULT_WORKAROUNDS</td>
</tr>
<tr>
<td>SSL_OP_NO_SSLv2</td>
</tr>
<tr>
<td>SSL_OP_NO_SSLv3</td>
</tr>
<tr>
<td>SSL_OP_NO_TLSv1</td>
</tr>
<tr>
<td>SSL_OP_NO_TLSv1_1</td>
</tr>
</tbody></table>

<table><thead>
<tr>
<th>Parameter</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>num</td>
<td>verifyMode. A numeric value that specifies the peer verification mode. The various bits in the number identify options that are set for the server. This number can be constructed by bitwise ORing values together. The <a href="https://snap-one.github.io/docs-driverworks-fundamentals/#operating-system-3-and-binary-data">BitOp library</a> (which is available to drivers) can perform these operations. Alternatively, if the options are known beforehand, then this value can be computed ahead of time and hardcoded. The following table identifies the options that can be set:</td>
</tr>
</tbody></table>

<table><thead>
<tr>
<th>Option</th>
<th>Value</th>
<th>Bitwise Position</th>
</tr>
</thead><tbody>
<tr>
<td>SSL_VERIFY_NONE: The server will not send a client certificate request to the client, so the client will not send a certificate.</td>
<td>0x01</td>
<td>0001</td>
</tr>
<tr>
<td>SSL_VERIFY_PEER: The server sends a client certificate request to the client. The certificate returned (if any) is checked. If the verification process fails, the TLS/SSL handshake is immediately terminated.</td>
<td>0x02</td>
<td>0010</td>
</tr>
<tr>
<td>SSL_VERIFY_FAIL_IF_NO_PEER_CERT: If the client did not return a certificate, the TLS/SSL handshake is immediately terminated. This flag must be used together with SSL_VERIFY_PEER.</td>
<td>0x04</td>
<td>0100</td>
</tr>
<tr>
<td>SSL_VERIFY_CLIENT_ONCE: Only request a client certificate once during the connection. Do not ask for a client certificate again during renegotiation or post-authentication if a certificate was requested during the initial handshake. This flag must be used together with SSL_VERIFY_PEER.</td>
<td>0x08</td>
<td>1000</td>
</tr>
</tbody></table>

<p>If the value is zero, then the following default value us used: 0x0A, which consists of the following options ORed together:</p>

<table><thead>
<tr>
<th>Options</th>
</tr>
</thead><tbody>
<tr>
<td>SSL_VERIFY_PEER</td>
</tr>
<tr>
<td>SSL_VERIFY_PEER</td>
</tr>
</tbody></table>

<table><thead>
<tr>
<th>Parameter</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>str</td>
<td>cipherList: A string that specifies the list of available ciphers. The format of this string is described here: Ciphers. If this string is empty, then the following default string is used: <strong>HIGH:!EXPORT:!DES:!RC4:!3DES:!MD5:!PSK</strong></td>
</tr>
<tr>
<td>str</td>
<td>: A string containing the certificate to use for server connections. This can be one of the following:</td>
</tr>
</tbody></table>

<table><thead>
<tr>
<th>Format</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>PEM</td>
<td>A PEM-encoded certificate</td>
</tr>
<tr>
<td>PEM-FILE</td>
<td>A path to a file containing a PEM-encoded certificate. The path is relative to either the C4Z directory or the driver&#39;s sandbox directory. Note that paths starting with either &quot;.&quot; or &quot;..&quot; are rejected.</td>
</tr>
<tr>
<td>#PKCS12-FILE</td>
<td>A path to a #PKCS12 file containing the certificate, private key, and an optional certificate chain. The password argument must specify the password (if required). When specified, the certificate and private key are extracted from the #PKCS12 file and applied to all server connections. As a result, the privateKey argument is ignored. The certificate chain found in the #PKCS12 file is used automatically unless the chain argument specifies an alternate certificate chain to be used.</td>
</tr>
</tbody></table>

<table><thead>
<tr>
<th>Parameter</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>str</td>
<td>password: The password used to unlock either a PEM-encoded private key or a #PKCS12 file. Note that the password is encrypted and stored in memory in its encrypted form. It is decrypted at the moment that it is needed. Thereafter, all buffers containing the password are scrubbed from memory.</td>
</tr>
<tr>
<td>str</td>
<td>chain; A string containing the certificate chain to use for server connections. This can be one of the following:</td>
</tr>
</tbody></table>

<table><thead>
<tr>
<th>Format</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>PEM</td>
<td>A list of one, or more, PEM-encoded certificates.</td>
</tr>
<tr>
<td>PEM-FILE</td>
<td>A path to a file containing a list of one, or more, PEM-encoded certificates. The path is relative to either the C4Z directory or the driver&#39;s sandbox directory. Note that paths starting with either &quot;.&quot; or &quot;..&quot; are rejected.</td>
</tr>
</tbody></table>
<h3 id='returns'>Returns</h3>
<p>The C4:CreateTLSServer function may return multiple values as follows:</p>

<table><thead>
<tr>
<th>Value</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>status</td>
<td>A boolean value indicating success or failure.</td>
</tr>
<tr>
<td>error</td>
<td>If status is false (failure), then the function also returns a string describing the error.</td>
</tr>
</tbody></table>

<h2 id='evaluateexpression'>EvaluateExpression</h2>
<p>EvaluateConditional evaluates the expression and returns a Boolean result. This API has 3 parameters, a logic operator and two operands.  ‘value1’ is the left operand and ‘value2’ is the right operand. </p>
<h6 id='available-from-2-10-0'>Available from 2.10.0</h6><h3 id='signature'>Signature</h3>
<p><code>C4:EvaluateExpression(logic, value1, value2)</code></p>

<table><thead>
<tr>
<th>Parameter</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>logic</td>
<td>Operator used in the conditionals. The following strings are accepted:</td>
</tr>
<tr>
<td></td>
<td>EQUAL</td>
</tr>
<tr>
<td></td>
<td>NOT_EQUAL</td>
</tr>
<tr>
<td></td>
<td>LESS_THAN</td>
</tr>
<tr>
<td></td>
<td>GREATER_THAN</td>
</tr>
<tr>
<td></td>
<td>GREATER_THAN_OR_EQUAL</td>
</tr>
<tr>
<td>value 1</td>
<td>Left operand of the expression</td>
</tr>
<tr>
<td>value 2</td>
<td>Right operand of the expression</td>
</tr>
</tbody></table>
<h3 id='returns'>Returns</h3>
<p><code>True or False</code></p>
<h3 id='example'>Example</h3>
<p><code>C4:EvaluateExpression(&quot;GREATER_THAN_OR_EQUAL&quot;, 50, 0)</code></p>

<p>In the example above, the expression could be written as “result = (50 &gt;= 0)” and would evaluate to result being equal to “true”.</p>

<h2 id='getallcodeitems'>GetAllCodeItems</h2>
<p>This function returns all Code Items within the project.</p>

<p><em>This API was introduced in O.S. Release 3.3.0</em></p>
<h3 id='signature'>Signature</h3>
<p><code>C4:GetAllCodeItems()</code></p>
<h3 id='parameters'>Parameters</h3>
<p><code>None</code></p>

<table><thead>
<tr>
<th>Returns</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>Table</td>
<td>LUA table  with all of the code items that exist in the active project. Table contents will vary based on the code items stored in the system.</td>
</tr>
</tbody></table>
<h3 id='example'>Example</h3>
<p>GetAllCodeItems returns a table with the device ID, the code item, and the event ID for each of the device ID/event ID pairs in the system.  The table contains the following key-value pairs:</p>

<table><thead>
<tr>
<th>Key</th>
<th>Value</th>
</tr>
</thead><tbody>
<tr>
<td>deviceid</td>
<td>The device ID a code item is for.</td>
</tr>
<tr>
<td>codeitem</td>
<td>A table that contains the code item information.</td>
</tr>
<tr>
<td>eventid</td>
<td>The event ID a code item is for.</td>
</tr>
</tbody></table>

<p>The table returned by the GetAllCodeItems API (that was stored in codeItems) might look like the table to the right.</p>
<div class="highlight"><pre class="highlight lua tab-lua"><code><span class="p">{</span>
    <span class="p">[</span><span class="s2">"event_mgr"</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
        <span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
            <span class="p">[</span><span class="s2">"deviceid"</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
            <span class="p">[</span><span class="s2">"codeitem"</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
                <span class="p">[</span><span class="s2">"enabled"</span><span class="p">]</span> <span class="o">=</span> <span class="kc">true</span><span class="p">,</span>
                <span class="p">[</span><span class="s2">"cmdcond"</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
                    <span class="p">[</span><span class="s2">"xml"</span><span class="p">]</span> <span class="o">=</span> 
                <span class="p">}</span> <span class="p">,</span>
                <span class="p">[</span><span class="s2">"creator"</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
                <span class="p">[</span><span class="s2">"device"</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
                <span class="p">[</span><span class="s2">"type"</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
                <span class="p">[</span><span class="s2">"display"</span><span class="p">]</span> <span class="o">=</span> <span class="p">,</span>
                <span class="p">[</span><span class="s2">"subitems"</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
                    <span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
                        <span class="p">[</span><span class="s2">"enabled"</span><span class="p">]</span> <span class="o">=</span> <span class="kc">true</span><span class="p">,</span>
                        <span class="p">[</span><span class="s2">"cmdcond"</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
                            <span class="p">[</span><span class="s2">"xml"</span><span class="p">]</span> <span class="o">=</span> <span class="o">&lt;</span><span class="n">devicecommand</span> <span class="n">owneridtype</span><span class="o">=</span><span class="s2">""</span> <span class="n">owneriditem</span><span class="o">=</span><span class="s2">"-1"</span><span class="o">&gt;&lt;</span><span class="n">command</span><span class="o">&gt;</span><span class="n">ON</span><span class="o">&lt;/</span><span class="n">command</span><span class="o">&gt;&lt;</span><span class="n">params</span><span class="o">/&gt;&lt;/</span><span class="n">devicecommand</span><span class="o">&gt;</span>
                        <span class="p">}</span> <span class="p">,</span>
                        <span class="p">[</span><span class="s2">"creator"</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
                        <span class="p">[</span><span class="s2">"device"</span><span class="p">]</span> <span class="o">=</span> <span class="mi">19</span><span class="p">,</span>
                        <span class="p">[</span><span class="s2">"type"</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
                        <span class="p">[</span><span class="s2">"display"</span><span class="p">]</span> <span class="o">=</span> <span class="n">Turn</span> <span class="n">on</span> <span class="n">the</span> <span class="n">NAME</span><span class="p">,</span>
                        <span class="p">[</span><span class="s2">"subitems"</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span> <span class="p">,</span>
                        <span class="p">[</span><span class="s2">"creatorstate"</span><span class="p">]</span> <span class="o">=</span> <span class="p">,</span>
                        <span class="p">[</span><span class="s2">"id"</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
                    <span class="p">}</span> 
                <span class="p">}</span> <span class="p">,</span>
                <span class="p">[</span><span class="s2">"creatorstate"</span><span class="p">]</span> <span class="o">=</span> <span class="p">,</span>
                <span class="p">[</span><span class="s2">"id"</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="p">}</span> <span class="p">,</span>
            <span class="p">[</span><span class="s2">"eventid"</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
        <span class="p">}</span> <span class="p">,</span>
        <span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
            <span class="p">[</span><span class="s2">"deviceid"</span><span class="p">]</span> <span class="o">=</span> <span class="mi">100100</span><span class="p">,</span>
            <span class="p">[</span><span class="s2">"codeitem"</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
                <span class="p">[</span><span class="s2">"enabled"</span><span class="p">]</span> <span class="o">=</span> <span class="kc">true</span><span class="p">,</span>
                <span class="p">[</span><span class="s2">"cmdcond"</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
                    <span class="p">[</span><span class="s2">"xml"</span><span class="p">]</span> <span class="o">=</span> 
                <span class="p">}</span> <span class="p">,</span>
                <span class="p">[</span><span class="s2">"creator"</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
                <span class="p">[</span><span class="s2">"device"</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
                <span class="p">[</span><span class="s2">"type"</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
                <span class="p">[</span><span class="s2">"display"</span><span class="p">]</span> <span class="o">=</span> <span class="p">,</span>
                <span class="p">[</span><span class="s2">"subitems"</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span> <span class="p">,</span>
                <span class="p">[</span><span class="s2">"creatorstate"</span><span class="p">]</span> <span class="o">=</span> <span class="p">,</span>
                <span class="p">[</span><span class="s2">"id"</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
            <span class="p">}</span> <span class="p">,</span>
            <span class="p">[</span><span class="s2">"eventid"</span><span class="p">]</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>

</code></pre></div>
<h2 id='getbootid'>GetBootID</h2>
<p>This function returns a string that contains an ID which is unique for the current kernel instance.  When the controller is
re-booted, the ID will change.  The returned value is the same value as the one stored on Linux at:</p>

<p><code>/proc/sys/kernel/random/boot_id</code> </p>

<p><em>This API was introduced in O.S. Release 3.3.0</em></p>
<h3 id='signature'>Signature</h3>
<p><code>C4:GetBootID()</code></p>
<h3 id='parameters'>Parameters</h3>
<p><code>None</code></p>

<table><thead>
<tr>
<th>Returns</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>string</td>
<td>Current kernel instance.</td>
</tr>
</tbody></table>
<h3 id='example'>Example</h3>
<p>GetBootID returns a string with the current boot ID for the kernel.  An example of the value that can be returned is:</p>

<p><code>1525a67e-b7bd-4a68-8919-dd65e7f3861a</code></p>

<h2 id='getcodeitems'>GetCodeItems</h2>
<p>This function returns Code Items for a specified device and event.</p>

<p><em>This API was introduced in O.S. Release 3.3.0</em></p>
<h3 id='signature'>Signature</h3>
<p><code>C4:GetCodeItems ()</code></p>

<table><thead>
<tr>
<th>Parameters</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>num</td>
<td>device ID value</td>
</tr>
<tr>
<td>num</td>
<td>event ID value</td>
</tr>
</tbody></table>

<table><thead>
<tr>
<th>Returns</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>Table</td>
<td>LUA table with the code items for the passed device ID and event ID. This will vary depending on parameters provided and the code items stored in the system.</td>
</tr>
</tbody></table>
<h3 id='example'>Example</h3>
<p>GetCodeItems returns a table with an entry for the device ID and event ID that were provided.  The table contains the following key-value pairs :</p>

<table><thead>
<tr>
<th>Key</th>
<th>Value</th>
</tr>
</thead><tbody>
<tr>
<td>enabled</td>
<td>true/false. Is this code item enabled?</td>
</tr>
<tr>
<td>cmdcond</td>
<td>A condition that needs to be met for this code item to be called.</td>
</tr>
<tr>
<td>creator</td>
<td>The ID of the entity that created this code item.</td>
</tr>
<tr>
<td>device</td>
<td>The device ID for the code item.</td>
</tr>
<tr>
<td>type</td>
<td>See &quot;Code Item Types&quot; section below</td>
</tr>
<tr>
<td>display</td>
<td>Description of the code item</td>
</tr>
<tr>
<td>subitems</td>
<td>Additional code items related to this one.</td>
</tr>
</tbody></table>

<p><strong>Code Item Types</strong></p>

<table><thead>
<tr>
<th>Description</th>
<th>Value</th>
</tr>
</thead><tbody>
<tr>
<td>Container</td>
<td>0</td>
</tr>
<tr>
<td>Command</td>
<td>1</td>
</tr>
<tr>
<td>Condition</td>
<td>2</td>
</tr>
<tr>
<td>Loop</td>
<td>3</td>
</tr>
<tr>
<td>Else</td>
<td>4</td>
</tr>
<tr>
<td>Comment</td>
<td>5</td>
</tr>
<tr>
<td>Operator</td>
<td>6</td>
</tr>
</tbody></table>

<p>The table that is returned by the GetCodeItems command (that was stored in codeItems) would look like the table to the right.</p>
<div class="highlight"><pre class="highlight lua tab-lua"><code><span class="p">{</span>
    <span class="p">[</span><span class="s2">"codeitems"</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
        <span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
            <span class="p">[</span><span class="s2">"enabled"</span><span class="p">]</span> <span class="o">=</span> <span class="kc">true</span><span class="p">,</span>
            <span class="p">[</span><span class="s2">"cmdcond"</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
                <span class="p">[</span><span class="s2">"xml"</span><span class="p">]</span> <span class="o">=</span>
            <span class="p">}</span> <span class="p">,</span>
            <span class="p">[</span><span class="s2">"creator"</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
            <span class="p">[</span><span class="s2">"device"</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
            <span class="p">[</span><span class="s2">"type"</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
            <span class="p">[</span><span class="s2">"display"</span><span class="p">]</span> <span class="o">=</span> <span class="p">,</span>
            <span class="p">[</span><span class="s2">"subitems"</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
                <span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
                    <span class="p">[</span><span class="s2">"enabled"</span><span class="p">]</span> <span class="o">=</span> <span class="kc">true</span><span class="p">,</span>
                    <span class="p">[</span><span class="s2">"cmdcond"</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
                        <span class="p">[</span><span class="s2">"xml"</span><span class="p">]</span> <span class="o">=</span> <span class="o">&lt;</span><span class="n">devicecommand</span> <span class="n">owneridtype</span><span class="o">=</span><span class="s2">""</span> <span class="n">owneriditem</span><span class="o">=</span><span class="s2">"-1"</span><span class="o">&gt;&lt;</span><span class="n">command</span><span class="o">&gt;</span><span class="n">ON</span><span class="o">&lt;/</span><span class="n">command</span><span class="o">&gt;&lt;</span><span class="n">params</span><span class="o">/&gt;&lt;/</span><span class="n">devicecommand</span><span class="o">&gt;</span>
                    <span class="p">}</span> <span class="p">,</span>
                    <span class="p">[</span><span class="s2">"creator"</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
                    <span class="p">[</span><span class="s2">"device"</span><span class="p">]</span> <span class="o">=</span> <span class="mi">19</span><span class="p">,</span>
                    <span class="p">[</span><span class="s2">"type"</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
                    <span class="p">[</span><span class="s2">"display"</span><span class="p">]</span> <span class="o">=</span> <span class="n">Turn</span> <span class="n">on</span> <span class="n">the</span> <span class="n">NAME</span><span class="p">,</span>
                    <span class="p">[</span><span class="s2">"subitems"</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span> <span class="p">,</span>
                    <span class="p">[</span><span class="s2">"creatorstate"</span><span class="p">]</span> <span class="o">=</span> <span class="p">,</span>
                    <span class="p">[</span><span class="s2">"id"</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
                <span class="p">}</span>
            <span class="p">}</span> <span class="p">,</span>
            <span class="p">[</span><span class="s2">"creatorstate"</span><span class="p">]</span> <span class="o">=</span> <span class="p">,</span>
            <span class="p">[</span><span class="s2">"id"</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>

</code></pre></div>
<h2 id='getc4idir'>GetC4iDir</h2>
<p>Function that will return the directory path on the controller where driver.c4i files reside.</p>
<h6 id='available-from-2-10-0'>Available from 2.10.0</h6><h3 id='signature'>Signature</h3>
<p><code>C4:GetC4iDir()</code></p>
<h3 id='parameters'>Parameters</h3>
<p><code>None</code></p>
<h3 id='returns'>Returns</h3>
<table><thead>
<tr>
<th>Value</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>str</td>
<td>Directory path.</td>
</tr>
</tbody></table>

<h2 id='getc4zdir'>GetC4zDir</h2>
<p>Function that will return the directory path on the controller where driver.c4z files reside.</p>
<h6 id='available-from-2-10-0'>Available from 2.10.0</h6><h3 id='signature'>Signature</h3>
<p><code>C4:GetC4zDir()</code></p>
<h3 id='parameters'>Parameters</h3>
<p><code>None</code></p>
<h3 id='returns'>Returns</h3>
<table><thead>
<tr>
<th>Value</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>str</td>
<td>Directory path.</td>
</tr>
</tbody></table>

<h2 id='getlogdir'>GetLogDir</h2>
<p>Function that will return the directory path on the controller where log files reside.</p>
<h6 id='available-from-2-10-0'>Available from 2.10.0</h6><h3 id='signature'>Signature</h3>
<p><code>C4:GetLogDir()</code></p>
<h3 id='parameters'>Parameters</h3>
<p><code>None</code></p>
<h3 id='returns'>Returns</h3>
<table><thead>
<tr>
<th>Value</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>str</td>
<td>Directory path.</td>
</tr>
</tbody></table>

<h2 id='getpushsettings'>getPushSettings</h2>
<p>A Boolean API that returns the project’s current setting for the “Push Settings from Project” checkbox in Composer Pro’s Project properties screen. True equals a populated checkbox. False equals an un-populated checkbox. This is useful for determining if a driver can push settings to a device (true) or if settings will be sent from the device to the project (false).</p>
<h6 id='available-from-2-7-0'>Available from 2.7.0.</h6>

<h2 id='getsandboxdir'>GetSandboxDir</h2>

<p>Returns the directory where the LUA driver will store its files.</p>

<p><h6 id='available-from-2-9-0'>Available from 2.9.0</h6><h3 id='signature'>Signature</h3>
<p><code>GetSandboxDir()</code></p>
<h3 id='example'>Example</h3>
<p><code>print(C4:GetSandboxDir())</code></p></p>

<p>Outputs:</p>

<p><code>/control4/drivers/lua/sandbox/88</code></p>

<p>Note that the value of 88 in the example above is the Device ID for the driver.</p>

<h2 id='gettimezone'>GetTimeZone</h2>

<p>Returns the Project&#39;s current Time Zone in the form of a LUA string. If there is no Time Zone set for the project, such as in the case of an unidentified controller, an empty string is returned.</p>

<p><h6 id='available-from-3-0-0'>Available from 3.0.0</h6><h3 id='signature'>Signature</h3>
<p><code>C4:GetTimeZone ()</code></p>
<h3 id='parameters'>Parameters</h3>
<p><code>None</code></p>
<h3 id='returns'>Returns</h3>
<table><thead>
<tr>
<th>Value</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>str</td>
<td>Time Zone in a string format.</td>
</tr>
</tbody></table></p>

<p>Examples of return strings are:
<code>US/Mountain</code>
<code>US/Pacific</code>
<code>US/Samoa</code></p>

<h3 id='usage-note'>Usage Note</h3>

<p>The string value returned will be same as the Project value set in: Composer -&gt; Project Settings -&gt; Time Zone field.</p>

<h2 id='hexdump'>hexdump</h2>

<p>Prints out the values of a string in both hex and ascii representation.  All characters that are not ‘A-Z’ or ‘0-9’ are printed as a ‘.’ in the ascii representation. The print goes to the Lua tab on the properties page of the driver. This API can be invoked during OnDriverInit.</p>

<p><h6 id='available-from-1-6-0'>Available from 1.6.0</h6><h3 id='signature'>Signature</h3>
<p><code>hexdump(strDump)</code></p></p>

<table><thead>
<tr>
<th>Parameter</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>strDump</td>
<td>Text to print out in a hexdump.</td>
</tr>
</tbody></table>

<h3 id='returns'>Returns</h3>

<p><code>None</code></p>

<h3 id='example'>Example</h3><div class="highlight"><pre class="highlight plaintext"><code>hexdump(tohex("00 ff de ad be ef ") .. "Test Text")

Prints out the following:
00000000  00 FF DE AD BE EF 54 65  ......Te
00000008  73 74 20 54 65 78 74     st.Text
</code></pre></div>
<h2 id='onbindingchanged'>OnBindingChanged</h2>
<p>Function called by Director when a binding changes state (bound or unbound).</p>
<h6 id='available-from-2-9-0'>Available from 2.9.0</h6><h3 id='signature'>Signature</h3>

<p><code>OnBindingChanged (idBinding, strClass, bIsBound, otherDeviceID, otherBindingID)</code></p>

<table><thead>
<tr>
<th>Parameter</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>idBinding</td>
<td>ID of the binding whose state has changed.</td>
</tr>
<tr>
<td>str</td>
<td>Class of binding that has changed. A single binding can have multiple classes: COMPONENT, STEREO, etc. This indicates which has been bound or unbound.</td>
</tr>
<tr>
<td>bIsBound</td>
<td>Whether the binding has been bound or unbound.</td>
</tr>
<tr>
<td>otherDeviceID</td>
<td>This Device ID value represents the Device ID for the device that makes up the other half of this binding.</td>
</tr>
<tr>
<td>otherBindingID</td>
<td>This Binding ID value represents the Binding ID for the device represented by the otherDeviceID value in the parameter above.</td>
</tr>
</tbody></table>

<h3 id='returns'>Returns</h3>

<p><code>None</code></p>

<h3 id='usage-note'>Usage Note</h3>

<p>Protocol drivers do not get OnBindingChanged notifications for AV and Room bindings being bound, only  control type bindings (Serial, IR, etc.). It is intended to be used specifically for when serial bindings are made, so the driver knows it can send initialization, etc. to the now-connected device.</p>

<h2 id='parsexml'>ParseXML</h2>

<p>Helper function which turns a XML document into a .lua table of parsed XML data. This API can be invoked during
OnDriverInit.</p>

<p><h6 id='available-from-2-7-0'>Available from 2.7.0</h6><h3 id='signature'>Signature</h3>
<p><code>C4:ParseXml (str)</code></p></p>

<table><thead>
<tr>
<th>Parameter</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>str</td>
<td>XML in string format</td>
</tr>
</tbody></table>

<h3 id='returns'>Returns</h3>

<table><thead>
<tr>
<th>Value</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>Table</td>
<td>Lua Table.</td>
</tr>
</tbody></table>

<h3 id='example'>Example</h3><div class="highlight"><pre class="highlight lua tab-lua"><code><span class="err">    </span> <span class="k">function</span> <span class="nf">ParseProxyCommandArgs</span><span class="p">(</span><span class="n">tParams</span><span class="p">)</span>
<span class="err">      </span> <span class="kd">local</span> <span class="n">args</span> <span class="o">=</span> <span class="p">{}</span>
<span class="err">      </span> <span class="kd">local</span> <span class="n">parsedArgs</span> <span class="o">=</span> <span class="n">C4</span><span class="p">:</span><span class="n">ParseXml</span><span class="p">(</span><span class="n">tParams</span><span class="p">[</span><span class="s2">"ARGS"</span><span class="p">])</span>
<span class="err">      </span> <span class="k">for</span> <span class="n">i</span><span class="p">,</span><span class="n">v</span> <span class="k">in</span> <span class="nb">pairs</span><span class="p">(</span><span class="n">parsedArgs</span><span class="p">.</span><span class="n">ChildNodes</span><span class="p">)</span> <span class="k">do</span>
<span class="err">             </span> <span class="n">args</span><span class="p">[</span><span class="n">v</span><span class="p">.</span><span class="n">Attributes</span><span class="p">[</span><span class="s2">"name"</span><span class="p">]]</span> <span class="o">=</span> <span class="n">v</span><span class="p">.</span><span class="n">Value</span>
<span class="err">      </span> <span class="k">end</span>
<span class="err">      </span> <span class="k">return</span> <span class="n">args</span>
<span class="err">      </span>
<span class="k">end</span>
</code></pre></div>
<h2 id='print'>print</h2>
<p>Function called from DriverWorks driver to prints items out the drivers’ properties page console. Note that for 
convenience, the print function can be called without prefacing with &quot;C4:&quot; This API can be invoked during
OnDriverInit.</p>
<h6 id='available-from-1-6-0'>Available from 1.6.0.</h6><h3 id='signature'>Signature</h3>

<p><code>print(strPrintText)</code></p>

<table><thead>
<tr>
<th>Parameter</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>str</td>
<td>Text to print.</td>
</tr>
</tbody></table>

<h3 id='returns'>Returns</h3>

<p><code>None</code></p>

<h3 id='usage-note'>Usage Note</h3>

<p>The Lua output window in ComposerPro does not necessarily display output in the order in which code is actually executed. The print API is a function implemented in Lua which causes the driver to send a DataToUI message.</p>

<p>DataToUI commands are not guaranteed to be in any particular order. ComposerPro simply captures this DATA and displays it. If the order of data appearing in the ComposerPro Lua window is important, Control4 suggests the use of the Director log.</p>

<h2 id='recordhistory'>RecordHistory</h2>

<p>Helper Function that writes history events to the History Agent database. </p>

<p><h6 id='available-from-1-6-0'>Available from 1.6.0.</h6><h3 id='signature'>Signature</h3>
<p><code>C4:RecordHistory(severity, eventType, category, subcategory, description)</code></p></p>

<table><thead>
<tr>
<th>Parameter</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>str</td>
<td>Severity: Valid parameters include: “Critical”, “Warning”, or “Info&quot;</td>
</tr>
<tr>
<td>str</td>
<td>eventType: Describes the type of event within a category. Each category would define specific types of history event. For example, the Security category could define the following event types: Arm, Disarm, Open, Close, Alarm, etc.</td>
</tr>
<tr>
<td>str</td>
<td>Category: Represents the high level logical group that the device or source belongs to. These  categories may correlate to Navigator categories, but could include additional categories. For example: Security, Lighting, Comfort, System etc.</td>
</tr>
<tr>
<td>str</td>
<td>Subcategory: An optional subcategory can be included. The sub category provides additional event criteria that may be used to query for events.</td>
</tr>
<tr>
<td>str</td>
<td>Description: Brief description.</td>
</tr>
</tbody></table>

<h3 id='returns'>Returns</h3>

<p><code>None</code></p>

<h3 id='example'>Example</h3>

<p><code>C4:RecordHistory(“Critical”,&quot;Disarm”,&quot;Security”,”Front Door”,”The front door was disarmed.&quot;)</code></p>

<h2 id='tohex'>tohex</h2>

<p>Function called from DriverWorks driver to convert a text string of hex into a string with hex values in it. Typically used when a protocol sends commands that are hex values. Note that for convenience, the print function can be called without prefacing with C4: This API can be invoked during OnDriverInit.</p>

<p><h6 id='available-from-1-6-0'>Available from 1.6.0.</h6><h3 id='signature'>Signature</h3>
<p><code>C4:tohex(strHex)</code></p></p>

<table><thead>
<tr>
<th>Parameter</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>str</td>
<td>Text to convert to binary hex.</td>
</tr>
</tbody></table>

<h3 id='returns'>Returns</h3>

<p><code>None</code></p>

<h3 id='example'>Example</h3>

<p>Store the HEX code for a discrete Power On command for a Mitsubishi TV: </p>

<p><code>POWER_ON = tohex(&quot;DF 80 70 F8 02 00 00&quot;)</code>  </p>

<h2 id='tonumberloc'>tonumberloc</h2>

<p>The Lua tonumber() function included in the Lua Library is locale specific. This can cause issues where the
Control4 system is set to a locale where the decimal separator is different from what is returned by the target device.  For example, if the target device sends the Control4 driver a string of  23.4 (23 decimal 4) but the locale expects this to be 23,4 (23 comma 4) then tonumber(&quot;23.4&quot;) will fail.  This problem often occurs in drivers where the UI uses decimal values and can occur with any proxy.</p>

<p>Driver writers must ensure that their drivers will not fail in these circumstances. To assist with this, Control4 has provided a function: tonumberloc(). This function is included in the driver templates beginning OS release 2.8.0 and its use ensures this problem does not occur.  Driver writers are advised to usetonumberloc()  in place of tonumber() in their code.</p>

<p><h6 id='available-from-1-6-0'>Available from 1.6.0.</h6><h3 id='signature'>Signature</h3>
<p><code>tonumber_loc()</code></p>
<h3 id='example'>Example</h3><div class="highlight"><pre class="highlight lua tab-lua"><code>
<span class="k">function</span> <span class="nf">tonumber_loc</span><span class="p">(</span><span class="n">str</span><span class="p">,</span> <span class="n">base</span><span class="p">)</span>
        <span class="kd">local</span> <span class="n">s</span>
        <span class="kd">local</span> <span class="n">num</span>
        <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">str</span><span class="p">)</span> <span class="o">==</span> <span class="s2">&quot;string&quot;</span> <span class="k">then</span>
                <span class="n">s</span> <span class="o">=</span> <span class="n">str</span><span class="p">:</span><span class="nb">gsub</span><span class="p">(</span><span class="sr">&quot;,&quot;</span><span class="p">,</span> <span class="sr">&quot;.&quot;</span><span class="p">)</span> <span class="c1">-- Assume US Locale decimal separator</span>
                <span class="n">num</span> <span class="o">=</span> <span class="nb">tonumber</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="n">base</span><span class="p">)</span>
                <span class="k">if</span> <span class="p">(</span><span class="n">num</span> <span class="o">==</span> <span class="kc">nil</span><span class="p">)</span> <span class="k">then</span>
                        <span class="n">s</span> <span class="o">=</span> <span class="n">str</span><span class="p">:</span><span class="nb">gsub</span><span class="p">(</span><span class="sr">&quot;%.&quot;</span><span class="p">,</span> <span class="sr">&quot;,&quot;</span><span class="p">)</span> <span class="c1">-- Non-US Locale decimal separator</span>
                        <span class="n">num</span> <span class="o">=</span> <span class="nb">tonumber</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="n">base</span><span class="p">)</span>
                <span class="k">end</span>
        <span class="k">else</span>
                <span class="n">num</span> <span class="o">=</span> <span class="nb">tonumber</span><span class="p">(</span><span class="n">str</span><span class="p">,</span> <span class="n">base</span><span class="p">)</span>
        <span class="k">end</span>
        <span class="k">return</span> <span class="n">num</span>
<span class="k">end</span></p>

<p></code></pre></div>
<h2 id='tostringlocalec'>ToStringLocaleC</h2>
<p>String helper function to convert a number to a string using the ‘C’ locale regardless of the locale setting of the Control4 Operating System. Some countries use commas instead of decimal points for floating point numbers.
Lua ‘tostring’ command and string concatenation (..) with a number variable will convert the decimal value from a decimal point to a comma in some countries (locales). There may be instances where you do not want this conversion to take place and want the floating-point number to always be represented using a decimal point as opposed to a comma. In these cases, the C4:ToStringLocaleC(num) command can be used to convert the number to a string using decimal points.</p>
<h6 id='available-from-1-6-0'>Available from 1.6.0.</h6><h3 id='signature'>Signature</h3>
<p><code>C4:ToStringLocaleC (num)</code></p></p>

<table><thead>
<tr>
<th>Parameter</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>num</td>
<td>The number to convert (may be a floating-point number)</td>
</tr>
</tbody></table>

<h3 id='example'>Example</h3>

<p>The xml schema for extras functionality for thermostat proxy drivers requires that all floating-point numbers be represented using a period for the (decimal point). Using string concatenation to generate the extras xml would produce xml with the comma for the floating-point number if the locale is set to a country that uses commas.
 
For example, if you have a thermostat that supports an “Auto Temperature” that is not supported by the proxy that you would like displayed under “Extras” in the Thermostat UI you would need to generate the “Extras” xml to send to the UI. If the temperature represented is a floating-point number then when this number is converted to a string with ‘tostring’ or string concatenation (..), it would be converted to a number represented with a comma. In this case you would want to use the C4:ToStringLocaleC() API to convert the floating number appropriately.</p>

<h2 id='unbind'>unbind</h2>

<p>This API provides the ability to unbind bound devices. The unbinding of the devices binding through this API is the same as manually unbinding two devices in ComposerPro&#39;s Connections area. Note the parameters passed in the API. Both have &quot;Consumer&quot; designation. These parameters represent the device that consumes data from the Provider device. To verify if a device driver is a Consumer, go to the driver&#39;s &lt;Connections&gt; XML. The &lt;consumer&gt; XML tag for this device&#39;s driver will be True or:  &lt;consumer&gt;True&lt;/consumer&gt;. Subsequently, the Consumer Binding ID value is the Consumer device&#39;s binding value.</p>

<p><h6 id='available-from-2-9-0'>Available from 2.9.0.</h6><h3 id='signature'>Signature</h3>
<p><code>C4:Unbind(idDeviceConsumer, idBindingConsumer)</code></p></p>

<table><thead>
<tr>
<th>Parameter</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>num</td>
<td>idDeviceConsumer - ID value of the device consuming data.</td>
</tr>
<tr>
<td>num</td>
<td>idBindingConsumer - Binding ID value of the binding for the Consumer Device</td>
</tr>
</tbody></table>

<h3 id='returns'>Returns</h3>

<p><code>None</code></p>

<h3 id='example'>Example</h3>

<p><code>C4:Unbind(81,1)</code></p>

<h2 id='uuid'>UUID</h2>

<p>This API generates a UUID (Universally Unique IDentifier) as described in <a href="https://www.ietf.org/rfc/rfc4122.txt">RFC 4122</a>. The type of UUID that is generated depends on the arguments passed into the function.</p>

<p><h6 id='available-from-3-3-0'>Available from 3.3.0</h6><h3 id='signature'>Signature</h3>
<p><code>C4:UUID(Type,[Value1,Value2,Value3])</code></p></p>

<table><thead>
<tr>
<th>Parameter</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>Type</td>
<td>Specifies the type of UUID to be generated: NIL, String, Name or Random. See below for further information.</td>
</tr>
<tr>
<td>Value1, Value2, Value3</td>
<td>Values passed to the remaining arguments depend on the type of UUID to be generated. Please see the list below for additional information about required arguments.</td>
</tr>
</tbody></table>

<p><em>The following section identifies the different types of UUIDs that are supported:</em></p>

<p><strong>NIL</strong></p>

<p>Required Argument: <code>(”NIL”)</code>
A NIL UUID is one in which all bits are zero. It is represented as a string containing all zeros: <code>00000000-0000-0000-0000-000000000000</code></p>

<p><strong>String</strong></p>

<p>Required Argument: <code>(”STRING”)</code>
A string containing the data to be formatted as a UUID. The String UUID type takes an input string and formats its contents as a UUID. The format of the string must match the following regular expression:</p>

<p><code>^({)?([0-9a-fA-F]{8})(?-)?([0-9a-fA-F]{4})(?(DASH)-)([0-9a-fA-F]{4})(?(DASH)-)([0-9a-fA-F]{4})(?(DASH)-)([0-9a-fA-F]{12})(?(1)})$</code></p>

<p>More generally, the following formats are accepted, where h is a valid hexadecimal character:</p>

<p><code>hhhhhhhh-hhhh-hhhh-hhhh-hhhhhhhhhhhh</code></p>

<p><code>{hhhhhhhh-hhhh-hhhh-hhhh-hhhhhhhhhhhh}</code></p>

<p><code>hhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhh</code></p>

<p><code>{hhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhh}</code></p>

<p><strong>Name</strong></p>

<p>Required Argument: <code>(”NAME”)</code></p>

<p>Hash: The hashing algorithm to use when generating the UUID. Valid values including the following:</p>

<table><thead>
<tr>
<th>Algorithm</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>MD5</td>
<td>Produces a version 3 UUID (UUID3)</td>
</tr>
<tr>
<td>SHA1</td>
<td>Produces a version 5 UUID (UUID5)</td>
</tr>
</tbody></table>

<p>Namespace: A string containing the namespace to be used when generating the UUID. The value must be one of the following as described in Appendix C of RFC 4122:</p>

<table><thead>
<tr>
<th>Namespace</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>DNS</td>
<td>The value of the Name argument (below) is a fully-qualified domain name.</td>
</tr>
<tr>
<td>URL</td>
<td>The value of the Name argument (below) is a URL.</td>
</tr>
<tr>
<td>OID</td>
<td>The value of the Name argument (below) is an ISO OID (Object IDentifier).</td>
</tr>
<tr>
<td>X500DN</td>
<td>The value of the Name argument is an X.500 DN.</td>
</tr>
</tbody></table>

<p>Name: A string containing the content from which the UUID is derived.</p>

<p><strong>Random</strong></p>

<p>Required Argument: <code>(”RANDOM”)</code>
Generates a random version 4 UUID (UUID4). The generator utilizes entropy provided by the operating system. For example: (i.e., /dev/urandom).</p>

<h3 id='returns'>Returns</h3>

<p>The function may return multiple values. On success, the function returns a string containing the newly generated UUID. On failure, the function returns nil and a string describing the failure.</p>

<h2 id='xmlescapestring'>XmlEscapeString</h2>

<p>&quot;Escapes&quot; the passed in string rendering any XML characters (only &amp;, &lt;, and &gt;) in the string as characters that are valid in an XML value. This API should not be invoked during OnDriverInit.</p>

<p><h6 id='available-from-1-6-0'>Available from 1.6.0.</h6><h3 id='signature'>Signature</h3>
<p><code>C4:XmlEscapeString(strRawInput)</code></p></p>

<table><thead>
<tr>
<th>Parameter</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>str</td>
<td>strRawInput: Raw input string, with possibly invalid characters for an XML value.</td>
</tr>
</tbody></table>

<h3 id='returns'>Returns</h3>

<table><thead>
<tr>
<th>Value</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>str</td>
<td>strEscaped: The passed in string, with all XML characters properly escaped.</td>
</tr>
</tbody></table>

<h3 id='example'>Example</h3>

<p>Builds an XML string with a string that could have invalid XML characters in it:</p>

<p><code>strXmlListItem = &quot;&lt;text&gt;&quot; .. C4:XmlEscapeString .. &quot;&lt;/text&gt;&quot;</code></p>
<h1 id='inbound-driver-interface'>Inbound Driver Interface</h1>

<h2 id='inbound-driver-interface'>InBound Driver Interface</h2>

<p>The functions listed below represent Lua functions that are not Control4 APIs but are however included in this documentation. The functions below are implemented within a DriverWorks driver and can be called by an API, Director or another external process.</p>

<p>For example, the Lua function UIRequest isn&#39;t a Control4 API. However, it is an InBound Driver Function that needs to be implemented in your driver if you intent to use the Control4 API:<a href="https://snap-one.github.io/docs-driverworks-api/#senduirequest">SendUIRequest</a>. SendUIRequest sends a request to another driver. It uses the proxy or protocol ID value of the driver as a means to target the driver where the request will be sent. The driver receiving the SendUIRequest must have the InBound Driver Function UIRequest configured, which will contain the return values requested by the SendUIRequest call.</p>

<p>Here is an example of using SendUIRequest in a driver:</p>

<p><code>C4:SendUIRequest(231, &quot;GET_MY_DRIVER_DATA&quot;, tParams)</code></p>

<p>In this example, the API contains a value of 231. This is the proxy ID value of the driver where the request is being sent. This is followed by a request called  <code>GET_MY_DRIVER_DATA</code>. This is an expected request by the driver receiving the SendUIRequest. A table of parameters follows the command.</p>

<p>To the right is an example of the required UIRequest InBound Driver Function found in the driver receiving the SendUIRequest. In this example, when the request is received it takes the values in the tParams table and, if they are not a specified value of 640 or 480, multiplies them by 10. It then formats the values into XML and returns them through retValue to the driver that initiated the SendUIRequest.</p>

<p><div class="highlight"><pre class="highlight lua tab-lua"><code><span class="k">function</span> <span class="nf">UIRequest</span><span class="p">(</span><span class="n">sRequest</span><span class="p">,</span> <span class="n">tParams</span><span class="p">)</span>
<span class="err">    </span><span class="n">tParams</span> <span class="o">=</span> <span class="n">tParams</span>
<span class="err">   </span> <span class="kd">local</span> <span class="n">param_x</span> <span class="o">=</span> <span class="nb">tonumber</span><span class="p">(</span><span class="n">tParams</span><span class="p">[</span><span class="s2">&quot;PARAM_X&quot;</span><span class="p">])</span> <span class="ow">or</span> <span class="mi">640</span>
<span class="err">    </span><span class="kd">local</span> <span class="n">param_y</span> <span class="o">=</span> <span class="nb">tonumber</span><span class="p">(</span><span class="n">tParams</span><span class="p">[</span><span class="s2">&quot;PARAM_Y&quot;</span><span class="p">])</span> <span class="ow">or</span> <span class="mi">480</span>
<span class="err">               </span>
<span class="err">         </span><span class="kd">local</span> <span class="n">value_x</span> <span class="o">=</span> <span class="n">param_x</span> <span class="o"><em></span> <span class="mi">10</span>
<span class="err">         </span><span class="kd">local</span> <span class="n">value_y</span> <span class="o">=</span> <span class="n">param_y</span> <span class="o"></em></span> <span class="mi">10</span>
<span class="err">               </span>
<span class="err">         </span><span class="kd">local</span> <span class="n">retValue</span> <span class="o">=</span> <span class="s2">&quot;&lt;driver_data&gt;&quot;</span>
<span class="err">         </span><span class="n">retValue</span> <span class="o">=</span> <span class="n">retValue</span> <span class="o">..</span> <span class="s2">&quot;&lt;value_x&gt;&quot;</span> <span class="o">..</span> <span class="n">value_x</span> <span class="o">..</span> <span class="s2">&quot;&lt;/value_x&gt;&quot;</span>
<span class="err">         </span><span class="n">retValue</span> <span class="o">=</span> <span class="n">retValue</span> <span class="o">..</span> <span class="s2">&quot;&lt;value_y&gt;&quot;</span> <span class="o">..</span> <span class="n">value_y</span> <span class="o">..</span> <span class="s2">&quot;&lt;/value_y&gt;&quot;</span>
<span class="err">         </span><span class="n">retValue</span> <span class="o">=</span> <span class="n">retValue</span> <span class="o">..</span> <span class="s2">&quot;&lt;/driver_data&gt;&quot;</span>
<span class="err">               </span>
<span class="err">    </span><span class="k">return</span> <span class="n">retValue</span>
<span class="k">end</span></p>

<p><span class="c1">--The XML below is the returned value.</span>
<span class="o">&lt;</span><span class="n">driver_data</span><span class="o">&gt;</span><span class="err">`</span>
<span class="err">   </span> <span class="o">&lt;</span><span class="n">value_x</span><span class="o">&gt;</span><span class="mi">10240</span><span class="o">&lt;/</span><span class="n">value_x</span><span class="o">&gt;</span>
<span class="err">   </span> <span class="o">&lt;</span><span class="n">value_y</span><span class="o">&gt;</span><span class="mi">7680</span><span class="o">&lt;/</span><span class="n">value_y</span><span class="o">&gt;</span>
<span class="o">&lt;/</span><span class="n">driver_data</span><span class="o">&gt;</span>
</code></pre></div><h3 id='list-of-inbound-driver-functions'>List of InBound Driver Functions:</h3>
<ul>
<li><a href="https://snap-one.github.io/docs-driverworks-api/#onbindingchanged">OnBindingChanged</a></li>
<li><a href="https://snap-one.github.io/docs-driverworks-api/#ondriverdestroyed">OnDriverDestroyed</a></li>
<li><a href="https://snap-one.github.io/docs-driverworks-api/#ondriverlateinit">OnDriverLateInit</a></li>
<li><a href="https://snap-one.github.io/docs-driverworks-api/#ondriverinit">OnDriverInit</a></li>
<li><a href="https://snap-one.github.io/docs-driverworks-api/#onpropertychanged">OnPropertyChanged</a></li>
<li><a href="https://snap-one.github.io/docs-driverworks-api/#senduirequest">SendUIRequest</a></li>
<li><a href="https://snap-one.github.io/docs-driverworks-api/#executecommand">ExecuteCommand</a></li>
<li><a href="https://snap-one.github.io/docs-driverworks-api/#receivedfromserial">ReceivedFromSerial</a></li>
<li><a href="https://snap-one.github.io/docs-driverworks-api/#receivedfromproxy">ReceivedFromProxy</a></li>
<li><a href="https://snap-one.github.io/docs-driverworks-api/#receivedfromnetwork">ReceivedFromNetwork</a></li>
<li><a href="https://snap-one.github.io/docs-driverworks-api/#getprivatekeypassword">GetPrivateKeyPassword</a></li>
<li><a href="https://snap-one.github.io/docs-driverworks-api/#onvariablechanged">OnVariableChanged</a></li>
<li><a href="https://snap-one.github.io/docs-driverworks-api/#onwatchedvariablechanged">OnWatchedVariableChanged</a></li>
<li><a href="https://snap-one.github.io/docs-driverworks-api/#onconnectionstatuschanged">OnConnectionStatusChanged</a></li>
<li><a href="https://snap-one.github.io/docs-driverworks-api/#onserverconnectionstatuschanged">OnServerConnectionStatusChanged</a></li>
<li><a href="https://snap-one.github.io/docs-driverworks-api/#onserverdatain">OnServerDataIn</a></li>
<li><a href="https://snap-one.github.io/docs-driverworks-api/#onnetworkbindingchanged">OnNetworkBindingChanged</a></li>
<li><a href="https://snap-one.github.io/docs-driverworks-api/#onzigbeeonlinestatuschanged">OnZigbeeOnlineStatusChanged</a></li>
<li><a href="https://snap-one.github.io/docs-driverworks-api/#onreflashlockgranted">OnReflashLockGranted</a></li>
<li><a href="https://snap-one.github.io/docs-driverworks-api/#onreflashlockrevoked">OnReflashLockRevoked</a></li>
</ul></p>
<h1 id='ir-interface'>IR Interface</h1>

<h2 id='sendir'>SendIR</h2>

<p>Function called from DriverWorks driver to send an IR Code. This API should not be invoked during OnDriverInit.</p>

<p><h6 id='available-from-1-6-0'>Available from 1.6.0</h6><h3 id='signature'>Signature</h3>
<p><code>C4:SendIR(idBinding,idIRCode)</code></p></p>

<table><thead>
<tr>
<th>Parameter</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>num</td>
<td>idBinding: IR Binding ID to send the IR Code.</td>
</tr>
<tr>
<td>num</td>
<td>idIRCode: ID of the IR Code to send from .c4i</td>
</tr>
<tr>
<td>num</td>
<td>idBinding:Proxy Binding ID. (optional)</td>
</tr>
</tbody></table>

<h3 id='returns'>Returns</h3>

<p><code>None</code></p>

<h3 id='usage-note'>Usage Note</h3>

<p>The IR code to send must be declared as an <code>&lt;ircode\&gt;</code> in the <code>&lt;irsection\&gt;</code> section of the driver  file.</p>

<h2 id='sendirstart'>SendIRStart</h2>

<p>Causes Director to start sending the specified IR Code out the specified binding. This is typically used on button press events. This API should not be invoked during OnDriverInit.</p>

<p><h6 id='available-from-1-6-0'>Available from 1.6.0</h6><h3 id='signature'>Signature</h3>
<p><code>C4:SendIRStart(idBinding, idBinding, idIRCode)</code></p></p>

<table><thead>
<tr>
<th>Parameter</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>num</td>
<td>idBinding: Proxy Binding ID.</td>
</tr>
<tr>
<td>num</td>
<td>idBinding: Binding ID to send the IR Code.</td>
</tr>
<tr>
<td>num</td>
<td>idIRCode: Id of the IR Code to start sending from the driver.</td>
</tr>
</tbody></table>

<h3 id='returns'>Returns</h3>

<p><code>None</code></p>

<h3 id='usage-note'>Usage Note</h3>

<p>Failure to call the <a href="https://snap-one.github.io/docs-driverworks-api/#sendirstop">SendIRStop</a> function will cause the IR code to be sent continually, which (in the case of
volume ramps) could be catastrophic to equipment. The IR code to send must be declared as an <code>&lt;ircode\&gt;</code> in the
<code>&lt;irsection\&gt;</code> of the driver file.</p>

<h3 id='example'>Example</h3>

<p>This example starts sending the specified IR Code out the specified IR Binding:</p>

<p><code>C4:SendIRStart(1, 22)</code></p>

<h2 id='sendirstop'>SendIRStop</h2>

<p>Causes Director to stop sending the specified IR Code out the specified binding. This is typically used on button release events. This API can be invoked during OnDriverInit.</p>

<p><h6 id='available-from-1-6-0'>Available from 1.6.0</h6><h3 id='signature'>Signature</h3>
<p><code>C4:SendIRStop(idBinding,idBinding, idIRCode)</code></p></p>

<table><thead>
<tr>
<th>Parameter</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>num</td>
<td>idBinding: Proxy Binding ID.</td>
</tr>
<tr>
<td>num</td>
<td>idBinding: Binding ID to send the IR Code.</td>
</tr>
<tr>
<td>num</td>
<td>idIRCode: Id of the IR Code to start sending from the driver file.</td>
</tr>
</tbody></table>

<h3 id='returns'>Returns</h3>

<p><code>None</code></p>

<h3 id='usage-note'>Usage Note</h3>

<p>Usage Note: The IR code to send must be declared as an <code>&lt;ircode\&gt;</code> in the <code>&lt;irsection\&gt;</code> section of the driver file.</p>

<h3 id='example'>Example</h3>

<p>This example stops sending the specified IR Code out the specified IR Binding:</p>

<p><code>C4:SendIRStop(1, 22)</code></p>
<h1 id='json-interface'>JSON Interface</h1>

<h2 id='c4json-null'>c4json.null</h2>

<p>c4json is a global object that is used by the JSON encoder/decoder.</p>

<p><code>null</code> Represents a JSON null value. </p>

<p><code>c4json.null</code> can be used to insert a null value into a JSON document (encode), or test for a null value that was encountered in a JSON document (decode).</p>

<h2 id='json-encode'>Json:Encode</h2>

<p>JSON function that takes the data in the Lua tCommand table and encodes it into a JSON formatted command string
representing a Lua object. 
On success, this function returns a single value which is as designed. On failure, the function returns two
values:</p>

<ol>
<li>nil</li>
<li>A string describing the error.</li>
</ol>

<p>This API should not be invoked during OnDriverInit.</p>

<table><thead>
<tr>
<th>Parameter</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>value</td>
<td>The Lua object to be encoded. Must be one of the following types: number, string, boolean, table. Tables can contain any combination of types (including nested tables) provided that all  items are one of the following types: number string, boolean. Note that c4:JsonEncode will fail  if any table  (or nested table) contains any of the following types: lightuserdata, userdata, function, thread.</td>
</tr>
<tr>
<td>formatted</td>
<td>Optional. A boolean flag value indicating whether the resulting JSPN string is formatted using newlines and indentations. The default value is False when omitted.</td>
</tr>
<tr>
<td>encodeArrays</td>
<td>Optional. A boolean flag value indicating whether the tables are encoded as JSON arrays. The default value is False when omitted.</td>
</tr>
<tr>
<td>symmetric</td>
<td>Optional. A boolean flag value indicating whether the resulting JSON objects consist of name/value pairs in which the name must be a string (i.e, double quotes).</td>
</tr>
</tbody></table>

<p>Where necessary, the encoder uses the following fabricated names:</p>

<table><thead>
<tr>
<th>Primitive Type</th>
<th>Fabricated Name</th>
</tr>
</thead><tbody>
<tr>
<td>Number</td>
<td>:number:</td>
</tr>
<tr>
<td>String</td>
<td>:string:</td>
</tr>
<tr>
<td>Boolean</td>
<td>:boolean:</td>
</tr>
<tr>
<td>Array Index</td>
<td>:index:</td>
</tr>
</tbody></table>

<h3 id='examples'>Examples</h3><div class="highlight"><pre class="highlight plaintext"><code>Primitive
local Foo = "Bar"
local Result = c4:JsonEncode(Foo)
</code></pre></div>
<p>The preceding example yields the following JSON string: {&quot;:string:&quot;:&quot;Bar&quot;} This occurs because &quot;Foo&quot; is a primitive type (i.e., String). Unfortunately, the name of a single primitive value is unknown to the encoder so it must use a fabricated name that identifies the type. This is necessary because the JSON specification requires that all JSON objects consist of name/value pairs in which the name must be a string (i.e., double quotes).</p>

<p>Note that you&#39;ll need to use a Lua table in order to provide a JSON string that includes the name of the value.
Consider the following example.</p>
<div class="highlight"><pre class="highlight plaintext"><code>Table
local MyTable = {
    Foo = "Bar"
}
</code></pre></div>
<p><code>C4:JsonEncode(MyTable)</code></p>

<p>The preceding example produces the following JSON string: {“Foo”:”Bar”} It is also possible to control whether the resulting JSON string is formatted using newlines and indentations.</p>
<div class="highlight"><pre class="highlight plaintext"><code>Unformatted
local Foo = {
    Biz = "Baz",
    Qux = "Norf"
}
</code></pre></div>
<p><code>C4:JsonEncode(Foo)</code></p>

<p>The preceding example yields the following JSON string: {“Biz”:”Baz”,”Qux”:”Norf”}. This might be acceptable when the string is to be used in processes that don&#39;t involve humans, such as invoking  a REST service. If readability is important, however, provide the formatted (second) parameter.</p>
<div class="highlight"><pre class="highlight plaintext"><code>Formatted
local Foo = {
    Biz = "Baz",
    Qux = "Norf"
}
</code></pre></div>
<p><code>C4:JsonEncode(Foo, true)</code></p>

<p>With this example, the resulting JSON string is formatted as:</p>
<div class="highlight"><pre class="highlight plaintext"><code>{
    "Biz" : "Baz"
    "Qux" : "Norf"
} 
</code></pre></div>
<p>The encodeArrays (third) parameter provides control over how tables are encoded. In certain cases it might be necessary to specify that tables are encoded as JSON arrays. Note that a Lua table is considered to be an array when each key is a non-negative integer greater than zero (k &gt; 0). Consider the following code.</p>
<div class="highlight"><pre class="highlight plaintext"><code>Object
local Foo = {
    "One",
    "Two",
    "Three",
    "Four",
}
</code></pre></div>
<p><code>C4:JsonEncode(Foo, true)</code></p>

<p>By default, tables are encoded using JSON objects, so the preceding example produces the following formatted 
JSON string:</p>
<div class="highlight"><pre class="highlight plaintext"><code>{
    "1" : "One"
    "2" : "Two"
    "3" : "Three"
    "4" : "Four"
}
</code></pre></div>
<p>This encoding results for two reasons: First, the table is a Lua array. Each entry corresponds to a numeric key. Second the JSON specification requires that an object consist of name/value pairs in which each name must be a string (i.e., double quotes). As a result, each numeric key is converted to a string. This same table can also be represented as a JSON array.</p>
<div class="highlight"><pre class="highlight plaintext"><code>Array
local Foo = {
    "One",
    "Two",
    "Three",
    "Four",
}
</code></pre></div>
<p><code>C4:JsonEncode(Foo, true, true)</code></p>

<p>With the encodeArrays (third) parameter set to true, the encoder yields the following JSON string: [ “One”,
“Two”, “Three”, “Four” ]</p>

<p>It is important to note that the encodeArrays parameter affects only tables that are Lua arrays. Consider the following code.</p>
<div class="highlight"><pre class="highlight plaintext"><code>Non-Array
local Foo = {
    Biz = "Baz",
    Quz = "Norf"
}
</code></pre></div>
<p><code>C4:JsonEncode(Foo, true, true)</code></p>

<p>Although the encodeArrays parameter was set to true, the resulting JSON string is encoded as JSON object:</p>
<div class="highlight"><pre class="highlight plaintext"><code>{
    "Biz" : "Baz",
    "Qux" : "Norf"

}
</code></pre></div>
<p>This occurs because the Lua table was not an array (i.e., contained at least one non-numeric key). Attempting to encode this table as an array would result in an invalid JSON string.</p>

<p>The symmetric (fourth) parameter specifies whether to use symmetric encoding. When symmetric encoding is enabled, the encoder places certain markers within the resulting JSON string. These markers make it possible to decode a JSON string back into the original (equivalent) object. Symmetric encoding (markers) is necessary due to ambiguities that arise when encoding a Lua object. Consider the following code.</p>
<div class="highlight"><pre class="highlight plaintext"><code>Non-Symmetric
local Foo = {
    "One",
    {
        Two = "Two",
        Three = "Three",
    }
}
</code></pre></div>
<p><code>C4:JsonEncode(Foo, true, false)</code></p>

<p>While this accurately represents the Lua object as a JSON string, given the rules of Lua arrays and JSON, it cannot be decoded back into its original (equivalent) table. Rather, decoding this string will produce the following Lua table.</p>
<div class="highlight"><pre class="highlight plaintext"><code>local Bar = {
    ["1"] = "one",
        ["2"] = {
        Two = "Two",
        Three = "Three",
    }
}
</code></pre></div>
<p>Note that the original numeric keys are now strings. Enable symmetric encoding corrects this problem by introducing markers into the resulting JSON string.</p>
<div class="highlight"><pre class="highlight plaintext"><code>Symmetric
local Foo = {
    "One",
    {
        Two = "Two",
        Three = "Three",
    }
}
</code></pre></div>
<p><code>C4:JsonEncode(Foo, true, false, true)</code></p>

<p>With the symmetric parameter set to true, the encoder produces the following JSON string:</p>
<div class="highlight"><pre class="highlight plaintext"><code>{
    ":index:1 : "One",
    ":index:2" : "Two" : {
        "Three" : "Three",
        "Two" : "Two"
    }
}
</code></pre></div>
<p>Note the use of the &quot;:index:&quot; markers. These markers specify that the first element, &quot;One&quot;, is located at the first numeric index. Similarly, the second element, &quot;Two&quot;, is located at the second numeric index. Decoding this JSON string produces the original Lua table. It is important to note that Lua doesn&#39;t guarantee any particular order when enumerating the elements of a table. As described in the documentation for the Lua next function. The order in which the indices are enumerated is not specified, even for numeric indices.</p>

<h2 id='json-decode'>Json:Decode</h2>
<p>JSON function that takes data from the JSON formatted string message and decodes it into the Lua table. On success, this function returns a single value which is as designed. On failure, the function returns two
values:</p>

<ol>
<li>nil</li>
<li>A string describing the error.</li>
</ol>

<p>This API should not be invoked during OnDriverInit.</p>
<h3 id='signature'>Signature</h3>

<p><code>C4:JsonDecode(json)</code></p>

<table><thead>
<tr>
<th>Parameter</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>json</td>
<td>A string containing the JSON to be decoded.An error will be raised if the string contains invalid JSON. The actual value returned depends on the value of the json parameter and can be any of the following: Number, String, Boolean, Table</td>
</tr>
<tr>
<td>decodeNull</td>
<td>Optional. Boolean flag value indicating how null values are decoded. By default (false), null values are converted to an empty table. A value of true specifies that null values are decoded as a lightuserdata object with a value of null.</td>
</tr>
</tbody></table>

<h3 id='returns'>Returns</h3>

<p>A value decoded from the specified JSON string.</p>

<h3 id='examples'>Examples</h3>

<p>Primitive
<code>C4:JsonDecode(&quot;{&quot;:number:&quot;:42}&quot;)</code></p>

<p>The preceding example will return a Number with the value: 42. In most cases, however, the decoder will return a table. Consider the following code:</p>

<div class="highlight"><pre class="highlight plaintext"><code>Table
local value  = '{"Contents":["Asia", "Africa", "North America", "South America", "Europe", "Australia"]}'
local Foo = C4:JsonDecode(value)

The preceding example produces the following Lua table:

local Foo = {
    "Continent" = {
        "Asia",
        "Africa", 
        "North America", 
        "South America", 
        "Europe", 
        "Australia"
    }
}
</code></pre></div>
<h1 id='log-interface'>Log Interface</h1>

<h1 id='debuglog'>DebugLog</h1>

<p>Function called from DriverWorks driver to send messages to the following log files: director.log and driver.log. This API can be invoked during OnDriverInit.</p>

<p><h6 id='available-from-1-6-0'>Available from 1.6.0</h6><h3 id='signature'>Signature</h3>
<p><code>C4:DebugLog(strLogText)</code></p></p>

<table><thead>
<tr>
<th>Parameters</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>str</td>
<td>Log text</td>
</tr>
</tbody></table>

<h3 id='returns'>Returns</h3>

<p><code>None</code></p>

<h3 id='examples'>Examples</h3><div class="highlight"><pre class="highlight lua tab-lua"><code><span class="k">function</span> <span class="nf">Log</span><span class="p">:</span><span class="n">Alert</span><span class="p">(</span><span class="n">strDebugText</span><span class="p">)</span>
   <span class="n">self</span><span class="p">:</span><span class="n">Print</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">strDebugText</span><span class="p">)</span>
<span class="k">end</span>

<span class="k">function</span> <span class="nf">Log</span><span class="p">:</span><span class="n">Error</span><span class="p">(</span><span class="n">strDebugText</span><span class="p">)</span>
   <span class="n">self</span><span class="p">:</span><span class="n">Print</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">strDebugText</span><span class="p">)</span>
<span class="k">end</span>

<span class="k">function</span> <span class="nf">Log</span><span class="p">:</span><span class="n">Warn</span><span class="p">(</span><span class="n">strDebugText</span><span class="p">)</span>
   <span class="n">self</span><span class="p">:</span><span class="n">Print</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">strDebugText</span><span class="p">)</span>
<span class="k">end</span>

<span class="k">function</span> <span class="nf">Log</span><span class="p">:</span><span class="n">Info</span><span class="p">(</span><span class="n">strDebugText</span><span class="p">)</span>
   <span class="n">self</span><span class="p">:</span><span class="n">Print</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="n">strDebugText</span><span class="p">)</span>
<span class="k">end</span>

<span class="k">function</span> <span class="nf">Log</span><span class="p">:</span><span class="n">Trace</span><span class="p">(</span><span class="n">strDebugText</span><span class="p">)</span>
   <span class="n">self</span><span class="p">:</span><span class="n">Print</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="n">strDebugText</span><span class="p">)</span>
<span class="k">end</span>

<span class="k">function</span> <span class="nf">Log</span><span class="p">:</span><span class="n">Debug</span><span class="p">(</span><span class="n">strDebugText</span><span class="p">)</span>
   <span class="n">self</span><span class="p">:</span><span class="n">Print</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="n">strDebugText</span><span class="p">)</span>
<span class="k">end</span>
</code></pre></div>
<h2 id='errorlog'>ErrorLog</h2>
<p>Function called from DriverWorks driver to send messages to the following log files: director.log and driver.log.</p>
<h6 id='available-from-1-6-0'>Available from 1.6.0</h6><h3 id='signature'>Signature</h3>

<p><code>C4:ErrorLog(strLogText)</code></p>

<h3 id='example'>Example</h3>

<p>Here is an example  using a variable called &quot;lightLevel&quot; to send an error log when a light level exceeds the value of 100:</p>

<div class="highlight"><pre class="highlight lua tab-lua"><code><span class="n">If</span> <span class="p">(</span><span class="n">lightLevel</span> <span class="o">&gt;</span> <span class="mi">100</span><span class="p">)</span> <span class="k">then</span>
   <span class="n">C4</span><span class="p">:</span><span class="n">ErrorLog</span><span class="p">(</span><span class="err">“</span><span class="n">ERROR</span><span class="p">:</span> <span class="n">light</span> <span class="n">level</span> <span class="n">out</span> <span class="n">of</span> <span class="n">range</span><span class="err">”</span><span class="p">)</span>
<span class="k">end</span>
</code></pre></div>
<h1 id='tcpclient-interface'>TCPClient Interface</h1>

<h2 id='createtcpclient'>CreateTCPClient</h2>

<p>Generally, the class cleans up any resources associated with it.  For example, when the object is no longer referenced, it will cleans it up.  However, there are a few exceptions:  When the class is performing an asynchronous operation, e.g. a connect request, it will remain alive until the appropriate event callback function is called. </p>

<p>For instance, if you call the <a href="https://snap-one.github.io/docs-driverworks-api/#connect">Connect</a>() method, the class will remain alive until it either called the <a href="https://snap-one.github.io/docs-driverworks-api/#onconnect">OnConnect</a> (and <a href="https://snap-one.github.io/docs-driverworks-api/#onresolve">OnResolve</a>) callback function, or the <a href="https://snap-one.github.io/docs-driverworks-api/#onerror">OnError</a> callback function, even if your lua code does not have any reference to the class during that time period.  The same applies to the time period between calling one of the Read() methods and the corresponding OnRead() or OnError() callback, and in between calling the Write() method and the OnWrite() or OnError() callback. This API should not be invoked during OnDriverInit.</p>

<h6 id='available-in-1-6-0'>Available in 1.6.0</h6>

<p> </p>

<h3 id='example'>Example</h3><div class="highlight"><pre class="highlight lua tab-lua"><code><span class="k">function</span> <span class="nf">PullHttpPage</span><span class="p">(</span><span class="n">host</span><span class="p">,</span> <span class="n">path</span><span class="p">,</span> <span class="n">timeout</span><span class="p">,</span> <span class="n">done</span><span class="p">)</span>
 <span class="kd">local</span> <span class="n">timer</span>
 <span class="kd">local</span> <span class="n">completed</span> <span class="o">=</span> <span class="kc">false</span>
 <span class="kd">local</span> <span class="n">complete</span> <span class="o">=</span> <span class="k">function</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">errMsg</span><span class="p">)</span>
  <span class="k">if</span> <span class="p">(</span><span class="ow">not</span> <span class="n">completed</span><span class="p">)</span> <span class="k">then</span>
   <span class="n">completed</span> <span class="o">=</span> <span class="kc">true</span>
   <span class="k">if</span> <span class="p">(</span><span class="n">timer</span> <span class="o">~=</span> <span class="kc">nil</span><span class="p">)</span> <span class="k">then</span>
    <span class="n">timer</span><span class="p">:</span><span class="n">Cancel</span><span class="p">()</span>
   <span class="k">end</span>
   <span class="n">done</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">errMsg</span><span class="p">)</span>
  <span class="k">end</span>
 <span class="k">end</span>
 <span class="kd">local</span> <span class="n">readingHeaders</span><span class="p">,</span> <span class="n">needBytes</span><span class="p">,</span> <span class="n">response</span><span class="p">,</span> <span class="n">allReceived</span>
 <span class="kd">local</span> <span class="n">cli</span> <span class="o">=</span> <span class="n">C4</span><span class="p">:</span><span class="n">CreateTCPClient</span><span class="p">()</span>
  <span class="p">:</span><span class="n">OnConnect</span><span class="p">(</span><span class="k">function</span><span class="p">(</span><span class="n">client</span><span class="p">)</span>
   <span class="kd">local</span> <span class="n">remote</span> <span class="o">=</span> <span class="n">client</span><span class="p">:</span><span class="n">GetRemoteAddress</span><span class="p">()</span>
   <span class="nb">print</span><span class="p">(</span><span class="s2">"Connected to "</span> <span class="o">..</span> <span class="n">remote</span><span class="p">.</span><span class="n">ip</span> <span class="o">..</span> <span class="s2">":"</span> <span class="o">..</span> <span class="n">remote</span><span class="p">.</span><span class="n">port</span><span class="p">)</span>
   <span class="n">client</span><span class="p">:</span><span class="n">Write</span><span class="p">(</span><span class="s2">"GET "</span> <span class="o">..</span> <span class="n">path</span> <span class="o">..</span> <span class="s2">" HTTP/1.0\r\nHost: "</span> <span class="o">..</span> <span class="n">host</span> <span class="o">..</span> <span class="s2">"</span><span class="se">\r\n\r\n</span><span class="s2">"</span><span class="p">):</span><span class="n">ReadUntil</span><span class="p">(</span><span class="s2">"</span><span class="se">\r\n</span><span class="s2">"</span><span class="p">)</span>
   <span class="n">readingHeaders</span> <span class="o">=</span> <span class="kc">true</span>
   <span class="n">needBytes</span> <span class="o">=</span> <span class="kc">nil</span>
   <span class="n">response</span> <span class="o">=</span> <span class="s2">""</span>
   <span class="n">allReceived</span> <span class="o">=</span> <span class="kc">false</span>
  <span class="k">end</span><span class="p">)</span>
  <span class="p">:</span><span class="n">OnResolve</span><span class="p">(</span><span class="k">function</span><span class="p">(</span><span class="n">client</span><span class="p">,</span> <span class="n">endpoints</span><span class="p">,</span> <span class="n">choose</span><span class="p">)</span>
   <span class="c1">-- Implementing this callback is optional</span>
   <span class="nb">print</span><span class="p">(</span><span class="s2">"Resolved.  Artificially delay choosing endpoint by one second..."</span><span class="p">)</span>
   <span class="n">C4</span><span class="p">:</span><span class="n">SetTimer</span><span class="p">(</span><span class="mi">1000</span><span class="p">,</span> <span class="k">function</span><span class="p">(</span><span class="n">_</span><span class="p">)</span>
    <span class="c1">--choose(1) -- This would choose the first endpoint in the endpoints array</span>
    <span class="c1">--choose(0) -- Abort the connection request</span>
    <span class="n">choose</span><span class="p">()</span> <span class="c1">-- Default behavior, this chooses the first endpoint (if available)</span>
   <span class="k">end</span><span class="p">)</span>
  <span class="k">end</span><span class="p">)</span>
  <span class="p">:</span><span class="n">OnDisconnect</span><span class="p">(</span><span class="k">function</span><span class="p">(</span><span class="n">client</span><span class="p">,</span> <span class="n">errCode</span><span class="p">,</span> <span class="n">errMsg</span><span class="p">)</span>
   <span class="k">if</span> <span class="p">(</span><span class="n">errCode</span> <span class="o">~=</span> <span class="mi">0</span><span class="p">)</span> <span class="k">then</span>
    <span class="n">complete</span><span class="p">(</span><span class="kc">nil</span><span class="p">,</span> <span class="s2">"Disconnected with error "</span> <span class="o">..</span> <span class="n">errCode</span> <span class="o">..</span> <span class="s2">": "</span> <span class="o">..</span> <span class="n">errMsg</span><span class="p">)</span>
   <span class="k">elseif</span> <span class="p">(</span><span class="n">needBytes</span> <span class="o">==</span> <span class="kc">nil</span><span class="p">)</span> <span class="k">then</span>
    <span class="n">complete</span><span class="p">(</span><span class="kc">nil</span><span class="p">,</span> <span class="s2">"Disconnected and no or invalid response received"</span><span class="p">)</span>
   <span class="k">elseif</span> <span class="p">(</span><span class="n">needBytes</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">then</span>
    <span class="n">complete</span><span class="p">(</span><span class="kc">nil</span><span class="p">,</span> <span class="s2">"Disconnected and received partial response"</span><span class="p">)</span>
   <span class="k">end</span>
  <span class="k">end</span><span class="p">)</span>
  <span class="p">:</span><span class="n">OnRead</span><span class="p">(</span><span class="k">function</span><span class="p">(</span><span class="n">client</span><span class="p">,</span> <span class="n">data</span><span class="p">)</span>
   <span class="k">if</span> <span class="p">(</span><span class="n">readingHeaders</span><span class="p">)</span> <span class="k">then</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">data</span> <span class="o">~=</span> <span class="s2">"</span><span class="se">\r\n</span><span class="s2">"</span><span class="p">)</span> <span class="k">then</span>
     <span class="c1">-- Look for the Content-Length header</span>
     <span class="kd">local</span> <span class="n">sep</span> <span class="o">=</span> <span class="nb">string.find</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="s2">":"</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="kc">true</span><span class="p">)</span>
     <span class="k">if</span> <span class="p">(</span><span class="n">sep</span> <span class="o">~=</span> <span class="kc">nil</span> <span class="ow">and</span> <span class="n">sep</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">)</span> <span class="k">then</span>
      <span class="kd">local</span> <span class="n">header</span> <span class="o">=</span> <span class="nb">string.lower</span><span class="p">(</span><span class="nb">string.sub</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">sep</span> <span class="o">-</span> <span class="mi">1</span><span class="p">))</span>
      <span class="kd">local</span> <span class="n">value</span> <span class="o">=</span> <span class="nb">string.sub</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">sep</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">)</span>
      <span class="k">if</span> <span class="p">(</span><span class="n">header</span> <span class="o">==</span> <span class="s2">"content-length"</span><span class="p">)</span> <span class="k">then</span>
       <span class="n">needBytes</span> <span class="o">=</span> <span class="nb">tonumber</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
      <span class="k">end</span>
     <span class="k">end</span>
     <span class="n">client</span><span class="p">:</span><span class="n">ReadUntil</span><span class="p">(</span><span class="s2">"</span><span class="se">\r\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="k">else</span>
     <span class="n">readingHeaders</span> <span class="o">=</span> <span class="kc">false</span>
     <span class="k">if</span> <span class="p">(</span><span class="n">needBytes</span> <span class="o">~=</span> <span class="kc">nil</span> <span class="ow">and</span> <span class="n">needBytes</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">then</span>
      <span class="c1">-- Got all headers, now read the body</span>
      <span class="n">client</span><span class="p">:</span><span class="n">ReadUpTo</span><span class="p">(</span><span class="n">needBytes</span><span class="p">)</span>
     <span class="k">else</span>
      <span class="c1">-- No body to read</span>
      <span class="n">client</span><span class="p">:</span><span class="n">Close</span><span class="p">()</span>
      <span class="k">if</span> <span class="p">(</span><span class="n">needBytes</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">then</span>
       <span class="n">complete</span><span class="p">(</span><span class="s2">""</span><span class="p">)</span>
      <span class="k">end</span>
     <span class="k">end</span>
    <span class="k">end</span>
   <span class="k">else</span>
    <span class="c1">-- Append the body data</span>
    <span class="n">response</span> <span class="o">=</span> <span class="n">response</span> <span class="o">..</span> <span class="n">data</span>
    <span class="n">needBytes</span> <span class="o">=</span> <span class="n">needBytes</span> <span class="o">-</span> <span class="nb">string.len</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">needBytes</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">then</span>
     <span class="c1">-- We haven't received everything, read more</span>
     <span class="n">client</span><span class="p">:</span><span class="n">ReadUpTo</span><span class="p">(</span><span class="n">needBytes</span><span class="p">)</span>
    <span class="k">else</span>
     <span class="c1">-- We received the entire body</span>
     <span class="n">client</span><span class="p">:</span><span class="n">Close</span><span class="p">()</span>
     <span class="n">complete</span><span class="p">(</span><span class="n">response</span><span class="p">)</span>
    <span class="k">end</span>
   <span class="k">end</span>
    <span class="k">end</span><span class="p">)</span>
  <span class="p">:</span><span class="n">OnError</span><span class="p">(</span><span class="k">function</span><span class="p">(</span><span class="n">client</span><span class="p">,</span> <span class="n">errCode</span><span class="p">,</span> <span class="n">errMsg</span><span class="p">)</span>
   <span class="n">complete</span><span class="p">(</span><span class="kc">nil</span><span class="p">,</span> <span class="s2">"Error "</span> <span class="o">..</span> <span class="n">errCode</span> <span class="o">..</span> <span class="s2">": "</span> <span class="o">..</span> <span class="n">errMsg</span><span class="p">)</span>
  <span class="k">end</span><span class="p">)</span>
  <span class="p">:</span><span class="n">Connect</span><span class="p">(</span><span class="n">host</span><span class="p">,</span> <span class="mi">80</span><span class="p">)</span>
 <span class="k">if</span> <span class="p">(</span><span class="n">timeout</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">then</span>
  <span class="n">timer</span> <span class="o">=</span> <span class="n">C4</span><span class="p">:</span><span class="n">SetTimer</span><span class="p">(</span><span class="n">timeout</span><span class="p">,</span> <span class="k">function</span><span class="p">()</span>
   <span class="n">cli</span><span class="p">:</span><span class="n">Close</span><span class="p">()</span>
   <span class="n">complete</span><span class="p">(</span><span class="kc">nil</span><span class="p">,</span> <span class="s2">"Timed out!"</span><span class="p">)</span>
  <span class="k">end</span><span class="p">)</span>
 <span class="k">end</span>
<span class="k">end</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">"Downloading http://example.com/ ..."</span><span class="p">)</span>
<span class="n">PullHttpPage</span><span class="p">(</span><span class="s2">"example.com"</span><span class="p">,</span> <span class="s2">"/"</span><span class="p">,</span> <span class="mi">5000</span><span class="p">,</span> <span class="k">function</span><span class="p">(</span><span class="n">info</span><span class="p">,</span> <span class="n">err</span><span class="p">)</span>
 <span class="k">if</span> <span class="p">(</span><span class="n">info</span> <span class="o">~=</span> <span class="kc">nil</span><span class="p">)</span> <span class="k">then</span>
  <span class="nb">print</span><span class="p">(</span><span class="s2">"GOT: "</span> <span class="o">..</span> <span class="nb">tostring</span><span class="p">(</span><span class="n">info</span><span class="p">))</span>
 <span class="k">else</span>
  <span class="nb">print</span><span class="p">(</span><span class="s2">"ERROR: "</span> <span class="o">..</span> <span class="n">err</span><span class="p">)</span>
 <span class="k">end</span>
<span class="k">end</span><span class="p">)</span>
</code></pre></div>
<h2 id='close'>Close</h2>
<p>This method closes an established connection, or cancels a pending resolve or connection request. If a resolve or connection request is canceled, the <a href="https://snap-one.github.io/docs-driverworks-api/#onerror">OnError</a> callback function will get called. This API should not be invoked during OnDriverInit. Once you call this method, no more data will be read from the socket and you can no longer write additional data to the socket. Also, the OnWrite callback will not be called anymore, even if the flush argument is set to true.</p>
<h6 id='available-in-1-6-0'>Available in 1.6.0</h6><h3 id='signature'>Signature</h3>

<p><code>C4:Close(flush)</code></p>

<table><thead>
<tr>
<th>Parameters</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>bool</td>
<td>flush: Value that indicates whether any queued-up write requests should be sent out prior to closing the connection.</td>
</tr>
</tbody></table>

<h2 id='connect'>Connect</h2>

<p>This method initiates a connection request to a host and service/port. If a connection request is already in progress, this function returns nil. This API should not be invoked during OnDriverInit.</p>

<p><h6 id='available-in-1-6-0'>Available in 1.6.0</h6><h3 id='signature'>Signature</h3>
<p><code>C4:Connect(host, service)</code></p></p>

<table><thead>
<tr>
<th>Parameters</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>host</td>
<td>IP address or host name to connect to.  It can also be one of these special values: &quot;!local&quot; or &quot;!loopback&quot; Connect over the loopback device service is the port number or a string with the service (e.g. 80 or &quot;http&quot;).</td>
</tr>
</tbody></table>

<p> </p>

<h3 id='returns'>Returns</h3>

<p>This method returns a reference to itself, or nil in case of an error.</p>

<h2 id='getlocaladdress'>GetLocalAddress</h2>

<p>This method returns a table with the IP address and port of the local endpoint. This API should not be invoked during OnDriverInit.</p>

<p><h6 id='available-in-1-6-0'>Available in 1.6.0</h6><h3 id='signature'>Signature</h3>
<p><code>C4:GetLocalAddress()</code></p>
<h3 id='parameters'>Parameters</h3>
<p><code>None</code></p>
<h3 id='returns'>Returns</h3>
<table><thead>
<tr>
<th>Value</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>table</td>
<td>IP address of the local endpoint </td>
</tr>
<tr>
<td></td>
<td>Port number of the local endpoint</td>
</tr>
</tbody></table></p>

<h2 id='getremoteaddress'>GetRemoteAddress</h2>

<p>This method returns a table with the IP address and port of the remote endpoint. This API should not be invoked during OnDriverInit.</p>

<p><h6 id='available-in-1-6-0'>Available in 1.6.0</h6><h3 id='signature'>Signature</h3>
<p><code>C4:GetRemoteAddress()</code></p></p>

<p>Parameters</p>

<p><code>None</code></p>

<h3 id='returns'>Returns</h3>

<table><thead>
<tr>
<th>Value</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>table</td>
<td>IP address of the remote endpoint</td>
</tr>
<tr>
<td></td>
<td>Port number of the remote endpoint</td>
</tr>
</tbody></table>

<h2 id='onconnect'>OnConnect</h2>

<p>This method sets a callback method that will be called once the endpoint has been chosen and the connection is successfully established.</p>

<p><h6 id='available-in-1-6-0'>Available in 1.6.0</h6><h3 id='signature'>Signature</h3>
<p><code>C4:OnConnect(func)</code></p></p>

<table><thead>
<tr>
<th>Parameters</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>func</td>
<td>Function should have this function signature: function(client). The client is this C4LuaTCPClient instance</td>
</tr>
</tbody></table>

<h3 id='returns'>Returns</h3>

<p>This method returns a reference to itself.</p>

<h2 id='ondisconnect'>OnDisconnect</h2>

<p>This method sets a callback method that will be called when the client gets disconnected.</p>

<p><h6 id='available-in-1-6-0'>Available in 1.6.0</h6><h3 id='signature'>Signature</h3>
<p><code>C4:OnDisconnect(func)</code></p></p>

<table><thead>
<tr>
<th>Parameters</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>func</td>
<td>Function should have this function signature:  function (client, errCode, errMsg)</td>
</tr>
</tbody></table>

<h3 id='usage-note'>Usage Note</h3>

<ul>
<li>client is this C4LuaTCPClient instance. </li>
<li>errCode is a number with an error code, if the connection was disconnected due to an error. If the connection was disconnected  gracefully, this value will be 0. </li>
<li>errMsg is a string with a description of the error indicated by errCode. </li>
</ul>

<h3 id='returns'>Returns</h3>

<p>This method returns a reference to itself.</p>

<h2 id='onerror'>OnError</h2>

<p>This method sets a callback method that will be called when an error happens during an asynchronous operation.</p>

<p><h6 id='available-in-1-6-0'>Available in 1.6.0</h6><h3 id='signature'>Signature</h3>
<p><code>C4:OnError(func)</code></p></p>

<table><thead>
<tr>
<th>Parameters</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>func</td>
<td>Function should have this function signature:  function (server, code, msg)</td>
</tr>
</tbody></table>

<h3 id='usage-note'>Usage Note</h3>

<ul>
<li>server is this C4LuaTCPServer instance </li>
<li>code is a number with the system error code </li>
<li>msg is a string with a description of the error </li>
</ul>

<h3 id='returns'>Returns</h3>

<p>This method returns a reference to itself.</p>

<h2 id='onread'>OnRead</h2>

<p>This method sets a callback method that will be called once data has been read on the socket.  If you would like to keep reading more data, you should call one of the Read() methods prior to returning from this callback function.</p>

<p><h6 id='available-in-1-6-0'>Available in 1.6.0</h6><h3 id='signature'>Signature</h3>
<p><code>C4:OnRead(func)</code></p></p>

<table><thead>
<tr>
<th>Parameters</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>func</td>
<td>Function should have this function signature:  function (client, data)</td>
</tr>
</tbody></table>

<h3 id='usage-note'>Usage Note</h3>

<ul>
<li>client is this C4LuaTCPClient instance</li>
<li>data is a string with the data that has been read. This can also be any object if you used the <a href="https://snap-one.github.io/docs-driverworks-api/#readuntil">ReadUntil</a>() method with a custom function that returns an object (e.g. pre-parsed data).</li>
</ul>

<h3 id='returns'>Returns</h3>

<p>This method returns a reference to itself.</p>

<h2 id='onresolve'>OnResolve</h2>

<p>This method sets a callback method that is called once the host/service has been resolved.  If implemented, it allows you to choose a particular endpoint to connect to, or to cancel the connection request.</p>

<p><h6 id='available-in-1-6-0'>Available in 1.6.0</h6><h3 id='signature'>Signature</h3>
<p><code>C4:OnResolve(func)</code></p></p>

<table><thead>
<tr>
<th>Parameters</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>func</td>
<td>Function should have this function signature:  function(client, endpoints, choose)</td>
</tr>
</tbody></table>

<h3 id='usage-note'>Usage Note</h3>

<ul>
<li>client is this C4LuaTCPClient instance</li>
<li>endpoints is an array of endpoint tables, describing all endpoints that the host/service could be resolved to. Each entry has the following fields:  ip (string): The IP address to connect to and  port (number) -  The port number to connect to</li>
<li>choose is a completion function with this signature:</li>
</ul>

<p><code>function([index])</code></p>

<p>Using this closure is optional and can be used to delay making a choice. The index argument is of type number, and it is optional.  If not provided, default behavior is requested (first endpoint, if available). If the index argument is provided, it should be an index into the endpoints array.  If the index argument is 0, the listen request will be canceled and the <a href="https://snap-one.github.io/docs-driverworks-api/#onerror">OnError</a> callback will be called with an invalid argument error (code 22). func may return a number value that describes the index into the endpoints array, which will be the endpoint that the server should listen on. If this value is 0, the listen request will be canceled and the OnError callback will be called with an invalid argument error (code 22). If the function doesn&#39;t return anything, default behavior is chosen unless the choose function is being used to delay making a choice.  Note that if you call the choose function prior to returning from this callback function, that choice will be used rather than whatever the callback may return (if anything). Also, note that modifying the endpoints array (or any table in it) in any way has no effect.|</p>

<h3 id='returns'>Returns</h3>

<p>This method returns a reference to itself.</p>

<h2 id='option'>Option</h2>

<p>This method sets a socket option. This API should not be invoked during OnDriverInit.</p>

<p><h6 id='available-in-1-6-0'>Available in 1.6.0</h6><h3 id='signature'>Signature</h3>
<p><code>C4:Option(name, value[, ...])</code></p></p>

<table><thead>
<tr>
<th>Parameters</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>str</td>
<td>Name is a string specifying the option to set.  It can be one of the following:</td>
</tr>
<tr>
<td></td>
<td>”keepalive&quot;: Enables or disables the socket&#39;s keep-alive option based on the boolean value supplied in the value argument.</td>
</tr>
<tr>
<td></td>
<td>”nodelay&quot;: Enables or disables the socket&#39;s no-delay option based on the boolean value supplied in the value argument.</td>
</tr>
<tr>
<td></td>
<td>”linger&quot;: Enables or disables the sockets&#39; linger option based on the boolean value supplied in the value argument.  This option requires a 3rd argument of type number that indicates the timeout period (in seconds).</td>
</tr>
</tbody></table>

<h3 id='returns'>Returns</h3>

<p>This method returns a reference to itself, or nil in case of an error.</p>

<h2 id='readatleast'>ReadAtLeast</h2>

<p>This method requests to read at least as many bytes as specified by the min argument. Once at least this amount of data is available, all available data is passed to the <a href="https://snap-one.github.io/docs-driverworks-api/#onread">OnRead</a> callback. This API should not be invoked during OnDriverInit.</p>

<p><h6 id='available-in-1-6-0'>Available in 1.6.0</h6><h3 id='signature'>Signature</h3>
<p><code>C4:ReadAtLeast(min)</code></p></p>

<table><thead>
<tr>
<th>Parameters</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>num</td>
<td>Number and must be greater than 0 and is currently limited to 1024 kb</td>
</tr>
</tbody></table>

<h3 id='returns'>Returns</h3>

<p>This method returns a reference to itself, or nil in case of an error.</p>

<h2 id='readuntil'>ReadUntil</h2>

<p>This method requests to read data until a specific condition is met. This API should not be invoked during OnDriverInit.</p>

<p><h6 id='available-in-1-6-0'>Available in 1.6.0</h6><h3 id='signature'>Signature</h3>
<p><code>C4:ReadUntil(arg) </code></p></p>

<table><thead>
<tr>
<th>Parameters</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>arg</td>
<td>arg can be a string, in which case  the read request will be satisfied until this string was read from the socket.  arg can also be a function, which can arbitrarily decide at what point the read request is satisfied:</td>
</tr>
<tr>
<td>arg (str)</td>
<td>All data until (and including) the value of this argument will be passed to the <a href="https://snap-one.github.io/docs-driverworks-api/#onread">OnRead</a>() callback.</td>
</tr>
<tr>
<td>arg (function)</td>
<td>The supplied function should have the following signature: function(data). </td>
</tr>
</tbody></table>

<h3 id='returns'>Returns</h3>

<table><thead>
<tr>
<th>Value</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>bool</td>
<td>indicates whether the matching condition to satisfy the read request was fulfilled</td>
</tr>
<tr>
<td>num</td>
<td>bytes that should be removed from the front of the read buffer, regardless of whether the condition is fulfilled. You should return a value if you returned true as first return value, otherwise the entire data will be discarded.</td>
</tr>
<tr>
<td></td>
<td>The third return value is optional, and if not nil, will be used to replace the data argument of the <a href="https://snap-one.github.io/docs-driverworks-api/#onread">OnRead</a> callback handler.  This is useful if the matching process is already rather expensive (e.g. parsing an XML document), as it allows you to transfer that information directly to the OnRead() callback handler without having to do the same work again.</td>
</tr>
</tbody></table>

<h2 id='readuntiloneof'>ReadUntilOneOf</h2>

<p>This method requests to read data until (and including) one of the bytes in the str argument is encountered. This API should not be invoked during OnDriverInit.</p>

<p><h6 id='available-in-1-6-0'>Available in 1.6.0</h6><h3 id='signature'>Signature</h3>
<p><code>C4:ReadUntilOneOf(str)</code></p></p>

<table><thead>
<tr>
<th>Parameters</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>str</td>
<td>string with all bytes that can trigger a match. This argument cannot be an empty string.</td>
</tr>
</tbody></table>

<h3 id='returns'>Returns</h3>

<p>This method returns a reference to itself, or nil in case of an error.</p>

<h2 id='readuntilonenotof'>ReadUntilOneNotOf</h2>

<p>This method requests to read data until (and including) any byte that is not in the str argument is encountered. This API should not be invoked during OnDriverInit.</p>

<p><h6 id='available-in-1-6-0'>Available in 1.6.0</h6><h3 id='signature'>Signature</h3>
<p><code>C4:ReadUntilOneNotOf(str)</code></p></p>

<table><thead>
<tr>
<th>Parameters</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>str</td>
<td>string with all bytes that can trigger a match. This argument cannot be an empty string.</td>
</tr>
</tbody></table>

<h3 id='returns'>Returns</h3>

<p>This method returns a reference to itself, or nil in case of an error.</p>

<h2 id='readupto'>ReadUpTo</h2>

<p>This method requests to read any available data up to (and including) the number of bytes specified by the max argument.  Once data is available, the OnRead callback will be called with whatever data was available, but no more than the limit specified in the max argument. This API should not be invoked during OnDriverInit</p>

<p><h6 id='available-in-1-6-0'>Available in 1.6.0</h6><h3 id='signature'>Signature</h3>
<p><code>C4:ReadUpTo(max)</code></p></p>

<table><thead>
<tr>
<th>Parameters</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>num</td>
<td>max  is a number and must be greater than 0 and it is currently limited to 4096 kb</td>
</tr>
</tbody></table>

<h3 id='returns'>Returns</h3>

<p>This method returns a reference to itself, or nil in case of an error.</p>
<h1 id='tcpserver-interface'>TCPServer Interface</h1>

<h2 id='createtcpserver'>CreateTCPServer</h2>

<p>This class does not in any way manage or keep track of connected clients.  If you explicitly <a href="https://snap-one.github.io/docs-driverworks-api/#close">Close</a>() the TCP server or it goes out of scope and gets cleaned up by lua&#39;s garbage collector, it does not affect any of the accepted client connections. You can keep track of connected clients by saving them into a map in the OnAccept callback, and setting up a OnDisconnect callback for the connected client connection that removes that client from that map.</p>

<p>Generally, the class cleans up any resources associated with it.  For example, when the object is no longer referenced, it will clean it up.  However, there are a few exceptions:  When the class is performing an asynchronous operation, e.g. a listen request, it will remain alive until the appropriate event callback function is called.  For instance, if you call the <a href="https://snap-one.github.io/docs-driverworks-api/#listen">Listen</a>() method, the class will remain alive until it either called the <a href="https://snap-one.github.io/docs-driverworks-api/#onlisten">OnListen</a> (and <a href="https://snap-one.github.io/docs-driverworks-api/#onresolve">OnResolve</a>) callback function, or the <a href="https://snap-one.github.io/docs-driverworks-api/#onerror">OnError</a> callback function, even if your lua code does not have any reference to the class during that time period.  However, once the OnListen callback was called, the class gets cleaned up unless at that point your lua code somehow references this instance. This API should not be invoked
during OnDriverInit.</p>

<p><h6 id='available-in-1-6-0'>Available in 1.6.0</h6><h3 id='example'>Example</h3>
<p>This is an example of a chat server that accepts a configurable number of clients and shuts the server down after a configurable number of minutes.  It manages all its client connections and shuts them down when the server is being shut down.</p>
<div class="highlight"><pre class="highlight lua tab-lua"><code><span class="kd">local</span> <span class="n">server</span> <span class="o">=</span> <span class="p">{</span>
       <span class="n">clients</span> <span class="o">=</span> <span class="p">{},</span>
       <span class="n">clientsCnt</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
       <span class="c1">--socket = nil,</span>
       <span class="n">notifyOthers</span> <span class="o">=</span> <span class="k">function</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">client</span><span class="p">,</span> <span class="n">message</span><span class="p">)</span>
              <span class="k">for</span> <span class="n">cli</span><span class="p">,</span><span class="n">info</span> <span class="k">in</span> <span class="nb">pairs</span><span class="p">(</span><span class="n">self</span><span class="p">.</span><span class="n">clients</span><span class="p">)</span> <span class="k">do</span>
                     <span class="k">if</span> <span class="p">(</span><span class="n">cli</span> <span class="o">~=</span> <span class="n">client</span> <span class="ow">and</span> <span class="n">info</span><span class="p">.</span><span class="n">name</span> <span class="o">~=</span> <span class="kc">nil</span><span class="p">)</span> <span class="k">then</span>
                           <span class="n">cli</span><span class="p">:</span><span class="n">Write</span><span class="p">(</span><span class="n">message</span> <span class="o">..</span> <span class="s2">&quot;</span><span class="se">\r\n</span><span class="s2">&quot;</span><span class="p">)</span>
                     <span class="k">end</span>
              <span class="k">end</span>
       <span class="k">end</span><span class="p">,</span>
       <span class="n">broadcast</span> <span class="o">=</span> <span class="k">function</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">client</span><span class="p">,</span> <span class="n">message</span><span class="p">)</span>
              <span class="kd">local</span> <span class="n">info</span> <span class="o">=</span> <span class="n">self</span><span class="p">.</span><span class="n">clients</span><span class="p">[</span><span class="n">client</span><span class="p">]</span>
              <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;broadcast for client &quot;</span> <span class="o">..</span> <span class="nb">tostring</span><span class="p">(</span><span class="n">client</span><span class="p">)</span> <span class="o">..</span> <span class="s2">&quot; info: &quot;</span> <span class="o">..</span><span class="nb">tostring</span><span class="p">(</span><span class="n">info</span><span class="p">))</span>
              <span class="k">if</span> <span class="p">(</span><span class="n">info</span> <span class="o">~=</span> <span class="kc">nil</span> <span class="ow">and</span> <span class="n">info</span><span class="p">.</span><span class="n">name</span> <span class="o">~=</span> <span class="kc">nil</span><span class="p">)</span> <span class="k">then</span>
                     <span class="n">self</span><span class="p">:</span><span class="n">notifyOthers</span><span class="p">(</span><span class="n">client</span><span class="p">,</span> <span class="n">info</span><span class="p">.</span><span class="n">name</span> <span class="o">..</span> <span class="s2">&quot; wrote: &quot;</span> <span class="o">..</span> <span class="n">message</span> <span class="o">..</span> <span class="s2">&quot;</span><span class="se">\r\n</span><span class="s2">&quot;</span><span class="p">)</span>
                     <span class="n">client</span><span class="p">:</span><span class="n">Write</span><span class="p">(</span><span class="s2">&quot;You wrote: &quot;</span> <span class="o">..</span> <span class="n">message</span> <span class="o">..</span> <span class="s2">&quot;</span><span class="se">\r\n</span><span class="s2">&quot;</span><span class="p">)</span>
              <span class="k">end</span>
       <span class="k">end</span><span class="p">,</span>
       <span class="n">haveName</span> <span class="o">=</span> <span class="k">function</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">name</span><span class="p">)</span>
              <span class="k">for</span> <span class="n">_</span><span class="p">,</span><span class="n">info</span> <span class="k">in</span> <span class="nb">pairs</span><span class="p">(</span><span class="n">self</span><span class="p">.</span><span class="n">clients</span><span class="p">)</span> <span class="k">do</span>
                     <span class="k">if</span> <span class="p">(</span><span class="n">info</span><span class="p">.</span><span class="n">name</span> <span class="o">~=</span> <span class="kc">nil</span> <span class="ow">and</span> <span class="nb">string.lower</span><span class="p">(</span><span class="n">info</span><span class="p">.</span><span class="n">name</span><span class="p">)</span> <span class="o">==</span> <span class="nb">string.lower</span><span class="p">(</span><span class="n">name</span><span class="p">))</span> <span class="k">then</span>
                           <span class="k">return</span> <span class="kc">true</span>
                     <span class="k">end</span>
              <span class="k">end</span>
              <span class="k">return</span> <span class="kc">false</span>
       <span class="k">end</span><span class="p">,</span>
       <span class="n">stripControlCharacters</span> <span class="o">=</span> <span class="k">function</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">data</span><span class="p">)</span>
              <span class="kd">local</span> <span class="n">ret</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
              <span class="k">for</span> <span class="n">i</span> <span class="k">in</span> <span class="nb">string.gmatch</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="s2">&quot;%C+&quot;</span><span class="p">)</span> <span class="k">do</span>
                     <span class="n">ret</span> <span class="o">=</span> <span class="n">ret</span> <span class="o">..</span> <span class="n">i</span>
              <span class="k">end</span>
              <span class="k">return</span> <span class="n">ret</span>
       <span class="k">end</span><span class="p">,</span>
       <span class="n">stop</span> <span class="o">=</span> <span class="k">function</span><span class="p">(</span><span class="n">self</span><span class="p">)</span>
              <span class="k">if</span> <span class="p">(</span><span class="n">self</span><span class="p">.</span><span class="n">socket</span> <span class="o">~=</span> <span class="kc">nil</span><span class="p">)</span> <span class="k">then</span>
                     <span class="n">self</span><span class="p">.</span><span class="n">socket</span><span class="p">:</span><span class="n">Close</span><span class="p">()</span>
                     <span class="n">self</span><span class="p">.</span><span class="n">socket</span> <span class="o">=</span> <span class="kc">nil</span></p>

<p><span class="c1">-- Make a copy of all clients and reset the map.</span>
                     <span class="c1">-- This ensures that calls to self:broadcast() and self:notifyOthers()</span>
                     <span class="c1">-- during the shutdown process get ignored.  All we want the clients to</span>
                     <span class="c1">-- see is the shutdown message.</span>
                     <span class="kd">local</span> <span class="n">clients</span> <span class="o">=</span> <span class="n">self</span><span class="p">.</span><span class="n">clients</span>
                     <span class="n">self</span><span class="p">.</span><span class="n">clients</span> <span class="o">=</span> <span class="p">{}</span>
                     <span class="n">self</span><span class="p">.</span><span class="n">clientsCnt</span> <span class="o">=</span> <span class="mi">0</span></p>

<p><span class="k">for</span> <span class="n">cli</span><span class="p">,</span><span class="n">info</span> <span class="k">in</span> <span class="nb">pairs</span><span class="p">(</span><span class="n">clients</span><span class="p">)</span> <span class="k">do</span>
                           <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Disconnecting &quot;</span> <span class="o">..</span> <span class="n">cli</span><span class="p">:</span><span class="n">GetRemoteAddress</span><span class="p">().</span><span class="n">ip</span> <span class="o">..</span> <span class="s2">&quot;:&quot;</span> <span class="o">..</span> <span class="n">cli</span><span class="p">:</span><span class="n">GetRemoteAddress</span><span class="p">().</span><span class="n">port</span> <span class="o">..</span> <span class="s2">&quot;: name: &quot;</span> <span class="o">..</span> <span class="nb">tostring</span><span class="p">(</span><span class="n">info</span><span class="p">.</span><span class="n">name</span><span class="p">))</span>
                           <span class="n">cli</span><span class="p">:</span><span class="n">Write</span><span class="p">(</span><span class="s2">&quot;Server is shutting down!\r\n&quot;</span><span class="p">):</span><span class="n">Close</span><span class="p">(</span><span class="kc">true</span><span class="p">)</span>
                     <span class="k">end</span>
              <span class="k">end</span>
       <span class="k">end</span><span class="p">,</span>
       <span class="n">start</span> <span class="o">=</span> <span class="k">function</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">maxClients</span><span class="p">,</span> <span class="n">bindAddr</span><span class="p">,</span> <span class="n">port</span><span class="p">,</span> <span class="n">done</span><span class="p">)</span>
              <span class="kd">local</span> <span class="n">calledDone</span> <span class="o">=</span> <span class="kc">false</span>
              <span class="n">self</span><span class="p">.</span><span class="n">socket</span> <span class="o">=</span> <span class="n">C4</span><span class="p">:</span><span class="n">CreateTCPServer</span><span class="p">()</span>
                     <span class="p">:</span><span class="n">OnResolve</span><span class="p">(</span>
                           <span class="k">function</span><span class="p">(</span><span class="n">srv</span><span class="p">,</span> <span class="n">endpoints</span><span class="p">)</span></p>

<p><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Server &quot;</span> <span class="o">..</span> <span class="nb">tostring</span><span class="p">(</span><span class="n">srv</span><span class="p">)</span> <span class="o">..</span> <span class="s2">&quot; resolved listening address&quot;</span><span class="p">)</span>
                                  <span class="k">for</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="o">#</span><span class="n">endpoints</span> <span class="k">do</span>
                                         <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Available endpoints: [&quot;</span> <span class="o">..</span> <span class="n">i</span> <span class="o">..</span> <span class="s2">&quot;] ip=&quot;</span> <span class="o">..</span> <span class="n">endpoints</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">ip</span> <span class="o">..</span> <span class="s2">&quot;:&quot;</span> <span class="o">..</span> <span class="n">endpoints</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">port</span><span class="p">)</span>
                                  <span class="k">end</span>
                           <span class="k">end</span>
                     <span class="p">)</span>
                     <span class="p">:</span><span class="n">OnListen</span><span class="p">(</span>
                            <span class="k">function</span><span class="p">(</span><span class="n">srv</span><span class="p">,</span> <span class="n">endpoint</span><span class="p">)</span>
                                  <span class="c1">-- Handling this callback is optional.  It merely lets you know that the server is now actually listening.</span>
                                  <span class="kd">local</span> <span class="n">addr</span> <span class="o">=</span> <span class="n">srv</span><span class="p">:</span><span class="n">GetLocalAddress</span><span class="p">()</span>
                                  <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Server &quot;</span> <span class="o">..</span> <span class="nb">tostring</span><span class="p">(</span><span class="n">srv</span><span class="p">)</span> <span class="o">..</span> <span class="s2">&quot; chose endpoint &quot;</span> <span class="o">..</span> <span class="n">endpoint</span><span class="p">.</span><span class="n">ip</span> <span class="o">..</span> <span class="s2">&quot;:&quot;</span> <span class="o">..</span> <span class="n">endpoint</span><span class="p">.</span><span class="n">port</span> <span class="o">..</span> <span class="s2">&quot;, listening on &quot;</span> <span class="o">..</span> <span class="n">addr</span><span class="p">.</span><span class="n">ip</span> <span class="o">..</span> <span class="s2">&quot;:&quot;</span> <span class="o">..</span> <span class="n">addr</span><span class="p">.</span><span class="n">port</span><span class="p">)</span>
                                  <span class="k">if</span> <span class="p">(</span><span class="ow">not</span> <span class="n">calledDone</span><span class="p">)</span> <span class="k">then</span>
                                         <span class="n">calledDone</span> <span class="o">=</span> <span class="kc">true</span>
                                         <span class="n">done</span><span class="p">(</span><span class="kc">true</span><span class="p">,</span> <span class="n">addr</span><span class="p">)</span>
                                  <span class="k">end</span>
                           <span class="k">end</span>
                     <span class="p">)</span>
                     <span class="p">:</span><span class="n">OnError</span><span class="p">(</span>
                           <span class="k">function</span><span class="p">(</span><span class="n">srv</span><span class="p">,</span> <span class="n">code</span><span class="p">,</span> <span class="n">msg</span><span class="p">,</span> <span class="n">op</span><span class="p">)</span>
                                  <span class="c1">-- code is the system error code (as a number)</span>
                                  <span class="c1">-- msg is the error message as a string</span>
                                  <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Server &quot;</span> <span class="o">..</span> <span class="nb">tostring</span><span class="p">(</span><span class="n">srv</span><span class="p">)</span> <span class="o">..</span> <span class="s2">&quot; Error &quot;</span> <span class="o">..</span> <span class="n">code</span> <span class="o">..</span> <span class="s2">&quot; (&quot;</span> <span class="o">..</span> <span class="n">msg</span> <span class="o">..</span> <span class="s2">&quot;)&quot;</span><span class="p">)</span>
                                  <span class="k">if</span> <span class="p">(</span><span class="ow">not</span> <span class="n">calledDone</span><span class="p">)</span> <span class="k">then</span>
                                         <span class="n">calledDone</span> <span class="o">=</span> <span class="kc">true</span>
                                         <span class="n">done</span><span class="p">(</span><span class="kc">false</span><span class="p">,</span> <span class="n">msg</span><span class="p">)</span>
                                  <span class="k">end</span>
                           <span class="k">end</span>
                     <span class="p">)</span>
                     <span class="p">:</span><span class="n">OnAccept</span><span class="p">(</span>
                           <span class="k">function</span><span class="p">(</span><span class="n">srv</span><span class="p">,</span> <span class="n">client</span><span class="p">)</span>
                                  <span class="c1">-- srv is the instance C4:CreateTCPServer() returned</span>
                                  <span class="c1">-- client is a C4LuaTcpClient instance of the new connection that was just accepted</span>
                                  <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Connection on server &quot;</span> <span class="o">..</span> <span class="nb">tostring</span><span class="p">(</span><span class="n">srv</span><span class="p">)</span> <span class="o">..</span> <span class="s2">&quot; accepted, client: &quot;</span> <span class="o">..</span> <span class="nb">tostring</span><span class="p">(</span><span class="n">client</span><span class="p">))</span>
                                  <span class="k">if</span> <span class="p">(</span><span class="n">self</span><span class="p">.</span><span class="n">clientsCnt</span> <span class="o">&gt;=</span> <span class="n">maxClients</span><span class="p">)</span> <span class="k">then</span>
                                         <span class="n">client</span><span class="p">:</span><span class="n">Write</span><span class="p">(</span><span class="s2">&quot;Sorry, I only allow &quot;</span> <span class="o">..</span> <span class="n">maxClients</span> <span class="o">..</span> <span class="s2">&quot; concurrent connections!\r\n&quot;</span><span class="p">):</span><span class="n">Close</span><span class="p">(</span><span class="kc">true</span><span class="p">)</span>
                                         <span class="k">return</span>
                                   <span class="k">end</span>
                                  <span class="kd">local</span> <span class="n">info</span> <span class="o">=</span> <span class="p">{}</span>
                                  <span class="n">self</span><span class="p">.</span><span class="n">clients</span><span class="p">[</span><span class="n">client</span><span class="p">]</span> <span class="o">=</span> <span class="n">info</span>
                                  <span class="n">self</span><span class="p">.</span><span class="n">clientsCnt</span> <span class="o">=</span> <span class="n">self</span><span class="p">.</span><span class="n">clientsCnt</span> <span class="o">+</span> <span class="mi">1</span>
                                  <span class="n">client</span>
                                         <span class="p">:</span><span class="n">OnRead</span><span class="p">(</span>
                                                <span class="k">function</span><span class="p">(</span><span class="n">cli</span><span class="p">,</span> <span class="n">data</span><span class="p">)</span>
                                                       <span class="c1">-- cli is the C4LuaTcpClient instance (same as client in the OnAccept handler) that the data was read on</span>
                                                       <span class="k">if</span> <span class="p">(</span><span class="nb">string.sub</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">)</span> <span class="o">==</span> <span class="s2">&quot;</span><span class="se">\r\n</span><span class="s2">&quot;</span><span class="p">)</span> <span class="k">then</span>
                                                              <span class="c1">-- Need to check if the delimiter exists.  It may not if the client sent data without one and then disconnected!</span>
                                                              <span class="n">data</span> <span class="o">=</span> <span class="nb">string.sub</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">3</span><span class="p">)</span> <span class="c1">-- Cut off \r\n</span>
                                                       <span class="k">end</span>
                                                       <span class="n">data</span> <span class="o">=</span> <span class="n">self</span><span class="p">:</span><span class="n">stripControlCharacters</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
                                                       <span class="k">if</span> <span class="p">(</span><span class="n">info</span><span class="p">.</span><span class="n">name</span> <span class="o">==</span> <span class="kc">nil</span><span class="p">)</span> <span class="k">then</span>
                                                              <span class="k">if</span> <span class="p">(</span><span class="o">#</span><span class="n">data</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">then</span>
                                                                     <span class="k">if</span> <span class="p">(</span><span class="n">self</span><span class="p">:</span><span class="n">haveName</span><span class="p">(</span><span class="n">data</span><span class="p">))</span> <span class="k">then</span>
                                                                           <span class="n">cli</span><span class="p">:</span><span class="n">Write</span><span class="p">(</span><span class="s2">&quot;Choose a different name, please:\r\n&quot;</span><span class="p">)</span>
                                                                     <span class="k">else</span>
                                                                           <span class="n">info</span><span class="p">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">data</span>
                                                                           <span class="n">self</span><span class="p">:</span><span class="n">notifyOthers</span><span class="p">(</span><span class="n">cli</span><span class="p">,</span> <span class="n">info</span><span class="p">.</span><span class="n">name</span> <span class="o">..</span> <span class="s2">&quot; joined!\r\n&quot;</span><span class="p">)</span>
                                                                           <span class="n">cli</span><span class="p">:</span><span class="n">Write</span><span class="p">(</span><span class="s2">&quot;Thank you, &quot;</span> <span class="o">..</span> <span class="n">info</span><span class="p">.</span><span class="n">name</span> <span class="o">..</span> <span class="s2">&quot;! Type &#39;quit&#39; to disconnect.\r\n&quot;</span><span class="p">)</span>
                                                                     <span class="k">end</span>
                                                              <span class="k">else</span>
                                                                     <span class="n">cli</span><span class="p">:</span><span class="n">Write</span><span class="p">(</span><span class="s2">&quot;Please enter your name:\r\n&quot;</span><span class="p">)</span>
                                                              <span class="k">end</span>
                                                              <span class="n">cli</span><span class="p">:</span><span class="n">ReadUntil</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\r\n</span><span class="s2">&quot;</span><span class="p">)</span>
                                                       <span class="k">elseif</span> <span class="p">(</span><span class="n">data</span> <span class="o">==</span> <span class="s2">&quot;quit&quot;</span><span class="p">)</span> <span class="k">then</span>
                                                              <span class="n">cli</span><span class="p">:</span><span class="n">Write</span><span class="p">(</span><span class="s2">&quot;Goodbye, &quot;</span> <span class="o">..</span> <span class="n">info</span><span class="p">.</span><span class="n">name</span> <span class="o">..</span> <span class="s2">&quot;!\r\n&quot;</span><span class="p">):</span><span class="n">Close</span><span class="p">(</span><span class="kc">true</span><span class="p">)</span>
                                                       <span class="k">else</span>
                                                              <span class="k">if</span> <span class="p">(</span><span class="o">#</span><span class="n">data</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">then</span>
                                                                     <span class="n">self</span><span class="p">:</span><span class="n">broadcast</span><span class="p">(</span><span class="n">cli</span><span class="p">,</span> <span class="n">data</span><span class="p">)</span>
                                                              <span class="k">end</span>
                                                              <span class="n">cli</span><span class="p">:</span><span class="n">ReadUntil</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\r\n</span><span class="s2">&quot;</span><span class="p">)</span>
                                                       <span class="k">end</span>
                                                <span class="k">end</span>
                                         <span class="p">)</span>
                                         <span class="p">:</span><span class="n">OnWrite</span><span class="p">(</span>
                                                <span class="k">function</span><span class="p">(</span><span class="n">cli</span><span class="p">)</span>
                                                       <span class="c1">-- cli is the C4LuaTcpClient instance (same as client in the OnAccept handler).  This callback is called when</span>
                                                       <span class="c1">-- all data was sent.</span>
                                                       <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Server &quot;</span> <span class="o">..</span> <span class="nb">tostring</span><span class="p">(</span><span class="n">srv</span><span class="p">)</span> <span class="o">..</span> <span class="s2">&quot; Client &quot;</span> <span class="o">..</span> <span class="nb">tostring</span><span class="p">(</span><span class="n">client</span><span class="p">)</span> <span class="o">..</span> <span class="s2">&quot; Data was sent.&quot;</span><span class="p">)</span>
                                                <span class="k">end</span>
                                         <span class="p">)</span>
                                         <span class="p">:</span><span class="n">OnDisconnect</span><span class="p">(</span>
                                                <span class="k">function</span><span class="p">(</span><span class="n">cli</span><span class="p">,</span> <span class="n">errCode</span><span class="p">,</span> <span class="n">errMsg</span><span class="p">)</span>
                                                       <span class="c1">-- cli is the C4LuaTcpClient instance (same as client in the OnAccept handler) that the data was read on</span>
                                                       <span class="c1">-- errCode is the system error code (as a number).  On a graceful disconnect, this value is 0.</span>
                                                       <span class="c1">-- errMsg is the error message as a string.</span>
                                                       <span class="k">if</span> <span class="p">(</span><span class="n">errCode</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">then</span>
                                                              <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Server &quot;</span> <span class="o">..</span> <span class="nb">tostring</span><span class="p">(</span><span class="n">srv</span><span class="p">)</span> <span class="o">..</span> <span class="s2">&quot; Client &quot;</span> <span class="o">..</span> <span class="nb">tostring</span><span class="p">(</span><span class="n">client</span><span class="p">)</span> <span class="o">..</span> <span class="s2">&quot; Disconnected gracefully.&quot;</span><span class="p">)</span>
                                                       <span class="k">else</span>
                                                              <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Server &quot;</span> <span class="o">..</span> <span class="nb">tostring</span><span class="p">(</span><span class="n">srv</span><span class="p">)</span> <span class="o">..</span> <span class="s2">&quot; Client &quot;</span> <span class="o">..</span> <span class="nb">tostring</span><span class="p">(</span><span class="n">client</span><span class="p">)</span> <span class="o">..</span> <span class="s2">&quot; Disconnected with error &quot;</span> <span class="o">..</span> <span class="n">errCode</span> <span class="o">..</span> <span class="s2">&quot; (&quot;</span> <span class="o">..</span> <span class="n">errMsg</span> <span class="o">..</span> <span class="s2">&quot;)&quot;</span><span class="p">)</span>
                                                       <span class="k">end</span></p>

<p><span class="k">if</span> <span class="p">(</span><span class="n">info</span><span class="p">.</span><span class="n">name</span> <span class="o">~=</span> <span class="kc">nil</span><span class="p">)</span> <span class="k">then</span>
                                                              <span class="n">self</span><span class="p">:</span><span class="n">notifyOthers</span><span class="p">(</span><span class="n">cli</span><span class="p">,</span> <span class="n">info</span><span class="p">.</span><span class="n">name</span> <span class="o">..</span> <span class="s2">&quot; disconnected!\r\n&quot;</span><span class="p">)</span>
                                                       <span class="k">end</span>
                                                       <span class="n">self</span><span class="p">.</span><span class="n">clients</span><span class="p">[</span><span class="n">cli</span><span class="p">]</span> <span class="o">=</span> <span class="kc">nil</span>
                                                       <span class="n">self</span><span class="p">.</span><span class="n">clientsCnt</span> <span class="o">=</span> <span class="n">self</span><span class="p">.</span><span class="n">clientsCnt</span> <span class="o">-</span> <span class="mi">1</span>
                                                <span class="k">end</span>
                                         <span class="p">)</span>
                                         <span class="p">:</span><span class="n">OnError</span><span class="p">(</span>
                                                <span class="k">function</span><span class="p">(</span><span class="n">cli</span><span class="p">,</span> <span class="n">code</span><span class="p">,</span> <span class="n">msg</span><span class="p">,</span> <span class="n">op</span><span class="p">)</span>
                                                       <span class="c1">-- cli is the C4LuaTcpClient instance (same as client in the OnAccept handler) that the data was read on</span>
                                                       <span class="c1">-- code is the system error code (as a number)</span>
                                                       <span class="c1">-- msg is the error message as a string</span>
                                                       <span class="c1">-- op indicates what type of operation failed: &quot;read&quot;, &quot;write&quot;</span>
                                                       <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Server &quot;</span> <span class="o">..</span> <span class="nb">tostring</span><span class="p">(</span><span class="n">srv</span><span class="p">)</span> <span class="o">..</span> <span class="s2">&quot; Client &quot;</span> <span class="o">..</span> <span class="nb">tostring</span><span class="p">(</span><span class="n">client</span><span class="p">)</span> <span class="o">..</span> <span class="s2">&quot; Error &quot;</span> <span class="o">..</span> <span class="n">code</span> <span class="o">..</span> <span class="s2">&quot; (&quot;</span> <span class="o">..</span> <span class="n">msg</span> <span class="o">..</span> <span class="s2">&quot;) on &quot;</span> <span class="o">..</span> <span class="n">op</span><span class="p">)</span>
                                                <span class="k">end</span>
                                         <span class="p">)</span>
                                         <span class="p">:</span><span class="n">Write</span><span class="p">(</span><span class="s2">&quot;Welcome! Please enter your name:\r\n&quot;</span><span class="p">)</span>
                                         <span class="p">:</span><span class="n">ReadUntil</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\r\n</span><span class="s2">&quot;</span><span class="p">)</span>
                           <span class="k">end</span>
                     <span class="p">)</span>
                     <span class="p">:</span><span class="n">Listen</span><span class="p">(</span><span class="n">bindAddr</span><span class="p">,</span> <span class="n">port</span><span class="p">)</span>
              <span class="k">if</span> <span class="p">(</span><span class="n">self</span><span class="p">.</span><span class="n">socket</span> <span class="o">~=</span> <span class="kc">nil</span><span class="p">)</span> <span class="k">then</span>
                     <span class="k">return</span> <span class="n">self</span>
              <span class="k">end</span>
       <span class="k">end</span>
<span class="p">}</span></p>

<p><span class="c1">-- Start the server with a limit of 5 concurrent connections, listen on all interfaces on a randomly available port.  The server will shut down after 10 minutes.</span>
<span class="n">server</span><span class="p">:</span><span class="n">start</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="s2">&quot;<em>&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="k">function</span><span class="p">(</span><span class="n">success</span><span class="p">,</span> <span class="n">info</span><span class="p">)</span>
       <span class="k">if</span> <span class="p">(</span><span class="n">success</span><span class="p">)</span> <span class="k">then</span>
              <span class="kd">local</span> <span class="n">minutes</span> <span class="o">=</span> <span class="mi">10</span>
              <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Server listening on &quot;</span> <span class="o">..</span> <span class="n">info</span><span class="p">.</span><span class="n">ip</span> <span class="o">..</span> <span class="s2">&quot;:&quot;</span> <span class="o">..</span> <span class="n">info</span><span class="p">.</span><span class="n">port</span> <span class="o">..</span> <span class="s2">&quot;. Will stop in &quot;</span> <span class="o">..</span> <span class="n">minutes</span> <span class="o">..</span> <span class="s2">&quot; minutes!&quot;</span><span class="p">)</span>
              <span class="n">C4</span><span class="p">:</span><span class="n">SetTimer</span><span class="p">(</span><span class="n">minutes</span> <span class="o"></em></span> <span class="mi">60</span> <span class="o">*</span> <span class="mi">1000</span><span class="p">,</span> <span class="k">function</span><span class="p">()</span>
                     <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Stopping server and disconnecting clients now.&quot;</span><span class="p">)</span>
                     <span class="n">server</span><span class="p">:</span><span class="n">stop</span><span class="p">()</span>
              <span class="k">end</span><span class="p">)</span>
       <span class="k">else</span>
              <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Could not start server: &quot;</span> <span class="o">..</span> <span class="n">info</span><span class="p">)</span>
       <span class="k">end</span>
<span class="k">end</span><span class="p">)</span>
</code></pre></div>
<h2 id='close'>Close</h2>
<p>This method stops the server socket, or cancels pending resolve or endpoint selection.  If a pending resolve or endpoint selection was canceled, the <a href="https://snap-one.github.io/docs-driverworks-api/#onerror">OnError</a> handler will be called.  However, if the server is already accepting connections, the OnError handler will NOT be called and the server simply ceases to accept further connection requests.  Note that the server does not manage accepted client connections and will not close any of these connections. it it is up to your implementation to manage client connections and how to act when you stop the TCP server.</p>
<h6 id='available-in-1-6-0'>Available in 1.6.0</h6><h3 id='signature'>Signature</h3>
<p><code>C4: Close()</code></p>
<h3 id='parameters'>Parameters</h3>
<p><code>None</code></p>
<h3 id='returns'>Returns</h3>
<p>This method returns a reference to itself, or nil in case of an error.</p></p>

<h2 id='getlocaladdress'>GetLocalAddress</h2>

<p>This method returns a table with the IP address and port that the server is listening on. </p>

<p><h6 id='available-in-1-6-0'>Available in 1.6.0</h6><h3 id='signature'>Signature</h3>
<p><code>C4:GetLocalAddress()</code></p>
<h3 id='parameters'>Parameters</h3>
<p><code>None</code></p>
<h3 id='returns'>Returns</h3>
<table><thead>
<tr>
<th>Value</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>table</td>
<td>IP address that the server is listening on</td>
</tr>
<tr>
<td>port</td>
<td>number  that the server is listening on</td>
</tr>
</tbody></table></p>

<h2 id='listen'>Listen</h2>

<p>This method starts a listen request to listen on a particular host/service.  Once the host/service has been resolved and an endpoint has been chosen, the <a href="https://snap-one.github.io/docs-driverworks-api/#onlisten">OnListen</a> callback function will be called. This indicates that the server is now ready to accept incoming connections.  If errors occur, the <a href="https://snap-one.github.io/docs-driverworks-api/#onerror">OnError</a> callback function will be called instead. This API should not be invoked during OnDriverInit.</p>

<p><h6 id='available-in-1-6-0'>Available in 1.6.0</h6><h3 id='signature'>Signature</h3>
<p><code>C4:Listen(host, service[, backlog])</code></p></p>

<table><thead>
<tr>
<th>Parameters</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>host</td>
<td>IP address or host name to listen on.  It can also be one of these special values: <code>“*&quot;, &quot;!all&quot;, or &quot;!any”</code></td>
</tr>
<tr>
<td>”!local&quot; or &quot;!loopback&quot;</td>
<td>Listens on the loopback device</td>
</tr>
<tr>
<td>service</td>
<td>port number or a string with the service (e.g. 80 or &quot;http&quot;).  If this argument is 0, a random available port will be</td>
</tr>
<tr>
<td>chosen.</td>
<td></td>
</tr>
<tr>
<td>backlog</td>
<td>number indicating the size of the connection accept backlog. This argument is optional</td>
</tr>
</tbody></table>

<h3 id='returns'>Returns</h3>

<p>This method returns a reference to itself, or nil in case of an error.</p>

<h2 id='onaccept'>OnAccept</h2>

<p>This method sets a callback method that will be called whenever a new client connection has been accepted by the TCP server.</p>

<p><h6 id='available-in-1-6-0'>Available in 1.6.0</h6><h3 id='signature'>Signature</h3>
<p><code>C4:OnAccept(func)</code></p></p>

<table><thead>
<tr>
<th>Parameters</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>func</td>
<td>should have this function signature: function(server, client)</td>
</tr>
<tr>
<td>server</td>
<td>server is this C4LuaTCPServer instance</td>
</tr>
<tr>
<td>client</td>
<td>server is this C4LuaTCPServer instance</td>
</tr>
</tbody></table>

<h3 id='returns'>Returns</h3>

<p>This method returns a reference to itself.</p>

<h2 id='onerror'>OnError</h2>

<p>This method sets a callback method that will be called when an error occurs during an asynchronous operation.</p>

<p><h6 id='available-in-1-6-0'>Available in 1.6.0</h6><h3 id='signature'>Signature</h3>
<p><code>C4:OnError(func)</code></p></p>

<table><thead>
<tr>
<th>Parameters</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>func</td>
<td>should have this function signature: function(server, code, msg)</td>
</tr>
<tr>
<td>code</td>
<td>number with the system error code</td>
</tr>
<tr>
<td>msg</td>
<td>string with a description of the error</td>
</tr>
</tbody></table>

<h3 id='returns'>Returns</h3>

<p>This method returns a reference to itself.</p>

<h2 id='onlisten'>OnListen</h2>

<p>This method sets a callback method that will be called once the TCP server starts listening.  This callback is called once the host/service has been resolved and the endpoints has been chosen.  It is optional to implement this callback method.</p>

<p><h6 id='available-in-1-6-0'>Available in 1.6.0</h6><h3 id='signature'>Signature</h3>
<p><code>C4:OnListen(func)</code></p></p>

<table><thead>
<tr>
<th>Parameters</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>func</td>
<td>should have this function signature: function (server, endpoint)</td>
</tr>
<tr>
<td>server</td>
<td>This C4LuaTCPServer instance</td>
</tr>
<tr>
<td>endpoint</td>
<td>Table with the following fields indicating the endpoint the server is listening on:</td>
</tr>
<tr>
<td></td>
<td>ip (string)</td>
</tr>
<tr>
<td></td>
<td>port (number) The port number the server is listening on</td>
</tr>
</tbody></table>

<p><code>Returns</code></p>

<p>This method returns a reference to itself.</p>

<h2 id='onresolve'>OnResolve</h2>

<p>This method sets a callback method that will be called once the host/service has been resolved.  If implemented, it allows you to choose a particular endpoint to listen on, or to cancel the listen request.</p>

<p><h6 id='available-in-1-6-0'>Available in 1.6.0</h6><h3 id='signature'>Signature</h3>
<p><code>C4: OnResolve(func)</code></p></p>

<table><thead>
<tr>
<th>Parameters</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>func</td>
<td>should have this function signature: function (server, endpoints, choose)</td>
</tr>
<tr>
<td>server</td>
<td>This C4LuaTCPServer instance</td>
</tr>
<tr>
<td>endpoints</td>
<td>Array of tables describing all endpoints that the host/service could be resolved to. Each entry has the following:</td>
</tr>
<tr>
<td></td>
<td>ip (string) The IP address the server is listening on</td>
</tr>
<tr>
<td></td>
<td>port (number) The port number the server is listening on</td>
</tr>
</tbody></table>

<p>Note that choose is a completion function with this signature: function(index) Using this closure is optional and can be used to delay making a choice.  The index argument is of type number, and it is optional.  If not provided, default behavior is requested (first endpoint, if available).  If the index argument is provided, it should be an index into the endpoints array.  If the index argument is 0, the listen request will be canceled and the OnError callback will be called with an invalid argument error (code 22).</p>

<h3 id='returns'>Returns</h3>

<p>This method returns a reference to itself.</p>

<h2 id='option'>Option</h2>

<p>This method sets a socket option.</p>

<p><h6 id='available-in-1-6-0'>Available in 1.6.0</h6><h3 id='signature'>Signature</h3>
<p><code>C4:Option(name, value[, ...])</code></p></p>

<table><thead>
<tr>
<th>Parameters</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>name</td>
<td>string specifying the option to set. It can be one of the following:</td>
</tr>
<tr>
<td></td>
<td>”reuseaddr&quot; Enables or disables the socket&#39;s reuse address option based on the boolean value supplied in the value argument.</td>
</tr>
<tr>
<td></td>
<td>”linger&quot;: Enables or disables the sockets&#39; linger option based on the boolean value supplied in the value argument.  This  option requires a 3rd argument of type number that indicates the timeout period (in seconds).</td>
</tr>
</tbody></table>

<h3 id='returns'>Returns</h3>

<p>This method returns a reference to itself.</p>
<h1 id='media-management-albums-interface'>Media Management - Albums Interface</h1>

<h2 id='overview'>Overview</h2>

<p>The examples used in the Albums section of this document will reference the following albums:</p>

<div class="highlight"><pre class="highlight lua tab-lua"><code><span class="n">mediaId1</span> <span class="o">=</span> <span class="n">C4</span><span class="p">:</span><span class="n">MediaAddAlbumInfo</span><span class="p">(</span><span class="s2">"http://127.0.0.1/music/Album1"</span><span class="p">,</span> <span class="s2">"Funky Music"</span><span class="p">,</span> <span class="n">Album1</span><span class="p">)</span>

<span class="n">songLocation1</span><span class="o">=</span><span class="s2">"http://127.0.0.1/music/song1.mp3"</span>
<span class="n">songLocation2</span><span class="o">=</span><span class="s2">"http://127.0.0.1/music/song2.mp3"</span>
<span class="n">songLocation3</span><span class="o">=</span><span class="s2">"http://127.0.0.1/music/song3.mp3"</span>

<span class="n">SomeSong1</span> <span class="o">=</span> <span class="p">{</span>
<span class="c1">--required fields</span>
<span class="o">=</span><span class="s2">"Title Test Song Number 1"</span><span class="p">,</span>
<span class="n">location</span><span class="o">=</span><span class="n">songLocation1</span><span class="p">,</span>
<span class="n">track_no</span><span class="o">=</span><span class="s2">"6"</span><span class="p">,</span>
<span class="c1">--optional fields</span>
<span class="n">name</span> <span class="o">=</span> <span class="s2">"Name Test Song Number 1"</span><span class="p">,</span>
<span class="n">artist</span> <span class="o">=</span> <span class="s2">"C4 Music Factory"</span><span class="p">,</span>
<span class="n">record_label</span><span class="o">=</span><span class="s2">"Island"</span><span class="p">,</span>
<span class="n">release_date</span><span class="o">=</span><span class="s2">"15 Jun 2004"</span><span class="p">,</span>
<span class="p">}</span>

<span class="n">SomeSong2</span> <span class="o">=</span> <span class="p">{</span>
<span class="n">title</span><span class="o">=</span><span class="s2">"Test Song Number 2"</span><span class="p">,</span>
<span class="n">location</span><span class="o">=</span><span class="n">songLocation2</span><span class="p">,</span>
<span class="n">track_no</span><span class="o">=</span><span class="s2">"1"</span><span class="p">,</span>
<span class="n">name</span> <span class="o">=</span> <span class="s2">"Name Test Song Number 2"</span><span class="p">,</span>
<span class="n">artist</span> <span class="o">=</span> <span class="s2">"C4 Music Factory"</span><span class="p">,</span>
<span class="n">record_label</span><span class="o">=</span><span class="s2">"Dos Record Label"</span><span class="p">,</span>
<span class="n">release_date</span><span class="o">=</span><span class="s2">"15 Jun 2222"</span><span class="p">,</span>
<span class="p">}</span>

<span class="n">SomeSong3</span> <span class="o">=</span> <span class="p">{</span>
<span class="n">title</span><span class="o">=</span><span class="s2">"Test Song Number 3"</span><span class="p">,</span>
<span class="n">track_no</span><span class="o">=</span><span class="s2">"7"</span><span class="p">,</span>
<span class="n">location</span><span class="o">=</span><span class="n">songLocation3</span><span class="p">,</span>
<span class="n">name</span> <span class="o">=</span> <span class="s2">"Name Test Song Number 3"</span><span class="p">,</span>
<span class="n">artist</span> <span class="o">=</span> <span class="s2">"C4 Music Factory"</span><span class="p">,</span>
<span class="n">record_label</span><span class="o">=</span><span class="s2">"Boat"</span><span class="p">,</span>
<span class="n">release_date</span><span class="o">=</span><span class="s2">"3 Dec 2002"</span><span class="p">,</span>
<span class="p">}</span>

<span class="n">Album1</span> <span class="o">=</span> <span class="p">{</span>
<span class="n">artist</span> <span class="o">=</span> <span class="s2">"Jimmy Joe"</span><span class="p">,</span>
<span class="n">description</span> <span class="o">=</span> <span class="s2">"Worst episode ever"</span><span class="p">,</span>
<span class="n">genre</span> <span class="o">=</span> <span class="s2">"Blues &amp; Browns"</span><span class="p">,</span>
<span class="n">release_date</span> <span class="o">=</span> <span class="s2">"1992"</span><span class="p">,</span>
<span class="n">release_label</span> <span class="o">=</span> <span class="s2">"Grass and Cash"</span><span class="p">,</span>
<span class="n">songs</span> <span class="o">=</span> <span class="p">{</span><span class="n">SomeSong1</span><span class="p">,</span> <span class="n">SomeSong2</span><span class="p">,</span> <span class="n">SomeSong3</span><span class="p">},</span> 
<span class="p">}</span>
</code></pre></div>

<h2 id='mediaaddalbuminfo'>MediaAddAlbumInfo</h2>

<p>This API should not be invoked during OnDriverInit.</p>

<p><h6 id='available-from-1-6-0'>Available from 1.6.0</h6><h3 id='signature'>Signature</h3>
<p><code>C4:MediaAddAlbumInfo ()</code></p></p>

<table><thead>
<tr>
<th>Parameters</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>str</td>
<td>location</td>
</tr>
<tr>
<td>str</td>
<td>title</td>
</tr>
<tr>
<td>table</td>
<td>Songs information is required. Table must contain the songs you want added to the album.</td>
</tr>
<tr>
<td>data</td>
<td>Data from MediaGetSongInfo: required fields are: <code>title, location, track_no</code> unique for that table</td>
</tr>
</tbody></table>

<h3 id='returns'>Returns</h3>

<table><thead>
<tr>
<th>Value</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>num</td>
<td>The new Media ID for the movie</td>
</tr>
</tbody></table>

<h3 id='example'>Example</h3>

<p><code>mediaId = C4:MediaAddAlbumInfo(&quot;http://127.0.0.1/music/Album1&quot;, &quot;Funky Music&quot;, Album1)</code></p>

<h2 id='mediagetalbuminfo'>MediaGetAlbumInfo</h2>

<p>This API should not be invoked during OnDriverInit.</p>

<p><h6 id='available-from-1-6-0'>Available from 1.6.0</h6><h3 id='signature'>Signature</h3>
<p><code>C4: MediaGetAlbumInfo</code></p></p>

<table><thead>
<tr>
<th>Parameters</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>num</td>
<td>This is the Media ID of the album.</td>
</tr>
</tbody></table>

<p><code>Returns</code></p>

<table><thead>
<tr>
<th>Value</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>str</td>
<td>location</td>
</tr>
<tr>
<td>str</td>
<td>title</td>
</tr>
<tr>
<td>table</td>
<td>Table information. The table may have entries for:</td>
</tr>
<tr>
<td></td>
<td>artist</td>
</tr>
<tr>
<td></td>
<td>record label</td>
</tr>
<tr>
<td></td>
<td>release date</td>
</tr>
<tr>
<td></td>
<td>description</td>
</tr>
<tr>
<td></td>
<td>genre</td>
</tr>
<tr>
<td></td>
<td>cover_art – this is a base64 encoded JPEG file of the cover art.</td>
</tr>
<tr>
<td></td>
<td>songs – an array of songs. Each song is a table, and must contain entries for</td>
</tr>
<tr>
<td></td>
<td>name</td>
</tr>
<tr>
<td></td>
<td>track number</td>
</tr>
<tr>
<td></td>
<td>location</td>
</tr>
</tbody></table>

<h3 id='example'>Example</h3><div class="highlight"><pre class="highlight lua tab-lua"><code><span class="n">MyAlbumInfo</span><span class="o">=</span> <span class="n">C4</span><span class="p">:</span><span class="n">MediaGetAlbumInfo</span><span class="p">(</span><span class="n">mediaId1</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">MyAlbumInfo</span><span class="p">[</span><span class="s2">"name"</span><span class="p">])</span>
</code></pre></div>
<h2 id='mediagetalbumlocation'>MediaGetAlbumLocation</h2>
<p>This API should not be invoked during OnDriverInit.</p>
<h6 id='available-from-1-6-0'>Available from 1.6.0</h6><h3 id='signature'>Signature</h3>

<p><code>C4: MediaGetAlbumLocations() </code></p>

<table><thead>
<tr>
<th>Parameters</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>num</td>
<td>The Media ID of the album.</td>
</tr>
</tbody></table>

<p><code>Returns</code></p>

<table><thead>
<tr>
<th>Value</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>str</td>
<td>The location of this media as stored in the database.</td>
</tr>
</tbody></table>

<h3 id='example'>Example</h3>

<p><code>print(C4:MediaGetAlbumLocation(mediaId1)) </code></p>

<h2 id='mediagetallalbums'>MediaGetAllAlbums</h2>

<p>This API should not be invoked during OnDriverInit.</p>

<p><h6 id='available-from-1-6-0'>Available from 1.6.0</h6><h3 id='signature'>Signature</h3>
<p><code>C4:MediaGetAllAlbums() </code></p></p>

<p>Parameters</p>

<p><code>None</code></p>

<p><code>Returns</code></p>

<table><thead>
<tr>
<th>Value</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>Table</td>
<td>Table containing Media IDs and locations.</td>
</tr>
</tbody></table>

<h3 id='example'>Example</h3><div class="highlight"><pre class="highlight lua tab-lua"><code><span class="n">Example</span>
<span class="n">allAlbums</span> <span class="o">=</span> <span class="n">C4</span><span class="p">:</span><span class="n">MediaGetAllAlbums</span><span class="p">()</span>
<span class="k">for</span> <span class="n">key</span><span class="p">,</span><span class="n">value</span> <span class="k">in</span> <span class="nb">pairs</span><span class="p">(</span><span class="n">allAlbums</span><span class="p">)</span> <span class="k">do</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">"mediaId is "</span><span class="o">..</span><span class="n">key</span><span class="o">..</span> <span class="s2">" location is "</span><span class="o">..</span><span class="n">value</span><span class="p">)</span>
<span class="k">end</span>
</code></pre></div>
<h2 id='mediaremovealbum'>MediaRemoveAlbum</h2>
<p>This API should not be invoked during OnDriverInit.</p>
<h6 id='available-from-1-6-0'>Available from 1.6.0</h6><h3 id='signature'>Signature</h3>

<p><code>C4:MediaRemoveAlbum() </code></p>

<table><thead>
<tr>
<th>Parameters</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>num</td>
<td>The Media ID of the album.  Note, all songs associated with this album will be removed as well.</td>
</tr>
</tbody></table>

<h3 id='returns'>Returns</h3>

<p><code>None</code></p>

<h3 id='example'>Example</h3>

<p><code>C4:MediaRemoveAlbum(mediaId1)</code></p>

<h2 id='mediaremoveallalbums'>MediaRemoveAllAlbums</h2>

<p>This API should not be invoked during OnDriverInit.</p>

<p><h6 id='available-from-1-6-0'>Available from 1.6.0</h6><h3 id='signature'>Signature</h3>
<p><code>C4: MediaRemoveAllAlbums() </code></p>
<h3 id='parameter'>Parameter</h3>
<p><code>None</code></p>
<h3 id='returns'>Returns</h3>
<p><code>None</code></p>
<h3 id='example'>Example</h3>
<p><code>C4:MediaRemoveAllAlbums()</code></p></p>

<h2 id='mediamodifyalbuminfo'>MediaModifyAlbumInfo</h2>

<p>This API should not be invoked during OnDriverInit.</p>

<p><h6 id='available-from-1-6-0'>Available from 1.6.0</h6><h3 id='signature'>Signature</h3>
<p><code>C4:MediaModifyAlbumInfo() </code></p></p>

<table><thead>
<tr>
<th>Parameters</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>num</td>
<td>media ID</td>
</tr>
<tr>
<td>str</td>
<td>location</td>
</tr>
<tr>
<td>str</td>
<td>name</td>
</tr>
<tr>
<td>table</td>
<td>Song information is required. Table must contain the songs you want added to the album.</td>
</tr>
<tr>
<td></td>
<td>Song Table info: data from  MediaGetSongInfo. Required fields are title, location and track number unique for that table.</td>
</tr>
</tbody></table>

<h3 id='returns'>Returns</h3>

<p><code>None</code></p>

<h3 id='usage-note'>Usage Note</h3>

<p>Usage Note:A modify call does not change the media’s ID number where a delete or add call will. Modify calls are useful if programming relies on the current Media ID. For example, if a button push is programmed to play the media, and a modify call is used, the media’s current ID is maintained and programming is not impacted.</p>

<p><h3 id='example'>Example</h3><div class="highlight"><pre class="highlight lua tab-lua"><code><span class="n">C4</span><span class="p">:</span><span class="n">MediaModifyAlbumInfo</span><span class="p">(</span><span class="n">mediaId1</span><span class="p">,</span><span class="s2">&quot;http://127.0.0.1/music/Album1M
&quot;</span><span class="n">Modified</span><span class="s2">&quot;,&quot;</span><span class="n">Some</span> <span class="n">New</span> <span class="n">Name</span><span class="s2">&quot;, Album1)
</span></code></pre></div></p>
<h1 id='media-management-broadcast-video-interface'>Media Management - Broadcast Video Interface</h1>

<h2 id='mediaaddbroadcastvideoinfo'>MediaAddBroadcastVideoInfo</h2>

<p>This function is used to add a new broadcast video station media entry. This API should not be invoked during OnDriverInit.  </p>

<p><h6 id='available-from-1-6-0'>Available from 1.6.0</h6><h3 id='signature'>Signature</h3>
<p><code>C4:MediaAddBroadcastVideoInfo()</code></p></p>

<table><thead>
<tr>
<th>Parameters</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>str</td>
<td>location</td>
</tr>
<tr>
<td>str</td>
<td>title</td>
</tr>
<tr>
<td>table</td>
<td>The table will have key of the media id and the stations locations as the values</td>
</tr>
</tbody></table>

<h3 id='returns'>Returns</h3>

<table><thead>
<tr>
<th>Value</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>num</td>
<td>The new Media ID for the station</td>
</tr>
</tbody></table>

<h3 id='example'>Example</h3>

<p><code>mediaId1 = C4:MediaAddBroadcastVideoInfo(&quot;https://kutv.com/watch,&quot;KUTV&quot;,bcVideoKUTV)</code></p>

<h2 id='mediagetallbroadcastvideo'>MediaGetAllBroadcastVideo</h2>

<p>This function is used to retrieve all the broadcast video stations associated with this device. This API should not be invoked during OnDriverInit.</p>

<p><h6 id='available-from-1-6-0'>Available from 1.6.0</h6><h3 id='signature'>Signature</h3>
<p><code>C4:MediaGetAllBroadcastVideo() </code></p></p>

<p>Parameters</p>

<p><code>None</code></p>

<p><code>Returns</code></p>

<table><thead>
<tr>
<th>Values</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>Table</td>
<td>Table containing Media IDs and the stations locations as the values.</td>
</tr>
</tbody></table>

<h3 id='example'>Example</h3><div class="highlight"><pre class="highlight lua tab-lua"><code><span class="kd">local</span> <span class="n">stations</span> <span class="o">=</span> <span class="n">C4</span><span class="p">:</span><span class="n">MediaGetAllBroadcastVideo</span><span class="p">()</span>
  <span class="k">for</span> <span class="n">mediId</span><span class="p">,</span><span class="n">loc</span> <span class="k">in</span> <span class="nb">pairs</span><span class="p">(</span><span class="n">stations</span><span class="p">)</span> <span class="k">do</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">"id "</span> <span class="o">..</span> <span class="n">mediId</span> <span class="o">..</span> <span class="s2">" location "</span> <span class="o">..</span> <span class="n">loc</span><span class="p">)</span>
<span class="k">end</span>
</code></pre></div>
<h2 id='mediagetbroadcastvideoinfo'>MediaGetBroadcastVideoInfo</h2>
<p>This function is used to get information about an existing broadcast audio media entry. This API should not be invoked during OnDriverInit.</p>
<h6 id='available-from-1-6-0'>Available from 1.6.0</h6><h3 id='signature'>Signature</h3>

<p><code>C4:MediaGetBroadcastVideoInfo() </code></p>

<table><thead>
<tr>
<th>Parameters</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>num</td>
<td>media ID of the station</td>
</tr>
<tr>
<td>str</td>
<td>location</td>
</tr>
<tr>
<td>str</td>
<td>name</td>
</tr>
</tbody></table>

<h3 id='returns'>Returns</h3>

<table><thead>
<tr>
<th>Value</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>str</td>
<td>location</td>
</tr>
<tr>
<td>str</td>
<td>genre</td>
</tr>
<tr>
<td>str</td>
<td>description</td>
</tr>
<tr>
<td>str</td>
<td>name</td>
</tr>
<tr>
<td>str</td>
<td>image.  this is a base64 encoded JPEG file of the cover art.</td>
</tr>
</tbody></table>

<h3 id='example'>Example</h3><div class="highlight"><pre class="highlight lua tab-lua"><code><span class="n">myStationInfo</span> <span class="o">=</span> <span class="n">C4</span><span class="p">:</span><span class="n">MediaGetBroadcastVideoInfo</span><span class="p">(</span><span class="n">mediaId1</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">myStationInfo</span><span class="p">[</span><span class="err">“</span><span class="n">name</span><span class="err">”</span><span class="p">])</span>
</code></pre></div>
<h2 id='mediamodifybroadcastvideoinfo'>MediaModifyBroadcastVideoInfo</h2>
<p>Modifies a broadcast video channel.  This API should not be invoked during OnDriverInit.</p>
<h6 id='available-from-1-6-0'>Available from 1.6.0</h6><h3 id='signature'>Signature</h3>

<p><code>C4:MediaModifyBroadcastVideoInfo() </code></p>

<table><thead>
<tr>
<th>Parameters</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>str</td>
<td>location</td>
</tr>
<tr>
<td>str</td>
<td>name</td>
</tr>
<tr>
<td>table</td>
<td>The table will have key of location, name, description and genre of the broadcast video channel modifications.</td>
</tr>
</tbody></table>

<h3 id='returns'>Returns</h3>

<p><code>None</code></p>

<h3 id='usage-note'>Usage Note</h3>

<p>A modify call does not change the media’s ID number where a delete or add call will. Modify calls are useful if programming relies on the current Media ID. For example, if a button push has is programmed to play the media, and a modify call is used, the media’s current ID is maintained and programming is not impacted.</p>

<h2 id='mediaremovebroadcastvideo'>MediaRemoveBroadcastVideo</h2>

<p>This function is used to remove a video station from the system.  This API should not be invoked during OnDriverInit.</p>

<p><h6 id='available-from-1-6-0'>Available from 1.6.0</h6><h3 id='signature'>Signature</h3>
<p><code>C4:MediaRemoveBroadcastVideo() </code></p></p>

<table><thead>
<tr>
<th>Parameters</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>num</td>
<td>The Media ID of the station to remove.</td>
</tr>
</tbody></table>

<h3 id='returns'>Returns</h3>

<p><code>None</code></p>

<h3 id='example'>Example</h3>

<p><code>C4:MediaRemoveBroadcastVideo(mediaId1)</code></p>
<h1 id='media-management-generic-interface'>Media Management - Generic Interface</h1>

<h2 id='mediagetdevicecontext'>MediaGetDeviceContext</h2>

<p>Function that returns the what the device context is currently set to.  If “0” then all media APIs are using the current driver’s device id. This API should not be invoked during OnDriverInit.</p>

<p><h6 id='available-from-1-6-0'>Available from 1.6.0</h6><h3 id='signature'>Signature</h3>
<p><code>C4:MediaGetDeviceContext)</code></p></p>

<p>Parameters</p>

<p><code>None</code></p>

<h3 id='returns'>Returns</h3>

<table><thead>
<tr>
<th>Value</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>num</td>
<td>Driver Device ID</td>
</tr>
</tbody></table>

<h3 id='example'>Example</h3><div class="highlight"><pre class="highlight lua tab-lua"><code>
<span class="kd">local</span> <span class="n">contextId</span> <span class="o">=</span> <span class="n">C4</span><span class="p">:</span><span class="n">MediaGetDeviceContext</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">"context is: "</span> <span class="o">..</span> <span class="n">contextId</span><span class="p">)</span>

<span class="n">prints</span><span class="p">:</span> <span class="n">context</span> <span class="n">is</span><span class="p">:</span> <span class="mi">391</span>
</code></pre></div>
<h2 id='mediaremoveallmedia'>MediaRemoveAllMedia</h2>
<p>Removes all albums songs and movies from the device. This API should not be invoked during OnDriverInit.</p>
<h6 id='available-from-1-6-0'>Available from 1.6.0</h6><h3 id='signature'>Signature</h3>

<p><code>C4:MediaRemoveAllMedia)</code></p>

<h3 id='parameters'>Parameters</h3>

<p><code>None</code></p>

<h2 id='mediasetdevicecontext'>MediaSetDeviceContext</h2>

<p>Function that sets a device id to be used for media related call.  If set to any value other than “0” then adding, modifying, retrieving or removing functionality will use the supplied device id. Note that this API must be called in the OnDriverLateInit area of the device driver.</p>

<p><h6 id='available-from-1-6-0'>Available from 1.6.0</h6><h3 id='signature'>Signature</h3>
<p><code>C4:MediaSetDeviceContext()</code></p></p>

<table><thead>
<tr>
<th>Parameters</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>num</td>
<td>New device id to be associated with media related api’s. </td>
</tr>
</tbody></table>

<h3 id='usage-note'>Usage Note</h3>

<p>If the number parameter is set to “0” then the media related APIs will use the current driver’s device id. </p>
<h1 id='media-management-miscellaneous-interface'>Media Management - Miscellaneous Interface</h1>

<h2 id='receiver-with-onscreen-binding'>Receiver with Onscreen Binding</h2>

<p>To enable a receiver to be capable of being the onscreen device, add the following to your &lt;connections&gt; section of your driver.  This will then allow the room&#39;s onscreen input to be hooked up to the receiver’s output.  Note that for the sections to be valid, a video path must also exist (the room must also be able to select the receiver as the video endpoint).</p>

<p><h3 id='example'>Example</h3><div class="highlight"><pre class="highlight lua tab-lua"><code><span class="o">&lt;</span><span class="n">connection</span><span class="o">&gt;</span>
    <span class="o">&lt;</span><span class="n">id</span><span class="o">&gt;</span><span class="mi">7500</span><span class="o">&lt;/</span><span class="n">id</span><span class="o">&gt;</span>
    <span class="o">&lt;</span><span class="n">facing</span><span class="o">&gt;</span><span class="mi">6</span><span class="o">&lt;/</span><span class="n">facing</span><span class="o">&gt;</span>
    <span class="o">&lt;</span><span class="n">connectionname</span><span class="o">&gt;</span><span class="n">OnscreenNavigator</span><span class="o">&lt;/</span><span class="n">connectionname</span><span class="o">&gt;</span>
    <span class="o">&lt;</span><span class="nb">type</span><span class="o">&gt;</span><span class="mi">7</span><span class="o">&lt;/</span><span class="nb">type</span><span class="o">&gt;</span>
    <span class="o">&lt;</span><span class="n">consumer</span><span class="o">&gt;</span><span class="n">False</span><span class="o">&lt;/</span><span class="n">consumer</span><span class="o">&gt;</span>
    <span class="o">&lt;</span><span class="n">audiosource</span><span class="o">&gt;</span><span class="n">False</span><span class="o">&lt;/</span><span class="n">audiosource</span><span class="o">&gt;</span>
    <span class="o">&lt;</span><span class="n">videosource</span><span class="o">&gt;</span><span class="n">False</span><span class="o">&lt;/</span><span class="n">videosource</span><span class="o">&gt;</span>
    <span class="o">&lt;</span><span class="n">linelevel</span><span class="o">&gt;</span><span class="n">False</span><span class="o">&lt;/</span><span class="n">linelevel</span><span class="o">&gt;</span>
   <span class="o">&lt;</span><span class="n">classes</span><span class="o">&gt;</span>
    <span class="o">&lt;</span><span class="n">class</span><span class="o">&gt;</span>
      <span class="o">&lt;</span><span class="n">classname</span><span class="o">&gt;</span><span class="n">ONSCREEN_SELECTION</span><span class="o">&lt;/</span><span class="n">classname</span><span class="o">&gt;</span>
    <span class="o">&lt;/</span><span class="n">class</span><span class="o">&gt;</span>
  <span class="o">&lt;/</span><span class="n">classes</span><span class="o">&gt;</span>
<span class="o">&lt;/</span><span class="n">connection</span><span class="o">&gt;</span>
</code></pre></div>
<h2 id='sending-room-keypress-commands-from-receiver-driver'>Sending Room Keypress Commands from Receiver Driver</h2><div class="highlight"><pre class="highlight lua tab-lua"><code><span class="err"><code>&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;roomId&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;C4&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;RoomGetId&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;&lt;span class=&quot;err&quot;&gt;</code></span>
    <span class="err"><code>&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;tParams&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{}&lt;/span&gt;&lt;span class=&quot;err&quot;&gt;</code></span>
    <span class="err"><code>&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;tParams&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{}&lt;/span&gt;&lt;span class=&quot;err&quot;&gt;</code></span>
<span class="err"><code>&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;-- send 1 keypress to the room’s currently selected device&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Note that commands not recognized by the room and director will still be sent through to the selected proxy device. The proxy may filter out unknown commands or it may still forward them to the protocol driver.&lt;/p&gt;
&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight lua tab-lua&quot;&gt;&lt;code&gt;&lt;span class=&quot;err&quot;&gt;</code></span><span class="n">roomId</span> <span class="o">=</span> <span class="n">C4</span><span class="p">:</span><span class="n">RoomGetId</span><span class="p">()</span>
<span class="err"><code>&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;tParams&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{}&lt;/span&gt;
&lt;span class=&quot;err&quot;&gt;</code></span><span class="c1">-- send 1 keypress to the room’s currently selected device</span>
<span class="err"><code>&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;C4&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;SendToDevice&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;roomId&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;FOO&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tParams&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;err&quot;&gt;</code></span>
</code></pre></div>
<p>Output from Media Player driver when receiver driver sent above commands:</p>
<div class="highlight"><pre class="highlight lua tab-lua"><code><span class="err"><code>&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ReceivedFromProxy&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;called&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;mediaplayer&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;xbmc&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;with&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;command&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;PAUSE&lt;/span&gt;&lt;span class=&quot;err&quot;&gt;</code></span>
<span class="err"><code>&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;..&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Parameter&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;ROOM&lt;/span&gt;&lt;span class=&quot;err&quot;&gt;\&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;_ID&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;with&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;value&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;39&lt;/span&gt;
&lt;span class=&quot;err&quot;&gt;</code></span><span class="n">Received</span> <span class="n">Action</span> <span class="n">Response</span> <span class="n">action</span> <span class="n">id</span><span class="o">=</span><span class="mi">12</span> <span class="n">erroCode</span><span class="o">=</span><span class="mi">0</span>
<span class="err"><code>&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;position&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;value&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;
&lt;span class=&quot;err&quot;&gt;</code></span><span class="n">ReceivedFromProxy</span> <span class="n">called</span> <span class="k">for</span> <span class="n">mediaplayer</span> <span class="n">xbmc</span> <span class="n">with</span> <span class="n">command</span><span class="p">:</span><span class="n">FOO</span>
<span class="err">`</span><span class="o">..</span><span class="n">Parameter</span><span class="p">:</span> <span class="n">ROOM</span><span class="err">&lt;/span&gt;<span class="n">_ID</span> <span class="n">with</span> <span class="n">value</span><span class="p">:</span> <span class="mi">39</span>
</code></pre></div></p>
<h1 id='media-management-movies-interface'>Media Management - Movies Interface</h1>

<h2 id='overview'>Overview</h2>

<p>The examples used in the Movies section of this document will reference the following movie:</p>

<div class="highlight"><pre class="highlight plaintext"><code>
shrekMovie = {
  directors = "Andrew Adamson; Vicky Jenson",
  description = "In this fully computer-animated fantasy",
  cast = "Mike Myers; Eddie Murphy; John Lithgow",
  rating = "",
  genre = "Children's/Family",
  release_date = "2001",
  release_company = "DreamWorks",
  cover_art = "/9j/4AAQSkZJRgABAQEBLAEsAAD/"
}
</code></pre></div>

<h2 id='mediaaddmovieinfo'>MediaAddMovieInfo</h2>

<p>This API should not be invoked during OnDriverInit.</p>

<p><h6 id='available-from-1-6-0'>Available from 1.6.0</h6><h3 id='signature'>Signature</h3>
<p><code>C4:MediaAddMovieInfo ()</code></p></p>

<table><thead>
<tr>
<th>Parameters</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>str</td>
<td>location</td>
</tr>
<tr>
<td>str</td>
<td>title</td>
</tr>
<tr>
<td>table</td>
<td>Table information. The table may have entries for:</td>
</tr>
<tr>
<td></td>
<td>string location</td>
</tr>
<tr>
<td></td>
<td>string title</td>
</tr>
<tr>
<td></td>
<td>string directors – comma separated</td>
</tr>
<tr>
<td></td>
<td>string description</td>
</tr>
<tr>
<td></td>
<td>string cast – comma separated</td>
</tr>
<tr>
<td></td>
<td>string rating</td>
</tr>
<tr>
<td></td>
<td>string rating reason</td>
</tr>
<tr>
<td></td>
<td>string reviews</td>
</tr>
<tr>
<td></td>
<td>string genre</td>
</tr>
<tr>
<td></td>
<td>string aspect ratio</td>
</tr>
<tr>
<td></td>
<td>string release date</td>
</tr>
<tr>
<td></td>
<td>string release company</td>
</tr>
<tr>
<td></td>
<td>string length – time span in minutes</td>
</tr>
<tr>
<td></td>
<td>string cover art – this is a base64 encoded JPEG file of the cover art.</td>
</tr>
</tbody></table>

<h3 id='returns'>Returns</h3>

<table><thead>
<tr>
<th>Values</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>num</td>
<td>The new Media ID for the movie</td>
</tr>
</tbody></table>

<h3 id='example'>Example</h3><div class="highlight"><pre class="highlight lua tab-lua"><code><span class="err">`</span><span class="n">mediaId1</span> <span class="o">=</span> <span class="n">C4</span><span class="p">:</span><span class="n">MediaAddMovieInfo</span><span class="p">(</span><span class="s2">"http://127.0.0.1/movies/shrek1"</span><span class="p">,</span> <span class="s2">"shrek1"</span><span class="p">,</span> <span class="n">shrekMovie</span><span class="p">)</span><span class="err">`</span>
</code></pre></div>
<h2 id='mediagetallmovies'>MediaGetAllMovies</h2>
<p>This API should not be invoked during OnDriverInit.</p>
<h6 id='available-from-1-6-0'>Available from 1.6.0</h6><h3 id='signature'>Signature</h3>

<p><code>C4:MediaGetAllMovies()</code></p>

<p>Parameters</p>

<p><code>None</code></p>

<p><code>Returns</code></p>

<table><thead>
<tr>
<th>Value</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>Table</td>
<td>Table containing Media IDs and locations.</td>
</tr>
</tbody></table>

<h3 id='example'>Example</h3><div class="highlight"><pre class="highlight lua tab-lua"><code><span class="n">allMovies</span> <span class="o">=</span> <span class="n">C4</span><span class="p">:</span><span class="n">MediaGetAllMovies</span><span class="p">()</span>
<span class="k">for</span> <span class="n">key</span><span class="p">,</span><span class="n">value</span> <span class="k">in</span> <span class="nb">pairs</span><span class="p">(</span><span class="n">allMovies</span><span class="p">)</span> <span class="k">do</span>
   <span class="nb">print</span><span class="p">(</span><span class="s2">"mediaId is "</span><span class="o">..</span><span class="n">key</span><span class="o">..</span> <span class="s2">" location is "</span><span class="o">..</span><span class="n">value</span><span class="p">)</span>
<span class="k">end</span>
</code></pre></div>
<h2 id='mediagetmovieinfo'>MediaGetMovieInfo</h2>
<p>This API should not be invoked during OnDriverInit.</p>
<h6 id='available-from-1-6-0'>Available from 1.6.0</h6><h3 id='signature'>Signature</h3>

<p><code>C4:MediaGetMovieInfo()</code></p>

<table><thead>
<tr>
<th>Parameters</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>num</td>
<td>This is the Media ID of the movie.</td>
</tr>
<tr>
<td>table</td>
<td>Table information. The table may have entries for:</td>
</tr>
<tr>
<td></td>
<td>string location</td>
</tr>
<tr>
<td></td>
<td>string title</td>
</tr>
<tr>
<td></td>
<td>string directors – comma separated</td>
</tr>
<tr>
<td></td>
<td>string description</td>
</tr>
<tr>
<td></td>
<td>string cast – comma separated</td>
</tr>
<tr>
<td></td>
<td>string rating</td>
</tr>
<tr>
<td></td>
<td>string rating reason</td>
</tr>
<tr>
<td></td>
<td>string reviews</td>
</tr>
<tr>
<td></td>
<td>string genre</td>
</tr>
<tr>
<td></td>
<td>string aspect ratio</td>
</tr>
<tr>
<td></td>
<td>string release date</td>
</tr>
<tr>
<td></td>
<td>string release company</td>
</tr>
<tr>
<td></td>
<td>string length – time span in minutes</td>
</tr>
<tr>
<td></td>
<td>string cover art – this is a base64 encoded JPEG file of the cover art.</td>
</tr>
</tbody></table>

<h3 id='returns'>Returns</h3>

<p><code>None</code></p>

<h3 id='example'>Example</h3><div class="highlight"><pre class="highlight lua tab-lua"><code><span class="n">myMovieInfo</span> <span class="o">=</span> <span class="n">C4</span><span class="p">:</span><span class="n">MediaGetMovieInfo</span><span class="p">(</span><span class="n">mediaId1</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">myMovieInfo</span><span class="p">[</span><span class="err">“</span><span class="n">title</span><span class="err">”</span><span class="p">])</span>
</code></pre></div>
<h2 id='mediagetmovielocation'>MediaGetMovieLocation</h2>
<p>This API should not be invoked during OnDriverInit.</p>
<h6 id='available-from-1-6-0'>Available from 1.6.0</h6><h3 id='signature'>Signature</h3>

<p><code>C4: MediaGetMovieLocations()</code></p>

<table><thead>
<tr>
<th>Parameters</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>num</td>
<td>The Media ID of the movie.</td>
</tr>
</tbody></table>

<p><code>Returns</code></p>

<table><thead>
<tr>
<th>Value</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>str</td>
<td>The location of this media as stored in the database.</td>
</tr>
</tbody></table>

<h3 id='example'>Example</h3>

<p><code>myLocation = C4:MediaGetMovieLocation(mediaId1)</code></p>

<h2 id='mediaremovemovie'>MediaRemoveMovie</h2>

<p>This API should not be invoked during OnDriverInit.</p>

<p><h6 id='available-from-1-6-0'>Available from 1.6.0</h6><h3 id='signature'>Signature</h3>
<p><code>C4:MediaRemoveMovie()</code></p></p>

<table><thead>
<tr>
<th>Parameters</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>num</td>
<td>The Media ID of the movie.</td>
</tr>
</tbody></table>

<h3 id='returns'>Returns</h3>

<p><code>None</code></p>

<h3 id='example'>Example</h3>

<p><code>C4:MediaRemoveMovie(mediaId3)</code></p>

<h2 id='mediaremoveallmovies'>MediaRemoveAllMovies</h2>

<p>This API should not be invoked during OnDriverInit.</p>

<p><h6 id='available-from-1-6-0'>Available from 1.6.0</h6><h3 id='signature'>Signature</h3>
<p><code>C4: MediaRemoveAllMovies()</code></p>
<h3 id='parameter'>Parameter</h3>
<p><code>None</code></p>
<h3 id='returns'>Returns</h3>
<p><code>None</code></p>
<h3 id='example'>Example</h3>
<p><code>C4:MediaRemoveAllMovies()</code></p></p>

<h2 id='mediamodifymovieinfo'>MediaModifyMovieInfo</h2>

<p>This API should not be invoked during OnDriverInit.</p>

<p><h6 id='available-from-1-6-0'>Available from 1.6.0</h6><h3 id='signature'>Signature</h3>
<p><code>C4:MediaModifyMovieInfo()</code></p></p>

<table><thead>
<tr>
<th>Parameters</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>num</td>
<td>media ID</td>
</tr>
<tr>
<td>str</td>
<td>location</td>
</tr>
<tr>
<td>str</td>
<td>name</td>
</tr>
<tr>
<td>table</td>
<td>Table information. The table may have entries for:</td>
</tr>
<tr>
<td></td>
<td>string location</td>
</tr>
<tr>
<td></td>
<td>string title</td>
</tr>
<tr>
<td></td>
<td>string directors – comma separated</td>
</tr>
<tr>
<td></td>
<td>string description</td>
</tr>
<tr>
<td></td>
<td>string cast – comma separated</td>
</tr>
<tr>
<td></td>
<td>string rating</td>
</tr>
<tr>
<td></td>
<td>string rating reason</td>
</tr>
<tr>
<td></td>
<td>string reviews</td>
</tr>
<tr>
<td></td>
<td>string genre</td>
</tr>
<tr>
<td></td>
<td>string aspect ratio</td>
</tr>
<tr>
<td></td>
<td>string release date</td>
</tr>
<tr>
<td></td>
<td>string release company</td>
</tr>
<tr>
<td></td>
<td>string length – time span in minutes</td>
</tr>
<tr>
<td></td>
<td>string cover art – this is a base64 encoded JPEG file of the cover art.</td>
</tr>
</tbody></table>

<h3 id='returns'>Returns</h3>

<p><code>None</code></p>

<h3 id='usage-note'>Usage Note</h3>

<p>A modify call does not change the media’s ID number where a delete or add call will. Modify calls are useful if programming relies on the current Media ID. For example, if a button push has is programmed to play the media, and a modify call is used, the media’s current ID is maintained and programming is not impacted.</p>

<h3 id='example'>Example</h3>

<p><code>C4:MediaModifyMovieInfo(mediaId1,&quot;http://127.0.0.1/movies/shrek1Modified&quot;,&quot;shrek1&quot;,shrekMovie)</code></p>
<h1 id='media-management-songs-interface'>Media Management - Songs Interface</h1>

<h2 id='mediaaddsonginfo'>MediaAddSongInfo</h2>

<p>This API should not be invoked during OnDriverInit.</p>

<p><h6 id='available-from-1-6-0'>Available from 1.6.0</h6><h3 id='signature'>Signature</h3>
<p><code>C4:MediaAddSongInfo()</code></p>
<h3 id='parameters'>Parameters</h3>
<p><code>None</code></p>
<h3 id='returns'>Returns</h3>
<table><thead>
<tr>
<th>Value</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>table</td>
<td>Information for location and title.</td>
</tr>
</tbody></table>
<h3 id='example'>Example</h3><div class="highlight"><pre class="highlight lua tab-lua"><code><span class="n">mySongInfo</span> <span class="o">=</span> <span class="n">C4</span><span class="p">:</span><span class="n">MediaGetSongInfo</span><span class="p">(</span><span class="n">mediaId1</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">mySongInfo</span><span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">])</span>
</code></pre></div>
<h2 id='mediagetsonglocation'>MediaGetSongLocation</h2>
<p>This API should not be invoked during OnDriverInit.</p>
<h6 id='available-from-1-6-0'>Available from 1.6.0</h6><h3 id='signature'>Signature</h3>
<p><code>C4: MediaGetSongLocation( </code></p></p>

<table><thead>
<tr>
<th>Parameters</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>num</td>
<td>The Media ID of the song.</td>
</tr>
</tbody></table>

<p><code>Returns</code></p>

<table><thead>
<tr>
<th>Value</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>str</td>
<td>The location of this media as stored in the database.</td>
</tr>
</tbody></table>

<h3 id='example'>Example</h3>

<p><code>print(C4:MediaGetSongLocation(mediaId1))</code></p>

<h2 id='mediaremovesong'>MediaRemoveSong</h2>

<p>This API should not be invoked during OnDriverInit.</p>

<p><h6 id='available-from-1-6-0'>Available from 1.6.0</h6><h3 id='signature'>Signature</h3>
<p><code>C4:MediaRemoveSong()</code></p></p>

<table><thead>
<tr>
<th>Parameters</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>num</td>
<td>The Media ID of the song.</td>
</tr>
</tbody></table>

<h3 id='returns'>Returns</h3>

<p><code>None</code></p>

<h3 id='example'>Example</h3>

<p><code>C4:MediaRemoveSong(mediaId1)</code></p>

<h2 id='medialinksongtoalbum'>MediaLinkSongToAlbum</h2>

<p>This API should not be invoked during OnDriverInit.</p>

<p><h6 id='available-from-1-6-0'>Available from 1.6.0</h6><h3 id='signature'>Signature</h3>
<p><code>C4:MediaLinkSongToAlbum()</code> </p></p>

<table><thead>
<tr>
<th>Parameters</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>num</td>
<td>The Media ID of the album</td>
</tr>
<tr>
<td>num</td>
<td>The Media ID of the song</td>
</tr>
<tr>
<td>num</td>
<td>Track-based sequence that this song belongs within the album</td>
</tr>
</tbody></table>

<h3 id='returns'>Returns</h3>

<p><code>None</code></p>

<h3 id='example'>Example</h3>

<p><code>C4:MediaLinkSongToAlbum(mediaIdAlbum, mediaIdSong, 1)</code></p>

<h2 id='mediagetsongsforalbum'>MediaGetSongsforAlbum</h2>

<p>This API should not be invoked during OnDriverInit.</p>

<p><h6 id='available-from-1-6-0'>Available from 1.6.0</h6><h3 id='signature'>Signature</h3>
<p><code>C4:MediaGetSongsforAlbum() 
</code></p></p>

<table><thead>
<tr>
<th>Parameters</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>num</td>
<td>The Media ID of the album containing songs</td>
</tr>
</tbody></table>

<h3 id='returns'>Returns</h3>

<table><thead>
<tr>
<th>Value</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>table</td>
<td>Values including Media ID and location for each song.</td>
</tr>
</tbody></table>

<h3 id='example'>Example</h3><div class="highlight"><pre class="highlight lua tab-lua"><code>
<span class="n">AllSongs</span><span class="o">=</span> <span class="n">C4</span><span class="p">:</span><span class="n">MediaGetSongsForAlbum</span><span class="p">(</span><span class="n">mediaIdAlbum</span><span class="p">)</span>
<span class="k">for</span> <span class="n">key</span><span class="p">,</span><span class="n">value</span> <span class="k">in</span> <span class="nb">pairs</span><span class="p">(</span><span class="n">AllSongs</span><span class="p">)</span> <span class="k">do</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">"mediaId is "</span><span class="o">..</span><span class="n">key</span><span class="o">..</span> <span class="s2">" location is "</span><span class="o">..</span><span class="n">value</span><span class="p">)</span>
<span class="k">end</span>
</code></pre></div>
<h2 id='mediamodifysonginfo'>MediaModifySongInfo</h2>
<p>This API should not be invoked during OnDriverInit.</p>
<h6 id='available-from-1-6-0'>Available from 1.6.0</h6><h3 id='signature'>Signature</h3>

<p><code>C4:MediaModifySongInfo() </code></p>

<table><thead>
<tr>
<th>Parameters</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>num</td>
<td>media ID</td>
</tr>
<tr>
<td>str</td>
<td>location</td>
</tr>
<tr>
<td>str</td>
<td>name</td>
</tr>
</tbody></table>

<h3 id='returns'>Returns</h3>

<p><code>None</code></p>

<h3 id='usage-note'>Usage Note</h3>

<p>A modify call does not change the media’s ID number where a delete or add call will. Modify calls are useful if programming relies on the current Media ID. For example, if a button push  is programmed to play the media, and a modify call is used, the media’s current ID is maintained and programming is not impacted.</p>

<h3 id='example'>Example</h3>

<p><code>C4:MediaModifySongInfo(mediaId1, &quot;http://127.0.0.1/music/songtest&quot;, &quot;Test of modified song&quot;)</code></p>
<h1 id='miscellaneous-interface'>Miscellaneous Interface</h1>

<h2 id='adddynamicbinding'>AddDynamicBinding</h2>

<p>Function called by a DriverWorks driver to add a dynamic binding (a binding added at runtime).  This is typically done by security panels or other devices whose number of bindings are unknown when the driver is created.</p>

<h6 id='available-from-1-6-0'>Available from 1.6.0</h6><h3 id='signature'>Signature</h3>
<p><code>C4:AddDynamicBinding(idBinding, strType, bIsProvider, strName, strClass, bHidden, bAutoBind)</code></p>

<table><thead>
<tr>
<th>Parameters</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>num</td>
<td>ID of the dynamic binding.</td>
</tr>
<tr>
<td>str</td>
<td>Type of dynamic binding. Valid types include: CONTROL, PROXY</td>
</tr>
<tr>
<td>bool</td>
<td>Provider: Whether the binding is a Provider or a Consumer binding.</td>
</tr>
<tr>
<td>str</td>
<td>Name of binding that will appear in Composer’s connections page.</td>
</tr>
<tr>
<td>str</td>
<td>Class of dynamic binding that is being created.</td>
</tr>
<tr>
<td>bool</td>
<td>Hidden: Whether the dynamic binding is hidden. Should typically be false.</td>
</tr>
<tr>
<td>bool</td>
<td>AutoBind: Whether the dynamic binding should be auto-bound. Should typically be false</td>
</tr>
</tbody></table>
<h3 id='example'>Example</h3>
<p>Dynamically create 4 Zone Contact Bindings for a Security Driver:</p>
<div class="highlight"><pre class="highlight lua tab-lua"><code><span class="n">C4</span><span class="p">:</span><span class="n">AddDynamicBinding</span><span class="p">(</span><span class="mi">101</span><span class="p">,</span> <span class="s2">"CONTROL"</span><span class="p">,</span> <span class="kc">true</span><span class="p">,</span> <span class="s2">"Zone 1"</span><span class="p">,</span> <span class="s2">"CONTACT_SENSOR"</span><span class="p">,</span> <span class="kc">false</span><span class="p">,</span> <span class="kc">false</span><span class="p">)</span>
<span class="n">C4</span><span class="p">:</span><span class="n">AddDynamicBinding</span><span class="p">(</span><span class="mi">102</span><span class="p">,</span> <span class="s2">"CONTROL"</span><span class="p">,</span> <span class="kc">true</span><span class="p">,</span> <span class="s2">"Zone 2"</span><span class="p">,</span> <span class="s2">"CONTACT_SENSOR"</span><span class="p">,</span> <span class="kc">false</span><span class="p">,</span> <span class="kc">false</span><span class="p">)</span>
<span class="n">C4</span><span class="p">:</span><span class="n">AddDynamicBinding</span><span class="p">(</span><span class="mi">103</span><span class="p">,</span> <span class="s2">"CONTROL"</span><span class="p">,</span> <span class="kc">true</span><span class="p">,</span> <span class="s2">"Zone 3"</span><span class="p">,</span> <span class="s2">"CONTACT_SENSOR"</span><span class="p">,</span> <span class="kc">false</span><span class="p">,</span> <span class="kc">false</span><span class="p">)</span>
</code></pre></div><h3 id='usage-note'>Usage Note</h3>
<p>Currently, the AddDynamicBinding API does not work for Audio, Video and Room Control bindings.</p>

<p>It is the responsibility of the DriverWorks driver to maintain the Dynamic bindings and to restore them from persistent data upon the driver being initialized. If this is not done, the bindings will not be available after a Director restart.</p>

<p>If dynamic bindings have been connected in Composer, if they are properly restored by the DriverWorks driver, the connections made between the bindings will be automatically restored.</p>

<p>To the right is an example of how to create and save bindings for three security contacts:</p>
<div class="highlight"><pre class="highlight lua tab-lua"><code>
  <span class="n">PersistData</span> <span class="o">=</span> <span class="p">{</span><span class="err">`</span><span class="p">}</span>
<span class="k">end</span>

<span class="n">PersistData</span><span class="p">[</span><span class="s2">"zonebindings"</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
<span class="n">PersistData</span><span class="p">[</span><span class="s2">"zonebindings"</span><span class="p">][</span><span class="mi">101</span><span class="p">]</span> <span class="o">=</span> <span class="s2">"Zone 1"</span>

<span class="n">C4</span><span class="p">:</span><span class="n">AddDynamicBinding</span><span class="p">(</span><span class="mi">101</span><span class="p">,</span> <span class="s2">"CONTROL"</span><span class="p">,</span> <span class="kc">true</span><span class="p">,</span> <span class="s2">"Zone 1"</span><span class="p">,</span> <span class="s2">"CONTACT_SENSOR"</span><span class="p">,</span> <span class="kc">false</span><span class="p">,</span> <span class="kc">false</span><span class="p">)</span>
<span class="n">PersistData</span><span class="p">[</span><span class="s2">"zonebindings"</span><span class="p">][</span><span class="mi">102</span><span class="p">]</span> <span class="o">=</span> <span class="s2">"Zone 2"</span>

<span class="n">C4</span><span class="p">:</span><span class="n">AddDynamicBinding</span><span class="p">(</span><span class="mi">102</span><span class="p">,</span> <span class="s2">"CONTROL"</span><span class="p">,</span> <span class="kc">true</span><span class="p">,</span> <span class="s2">"Zone 2"</span><span class="p">,</span> <span class="s2">"CONTACT_SENSOR"</span><span class="p">,</span> <span class="kc">false</span><span class="p">,</span> <span class="kc">false</span><span class="p">)</span>
<span class="n">PersistData</span><span class="p">[</span><span class="s2">"zonebindings"</span><span class="p">][</span><span class="mi">103</span><span class="p">]</span> <span class="o">=</span> <span class="s2">"Zone 3"</span>
<span class="n">C4</span><span class="p">:</span><span class="n">AddDynamicBinding</span><span class="p">(</span><span class="mi">103</span><span class="p">,</span> <span class="s2">"CONTROL"</span><span class="p">,</span> <span class="kc">true</span><span class="p">,</span> <span class="s2">"Zone 3"</span><span class="p">,</span> <span class="s2">"CONTACT_SENSOR"</span><span class="p">,</span> <span class="kc">false</span><span class="p">,</span> <span class="kc">false</span><span class="p">)</span>
</code></pre></div>
<p>The next is an example of how to restore saved bindings. This code should be in the main body of the script section of the driver, not within any declared function:</p>
<div class="highlight"><pre class="highlight lua tab-lua"><code><span class="k">if</span> <span class="p">(</span><span class="n">PersistData</span> <span class="o">~=</span> <span class="kc">nil</span><span class="p">)</span> <span class="k">then</span>
  <span class="k">for</span> <span class="n">key</span><span class="p">,</span><span class="n">value</span> <span class="k">in</span> <span class="nb">pairs</span><span class="p">(</span><span class="n">PersistData</span><span class="p">[</span><span class="s2">"zonebindings"</span><span class="p">])</span> <span class="k">do</span> 
    <span class="n">C4</span><span class="p">:</span><span class="n">AddDynamicBinding</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="s2">"CONTROL"</span><span class="p">,</span> <span class="kc">true</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="s2">"CONTACT_SENSOR"</span><span class="p">,</span> <span class="kc">false</span><span class="p">,</span> <span class="kc">false</span><span class="p">)</span>
  <span class="k">end</span>
<span class="k">end</span>
</code></pre></div>
<p>A sample driver using AddDyamicBinding can be found in the Samples folder of the SDK.</p>
<h3 id='warning'>Warning</h3>
<p>No events will be sent prior to OnDriverLateInit. If an Event is required this method must be invoked in OnDriverLateInit.</p>

<h2 id='allowexecute'>AllowExecute</h2>
<p>Beginning with OS release 2.6.0, default runtime editing of encrypted drivers has been deprecated. This has been done to better protect encrypted drivers from unwanted code review or hacking. The AllowExecute API allows for the runtime editing of encrypted drivers through its setting. The API defaults to a setting of False. When set to True, the lua command window will not support entry of any data and the lua output window cannot be used as a display. Use of this API allows driver developers to build into their driver the option to enable remote execution permanently or embed the function call within your own debugging functions to allow or disallow executing of commands in Composer. This API can be invoked during OnDriverInit.</p>
<h3 id='signature'>Signature</h3>
<p><code>C4:AllowExecute()</code></p>

<table><thead>
<tr>
<th>Parameters</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>bool</td>
<td>True / False</td>
</tr>
</tbody></table>

<h2 id='base64encode'>Base64Encode</h2>
<p>Function called in a DriverWorks driver to encode the specified string as a Base64-encoded string. This API can be invoked during OnDriverInit.</p>
<h6 id='available-from-1-6-0'>Available from 1.6.0</h6><h3 id='signature'>Signature</h3>
<p><code>C4:Base64Encode(strToEncode)</code></p>

<table><thead>
<tr>
<th>Parameters</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>str</td>
<td>String to be encoded in Base64 encoding</td>
</tr>
</tbody></table>
<h3 id='returns'>Returns</h3>
<table><thead>
<tr>
<th>Values</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>str</td>
<td>String encoded in Base64 encoding.</td>
</tr>
</tbody></table>

<h2 id='base64decode'>Base64Decode</h2>
<p>Function called in a DriverWorks driver to decode the specified string from a Base64-encoded string. This API can be invoked during OnDriverInit.</p>
<h6 id='available-from-1-6-0'>Available from 1.6.0</h6><h3 id='signature'>Signature</h3>
<p><code>C4:Base64Decode(strToDecode)</code></p>

<table><thead>
<tr>
<th>Parameters</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>str</td>
<td>String to be decoded from <a href="https://snap-one.github.io/docs-driverworks-api/#base64encode">Base64 encoding</a></td>
</tr>
</tbody></table>
<h3 id='returns'>Returns</h3>
<table><thead>
<tr>
<th>Value</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>str</td>
<td>Decoded from Base64 encoding.</td>
</tr>
</tbody></table>

<h2 id='persistdata'>PersistData</h2>
<p>The Lua Table ‘PersistData’ is available for drivers to keep persistent data across director restarts.  Any values placed into the PersistData table will exist in the PersistData table when the driver is loaded after a director restart.</p>

<p>Note: we do not guarantee that binary data will be persisted correctly.  If you wish to persist binary data in the PersistData table, it is recommended that you encode it to be 7-bit safe, by using something like <code>C4:Base64Encode</code>.</p>
<h5 id='available-from-1-6-0'>Available from 1.6.0</h5><h3 id='signature'>Signature</h3>
<p><code>PersistData = {}</code></p>
<h3 id='usage-note'>Usage Note</h3>
<p>It is recommended to use the <a href="https://snap-one.github.io/docs-driverworks-api/#persistsetvalue">PersistSetValue</a> and <a href="https://snap-one.github.io/docs-driverworks-api/#persistgetvalue">PersistGetValue</a> calls if they&#39;re supported in your O.S. These calls were introduced with OS 2.10.0. They immediately write to the state database.The PersistData table only is only written out when Director cycles through each driver to save its state. Because of this, latency issues can occur when using PersistData.</p>

<h2 id='exit-navigation'>Exit Navigation</h2>
<p>This command is sent to the room to change the room from the “In Navigation” mode back to the “Normal” mode.  While in the “Normal” mode, the commands sent to the room are sent to the selected audio or video device.  When in the “In Navigation” mode a set of the navigational commands are sent to the on screen device.</p>

<p>For reference, the set of commands that are forwarded are:</p>

<ul>
<li>”UP&quot; </li>
<li>&quot;DOWN&quot; </li>
<li>&quot;RIGHT&quot;</li>
<li>&quot;LEFT&quot;</li>
<li>&quot;PAGE_UP&quot; _</li>
<li>&quot;PAGE_DOWN&quot; </li>
<li>&quot;CANCEL&quot; &quot;GUIDE&quot;</li>
<li>&quot;START_UP&quot; </li>
<li>&quot;START_DOWN&quot; </li>
<li>&quot;START_RIGHT&quot; </li>
<li>&quot;START_LEFT&quot; </li>
<li>&quot;START_PAGE_UP” </li>
<li>&quot;START_PAGE_DOWN” </li>
<li>&quot;ENTER&quot; </li>
<li>&quot;STOP_UP&quot; </li>
<li>&quot;STOP_DOWN&quot; </li>
<li>&quot;STOP_RIGHT&quot; </li>
<li>&quot;STOP_LEFT&quot; </li>
<li>&quot;STOP_PAGE_UP&quot; </li>
<li>&quot;STOP_PAGE_DOWN&quot; </li>
<li>&quot;BACK&quot;</li>
</ul>

<p>Sending the “CONTROL4” command to the room will have it select the bound on screen navigation and enter the “In Navigation” mode.</p>

<p>Sending the <code>EXIT_NAVIGATION</code> command will have the room go back to the “Normal” mode.</p>
<h5 id='available-from-1-6-0'>Available from 1.6.0</h5><h3 id='example'>Example</h3>
<p>roomId = C4:RoomGetId()
    -- now tell the room to enter &quot;In Navigation&quot; mode
    tParams = {}
    C4:SendToDevice(roomId, &quot;CONTROL4&quot;, tParams) 
    -- now go back to normal mode
    C4:SendToDevice(roomId, &quot;EXIT_NAVIGATION&quot;, tParams)</p>

<h2 id='getcapability'>GetCapability</h2>
<p>Function called from DriverWorks driver to get a capability from the driver. This API should not be invoked during OnDriverInit.</p>
<h6 id='available-from-1-6-0'>Available from 1.6.0</h6><h3 id='signature'>Signature</h3>
<p><code>C4:GetCapability(strName)</code></p>

<table><thead>
<tr>
<th>Parameters</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>str</td>
<td>The name of the capability to retrieve</td>
</tr>
</tbody></table>
<h3 id='returns'>Returns</h3>
<table><thead>
<tr>
<th>Value</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>str</td>
<td>The value of the capability retrieved from the driver file</td>
</tr>
</tbody></table>
<h3 id='examples'>Examples</h3>
<p>If this device supports discrete volume control, send discrete volume, otherwise, send a Volume Up or Volume Down command:</p>

<p>if (C4:GetCapability(&quot;has_discrete_volume_control&quot;) == &quot;False&quot;) then
      if (VolumeValue &gt; CurVolumeValue) then
        SendVolumeUp()
      else
        SendVolumeDown()
      end
    else
      SendVolumeDiscrete(VolumeValue)
    End
    OnBindingChanged</p>

<h2 id='getdevicedata'>GetDeviceData</h2>
<p>This API returns data found in the driver&#39;s device data, &lt;devicedata&gt; XML. The Device ID of the driver value must be passed to return the XML content. An optional string value parameter can be passed to retrieve specific XML data.</p>
<h6 id='available-from-2-10-0'>Available from 2.10.0</h6><h3 id='signature'>Signature</h3>
<p><code>C4:GetDeviceData()</code></p>

<table><thead>
<tr>
<th>Parameters</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>num</td>
<td>Device ID of the driver.</td>
</tr>
<tr>
<td>str</td>
<td>tagName is an optional parameter that can be passed to return specific devicedata.</td>
</tr>
</tbody></table>
<h3 id='usage-note'>Usage Note</h3>
<p>For example, if the “string parameter is passed as “version”, the value for the devicedata&#39;s &lt;version&gt;&lt;/version&gt; XML tag will be returned. </p>
<h3 id='returns'>Returns</h3>
<p>XML data found in the driver&#39;s <code>&lt;devicedata&gt;&lt;/devicedata&gt;</code>. </p>
<h3 id='usage-note-2'>Usage Note</h3>
<p>If multiple instances of identical XML tags exist in the &lt;devicedata&gt; section for the driver, only the first instance of that XML data will be returned. Also, the GetDeviceData API only has the ability to return data from the first two levels of XML.</p>
<h3 id='examples'>Examples</h3>
<p>For example purposes, consider the following sample XML to the right.  It is taken from a Pool Controller&#39;s  &lt;devicedata&gt;&lt;/devicedata&gt;. This Pool Controller has a DeviceID of 8 in the project:</p>
<div class="highlight"><pre class="highlight xml tab-xml"><code><span class="nt">&lt;devicedata&gt;</span>
    <span class="nt">&lt;copyright&gt;</span>Copyright 2016 Control4 Corporation.  All rights reserved.<span class="nt">&lt;/copyright&gt;</span>
    <span class="nt">&lt;creator&gt;</span>Control4<span class="nt">&lt;/creator&gt;</span>
    <span class="nt">&lt;created&gt;</span>8/26/2014 2:09 PM<span class="nt">&lt;/created&gt;</span>
    <span class="nt">&lt;modified&gt;</span>11/17/2015 11:00 AM<span class="nt">&lt;/modified&gt;</span>
    <span class="nt">&lt;version&gt;</span>7<span class="nt">&lt;/version&gt;</span>
    <span class="nt">&lt;control&gt;</span>lua_gen<span class="nt">&lt;/control&gt;</span>
    <span class="nt">&lt;controlmethod&gt;</span>ip<span class="nt">&lt;/controlmethod&gt;</span>
    <span class="nt">&lt;driver&gt;</span>DriverWorks<span class="nt">&lt;/driver&gt;</span>
    <span class="nt">&lt;proxies</span> <span class="na">qty=</span><span class="s">"1"</span><span class="nt">&gt;</span>
        <span class="nt">&lt;proxy</span> <span class="na">proxybindingid=</span><span class="s">"5001"</span> <span class="na">primary=</span><span class="s">"True"</span><span class="nt">&gt;</span>pool<span class="nt">&lt;/proxy&gt;</span>
    <span class="nt">&lt;/proxies&gt;</span>
    <span class="nt">&lt;capabilities&gt;</span>
        <span class="nt">&lt;pool_pumpmodes&gt;</span>Off,On<span class="nt">&lt;/pool_pumpmodes&gt;</span>
        <span class="nt">&lt;spa_pumpmodes&gt;</span>Off,On<span class="nt">&lt;/spa_pumpmodes&gt;</span>
        <span class="nt">&lt;temp_min&gt;</span>34<span class="nt">&lt;/temp_min&gt;</span>
        <span class="nt">&lt;temp_max&gt;</span>104<span class="nt">&lt;/temp_max&gt;</span>
        <span class="nt">&lt;pool_heat_modes&gt;</span>
            <span class="nt">&lt;mode&gt;</span>
                <span class="nt">&lt;id&gt;</span>1<span class="nt">&lt;/id&gt;</span>
                <span class="nt">&lt;text&gt;</span>Heater<span class="nt">&lt;/text&gt;</span>
            <span class="nt">&lt;/mode&gt;</span>
            <span class="nt">&lt;mode&gt;</span>
                <span class="nt">&lt;id&gt;</span>2<span class="nt">&lt;/id&gt;</span>
                <span class="nt">&lt;text&gt;</span>Solar Heater<span class="nt">&lt;/text&gt;</span>
            <span class="nt">&lt;/mode&gt;</span>
        <span class="nt">&lt;/pool_heat_modes&gt;</span>
        <span class="nt">&lt;spa_heat_modes&gt;</span>
            <span class="nt">&lt;mode&gt;</span>
                <span class="nt">&lt;id&gt;</span>1<span class="nt">&lt;/id&gt;</span>
                <span class="nt">&lt;text&gt;</span>Heater<span class="nt">&lt;/text&gt;</span>
            <span class="nt">&lt;/mode&gt;</span>
        <span class="nt">&lt;/spa_heat_modes&gt;</span>
    <span class="nt">&lt;/capabilities&gt;</span>
<span class="nt">&lt;/devicedata&gt;</span>
</code></pre></div>
<p>If <code>C4:GetDeviceData</code> is executed with only the Device ID value, as:</p>

<p><code>C4:GetDeviceData(8)</code></p>

<p>All of the XML found in the &lt;devicedata&gt; section of the driver is returned. </p>

<p><code>C4:GetDeviceData</code> can also be executed with the optional tagName parameter to return specific XML data. For example, If <code>C4:GetDeviceData</code> is executed with the Device ID value and the version tag, as:</p>

<p><code>C4:GetDeviceData(8, “version”)</code></p>

<p>The return value will be: 7</p>

<p>Similarly, the API can return all of the supported pump modes by passing C4:GetDeviceData as:</p>

<p><code>C4:GetDeviceData(8, “pool\_pumpmodes”)</code>
`
The return values will be: <code>Off,On</code></p>

<p>If we wanted to return all of the pool Controller&#39;s capabilities, C4:GetDeviceData is passed as:</p>

<p><code>C4:GetDeviceData(8, “capabilities”)</code></p>

<p>To the right is the return value: </p>
<div class="highlight"><pre class="highlight plaintext"><code>-- Return Value

&lt;pool_pumpmodes&gt;Off,On&lt;/pool_pumpmodes&gt;
&lt;spa_pumpmodes&gt;Off,On&lt;/spa_pumpmodes&gt;
&lt;temp_min&gt;34&lt;/temp_min&gt;
&lt;temp_max&gt;104&lt;/temp_max&gt;
&lt;pool_heat_modes&gt;
    &lt;mode&gt;
        &lt;id&gt;1&lt;/id&gt;
        &lt;text&gt;Heater&lt;/text&gt;
    &lt;/mode&gt;
    &lt;mode&gt;
        &lt;id&gt;2&lt;/id&gt;
        &lt;text&gt;Solar Heater&lt;/text&gt;
    &lt;/mode&gt;
&lt;/pool_heat_modes&gt;
&lt;spa_heat_modes&gt;
    &lt;mode&gt;
        &lt;id&gt;1&lt;/id&gt;
        &lt;text&gt;Heater&lt;/text&gt;
    &lt;/mode&gt;
&lt;/spa_heat_modes
</code></pre></div>
<h2 id='getdevices'>GetDevices</h2>
<p>The GetDevices API provides the ability to return a table of devices based on driver names and/or device ID values. Additionally, the use of the location parameter further limits the list returned based on locations found within a project.</p>
<h6 id='available-from-2-10-0'>Available from 2.10.0</h6><h3 id='signature'>Signature</h3>
<p><code>GetDevices(tFilter, locationFilter)</code></p>
<h3 id='parameters'>Parameters</h3>
<p>tFilter:  (optional) The tFilter is a table of key/value pairs that specify the filters used within the search. The search can be filtered by .c4i or .c4z driver names and/or device id values.  To filter by driver names, add an entry in the table called C4iNames. The value is a string consisting of a comma delimited list of .c4i or .c4z names such as:</p>

<p><code>control4_sr250.c4i, control4_sr150.c4i</code>.  </p>

<p>An example of a table would be: </p>

<p><code>tFilter = {C4iNames = &quot;control4_sr260.c4i,control4_sr250.c4i,control4_sr150.c4i&quot;}</code></p>

<p>To filter by device id values rather than driver names, add an entry in the table called DeviceIds. The value is a string consisting of a comma delimited list of ID values representing Proxy IDs or Device IDs such as: “22,23,24”. An example of a table would be:</p>

<p><code>tFilter = {DeviceIds = &quot;22,34,56&quot;}</code></p>

<p>Note that the tFilter parameter is an optional parameter of the GetDevices function. Also, empty filter tables  tFilter = {} can be passed within the function. This will result in all devices being included when the function is executed.</p>

<p>locationFilter: The locationFilter parameter is a comma delimited list of project location IDs. Only devices matching the filter criteria used in the first parameter and belonging to one of the locations in the list will be included when the function is executed. Locations IDs include Sites, Buildings, Floors and Rooms.</p>
<h3 id='returns'>Returns</h3>
<table><thead>
<tr>
<th>Value</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>table</td>
<td>tReturn: Varies  based on not only the parameters passed in it, but the types of drivers in the project. Driver types that should be considered when viewing return data include: Combo Drivers, Proxy/Protocol Driver and Multi-Proxy Drivers.</td>
</tr>
</tbody></table>

<p>To better understand how driver data is arranged in tables and how the data is returned by the GetDevices API, the following section consists of example data returned from the function. </p>
<h3 id='example-1'>Example 1</h3>
<p>Return Example for All Drivers including Combo Drivers
GetDevices returns a table with an entry for each device found. The key of the entry is the ID number of the device. The value is a table that contains additional information about the device. The table contains the following key-value pairs:</p>

<table><thead>
<tr>
<th>Key</th>
<th>Value</th>
</tr>
</thead><tbody>
<tr>
<td>driverFileName</td>
<td><code>&lt;driver_filename&gt;</code></td>
</tr>
<tr>
<td>deviceName</td>
<td><code>&lt;device_filename&gt;</code></td>
</tr>
<tr>
<td>roomID</td>
<td><code>&lt;room_ID&gt;</code></td>
</tr>
<tr>
<td>roomName</td>
<td><code>&lt;room_name&gt;</code></td>
</tr>
</tbody></table>

<p>To the right is an example where you would like to get a list of all the remotes in the project. Passing driver names, you would use GetDevices in the following manner:</p>
<div class="highlight"><pre class="highlight lua tab-lua"><code><span class="c1">-- Example 1</span>

<span class="n">tFilter</span> <span class="o">=</span> <span class="p">{</span>
    <span class="n">C4iNames</span> <span class="o">=</span> <span class="s2">"control4_sr260.c4i,
        control4_sr250.c4i, 
        control4_sr150.c4i"</span><span class="p">}</span>

<span class="n">tResult</span> <span class="o">=</span> <span class="n">C4</span><span class="p">:</span><span class="n">GetDevices</span><span class="p">(</span><span class="n">tFilter</span><span class="p">)</span>
</code></pre></div>
<p>The table that is returned by the GetDevices command (that was stored in tReturn) is to the right :</p>
<div class="highlight"><pre class="highlight lua tab-lua"><code> <span class="c1">-- Example 1 Return</span>

    <span class="p">[</span><span class="mi">27</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
        <span class="n">driverFileName</span> <span class="o">=</span> <span class="s2">"control4_sr150.c4i"</span><span class="p">,</span>
        <span class="n">deviceName</span> <span class="o">=</span> <span class="s2">"System Remote Control SR-150"</span><span class="p">,</span>
        <span class="n">roomId</span> <span class="o">=</span> <span class="s2">"26"</span><span class="p">,</span>
        <span class="n">roomName</span> <span class="o">=</span> <span class="s2">"Master"</span>
    <span class="p">},</span>
    <span class="p">[</span><span class="mi">17</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
        <span class="n">driverFileName</span> <span class="o">=</span> <span class="s2">"control4_sr260.c4i"</span><span class="p">,</span>
        <span class="n">deviceName</span> <span class="o">=</span> <span class="s2">"System Remote Control SR260"</span><span class="p">,</span>
        <span class="n">roomId</span> <span class="o">=</span> <span class="s2">"16"</span><span class="p">,</span>
        <span class="n">roomName</span> <span class="o">=</span> <span class="s2">"Dining"</span>
    <span class="p">},</span>
    <span class="p">[</span><span class="mi">21</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
        <span class="n">driverFileName</span> <span class="o">=</span> <span class="s2">"control4_sr150.c4i"</span><span class="p">,</span>
        <span class="n">deviceName</span> <span class="o">=</span> <span class="s2">"System Remote Control SR-150"</span><span class="p">,</span>
        <span class="n">roomId</span> <span class="o">=</span> <span class="s2">"20"</span><span class="p">,</span>
        <span class="n">roomName</span> <span class="o">=</span> <span class="s2">"Laundry"</span>
    <span class="p">},</span>
    <span class="p">[</span><span class="mi">25</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
        <span class="n">driverFileName</span> <span class="o">=</span> <span class="s2">"control4_sr250.c4i"</span><span class="p">,</span>
        <span class="n">deviceName</span> <span class="o">=</span> <span class="s2">"System Remote Control SR-250"</span><span class="p">,</span>
        <span class="n">roomId</span> <span class="o">=</span> <span class="s2">"24"</span><span class="p">,</span>
        <span class="n">roomName</span> <span class="o">=</span> <span class="s2">"Bathroom"</span>
    <span class="p">},</span>
    <span class="p">[</span><span class="mi">19</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
        <span class="n">driverFileName</span> <span class="o">=</span> <span class="s2">"control4_sr150.c4i"</span><span class="p">,</span>
        <span class="n">deviceName</span> <span class="o">=</span> <span class="s2">"System Remote Control SR-150"</span><span class="p">,</span>
        <span class="n">roomId</span> <span class="o">=</span> <span class="s2">"18"</span><span class="p">,</span>
        <span class="n">roomName</span> <span class="o">=</span> <span class="s2">"Kitchen"</span>
    <span class="p">},</span>
    <span class="p">[</span><span class="mi">14</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
        <span class="n">driverFileName</span> <span class="o">=</span> <span class="s2">"control4_sr260.c4i"</span><span class="p">,</span>
        <span class="n">deviceName</span> <span class="o">=</span> <span class="s2">"System Remote Control SR260"</span><span class="p">,</span>
        <span class="n">roomId</span> <span class="o">=</span> <span class="s2">"13"</span><span class="p">,</span>
        <span class="n">roomName</span> <span class="o">=</span> <span class="s2">"Living"</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
<p>In this  example, note the value of 27. This is the index into the table that, in this example, contains a list of key/value pairs of device information for the remote with device id of 27. Based on our return table, we can see the project has six remotes and we can also see which room those remotes are located as well as the location ID value and their respective device name.</p>
<h3 id='example-2'>Example 2</h3>
<p>Return Example for a Proxy Driver 
Proxy Drivers return a table as described in the previous example with the addition of an extra key/value pair. The additional information is the protocol information for the driver. In the table returned, the additional key is the driverFilename and its value is the string of the protocol&#39;s name. The return table structure looks like this:</p>

<table><thead>
<tr>
<th>Key</th>
<th>Value</th>
</tr>
</thead><tbody>
<tr>
<td>driverFileName</td>
<td><code>&lt;driver_filename&gt;</code></td>
</tr>
<tr>
<td>deviceName</td>
<td><code>&lt;device_filename&gt;</code></td>
</tr>
<tr>
<td>roomID</td>
<td><code>&lt;room_ID&gt;</code></td>
</tr>
<tr>
<td>roomName</td>
<td><code>&lt;room_name&gt;</code></td>
</tr>
</tbody></table>

<p>In addition to key value pairs above, a protocol sub-table is also returned that contains the protocol information. This table contains another table with the file name of the protocol and the device name: …</p>

<table><thead>
<tr>
<th>Protocol</th>
<th>Table</th>
</tr>
</thead><tbody>
<tr>
<td>deviceId</td>
<td><code>table</code></td>
</tr>
<tr>
<td>driverFileName</td>
<td><code>&lt;protocol_filename&gt; </code></td>
</tr>
<tr>
<td>deviceName</td>
<td><code>&lt;name_of_devie&gt;</code></td>
</tr>
</tbody></table>

<p>For example, if you would like to get a list of all lights in the project, you could execute GetDevices  passing the <code>light_v2.c4z&quot;</code>as the tFilter parameter.  <code>light_v2.c4z </code>is the proxy file name used by the lights:</p>

<p><code>C4:GetDevices(`light_v2.c4z`)</code></p>

<p>The table that is returned by the GetDevices command looks like this:</p>
<div class="highlight"><pre class="highlight lua tab-lua"><code><span class="c1">-- Example 2</span>

<span class="p">{</span>
    <span class="p">[</span><span class="mi">11</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
        <span class="n">deviceName</span> <span class="o">=</span> <span class="s2">"Keypad Dimmer Light"</span><span class="p">,</span>
        <span class="n">protocol</span> <span class="o">=</span> <span class="p">{</span>
            <span class="p">[</span><span class="mi">10</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
                <span class="n">driverFileName</span> <span class="o">=</span> <span class="err">`</span><span class="n">combo_dimmer</span><span class="p">.</span><span class="n">c4i</span><span class="err">`</span><span class="p">,</span>
                <span class="n">deviceName</span> <span class="o">=</span> <span class="s2">"Keypad Dimmer Light"</span>
            <span class="p">}</span>
        <span class="p">},</span>
        <span class="n">roomName</span> <span class="o">=</span> <span class="s2">"Foyer"</span><span class="p">,</span>
        <span class="n">roomId</span> <span class="o">=</span> <span class="s2">"9"</span><span class="p">,</span>
        <span class="n">driverFileName</span> <span class="o">=</span> <span class="s2">"light_v2.c4i"</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
<p>Based on this return table, we can see that the project has one light., located in the Foyer, which happens to have a location ID of 9. Additionally, we can see the protocol sub-table that  is returned with the driver filename and the device name.</p>

<p>Example 3: Return Example for a Protocol Driver 
Protocol Drivers that have one or more proxies have an additional key-value pair returned from GetDevices. The key is proxies. &quot;proxies&quot; is a table with an entry for each proxy found within the driver.  The key of the entry is the Proxy ID. The value is a table that contains additional information about the proxy, specifically the proxyFilename and deviceName values.</p>

<p>The table contains the following key-value pairs:</p>

<table><thead>
<tr>
<th>Key</th>
<th>Value</th>
</tr>
</thead><tbody>
<tr>
<td>driverFileName</td>
<td><code>&lt;driver_filename&gt;</code></td>
</tr>
<tr>
<td>deviceName</td>
<td><code>&lt;device_filename&gt;</code></td>
</tr>
<tr>
<td>roomID</td>
<td><code>&lt;room_ID&gt;</code></td>
</tr>
<tr>
<td>roomName</td>
<td><code>&lt;room_name&gt;</code></td>
</tr>
</tbody></table>

<p>In addition to key value pairs above, a proxy sub-table is also returned that contains the proxy information. This table contains another table with the file name of the proxy and the device name:</p>

<table><thead>
<tr>
<th>Key</th>
<th>Value</th>
</tr>
</thead><tbody>
<tr>
<td>deviceId</td>
<td><code>table</code></td>
</tr>
<tr>
<td>driverFileName</td>
<td><code>&lt;proxy_filename&gt;</code></td>
</tr>
<tr>
<td>deviceName</td>
<td><code>&lt;name_of_devie&gt;</code></td>
</tr>
</tbody></table>

<p>If the device utilizes multiple proxies, each of those proxies will be represented here by its respective table.</p>

<p>Consider an example where you would like to get a list of all of the keypad dimmers in the project.  These dimmer devices rely on two proxies: a proxy for the dimmer portion of the device <code>light_v2 proxy</code> as well as a proxy for the keypad capabilities <code>keypad_proxy</code>. To do this, you can pass the proxy id value used by the dimmers in the tFilter parameter:</p>
<div class="highlight"><pre class="highlight lua tab-lua"><code><span class="n">tFilter</span> <span class="o">=</span> <span class="p">{</span>
    <span class="n">c4iNames</span> <span class="o">=</span> <span class="s2">"combo_dimmer.c4i"</span><span class="p">}</span>

<span class="n">tResult</span> <span class="o">=</span> <span class="n">C4</span><span class="p">:</span><span class="n">GetDevices</span><span class="p">(</span><span class="n">tFilter</span><span class="p">)</span>

<span class="n">The</span> <span class="n">tReturn</span> <span class="n">table</span> <span class="n">would</span> <span class="n">look</span> <span class="n">like</span> <span class="n">this</span><span class="p">:</span>
<span class="p">{</span>
    <span class="p">[</span><span class="mi">10</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
        <span class="n">deviceName</span> <span class="o">=</span> <span class="s2">"Keypad Dimmer Light"</span><span class="p">,</span>
        <span class="n">proxies</span> <span class="o">=</span> <span class="p">{</span>
            <span class="p">[</span><span class="mi">11</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
                <span class="n">driverFileName</span> <span class="o">=</span> <span class="s2">"light_v2.c4i"</span><span class="p">,</span>
                <span class="n">deviceName</span> <span class="o">=</span> <span class="s2">"Keypad Dimmer Light"</span>
            <span class="p">},</span>
            <span class="p">[</span><span class="mi">12</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
                <span class="n">driverFileName</span> <span class="o">=</span> <span class="s2">"keypad_proxy.c4i"</span><span class="p">,</span>
                <span class="n">deviceName</span> <span class="o">=</span> <span class="s2">"Keypad"</span>
            <span class="p">}</span>
        <span class="p">},</span>
        <span class="n">roomName</span> <span class="o">=</span> <span class="s2">"Foyer"</span><span class="p">,</span>
        <span class="n">roomId</span> <span class="o">=</span> <span class="s2">"9"</span><span class="p">,</span>
        <span class="n">driverFileName</span> <span class="o">=</span> <span class="s2">"combo_dimmer.c4i"</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
<p>Based on this return table, we can see to the right that the project has one light, located in the Foyer, which happens to have a location ID of 9. Additionally, we can see the two proxy sub-tables that are returned with the driver filename.</p>

<h2 id='getdevicesbyname'>GetDevicesByName</h2>
<p>Function used to obtain the Device ID and the Room ID assigned to a device in the project. This API should not be invoked during OnDriverInit.</p>
<h6 id='available-from-2-8-0'>Available from 2.8.0</h6><h3 id='signature'>Signature</h3>
<p><code>C4:GetDeviceByName(str,str)</code></p>

<table><thead>
<tr>
<th>Parameter</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>str</td>
<td>Name of the Device in the project.</td>
</tr>
<tr>
<td>str</td>
<td>Optional. Name of the Room where the Device resides.</td>
</tr>
</tbody></table>
<h3 id='returns'>Returns</h3>
<table><thead>
<tr>
<th>Value</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>table</td>
<td>Device ID and Room ID values.</td>
</tr>
</tbody></table>
<h3 id='usage-note'>Usage Note</h3>
<p>The ID value returned for the Device is actually the Proxy ID.</p>
<h3 id='example'>Example</h3>
<p><code>C4:GetDevicesByName(&quot;AV Switch&quot;,&quot;Theater&quot;)</code></p>

<h2 id='getdeviceid'>GetDeviceID</h2>
<p>Function called from DriverWorks driver to get this driver’s Device ID. This API should not be invoked during OnDriverInit.</p>
<h3 id='signature'>Signature</h3>
<p><code>C4:GetDeviceID()</code></p>

<h2 id='getdevicevariables'>GetDeviceVariables</h2>
<p>Function used to obtain a Device&#39;s variables. This API should not be invoked during OnDriverInit.</p>
<h6 id='available-from-2-8-0'>Available from 2.8.0</h6><h3 id='signature'>Signature</h3>
<p><code>C4:GetDeviceVariables()</code></p>

<table><thead>
<tr>
<th>Parameter</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>num</td>
<td>This is the Proxy ID or the Protocol ID assigned to the Device in the project.</td>
</tr>
</tbody></table>
<h3 id='returns'>Returns</h3>
<table><thead>
<tr>
<th>Value</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>table</td>
<td>Table of all of the proxy variables or protocol variables for the Device (depending on the parameter passed) as well as all of the information for each of the variables.</td>
</tr>
</tbody></table>
<h3 id='example'>Example</h3>
<p><code>C4:GetDeviceVariables(1000)</code></p>

<h2 id='getdriverconfiginfo'>GetDriverConfigInfo</h2>
<p>Function that returns the XML contents of a driver&#39;s config.xml file. This API should not be invoked during OnDriverInit.</p>
<h6 id='available-from-2-8-0'>Available from 2.8.0</h6><h3 id='signature'>Signature</h3>
<p><code>C4:GetDriverConfigInfo()</code></p>

<table><thead>
<tr>
<th>Parameter</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>str</td>
<td>XML tag for the inner XML that is being requested. This is passed in a string format without the XML brackets.</td>
</tr>
</tbody></table>
<h3 id='returns'>Returns</h3>
<table><thead>
<tr>
<th>Value</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>xml</td>
<td>XML of the tag that is passed as a parameter.</td>
</tr>
</tbody></table>
<h3 id='usage-note'>Usage Note</h3>
<p>User defined XML tags can also be returned using this function.</p>
<h3 id='example'>Example</h3>
<p><code>C4:GetDriverConfigInfo(&quot;version&quot;)</code></p>

<h2 id='getdriverfilename'>GetDriverFileName</h2>
<p>Function that returns the name of the filename (i.e., .c4i, .c4z) for a driver.</p>
<h6 id='available-from-3-3-0'>Available from 3.3.0</h6><h3 id='signature'>Signature</h3>
<p><code>C4:GetDriverFileName()</code></p>
<h3 id='parameters'>Parameters</h3>
<p><em>None</em></p>
<h3 id='returns'>Returns</h3>
<table><thead>
<tr>
<th>Value</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>str</td>
<td>Filename of the driver.</td>
</tr>
</tbody></table>

<h2 id='getlocale'>GetLocale</h2>
<p>Function to get the current locale of the system. This API should not be invoked during OnDriverInit.</p>
<h6 id='available-from-1-6-0'>Available from 1.6.0</h6><h3 id='signature'>Signature</h3>
<p><code>C4:GetLocale()</code></p>
<h3 id='parameters'>Parameters</h3>
<p><code>None</code></p>
<h3 id='returns'>Returns</h3>
<p>String of local.</p>
<h3 id='example'>Example</h3><div class="highlight"><pre class="highlight lua tab-lua"><code><span class="nb">print</span><span class="p">(</span><span class="s2">"Current locale is "</span> <span class="o">..</span> <span class="n">C4</span><span class="p">:</span><span class="n">GetLocale</span><span class="p">())</span>
 <span class="n">Output</span><span class="p">:</span> <span class="n">Current</span> <span class="n">locale</span> <span class="n">is</span> <span class="n">C</span>

</code></pre></div>
<h2 id='getprojecthierarchy'>GetProjectHierarchy</h2>
<p>This API returns a table. The table is a representation of the project. The table consists of key/value pairs where the key is the ID of the location. The value is a table with entries of all of the location’s children if any. It also contains the locations name and type.</p>
<h6 id='available-from-2-10-0'>Available from 2.10.0</h6><h3 id='signature'>Signature</h3>
<p><code>C4:GetProjectHierarchy()</code></p>

<table><thead>
<tr>
<th>Parameter</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>str</td>
<td>location (optional) – The location parameter can be passed to identify a specific place in the project where project hierarchy data will be returned. All children of the location specified (including itself) will be included in the results.</td>
</tr>
</tbody></table>
<h3 id='returns'>Returns</h3>
<table><thead>
<tr>
<th>Value</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>table</td>
<td>Table that represents the project hierarchy.</td>
</tr>
</tbody></table>

<h2 id='getprivatekeypassword'>GetPrivateKeyPassword</h2>
<p>This function allows Director to request the private key password from a driver. Implementing GetPrivateKeyPassword within a driver permits a password to be returned for a connection which requires client certificate. When implemented correctly (see Usage Notes below), this function should return the string value of the SSL Certificate password. When using a protected certificate it is highly recommend that the driver be encrypted as there is no protection from this function being called by an end user. </p>
<h6 id='available-from-1-6-0'>Available from 1.6.0</h6>

<table><thead>
<tr>
<th>Parameter</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>num</td>
<td>Binding ID of the network connection with the password-protected certificate.</td>
</tr>
<tr>
<td>num</td>
<td>Port number for the network connection with the password-protected certificate.</td>
</tr>
</tbody></table>

<h3 id='returns'>Returns</h3>

<table><thead>
<tr>
<th>Value</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>str</td>
<td>String value of the SSL Certificate password</td>
</tr>
</tbody></table>

<h3 id='usage-notes'>Usage Notes</h3>

<p><strong>SSL Connection Setup:</strong>
An example “class” of connections that enable the declaration of an SSL connection within a driver file is defined to the right. The code example declares an SSL connection bound to port 2112.</p>

<div class="highlight"><pre class="highlight xml tab-xml"><code><span class="nt">&lt;class&gt;</span>
 <span class="nt">&lt;classname&gt;</span>SSL<span class="nt">&lt;/classname&gt;</span>
 <span class="nt">&lt;ports&gt;</span>
  <span class="nt">&lt;port&gt;</span>
    <span class="nt">&lt;number&gt;</span>2112<span class="nt">&lt;/number&gt;</span>
    <span class="nt">&lt;auto_connect&gt;</span>true<span class="nt">&lt;/auto_connect&gt;</span>
    <span class="nt">&lt;monitor_connection&gt;</span>true<span class="nt">&lt;/monitor_connection&gt;</span>
    <span class="nt">&lt;keep_connection&gt;</span>true<span class="nt">&lt;/keep_connection&gt;</span>
    <span class="nt">&lt;certificate&gt;</span>./cert/cert.pem<span class="nt">&lt;/certificate&gt;</span>
    <span class="nt">&lt;private_key</span> <span class="na">protected=</span><span class="s">"True"</span><span class="nt">&gt;</span>./cert/key.pem<span class="nt">&lt;/private_key&gt;</span>
    <span class="nt">&lt;cacert&gt;</span>./cert/cacert.pem<span class="nt">&lt;/cacert&gt;</span>
    <span class="nt">&lt;verify_mode&gt;</span>peer<span class="nt">&lt;/verify_mode&gt;</span>
    <span class="nt">&lt;method&gt;</span>tlsv12<span class="nt">&lt;/method&gt;</span>
  <span class="nt">&lt;/port&gt;</span>
 <span class="nt">&lt;/ports&gt;</span>
<span class="nt">&lt;/class&gt;</span>
</code></pre></div>

<p>In the driver’s XML definition,  the <code>&lt;port&gt;&lt;/port&gt;</code>section in the example has numerous parameters. Several of these are required for SSL Certificate support. Those parameters are:</p>

<p><code>certificate</code> - Path to the certificate to use for the connection. The path is relative to driver’s C4Z location. In this example, a directory at the root of the .c4z file named cert has been created that contains the SSL files.</p>

<p><code>private_key</code> - Path to the private key to use for the connection. The path is also relative to the driver’s C4Z location and we can see in the example that the key file resides in the cert directory.</p>

<p>If the client cert id password protected, (attribute of True)  then Director will call GetPrivateKeyPassword to retrieve the password from the driver. See the example to the right.</p>

<div class="highlight"><pre class="highlight lua tab-lua"><code><span class="k">function</span> <span class="nf">GetPrivateKeyPassword</span><span class="p">(</span><span class="n">Binding</span><span class="p">,</span> <span class="n">Port</span><span class="p">)</span>
<span class="err">   </span><span class="k">return</span> <span class="s1">'TheKey'</span>
<span class="k">end</span>
</code></pre></div>

<p><code>cacert</code> - Path to the CA (certificate authority) certificate to use for the connection. As with the cert.pem and key.pem files, in our example cacert.pem resides in the created cert directory.</p>

<p>Note that It is not required to split the <code>&lt;certificate&gt;, &lt;private_key&gt;</code> and <code>&lt;cacert&gt;</code> elements out into separate driver files to work properly.  If the SSL cert files are maintained in individual driver files, their respective directory names must be passed in the connection XML.</p>

<p><code>verify_mode</code> - Specifies the verification mode to use for the connection. The verify mode corresponds to those supported by OpenSSL. Note that Control4 currently supports only the peer verification mode <code>SSL_VERIFY_PEER</code>. Value values include:</p>

<ul>
<li>none</li>
<li>peer</li>
</ul>

<p>If this property is omitted, then Director defaults to use no verification (“none”).</p>

<p><code>method</code> - Specifies the method to use for establishing the connection. Valid values include:</p>

<ul>
<li>sslv2</li>
<li>sslv23</li>
<li>sslv3</li>
<li>tlsv1</li>
<li>tlsv11</li>
<li>tlsv12</li>
</ul>

<p>If this property is omitted, then Director defaults to using sslv23 (which is the OpenSSL default).</p>

<p><strong>.c4zproj Update:</strong>
Once the SSL connection XML is correctly configured to include the driver directory that contains your SSL cert files, it will be necessary to update your driver’s c4zproj manifest XML to include the new directory. Based on the example above, the addition of the following line is required within the <code>&lt;Items&gt;&lt;/Items&gt;</code>section of the manifest :</p>

<p><code>&lt;Item type=&quot;dir&quot; c4zDir=&quot;cert&quot; name=&quot;cert&quot; recurse=&quot;true&quot; exclude=&quot;false&quot; /&gt;</code></p>

<h2 id='getprojectitems'>GetProjectItems</h2>

<p>If no parameter is passed, this API returns the entire project as an .XML string. This string can then be parsed to retrieve variable IDs. The API supports several parameters (filters) that will return specific XML. This API should not be invoked during OnDriverInit.</p>

<p><h6 id='available-from-1-6-0'>Available from 1.6.0</h6><h3 id='signature'>Signature</h3>
<p><code>C4:GetProjectItems()</code></p></p>

<table><thead>
<tr>
<th>Parameter</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>str</td>
<td>Filter. Optional, Filters can be applied to GetProjectItems(). Each filter is a separate string parameter to the function. The list of filters include: ALL, LOCATIONS, PROXIES, DEVICES, AGENTS, LIMIT_DEVICE_DATA, JUST_CAPABILITIES and NO_ROOT_TAGS</td>
</tr>
</tbody></table>

<h3 id='returns'>Returns</h3>

<table><thead>
<tr>
<th>Value</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>str</td>
<td>Project data in XML format.</td>
</tr>
</tbody></table>

<h3 id='examples'>Examples</h3>

<p>To return the entire project in XML: </p>

<p><code>print(C4:GetProjectItems())
</code></p>

<p>To return general information about the project i.e. location, dealer info, etc:</p>

<p><code>print(C4:GetProjectItems(&quot;LOCATIONS&quot;, &quot;LIMIT_DEVICE_DATA&quot;,&quot;NO_ROOT_TAGS&quot;))</code></p>

<h2 id='getsystemtype'>GetSystemType</h2>

<p>Function that returns the controller type used as the primary controller in a project. Returns OS Info of Windows when called from a Virtual Director environment.</p>

<p><h6 id='available-from-2-9-0'>Available from 2.9.0</h6><h3 id='signature'>Signature</h3>
<p><code>C4:GetSystemType()</code></p>
<h3 id='parameter'>Parameter</h3>
<p><code>None</code></p>
<h3 id='returns'>Returns</h3>
<p><code>None</code></p>
<h3 id='examples'>Examples</h3>
<p><code>print(C4:GetSystemType())</code>
Output: <code>XDT_EA5</code></p></p>

<p>Virtual Director Example:</p>

<p><code>print(C4:GetSystemType())</code>
Output: <code>XDT_Windows</code>_ </p>

<h2 id='gettext'>GetText</h2>

<p>Function to get a string translated into the current locale from a “C” (English) input string. This will only return translated strings if there is a corresponding input -&gt; translation match in the current translated string for the set locale. If no translation is found the input string is returned. This API can be invoked during OnDriverInit.</p>

<p><h6 id='available-from-1-6-0'>Available from 1.6.0</h6><h3 id='signature'>Signature</h3>
<p><code>C4:GetText()</code></p></p>

<table><thead>
<tr>
<th>Parameter</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>str</td>
<td>String to be translated</td>
</tr>
</tbody></table>

<h3 id='returns'>Returns</h3>

<table><thead>
<tr>
<th>Value</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>str</td>
<td>Translated string</td>
</tr>
</tbody></table>

<h3 id='example'>Example</h3><div class="highlight"><pre class="highlight lua tab-lua"><code><span class="nb">print</span> <span class="p">(</span><span class="s2">"Translation of stop is "</span> <span class="o">..</span> <span class="n">C4</span><span class="p">:</span><span class="n">GetText</span><span class="p">(</span><span class="s2">"stop"</span><span class="p">))</span>

<span class="n">Output</span><span class="p">:</span> 

<span class="n">Translation</span> <span class="n">of</span> <span class="n">stop</span> <span class="n">is</span> <span class="n">stop</span>
</code></pre></div>
<h2 id='getuniquemac'>GetUniqueMAC</h2>
<p>Function to get the unique MAC address of the Director box. This API can be invoked during OnDriverInit.</p>
<h6 id='available-from-1-6-0'>Available from 1.6.0</h6><h3 id='signature'>Signature</h3>

<p><code>C4:GetUniqueMAC()</code></p>

<p>Parameter</p>

<p><code>None</code></p>

<h3 id='returns'>Returns</h3>

<p><code>None</code></p>

<h3 id='usage-note'>Usage Note</h3>

<p>The unique MAC may not be the active MAC if multiple NICs are present. For example, for systems using a wireless interface the MAC returned will be the MAC of the wired Ethernet card. When using Virtual Director, the MAC returned will be the PC&#39;s MAC address.</p>

<h3 id='example'>Example</h3>

<p><code>print(&quot;Unique mac is &quot; .. C4:GetUniqueMAC())</code>
Output: <code>Unique mac is 000FFF102F73</code></p>

<h2 id='ntoh-1'>ntoh  1</h2>

<p>Function called from DriverWorks driver to get a capability from the driver’s .c4z file. This API should not be invoked during OnDriverInit.</p>

<p><h6 id='available-from-1-6-0'>Available from 1.6.0</h6><h3 id='signature'>Signature</h3>
<p><code>C4:ntoh_1()</code></p></p>

<table><thead>
<tr>
<th>Parameter</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>str</td>
<td>The name of the capability to retrieve</td>
</tr>
</tbody></table>

<h3 id='returns'>Returns</h3>

<table><thead>
<tr>
<th>Value</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>str</td>
<td>The value of the capability retrieved from the driver file</td>
</tr>
</tbody></table>

<h3 id='example'>Example</h3>

<p>If this device supports discrete volume control, send discrete volume, otherwise, send a Volume Up or Volume Down command:</p>

<div class="highlight"><pre class="highlight lua tab-lua"><code><span class="k">if</span> <span class="p">(</span><span class="n">C4</span><span class="p">:</span><span class="n">GetCapability</span><span class="p">(</span><span class="s2">"has_discrete_volume_control"</span><span class="p">)</span> <span class="o">==</span> <span class="s2">"False"</span><span class="p">)</span> <span class="k">then</span>
  <span class="k">if</span> <span class="p">(</span><span class="n">VolumeValue</span> <span class="o">&gt;</span> <span class="n">CurVolumeValue</span><span class="p">)</span> <span class="k">then</span>
    <span class="n">SendVolumeUp</span><span class="p">()</span>
  <span class="k">else</span>
    <span class="n">SendVolumeDown</span><span class="p">()</span>
  <span class="k">end</span>
<span class="k">else</span>
  <span class="n">SendVolumeDiscrete</span><span class="p">(</span><span class="n">VolumeValue</span><span class="p">)</span>
<span class="n">End</span>
<span class="n">OnBindingChanged</span>
</code></pre></div>

<h2 id='htoh-2'>htoh  2</h2>

<p>Converts the numeric value passed in to network byte order. This API can be invoked during OnDriverInit.</p>

<p><h6 id='available-from-1-6-0'>Available from 1.6.0</h6><h3 id='signature'>Signature</h3>
<p><code>C4:htoh_1()</code></p></p>

<table><thead>
<tr>
<th>Parameter</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>int</td>
<td>Number to be converted</td>
</tr>
</tbody></table>

<h3 id='returns'>Returns</h3>

<table><thead>
<tr>
<th>Value</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>str</td>
<td>8 byte string representing the converted network byte order</td>
</tr>
</tbody></table>

<h3 id='usage-note'>Usage Note</h3>

<p>This function is typically used to convert numeric values to be passed over a network, when the byte order of the two ends is unknown or may be different from each other. This way, ‘little-endian’ and ‘big-endian’ machines can communicate without confusion. ‘Host’ byte order is the byte order of values on the local machine, and ‘Network’ byte order is the standard byte order on Ethernet networks.</p>

<h3 id='example'>Example</h3><div class="highlight"><pre class="highlight plaintext"><code>nbo = C4:ntoh_l(0x34120000)
print("network val is " .. nbo)
Output: network val is 00001234
</code></pre></div>
<h2 id='onbindingchanged'>OnBindingChanged</h2>
<p>Converts the numeric value passed in to network byte order. This API can be invoked during OnDriverInit.</p>
<h6 id='available-from-1-6-0'>Available from 1.6.0</h6><h3 id='signature'>Signature</h3>

<p><code>C4:OnBindingChanged(idBinding, strClass, bIsBound, otherDeviceID, otherBindngID) </code></p>

<table><thead>
<tr>
<th>Parameter</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>num</td>
<td>ID of the binding whose state has changed</td>
</tr>
<tr>
<td>str</td>
<td>Class of binding that has changed. A single binding can have multiple classes: COMPONENT, STEREO, etc</td>
</tr>
<tr>
<td>bool</td>
<td>Whether the binding has been bound or unbound.</td>
</tr>
<tr>
<td>num</td>
<td>ID value representing the device that IS NOT the Device who&#39;s Binding ID is the first parameter for this API.</td>
</tr>
<tr>
<td>otherBindingID</td>
<td>Binding ID  for the device represented by the otherDeviceID value in the parameter above.</td>
</tr>
</tbody></table>

<h3 id='returns'>Returns</h3>

<p><code>None</code></p>

<h3 id='usage-note'>Usage Note</h3>

<p>Protocol drivers do not get OnBindingChanged notifications for AV and Room bindings being bound, only  control type bindings (Serial, IR, etc.). It is intended to be used specifically for when serial bindings are made, so the driver knows it can send initialization, etc. to the now-connected device.</p>

<h2 id='ondriverdestroyed'>OnDriverDestroyed</h2>

<p>Called when a driver is deleted from a project, updated within a project or Director is shut down. All of the driver&#39;s timers will be killed within the OnDriverDestroyed function.</p>

<p><h6 id='available-from-1-6-0'>Available from 1.6.0</h6><h3 id='signature'>Signature</h3>
<p><code>OnDriverDestroyed(strDIT) </code></p></p>

<table><thead>
<tr>
<th>Parameter</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>str</td>
<td>This optional parameter indicates the scenario in which the driver is initializing. Scenarios include:</td>
</tr>
<tr>
<td></td>
<td><code>DIT_UPDATING</code>: Called as a result of the driver being updated.</td>
</tr>
<tr>
<td></td>
<td><code>DIT_LOADED</code>: Called manually after the driver has already been loaded.</td>
</tr>
</tbody></table>

<p>The DIT parameters are available in O.S. 3.2.0 and later.</p>

<h3 id='usage-note'>Usage Note</h3>

<p><strong>Driver Initialization and Destruction</strong></p>

<p>When a driver is loaded, there are two initialization functions that are called if those functions exist in the driver. They are OnDriverInit and OnDriverLateInit. When a driver is being removed, updated or otherwise removed from memory, OnDriverDestroyed will be called if that function has been implemented within the driver.</p>

<p>Your driver will need to implement these functions in order to complete its initialization process successfully. It’s important to know when these functions are called in order to know how to properly initialize a driver.</p>

<p>There are multiple instances of when a driver is loaded. Driver initialization occurs under the following conditions:</p>

<p><strong>Driver Added to Project</strong> </p>

<p>When a driver is added to a project, OnDriverInit will be called followed by a call to OnDriverLateInit.</p>

<p><strong>Project Load </strong></p>

<p>When a project is loaded, either when director starts up or a new project is loaded, the following occurs:</p>

<ol>
<li>As each driver is loaded, the OnDriverInit function is called.</li>
<li>After all the drivers in the project have been loaded, then OnDriverLateInit is called for all the drivers in the project. This ensures that all the driver’s bindings and initialization is complete. Any initialization that requires that all the bindings be bound, or other driver initialization is complete should be done in OnDriverLateInit.</li>
</ol>

<p><strong>Driver Update</strong> </p>

<p>When a driver is being updated, prior to the driver being reloaded, OnDriverDestroyed will be called. This will allow the driver to do any necessary cleanup prior to the driver being reloaded. When the driver is reloaded, OnDriverInit will be called followed by a call to OnDriverLateInit.</p>

<p>There may be instances when a driver needs to know under what condition or event caused the Initialization or Destroyed functions to be called. OS Release 3.2.0 introduced a new string parameter to these functions to identify the reason for the call. This parameter, driverInitType (DIT) provides this information.</p>

<p>OnDriverInit and OnDriverLateInit valid values for this parameter are as follows:</p>

<p>• <code>DIT_ADDING</code>: When a driver is being added.</p>

<p>• <code>DIT_STARTUP</code>: When a project is being loaded.</p>

<p>• <code>DIT_UPDATING</code>: When a driver is being updated.</p>

<p>OnDriverDestroyed valid values are as follows:</p>

<p>• <code>DIT_LOADED</code>: When the driver is being removed or director is being shut down.</p>

<p>• <code>DIT_UPDATING</code>: When a driver is being updated.</p>

<h3 id='example'>Example</h3><div class="highlight"><pre class="highlight lua tab-lua"><code><span class="c1">-- Release things this driver had allocated...</span>

<span class="k">function</span> <span class="nf">OnDriverDestroyed</span><span class="p">()</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">driverInitType</span> <span class="o">==</span> <span class="s2">"DIT_UPDATING"</span><span class="p">)</span> <span class="k">then</span>
        <span class="c1">-- Invoked prior to a driver being updated</span>
    <span class="k">elseif</span> <span class="p">(</span><span class="n">driverInitType</span> <span class="o">==</span> <span class="s2">"DIT_ LOADED"</span><span class="p">)</span> <span class="k">then</span>
        <span class="c1">-- Invoked prior to the driver being unloaded or</span>
        <span class="c1">-- removed from a project.</span>
    <span class="k">end</span>
<span class="k">end</span>
</code></pre></div>
<h2 id='ondriverinit'>OnDriverInit</h2>
<p>Function invoked when a driver is loaded or being updated. This API is provided for the driver developer to initialize all of the driver objects that require initialization. </p>
<h6 id='available-from-2-0-0'>Available from 2.0.0</h6><h3 id='signature'>Signature</h3>

<p><code>OnDriverInit(strDIT) </code></p>

<table><thead>
<tr>
<th>Parameter</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>str</td>
<td>This optional parameter indicates the scenario in which the driver is initializing. Scenarios include:</td>
</tr>
<tr>
<td></td>
<td><code>DIT_ADDING</code>: Called as a result of the driver being added to a project.</td>
</tr>
<tr>
<td></td>
<td><code>DIT_STARTUP</code>: Called as a result of Director starting or a new project being loaded.</td>
</tr>
<tr>
<td></td>
<td><code>DIT_UPDATING</code>: Called as a result of the driver being updated.</td>
</tr>
</tbody></table>

<p>The DIT parameters are available in O.S. 3.2.0 and later.</p>

<h3 id='usage-note'>Usage Note</h3>

<p><strong>Driver Initialization and Destruction</strong></p>

<p>When a driver is loaded, there are two initialization functions that are called if those functions exist in the driver. They are OnDriverInit and OnDriverLateInit. When a driver is being removed, updated or otherwise removed from memory, OnDriverDestroyed will be called if that function has been implemented within the driver.</p>

<p>Your driver will need to implement these functions in order to complete its initialization process successfully. It’s important to know when these functions are called in order to know how to properly initialize a driver.</p>

<p>There are multiple instances of when a driver is loaded. Driver initialization occurs under the following conditions:</p>

<p><strong>Driver Added to Project</strong> </p>

<p>When a driver is added to a project, OnDriverInit will be called followed by a call to OnDriverLateInit.</p>

<p><strong>Project Load </strong></p>

<p>When a project is loaded, either when director starts up or a new project is loaded, the following occurs:
1. As each driver is loaded, the OnDriverInit function is called.
2. After all the drivers in the project have been loaded, then OnDriverLateInit is called for all the drivers in the project. This ensures that all the driver’s bindings and initialization is complete. Any initialization that requires that all the bindings be bound, or other driver initialization is complete should be done in OnDriverLateInit.</p>

<p><strong>Driver Update</strong> </p>

<p>When a driver is being updated, prior to the driver being reloaded, OnDriverDestroyed will be called. This will allow the driver to do any necessary cleanup prior to the driver being reloaded. When the driver is reloaded, OnDriverInit will be called followed by a call to OnDriverLateInit.</p>

<p>There may be instances when a driver needs to know under what condition or event caused the Initialization or Destroyed functions to be called. OS Release 3.2.0 introduced a new string parameter to these functions to identify the reason for the call. This parameter, driverInitType (DIT) provides this information.</p>

<p>OnDriverInit and OnDriverLateInit valid values for this parameter are as follows:</p>

<ul>
<li><code>DIT_ADDING</code>: When a driver is being added.</li>
<li><code>DIT_STARTUP</code>: When a project is being loaded.</li>
<li><code>DIT_UPDATING</code>: When a driver is being updated.</li>
</ul>

<p>OnDriverDestroyed valid values are as follows:</p>

<ul>
<li><code>DIT_LOADED</code>: When the driver is being removed or director is being shut down.</li>
<li><code>DIT_UPDATING</code>: When a driver is being updated.</li>
</ul>

<h3 id='example'>Example</h3><div class="highlight"><pre class="highlight lua tab-lua"><code><span class="k">function</span> <span class="nf">OnDriverInit</span><span class="p">(</span><span class="n">driverInitType</span><span class="p">)</span>

    <span class="c1">-- Fire On Property Changed to set the initial Headers and other</span>
    <span class="c1">-- Property global sets, they'll change if Property is changed.</span>
    <span class="k">for</span> <span class="n">k</span><span class="p">,</span><span class="n">v</span> <span class="k">in</span> <span class="nb">pairs</span><span class="p">(</span><span class="n">Properties</span><span class="p">)</span> <span class="k">do</span>
       <span class="n">OnPropertyChanged</span><span class="p">(</span><span class="n">k</span><span class="p">)</span>
    <span class="k">end</span>

    <span class="n">C4</span><span class="p">:</span><span class="n">AddVariable</span><span class="p">(</span><span class="s2">"LIGHT_LEVEL"</span><span class="p">,</span> <span class="s2">"0"</span><span class="p">,</span> <span class="s2">"INT"</span><span class="p">)</span>
    <span class="n">C4</span><span class="p">:</span><span class="n">AddVariable</span><span class="p">(</span><span class="s2">"FIRMWARE_VERSION"</span><span class="p">,</span> <span class="s2">""</span><span class="p">,</span> <span class="s2">"STRING"</span><span class="p">)</span>
    <span class="n">C4</span><span class="p">:</span><span class="n">AddVariable</span><span class="p">(</span><span class="s2">"EMERGENCY_MODE"</span><span class="p">,</span> <span class="s2">""</span><span class="p">,</span> <span class="s2">"BOOL"</span><span class="p">)</span>

    <span class="k">if</span> <span class="p">(</span><span class="n">driverInitType</span> <span class="o">==</span> <span class="s2">"DIT_ADDING"</span><span class="p">)</span> <span class="k">then</span>
        <span class="c1">-- Initialization needed only when the driver is added</span>
        <span class="c1">-- to a project</span>
    <span class="k">elseif</span> <span class="p">(</span><span class="n">driverInitType</span> <span class="o">==</span> <span class="s2">"DIT_STARTUP"</span><span class="p">)</span> <span class="k">then</span>
        <span class="c1">-- Initialization needed only during initial startup</span>
    <span class="k">elseif</span> <span class="p">(</span><span class="n">driverInitType</span> <span class="o">==</span> <span class="s2">"DIT_UPDATING"</span><span class="p">)</span> <span class="k">then</span>
        <span class="c1">-- Initialization needed only after a driver update</span>
    <span class="k">end</span>
<span class="k">end</span>
</code></pre></div>
<h2 id='ondriverlateinit'>OnDriverLateInit</h2>
<p>Function  that serves as a callback into a project after the project is loaded. If any initialization has to occur after the project is loaded, it must occur in OndriverLateInit. See the <a href="https://snap-one.github.io/docs-driverworks-api/#safe-usage-of-ondriverinit-and-ondriverlateinit">safe usage table</a> for a list of APIs that can be invoked before OnDriverLateInit is executed.</p>
<h6 id='available-from-2-5-0'>Available from 2.5.0</h6><h3 id='signature'>Signature</h3>

<p><code>OnDriverLateInit(strDIT) </code></p>

<table><thead>
<tr>
<th>Parameter</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>str</td>
<td>This optional parameter indicates the scenario in which the driver is initializing. Scenarios include:</td>
</tr>
<tr>
<td></td>
<td><code>DIT_ADDING</code>: Called as a result of the driver being added to a project.</td>
</tr>
<tr>
<td></td>
<td><code>DIT_STARTUP</code>: Called as a result of Director starting or a new project being loaded.</td>
</tr>
<tr>
<td></td>
<td><code>DIT_UPDATING</code>: Called as a result of the driver being updated.</td>
</tr>
</tbody></table>

<p>The DIT parameters are available in O.S. 3.2.0 and later.</p>

<h3 id='usage-note'>Usage Note</h3>

<p><strong>Driver Initialization and Destruction</strong>
When a driver is loaded, there are two initialization functions that are called if those functions exist in the driver. They are OnDriverInit and OnDriverLateInit. When a driver is being removed, updated or otherwise removed from memory, OnDriverDestroyed will be called if that function has been implemented within the driver.</p>

<p>Your driver will need to implement these functions in order to complete its initialization process successfully. It’s important to know when these functions are called in order to know how to properly initialize a driver.</p>

<p>There are multiple instances of when a driver is loaded. Driver initialization occurs under the following conditions:</p>

<p><strong>Driver Added to Project</strong></p>

<p>When a driver is added to a project, OnDriverInit will be called followed by a call to OnDriverLateInit.</p>

<p><strong>Project Load </strong></p>

<p>When a project is loaded, either when director starts up or a new project is loaded, the following occurs:
1. As each driver is loaded, the OnDriverInit function is called.
2. After all the drivers in the project have been loaded, then OnDriverLateInit is called for all the drivers in the project. This ensures that all the driver’s bindings and initialization is complete. Any initialization that requires that all the bindings be bound, or other driver initialization is complete should be done in OnDriverLateInit.</p>

<p><strong>Driver Update</strong></p>

<p>When a driver is being updated and prior to the driver being reloaded, OnDriverDestroyed will be called. This will allow the driver to do any necessary cleanup prior to the driver being reloaded. When the driver is reloaded, OnDriverInit will be called followed by a call to OnDriverLateInit.</p>

<p>There may be instances when a driver needs to know under what condition or event caused the Initialization or Destroyed functions to be called. OS Release 3.2.0 introduced a new string parameter to these functions to identify the reason for the call. This parameter, driverInitType (DIT) provides this information.</p>

<p>OnDriverInit and OnDriverLateInit valid values for this parameter are as follows:</p>

<ul>
<li><code>DIT_ADDING</code>: When a driver is being added.</li>
<li><code>DIT_STARTUP</code>: When a project is being loaded.</li>
<li><code>DIT_UPDATING</code>: When a driver is being updated.</li>
</ul>

<p>OnDriverDestroyed valid values are as follows:</p>

<ul>
<li><code>DIT_LOADED</code>: When the driver is being removed or director is being shut down.</li>
<li><code>DIT_UPDATING</code>: When a driver is being updated.</li>
</ul>

<h3 id='example'>Example</h3><div class="highlight"><pre class="highlight lua tab-lua"><code><span class="k">function</span> <span class="nf">OnDriverLateInit</span><span class="p">(</span><span class="n">driverInitType</span><span class="p">)</span>

    <span class="k">if</span> <span class="p">(</span><span class="n">driverInitType</span> <span class="o">==</span> <span class="s2">"DIT_ADDING"</span><span class="p">)</span> <span class="k">then</span>
        <span class="c1">-- Initialization needed only when the driver is added</span>
        <span class="c1">-- to a project</span>
    <span class="k">elseif</span> <span class="p">(</span><span class="n">driverInitType</span> <span class="o">==</span> <span class="s2">"DIT_STARTUP"</span><span class="p">)</span> <span class="k">then</span>
        <span class="c1">-- Initialization needed only during initial startup</span>
    <span class="k">elseif</span> <span class="p">(</span><span class="n">driverInitType</span> <span class="o">==</span> <span class="s2">"DIT_UPDATING"</span><span class="p">)</span> <span class="k">then</span>
        <span class="c1">-- Initialization needed only after a driver update</span>
    <span class="k">end</span>

<span class="c1">-- Release things this driver had allocated...</span>
<span class="k">function</span> <span class="nf">OnDriverDestroyed</span><span class="p">()</span>
<span class="k">end</span>

</code></pre></div>
<h2 id='safe-usage-of-ondriverinit-and-ondriverlateinit'>Safe Usage of OnDriverInit and OnDriverLateInit</h2>
<p>As best practice, Control4 recommends invoking certain API functions prior to <a href="https://snap-one.github.io/docs-driverworks-api/#ondriverlateinit">OnDriverLateInit</a>. The table below identifies functions that can safely be invoked during driver initialization through <a href="https://snap-one.github.io/docs-driverworks-api/#ondriverinit">OnDriverInit</a> with a designation of &quot;YES&quot;. Some API functions have significant performance impacts to Director during startup or have been proven to produce non-deterministic results when invoked in <a href="https://snap-one.github.io/docs-driverworks-api/#ondriverinit">OndriverInit</a>. The APIs are identified in the table below with a designation of &quot;NO&quot;.</p>

<table><thead>
<tr>
<th><strong>API</strong></th>
<th><strong>Invoke Before OnDriverLateInit </strong></th>
<th><strong>Notes</strong></th>
</tr>
</thead><tbody>
<tr>
<td>AddDynamicBinding</td>
<td>Warning</td>
<td>No Events will be sent prior to OnDriverlateInit. If an Event is required, this must be invoked in OnDriverLateInit</td>
</tr>
<tr>
<td>AddEvent</td>
<td>NO</td>
<td></td>
</tr>
<tr>
<td>AddTimer</td>
<td>NO</td>
<td></td>
</tr>
<tr>
<td>AddVariable</td>
<td>YES</td>
<td>Note that Variables need to be added in OnDriverInit. Programming attached to variables added after OnDriverInit may not work properly on Director restart.</td>
</tr>
<tr>
<td>AllowExecute</td>
<td>YES</td>
<td></td>
</tr>
<tr>
<td>Attach</td>
<td>NO</td>
<td></td>
</tr>
<tr>
<td>Base64Decode</td>
<td>YES</td>
<td></td>
</tr>
<tr>
<td>Base64Encode</td>
<td>YES</td>
<td></td>
</tr>
<tr>
<td>blowfishEcbdecrypt</td>
<td>YES</td>
<td></td>
</tr>
<tr>
<td>blowfishECbEncrypt</td>
<td>YES</td>
<td></td>
</tr>
<tr>
<td>CallAsynch</td>
<td>NO</td>
<td></td>
</tr>
<tr>
<td>CheckLicense</td>
<td>NO</td>
<td></td>
</tr>
<tr>
<td>Close</td>
<td>NO</td>
<td></td>
</tr>
<tr>
<td>Connect</td>
<td>NO</td>
<td></td>
</tr>
<tr>
<td>CreateNetworkConnection</td>
<td>NO</td>
<td></td>
</tr>
<tr>
<td>CreateServer</td>
<td>NO</td>
<td></td>
</tr>
<tr>
<td>CreateTCPClient</td>
<td>NO</td>
<td></td>
</tr>
<tr>
<td>CreateTCPServer</td>
<td>NO</td>
<td></td>
</tr>
<tr>
<td>DebugLog</td>
<td>YES</td>
<td></td>
</tr>
<tr>
<td>Decode</td>
<td>YES</td>
<td></td>
</tr>
<tr>
<td>Decrypt</td>
<td>YES</td>
<td></td>
</tr>
<tr>
<td>DeleteEvent</td>
<td>NO</td>
<td></td>
</tr>
<tr>
<td>DeleteVariable</td>
<td>NO</td>
<td></td>
</tr>
<tr>
<td>DestroyServer</td>
<td>NO</td>
<td></td>
</tr>
<tr>
<td>DisbableRemoteDebugging</td>
<td>NO</td>
<td></td>
</tr>
<tr>
<td>EnableRemoteDebugging</td>
<td>NO</td>
<td></td>
</tr>
<tr>
<td>Encode</td>
<td>YES</td>
<td></td>
</tr>
<tr>
<td>Encrypt</td>
<td>YES</td>
<td></td>
</tr>
<tr>
<td>ErrorLog</td>
<td>YES</td>
<td></td>
</tr>
<tr>
<td>ExecuteCommand</td>
<td>NO</td>
<td></td>
</tr>
<tr>
<td>FileClose</td>
<td>YES</td>
<td></td>
</tr>
<tr>
<td>FileDelete</td>
<td>YES</td>
<td></td>
</tr>
<tr>
<td>FileExists</td>
<td>YES</td>
<td></td>
</tr>
<tr>
<td>FileFreeSpace</td>
<td>YES</td>
<td></td>
</tr>
<tr>
<td>FileGetName</td>
<td>YES</td>
<td></td>
</tr>
<tr>
<td>FileGetOpenedHandles</td>
<td>YES</td>
<td></td>
</tr>
<tr>
<td>FileGetPos</td>
<td>YES</td>
<td></td>
</tr>
<tr>
<td>FileGetSize</td>
<td>YES</td>
<td></td>
</tr>
<tr>
<td>FileIsValid</td>
<td>YES</td>
<td></td>
</tr>
<tr>
<td>FileList</td>
<td>YES</td>
<td></td>
</tr>
<tr>
<td>FileOpen</td>
<td>YES</td>
<td></td>
</tr>
<tr>
<td>FileRead</td>
<td>Yes</td>
<td></td>
</tr>
<tr>
<td>FileSetPos</td>
<td>YES</td>
<td></td>
</tr>
<tr>
<td>FileWrite</td>
<td>YES</td>
<td></td>
</tr>
<tr>
<td>FileWriteString</td>
<td>YES</td>
<td></td>
</tr>
<tr>
<td>FireEvent</td>
<td>NO</td>
<td></td>
</tr>
<tr>
<td>FireEventByID</td>
<td>NO</td>
<td></td>
</tr>
<tr>
<td>GetBindingAddress</td>
<td>NO</td>
<td></td>
</tr>
<tr>
<td>GetBlobByName</td>
<td>NO</td>
<td></td>
</tr>
<tr>
<td>GetBoundConsumerDevices</td>
<td>NO</td>
<td></td>
</tr>
<tr>
<td>GetBoundProviderDevice</td>
<td>NO</td>
<td></td>
</tr>
<tr>
<td>GetCapability</td>
<td>NO</td>
<td></td>
</tr>
<tr>
<td>GetControllerNetworkAddress</td>
<td>NO</td>
<td></td>
</tr>
<tr>
<td>GetDeviceDisplayName</td>
<td>NO</td>
<td></td>
</tr>
<tr>
<td>GetDeviceID</td>
<td>NO</td>
<td></td>
</tr>
<tr>
<td>GetDevicesByC4iName</td>
<td>NO</td>
<td></td>
</tr>
<tr>
<td>GetDevicesByName</td>
<td>NO</td>
<td></td>
</tr>
<tr>
<td>GetDeviceVariable</td>
<td>NO</td>
<td></td>
</tr>
<tr>
<td>GetDeviceVariables</td>
<td>NO</td>
<td></td>
</tr>
<tr>
<td>GetDriverConfigInfo</td>
<td>NO</td>
<td></td>
</tr>
<tr>
<td>GetLocalAddress</td>
<td>NO</td>
<td></td>
</tr>
<tr>
<td>GetLocale</td>
<td>NO</td>
<td></td>
</tr>
<tr>
<td>GetMyNetworkAddress</td>
<td>NO</td>
<td></td>
</tr>
<tr>
<td>GetPrivateKeyPassword</td>
<td>YES</td>
<td></td>
</tr>
<tr>
<td>GetProjectItems</td>
<td>NO</td>
<td></td>
</tr>
<tr>
<td>GetProxyDevices</td>
<td>NO</td>
<td></td>
</tr>
<tr>
<td>GetProxyDevicesbyID</td>
<td>NO</td>
<td></td>
</tr>
<tr>
<td>GetProxyDevicesByName</td>
<td>NO</td>
<td></td>
</tr>
<tr>
<td>GetPushSettings</td>
<td>NO</td>
<td></td>
</tr>
<tr>
<td>GetRemoteAddress</td>
<td>NO</td>
<td></td>
</tr>
<tr>
<td>GetSerialSettings</td>
<td>NO</td>
<td></td>
</tr>
<tr>
<td>GetSupportedCiphers</td>
<td>YES</td>
<td></td>
</tr>
<tr>
<td>GetSupportedDigests</td>
<td>YES</td>
<td></td>
</tr>
<tr>
<td>GetText</td>
<td>YES</td>
<td></td>
</tr>
<tr>
<td>GetUniqueMAC</td>
<td>YES</td>
<td></td>
</tr>
<tr>
<td>GetVariable</td>
<td>NO</td>
<td></td>
</tr>
<tr>
<td>GetVersionInfo</td>
<td>YES</td>
<td></td>
</tr>
<tr>
<td>GetZigbeeEUID</td>
<td>NO</td>
<td></td>
</tr>
<tr>
<td>Hash</td>
<td>YES</td>
<td></td>
</tr>
<tr>
<td>hexdump(strdump)</td>
<td>YES</td>
<td></td>
</tr>
<tr>
<td>HMAC</td>
<td>YES</td>
<td></td>
</tr>
<tr>
<td>hton_1</td>
<td>YES</td>
<td></td>
</tr>
<tr>
<td>InvalidateState</td>
<td>NO</td>
<td></td>
</tr>
<tr>
<td>JSON:decode</td>
<td>NO</td>
<td></td>
</tr>
<tr>
<td>JSON:encode</td>
<td>YES</td>
<td></td>
</tr>
<tr>
<td>KeepReflashLock</td>
<td>NO</td>
<td></td>
</tr>
<tr>
<td>KillTimer</td>
<td>NO</td>
<td></td>
</tr>
<tr>
<td>Listen</td>
<td>NO</td>
<td></td>
</tr>
<tr>
<td>ListEvent</td>
<td>NO</td>
<td></td>
</tr>
<tr>
<td>ListGetDeviceContainer</td>
<td>NO</td>
<td></td>
</tr>
<tr>
<td>ListGetDeviceName</td>
<td>NO</td>
<td></td>
</tr>
<tr>
<td>ListGetItems</td>
<td>NO</td>
<td></td>
</tr>
<tr>
<td>ListGetRoomID NO</td>
<td></td>
<td></td>
</tr>
<tr>
<td>ListGetSelectedDevice</td>
<td>NO</td>
<td></td>
</tr>
<tr>
<td>ListGoToRoot</td>
<td>NO</td>
<td></td>
</tr>
<tr>
<td>ListIsInNavigation</td>
<td>NO</td>
<td></td>
</tr>
<tr>
<td>ListIsStarted</td>
<td>NO</td>
<td></td>
</tr>
<tr>
<td>ListMIBReceived NO</td>
<td></td>
<td></td>
</tr>
<tr>
<td>ListNewControl</td>
<td>NO</td>
<td></td>
</tr>
<tr>
<td>ListNewList</td>
<td>NO</td>
<td></td>
</tr>
<tr>
<td>ListSendCommand</td>
<td>NO</td>
<td></td>
</tr>
<tr>
<td>ListSetCapabilities</td>
<td>NO</td>
<td></td>
</tr>
<tr>
<td>ListStart</td>
<td>NO</td>
<td></td>
</tr>
<tr>
<td>ListStop</td>
<td>NO</td>
<td></td>
</tr>
<tr>
<td>MediaAddAlbumInfo</td>
<td>NO</td>
<td></td>
</tr>
<tr>
<td>MediaAddBroadcastAudioInfo</td>
<td>NO</td>
<td></td>
</tr>
<tr>
<td>MediaAddMovieInfo</td>
<td>NO</td>
<td></td>
</tr>
<tr>
<td>MediaGetAlbumInfo</td>
<td>NO</td>
<td></td>
</tr>
<tr>
<td>MediaGetAlbumLocation</td>
<td>NO</td>
<td></td>
</tr>
<tr>
<td>MediaGetAllAlbums</td>
<td>NO</td>
<td></td>
</tr>
<tr>
<td>MediaGetAllBroadcastAudio</td>
<td>NO</td>
<td></td>
</tr>
<tr>
<td>MediaGetAllMovies</td>
<td>NO</td>
<td></td>
</tr>
<tr>
<td>MediaGetAllBroadcastAudioInfo</td>
<td>NO</td>
<td></td>
</tr>
<tr>
<td>MediaGetDeviceContext</td>
<td>NO</td>
<td></td>
</tr>
<tr>
<td>MediaGetMovieInfo</td>
<td>NO</td>
<td></td>
</tr>
<tr>
<td>MediaGetMovieLocation</td>
<td>NO</td>
<td></td>
</tr>
<tr>
<td>MediaGetSongInfo</td>
<td>NO</td>
<td></td>
</tr>
<tr>
<td>MediaGetSongLocation</td>
<td>NO</td>
<td></td>
</tr>
<tr>
<td>MediaGetSongsforAlbum</td>
<td>NO</td>
<td></td>
</tr>
<tr>
<td>MediaLinkSongToAlbum</td>
<td>NO</td>
<td></td>
</tr>
<tr>
<td>MediaModifyAlbumInfo</td>
<td>NO</td>
<td></td>
</tr>
<tr>
<td>MediaModifyMovieInfo</td>
<td>NO</td>
<td></td>
</tr>
<tr>
<td>MediaModifySongInfo</td>
<td>NO</td>
<td></td>
</tr>
<tr>
<td>MediaRemoveAlbum</td>
<td>NO</td>
<td></td>
</tr>
<tr>
<td>MediaRemoveAllAlbums</td>
<td>NO</td>
<td></td>
</tr>
<tr>
<td>MediaRemoveAllMedia</td>
<td>NO</td>
<td></td>
</tr>
<tr>
<td>MediaRemoveBroadcastAudio</td>
<td>NO</td>
<td></td>
</tr>
<tr>
<td>MediaRemoveMovie</td>
<td>NO</td>
<td></td>
</tr>
<tr>
<td>MediaRemoveSong</td>
<td>NO</td>
<td></td>
</tr>
<tr>
<td>MediaRemoveAllMovies</td>
<td>NO</td>
<td></td>
</tr>
<tr>
<td>MediaSetDeviceContent</td>
<td>NO</td>
<td></td>
</tr>
<tr>
<td>NetConnect</td>
<td>NO</td>
<td></td>
</tr>
<tr>
<td>NetDisconnect</td>
<td>NO</td>
<td></td>
</tr>
<tr>
<td>NetPortOptions</td>
<td>NO</td>
<td></td>
</tr>
<tr>
<td>Option</td>
<td>NO</td>
<td></td>
</tr>
<tr>
<td>ParseIso8601DateTime</td>
<td>YES</td>
<td></td>
</tr>
<tr>
<td>ParseXml</td>
<td>YES</td>
<td></td>
</tr>
<tr>
<td>PBKDF2</td>
<td>YES</td>
<td></td>
</tr>
<tr>
<td>Print</td>
<td>YES</td>
<td></td>
</tr>
<tr>
<td>ReadAtLeast</td>
<td>NO</td>
<td></td>
</tr>
<tr>
<td>ReadUntil</td>
<td>NO</td>
<td></td>
</tr>
<tr>
<td>ReadUntilOneOf</td>
<td>NO</td>
<td></td>
</tr>
<tr>
<td>ReadUpTo</td>
<td>NO</td>
<td></td>
</tr>
<tr>
<td>ReceivedAsync</td>
<td>NO</td>
<td></td>
</tr>
<tr>
<td>ReceivedFromNetwork</td>
<td>NO</td>
<td></td>
</tr>
<tr>
<td>ReceivedFromProxy</td>
<td>NO</td>
<td></td>
</tr>
<tr>
<td>ReceivedFromSerial</td>
<td>NO</td>
<td></td>
</tr>
<tr>
<td>RegisterVariableListewner</td>
<td>WARNING</td>
<td>Does not work if variable does not exist.</td>
</tr>
<tr>
<td>ReleaseReflashLock</td>
<td>NO</td>
<td></td>
</tr>
<tr>
<td>RemoveDynamicBinding</td>
<td>WARNING</td>
<td>No Events will be sent prior to OnDriverlateInit. If an Event is required, this must be invoked in OnDriverLateInit.</td>
</tr>
<tr>
<td>RenameDevice</td>
<td>NO</td>
<td></td>
</tr>
<tr>
<td>RequestReflashLock</td>
<td>NO</td>
<td></td>
</tr>
<tr>
<td>RoomGetId</td>
<td>NO</td>
<td></td>
</tr>
<tr>
<td>RoomSelectNav</td>
<td>NO</td>
<td></td>
</tr>
<tr>
<td>ReadUntilOneNotOf</td>
<td>NO</td>
<td></td>
</tr>
<tr>
<td>SendDataToUI</td>
<td>NO</td>
<td></td>
</tr>
<tr>
<td>SendIR</td>
<td>NO</td>
<td></td>
</tr>
<tr>
<td>SendIRStart</td>
<td>NO</td>
<td></td>
</tr>
<tr>
<td>SendIRStop</td>
<td>YES</td>
<td></td>
</tr>
<tr>
<td>SendToDevice</td>
<td>NO</td>
<td></td>
</tr>
<tr>
<td>SendToNetwork</td>
<td>NO</td>
<td></td>
</tr>
<tr>
<td>SendToProxy</td>
<td>NO</td>
<td></td>
</tr>
<tr>
<td>SendToSerial</td>
<td>NO</td>
<td></td>
</tr>
<tr>
<td>SendZigbeePacket</td>
<td>NO</td>
<td></td>
</tr>
<tr>
<td>ServerCloseClient</td>
<td>NO</td>
<td></td>
</tr>
<tr>
<td>ServerSend</td>
<td>NO</td>
<td></td>
</tr>
<tr>
<td>SetBindingAddress</td>
<td>NO</td>
<td></td>
</tr>
<tr>
<td>SetDeviceVariable</td>
<td>NO</td>
<td></td>
</tr>
<tr>
<td>SetPropertyAttribs</td>
<td>NO</td>
<td></td>
</tr>
<tr>
<td>SetTimer</td>
<td>NO</td>
<td></td>
</tr>
<tr>
<td>SetVariable</td>
<td>NO</td>
<td></td>
</tr>
<tr>
<td>TEADecrypt</td>
<td>YES</td>
<td></td>
</tr>
<tr>
<td>TEAEncrypt</td>
<td>YES</td>
<td></td>
</tr>
<tr>
<td>tohex</td>
<td>YES</td>
<td></td>
</tr>
<tr>
<td>tonumber_loc</td>
<td>YES</td>
<td></td>
</tr>
<tr>
<td>UnRegisterVariableListener</td>
<td>WARNING</td>
<td>Does not work if variable has not been registered, added or does not exist.</td>
</tr>
<tr>
<td>UpdateProperty</td>
<td>NO</td>
<td></td>
</tr>
<tr>
<td>UpdatePropertyList</td>
<td>NO</td>
<td></td>
</tr>
<tr>
<td>urlCancel</td>
<td>NO</td>
<td></td>
</tr>
<tr>
<td>urlCancelAll</td>
<td>NO</td>
<td></td>
</tr>
<tr>
<td>urlCustom</td>
<td>NO</td>
<td></td>
</tr>
<tr>
<td>urlDelete</td>
<td>NO</td>
<td></td>
</tr>
<tr>
<td>urlGet</td>
<td>NO</td>
<td></td>
</tr>
<tr>
<td>urlGetOption</td>
<td>NO</td>
<td></td>
</tr>
<tr>
<td>urlGetTickets</td>
<td>NO</td>
<td></td>
</tr>
<tr>
<td>urlPost</td>
<td>NO</td>
<td></td>
</tr>
<tr>
<td>urlPut</td>
<td>NO</td>
<td></td>
</tr>
<tr>
<td>urlSetOption</td>
<td>NO</td>
<td></td>
</tr>
<tr>
<td>urlSetProxy</td>
<td>NO</td>
<td></td>
</tr>
<tr>
<td>urlSetTimeout</td>
<td>NO</td>
<td></td>
</tr>
<tr>
<td>XmlEscapeString</td>
<td>NO</td>
<td></td>
</tr>
</tbody></table>

<h2 id='ondriver-removedfromproject'>OnDriver RemovedFromProject</h2>
<p>Called whenever a driver is removed or deleted from a project. This API is useful if a driver has any cleanup requirements or needs to send any final commands to a device prior to being removed or deleted from a project. If so, those should be implemented within this function.</p>
<h6 id='available-from-2-1-0'>Available from 2.1.0</h6><h3 id='signature'>Signature</h3>

<p><code>C4:OnDriverRemovedFromProject</code></p>

<h2 id='parseiso8601datetime'>ParseIso8601DateTime</h2>

<p>Parses a ISO 8601 date/time stamp to UTC (Coordinated Universal Time). This API can be invoked during OnDriverInit.</p>

<p><h6 id='available-from-2-7-0'>Available from 2.7.0</h6><h3 id='signature'>Signature</h3>
<p><code>C4:ParseIso8601DateTime(str[, strict])</code></p></p>

<table><thead>
<tr>
<th>Parameter</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>str</td>
<td>The string to be parsed.</td>
</tr>
<tr>
<td>bool</td>
<td>Optional. Strict parsing type,. Defaults to false.  If enabled, leading or trailing  whitespace will cause the function to fail.</td>
</tr>
</tbody></table>

<h3 id='returns'>Returns</h3>

<table><thead>
<tr>
<th>Parameter</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>table</td>
<td>similar to what a os.date(&quot;t&quot;) call would return, except that the isdst field will be missing due to it being UTC.</td>
</tr>
<tr>
<td>num</td>
<td>The Number of the second epoch in UTC.</td>
</tr>
<tr>
<td>num</td>
<td>The fraction of a second, expressed in microseconds.</td>
</tr>
</tbody></table>

<h3 id='usage-note'>Usage Note</h3>

<p>If the functions fails, nothing is returned.</p>

<h3 id='example'>Example</h3><div class="highlight"><pre class="highlight lua tab-lua"><code><span class="kd">local</span> <span class="n">t</span><span class="p">,</span> <span class="n">epoch</span><span class="p">,</span> <span class="n">microsecs</span> <span class="o">=</span> <span class="n">C4</span><span class="p">:</span><span class="n">ParseIso8601DateTime</span><span class="p">(</span><span class="s2">"2014-01-01T12:01:00.750+01:00"</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="nb">os.date</span><span class="p">(</span><span class="s2">"%x %X"</span><span class="p">,</span> <span class="nb">os.time</span><span class="p">(</span><span class="n">t</span><span class="p">))</span> <span class="o">..</span> <span class="s2">" and "</span> <span class="o">..</span> <span class="n">microsecs</span> <span class="o">..</span> <span class="s2">" microseconds"</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">"Seconds since epoch (utc) = "</span> <span class="o">..</span> <span class="n">epoch</span><span class="p">)</span>
<span class="n">t</span> <span class="o">=</span> <span class="n">C4</span><span class="p">:</span><span class="n">ParseIso8601DateTime</span><span class="p">(</span><span class="s2">"   2014-01-01T12:01:00.750+01:00  "</span><span class="p">,</span> <span class="kc">true</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">"t = "</span> <span class="o">..</span> <span class="nb">tostring</span><span class="p">(</span><span class="n">t</span><span class="p">))</span>
<span class="cm">--[[
  Example output:
   01/01/14 11:01:00 and 750000 microseconds
   Seconds since epoch (utc) = 1388574060
   t = nil
--]]</span>
</code></pre></div>
<h2 id='persistdeleteall'>PersistDeleteAll</h2>
<p>Deletes all values. See PersistGetValue and PersistSetValue</p>
<h6 id='available-from-2-10-0'>Available from 2.10.0</h6><h3 id='signature'>Signature</h3>

<p><code>C4:PersistDeleteAll()</code></p>

<p>Parameter</p>

<p><code>None</code></p>

<h3 id='returns'>Returns</h3>

<p><code>None</code></p>

<h3 id='example'>Example</h3>

<p><code>C4:PersistDeleteAll()</code></p>

<h2 id='persistgetvalue'>PersistGetValue</h2>

<p>Returns the value associated with the specified name. This API can be used before OnDriverLateInit.</p>

<p><h6 id='available-from-2-10-0'>Available from 2.10.0</h6><h3 id='signature'>Signature</h3>
<p><code>C4:PersistGetValue()</code></p></p>

<table><thead>
<tr>
<th>Parameter</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>str</td>
<td>A string containing the name of the value.</td>
</tr>
<tr>
<td>bool</td>
<td>Boolean indicating whether the value is encrypted. If true, the value is decrypted before it is returned</td>
</tr>
</tbody></table>

<h3 id='returns'>Returns</h3>

<table><thead>
<tr>
<th>Parameter</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>value</td>
<td>The value associated with the specified name, or nil if no value was found. Can be : number, string, boolean, table.</td>
</tr>
</tbody></table>

<h3 id='example'>Example</h3>

<p><code>local Foo = C4:PersistGetValue(&quot;Foo&quot;) </code></p>

<h2 id='persistsetvalue'>PersistSetValue</h2>

<p>Persists a value associated with the specified name. This API can be used before OnDriverLateInit.</p>

<p><h6 id='available-from-2-10-0'>Available from 2.10.0</h6><h3 id='signature'>Signature</h3>
<p><code>C4:PersistSetValue(name, value, encrypted) </code></p></p>

<table><thead>
<tr>
<th>Parameter</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>str</td>
<td>A string containing the name of the value.</td>
</tr>
<tr>
<td>value</td>
<td>The value to be persisted. The type can be any one of the following: number, string, boolean, table.</td>
</tr>
</tbody></table>

<h3 id='returns'>Returns</h3>

<table><thead>
<tr>
<th>Value</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>value</td>
<td>The value associated with the specified name, or nil if no value was found.</td>
</tr>
<tr>
<td>bool</td>
<td>Boolean indicating whether the value is encrypted before persisting.</td>
</tr>
</tbody></table>

<h3 id='usage-note'>Usage Note</h3>

<p>The value parameter type depends on the value that was set previously and can be one of the following: number, string, boolean, table.If the value parameter is a table, then the elements within the table must be one of the following types: number, string, boolean, table, nil. Tables can contain any combination of types, including nested tables. However, C4:PersistSetValue will fail if the table, or any nested table, contains any elements of the following types: lightuserdata, userdata, function, thread.</p>

<p>PersistSetValue uses its own thread for pushing values to the database. This thread doesn&#39;t start running until just before OnDriverLateInit. All values destined for the database are queued up so is lost. However, there is a window of time during which calling <a href="https://snap-one.github.io/docs-driverworks-api/#persistgetvalue">C4:PersistGetValue</a> might not return values set previously with C4.PersistSetValue.</p>

<h3 id='example'>Example</h3><div class="highlight"><pre class="highlight lua tab-lua"><code><span class="n">C4</span><span class="p">:</span><span class="n">PersistSetValue</span><span class="p">(</span><span class="s2">"Foo"</span><span class="p">,</span> <span class="s2">"Bar"</span><span class="p">)</span>
<span class="kd">local</span> <span class="n">Foo</span> <span class="o">=</span> <span class="n">C4</span><span class="p">:</span><span class="n">PersistGetValue</span><span class="p">(</span><span class="s2">"Foo"</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">Foo</span><span class="p">)</span>

<span class="o">...</span>

<span class="kd">local</span> <span class="n">Foo</span> <span class="o">=</span> <span class="p">{</span>
<span class="err"> </span> <span class="err"> </span> <span class="n">Biz</span> <span class="o">=</span> <span class="s2">"Baz"</span><span class="p">,</span>
<span class="err"> </span> <span class="err"> </span> <span class="n">Qux</span> <span class="o">=</span> <span class="s2">"Norf
}

C4:PersistSetValue("</span><span class="n">Foo</span><span class="s2">", Foo)

local Bar = C4:PersistGetValue("</span><span class="n">Foo</span><span class="s2">")
print(Bar["</span><span class="n">Biz</span><span class="s2">"])
print(Bar["</span><span class="n">Qux</span><span class="s2">"])
</span></code></pre></div>
<h2 id='removedynamicbinding'>RemoveDynamicBinding</h2>
<p>Function called by a DriverWorks driver to remove a dynamically created binding. This API should not be invoked during OnDriverInit. No Events will be sent prior to OnDriverlateInit. If an event is required, this method must be invoked in OnDriverlateInit.</p>
<h6 id='available-from-1-6-0'>Available from 1.6.0</h6><h3 id='signature'>Signature</h3>

<p><code>C4:RemoveDynamicBinding(idBinding)</code></p>

<table><thead>
<tr>
<th>Parameter</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>num</td>
<td>ID of the dynamic binding to remove.</td>
</tr>
</tbody></table>

<h3 id='returns'>Returns</h3>

<p><code>None</code></p>

<h2 id='renamedevice'>RenameDevice</h2>

<p>The ReNameDevice API supports the ability to rename a device that is currently in a Control4 project from a driver. This API can be also called from a driver other than that of the device&#39;s. This supports that ability to rename project devices externally. This API should not be invoked during OnDriverInit.</p>

<p><h6 id='available-from-1-6-0'>Available from 1.6.0</h6><h3 id='signature'>Signature</h3>
<p><code>C4:RenameDevice(proxyId, name)</code>
or
<code>C4:RenameDevice(deviceId, name)</code></p></p>

<table><thead>
<tr>
<th>Parameter</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>num</td>
<td>The Proxy ID value of the device being renamed</td>
</tr>
<tr>
<td>num</td>
<td>Device ID of the device being renamed.</td>
</tr>
<tr>
<td>str</td>
<td>New device name.</td>
</tr>
</tbody></table>

<h3 id='returns'>Returns</h3>

<p><code>None</code></p>

<h3 id='usage-note'>Usage Note</h3>

<p>Note that ComposerPro shows the Proxy Device and not the protocol drivers id.  In most cases, the Lua Driver’s deviceId is the protocol ID and is probably not the id to be changed. When this API is executed it will refresh the project. This API works if called in OnDriverLateInit. It will not work in onDriverInit.</p>

<h3 id='example'>Example</h3>

<p><code>C4:RenameDevice(9, &quot;Testing&quot;)</code></p>

<h2 id='roomgetid'>RoomGetId</h2>

<p>Function to get the ID value of the room containing the driver. This API should not be invoked during OnDriverInit.</p>

<p><h6 id='available-from-1-6-0'>Available from 1.6.0</h6><h3 id='signature'>Signature</h3>
<p><code>C4:RoomGetId()</code></p>
<h3 id='parameters'>Parameters</h3>
<p><code>None</code></p>
<h3 id='returns'>Returns</h3>
<table><thead>
<tr>
<th>Parameter</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>int</td>
<td>Device ID of containing room.</td>
</tr>
</tbody></table>
<h3 id='example'>Example</h3><div class="highlight"><pre class="highlight plaintext"><code>idRoom = C4:RoomGetId()
print(&quot;Room id is &quot; .. idRoom)
</code></pre></div>
<h2 id='roomselectnav'>RoomSelectNav</h2>
<p>Function to force the selection of onscreen for the selected room. This API should not be invoked during OnDriverInit.</p>
<h6 id='available-from-1-6-0'>Available from 1.6.0</h6><h3 id='signature'>Signature</h3>
<p><code>C4:RoomSelectNav (int)</code></p></p>

<table><thead>
<tr>
<th>Parameter</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>int</td>
<td>Device ID of the room to force onscreen selection</td>
</tr>
</tbody></table>

<h3 id='returns'>Returns</h3>

<p><code>None</code></p>

<h3 id='example'>Example</h3>

<p><code>C4:RoomSelectnav(C4:RoomGetId())</code></p>

<h2 id='senddatatoui'>SendDataToUI</h2>

<p>Function to send data to subscribed navigators. This API should not be invoked during OnDriverInit.</p>

<p><h6 id='available-from-1-6-0'>Available from 1.6.0</h6><h3 id='signature'>Signature</h3>
<p>This API has a dual signature. It can be used to send an XML string or a command with parameters.</p></p>

<p><code>C4:SendDataToUI (xml)</code></p>

<table><thead>
<tr>
<th>Parameter</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>str</td>
<td>xml string to send</td>
</tr>
</tbody></table>

<p><code>C4:SendDataToUI (strCommand, tParams)</code></p>

<table><thead>
<tr>
<th>Parameter</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>strCommand</td>
<td>Command to be sent to subscribed navigators.</td>
</tr>
<tr>
<td>tParams</td>
<td>Lua table of parameters for the command.</td>
</tr>
</tbody></table>

<h3 id='returns'>Returns</h3>

<p><code>None</code></p>

<h3 id='usage-note'>Usage Note</h3>

<p>The xml must be properly formatted and escaped for the function to succeed. Only navigators that have set up subscriptions to receive data from this device will receive the sent data.</p>

<h3 id='example'>Example</h3>

<p>Sending XML string:</p>

<p><code>C4:SendDataToUI(&quot;&lt;myxml&gt;xml data to be sent to navs&lt;/myxml&gt;&quot;)</code></p>

<p>Sending command with parameters:</p>

<p><code>C4:SendDataToUI(&quot;DRIVER_COMMAND&quot;, { PARAM1 = &quot;Data1&quot;, PARAM2 = &quot;Data1&quot; })</code></p>

<h2 id='senduirequest'>SendUIRequest</h2>

<p>Function that sends a request to another driver. It uses the proxy or protocol ID value of the driver as a means to target the driver where the request will be sent. The driver receiving the SendUIRequest must have an a UIRequest function configured which will contain the return values requested by the SendUIRequest call.</p>

<p><h6 id='available-from-2-9-0'>Available from 2.9.0</h6><h3 id='signature'>Signature</h3>
<p><code>C4:SendUIRequest (int,string, tParams)</code></p></p>

<table><thead>
<tr>
<th>Parameter</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>int</td>
<td>Proxy or protocol ID value of the driver receiving the SendUIRequest</td>
</tr>
<tr>
<td>str</td>
<td>Request to send in string format</td>
</tr>
<tr>
<td>table</td>
<td>Table containing values sent with the request. If no values are needed an empty table must be sent.</td>
</tr>
</tbody></table>

<h3 id='returns'>Returns</h3>

<p>Data is returned to the driver sending the SendUIRequest in XML format.</p>

<h3 id='examples'>Examples</h3>

<p><code>C4:SendUIRequest(231, &quot;GET_MY_DRIVER_DATA&quot;, tParams)</code></p>

<p>The above example is used below in a driver initiating the SendUIRequest. In this example, the API contains a value of 231. This is the proxy ID value of the driver where the request is being sent. This is followed by a request called  <code>GET_MY_DRIVER_DATA</code>. This is an expected request by the driver receiving the SendUIRequest. A table of parameters follows the command.  </p>

<div class="highlight"><pre class="highlight lua tab-lua"><code><span class="k">function</span> <span class="nf">TestUIRequest</span><span class="p">()</span>
    <span class="kd">local</span> <span class="n">tParams</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="n">tParams</span><span class="p">[</span><span class="s2">"PARAM_X"</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1024</span>
    <span class="n">tParams</span><span class="p">[</span><span class="s2">"PARAM_Y"</span><span class="p">]</span> <span class="o">=</span> <span class="mi">768</span>
    <span class="n">C4</span><span class="p">:</span><span class="n">SendUIRequest</span><span class="p">(</span><span class="mi">231</span><span class="p">,</span> <span class="s2">"GET_MY_DRIVER_DATA"</span><span class="p">,</span> <span class="n">tParams</span><span class="p">)</span>
<span class="k">end</span>
</code></pre></div>

<p>To the right is an example of the required UIRequest found in the driver receiving the SendUIRequest. In this example, when the request is received it takes the values in the tParams table and, if they are not a specified value of 640 or 480, multiplies them by 10. It then formats the values into XML and returns them through retValue to the driver that initiated the SendUIRequest.</p>

<div class="highlight"><pre class="highlight lua tab-lua"><code><span class="k">function</span> <span class="nf">UIRequest</span><span class="p">(</span><span class="n">sRequest</span><span class="p">,</span> <span class="n">tParams</span><span class="p">)</span>
<span class="err">   </span> <span class="n">tParams</span> <span class="o">=</span> <span class="n">tParams</span> <span class="ow">or</span> <span class="p">{}</span>
<span class="err">   </span> <span class="kd">local</span> <span class="n">param_x</span> <span class="o">=</span> <span class="nb">tonumber</span><span class="p">(</span><span class="n">tParams</span><span class="p">[</span><span class="s2">"PARAM_X"</span><span class="p">])</span> <span class="ow">or</span> <span class="mi">640</span>
<span class="err">   </span> <span class="kd">local</span> <span class="n">param_y</span> <span class="o">=</span> <span class="nb">tonumber</span><span class="p">(</span><span class="n">tParams</span><span class="p">[</span><span class="s2">"PARAM_Y"</span><span class="p">])</span> <span class="ow">or</span> <span class="mi">480</span>
    <span class="err">               </span>
<span class="err">         </span><span class="kd">local</span> <span class="n">value_x</span> <span class="o">=</span> <span class="n">param_x</span> <span class="o">*</span> <span class="mi">10</span>
<span class="err">         </span><span class="kd">local</span> <span class="n">value_y</span> <span class="o">=</span> <span class="n">param_y</span> <span class="o">*</span> <span class="mi">10</span>
    <span class="err">               </span>
<span class="err">         </span><span class="kd">local</span> <span class="n">retValue</span> <span class="o">=</span> <span class="s2">"&lt;driver_data&gt;"</span>
<span class="err">         </span><span class="n">retValue</span> <span class="o">=</span> <span class="n">retValue</span> <span class="o">..</span> <span class="s2">"&lt;value_x&gt;"</span> <span class="o">..</span> <span class="n">value_x</span> <span class="o">..</span> <span class="s2">"&lt;/value_x&gt;"</span>
<span class="err">         </span><span class="n">retValue</span> <span class="o">=</span> <span class="n">retValue</span> <span class="o">..</span> <span class="s2">"&lt;value_y&gt;"</span> <span class="o">..</span> <span class="n">value_y</span> <span class="o">..</span> <span class="s2">"&lt;/value_y&gt;"</span>
<span class="err">         </span><span class="n">retValue</span> <span class="o">=</span> <span class="n">retValue</span> <span class="o">..</span> <span class="s2">"&lt;/driver_data&gt;"</span>
    <span class="err">               </span>
<span class="err">   </span> <span class="k">return</span> <span class="n">retValue</span>
<span class="k">end</span>
</code></pre></div>

<p>The XML below the example is the returned value.</p>

<div class="highlight"><pre class="highlight lua tab-lua"><code><span class="c1">--Returned Value</span>

<span class="o">&lt;</span><span class="n">driver_data</span><span class="o">&gt;</span>
<span class="err">   </span> <span class="o">&lt;</span><span class="n">value_x</span><span class="o">&gt;</span><span class="mi">10240</span><span class="o">&lt;/</span><span class="n">value_x</span><span class="o">&gt;</span>
<span class="err">   </span> <span class="o">&lt;</span><span class="n">value_y</span><span class="o">&gt;</span><span class="mi">7680</span><span class="o">&lt;/</span><span class="n">value_y</span><span class="o">&gt;</span>
<span class="o">&lt;/</span><span class="n">driver_data</span><span class="o">&gt;</span>
</code></pre></div>

<h2 id='setpropertyattribs'>SetPropertyAttribs</h2>

<p>Function to modify the visibility of properties as viewed from Composer. This API should not be invoked during OnDriverInit.</p>

<p><h6 id='available-from-1-6-0'>Available from 1.6.0</h6><h3 id='signature'>Signature</h3>
<p><code>C4:SetPropertyAttribs(string, int)</code></p></p>

<table><thead>
<tr>
<th>Parameter</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>str</td>
<td>Name of property to modify</td>
</tr>
<tr>
<td>int</td>
<td>0 (to show) or 1 (to hide)</td>
</tr>
</tbody></table>

<h3 id='returns'>Returns</h3>

<p><code>None</code></p>

<h3 id='example'>Example</h3>

<p>The following code would hide the property named “resolution” in the Lua property page for this driver:
<code>C4:SetPropertyAttribs(&quot;Resolution&quot;, 1)</code></p>

<h2 id='teadecrypt'>TEADecrypt</h2>

<p>Decrypt the input string with Corrected Block TEA (XXTEA) Algorithm, using the specified key. This API can be invoked during OnDriverInit.</p>

<p><h6 id='available-from-1-6-0'>Available from 1.6.0</h6><h3 id='signature'>Signature</h3>
<p><code>C4:TEADecrypt(strBuf, strKey)</code></p></p>

<table><thead>
<tr>
<th>Parameter</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>str</td>
<td>String to be decrypted</td>
</tr>
<tr>
<td>key</td>
<td>Key to use for decryption. Keys are 32 hex digits, encoded as a string (128-bit).</td>
</tr>
</tbody></table>

<h3 id='returns'>Returns</h3>

<table><thead>
<tr>
<th>Parameter</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>str</td>
<td>Decrypted version of input string.</td>
</tr>
</tbody></table>

<h3 id='usage-note'>Usage Note</h3>

<p>Key must be the same for encryption / decryption to function properly. The input string (strBuf) must be padded to a 4-byte boundary. More information about the Corrected Block TEA algorithm (XXTEA) as well as a compatible C implementation of XXTEA may be found at Wikipedia: <a href="http://en.wikipedia.org/wiki/XXTEA">http://en.wikipedia.org/wiki/XXTEA</a></p>

<h3 id='example'>Example</h3>

<p>Encrypt then Decrypt a string, then print the original string out:</p>

<p>local key = &quot;1234567887654321abcdefabcabcdefa&quot;
    e = C4:TEAEncrypt(&quot;Control4 Rocks! &quot;, key)
    print(C4:TEADecrypt(e, key))</p>

<p>-- prints &quot;Control4 Rocks! </p>

<h2 id='teaencrypt'>TEAEncrypt</h2>

<p>Encrypt the input string with Corrected Block TEA (XXTEA) Algorithm, using the specified key. This API can be invoked during OnDriverInit</p>

<p><h6 id='available-from-1-6-0'>Available from 1.6.0</h6><h3 id='signature'>Signature</h3>
<p><code>C4:TEAEncrypt(strBuf, strKey)</code></p></p>

<table><thead>
<tr>
<th>Parameter</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>str</td>
<td>String to be encrypted</td>
</tr>
<tr>
<td>key</td>
<td>Key to use for encryption. Keys are 32 hex digits, encoded as a string (128-bit).</td>
</tr>
</tbody></table>

<h3 id='returns'>Returns</h3>

<table><thead>
<tr>
<th>Parameter</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>str</td>
<td>TEA Encrypted version of input string</td>
</tr>
</tbody></table>

<h3 id='usage-note'>Usage Note</h3>

<p>Key must be the same for encryption / decryption to function properly. The input string (strBuf) must be padded to a 4-byte boundary. More information about the Corrected Block TEA algorithm (XXTEA) as well as a compatible C implementation of XXTEA may be found at Wikipedia: <a href="https://en.wikipedia.org/wiki/XXTEA">http://en.wikipedia.org/wiki/XXTEA</a></p>

<h3 id='example'>Example</h3>

<p>Encrypt then Decrypt a string, then print the original string out:</p>

<p>local key = &quot;1234567887654321abcdefabcabcdefa&quot;
    e = C4:TEAEncrypt(&quot;Control4 Rocks! &quot;, key)
    print(C4:TEADecrypt(e, key))</p>

<p>-- prints &quot;Control4 Rocks! </p>
<h1 id='notification-interface'>Notification Interface</h1>

<h2 id='notification-interface'>Notification Interface</h2>

<p>Beginning with OS 3, device drivers have the ability to include .jpeg files within notifications. These images are displayed as part of the notification. The .jpeg file can be retrieved from a cloud service that supports the device, from the device itself or from a location on a Control4 Controller.</p>

<p>Leveraging this functionality in a driver requires the following:</p>

<ol>
<li>Configuration: New Driver XML implementation to support attachment notifications and attachment source locations</li>
<li>Execution: API implementation for each source location needed.</li>
</ol>

<h3 id='configuration'>Configuration</h3>

<p>Required Driver XML: In order for a driver to support attachments within the notifications sent by the Notification Agent, the following XML element must be included and set to True:</p>

<p><code>&lt;notification_attachment_provider&gt;True&lt;/notification_attachment_provider&gt;</code></p>

<p>Once set to True, the Notification Agent in ComposerPro now includes a new attachment field.</p>

<p>There are three types of .jpeg attachments that can be included in the Push Notification: Memory, File or Snapshot (URL). Note that any combination of the three may be implemented in the driver XML. This is largely dependent upon the device&#39;s capabilities. When the following XML is added to the driver these options are available through the Add button:</p>

<div class="highlight"><pre class="highlight xml tab-xml"><code><span class="nt">&lt;notification_attachments&gt;</span>
              <span class="nt">&lt;attachment&gt;</span>
                    <span class="nt">&lt;id&gt;</span>1001<span class="nt">&lt;/id&gt;</span>
                    <span class="nt">&lt;type&gt;</span>IMAGE_JPEG<span class="nt">&lt;/type&gt;</span>
                    <span class="nt">&lt;description&gt;</span>Current Snapshot<span class="nt">&lt;/description&gt;</span>
                    <span class="nt">&lt;source&gt;</span>MEMORY<span class="nt">&lt;/source&gt;</span>
              <span class="nt">&lt;/attachment&gt;</span>
              <span class="nt">&lt;attachment&gt;</span>
                    <span class="nt">&lt;id&gt;</span>1002<span class="nt">&lt;/id&gt;</span>
                    <span class="nt">&lt;type&gt;</span>IMAGE_JPEG<span class="nt">&lt;/type&gt;</span>
                    <span class="nt">&lt;description&gt;</span>Snapshot (FILE)<span class="nt">&lt;/description&gt;</span>
                    <span class="nt">&lt;source&gt;</span>FILE<span class="nt">&lt;/source&gt;</span>
              <span class="nt">&lt;/attachment&gt;</span>
              <span class="nt">&lt;attachment&gt;</span>
                     <span class="nt">&lt;id&gt;</span>1003<span class="nt">&lt;/id&gt;</span>
                     <span class="nt">&lt;type&gt;</span>IMAGE_JPEG<span class="nt">&lt;/type&gt;</span>
                     <span class="nt">&lt;description&gt;</span>Snapshot (URL)<span class="nt">&lt;/description&gt;</span>
                     <span class="nt">&lt;source&gt;</span>URL<span class="nt">&lt;/source&gt;</span>
              <span class="nt">&lt;/attachment&gt;</span>
 <span class="nt">&lt;/notification_attachments&gt;</span>
</code></pre></div>

<p>After clicking the Add button and opening the driver, which is a security camera in this example, we can see the three image types. When the correct type for the device the driver supports is selected, the attachment field is populated.</p>

<h3 id='execution'>Execution</h3>

<p>The following APIs have been delivered in OS 3 to support the return of the .jpeg files.</p>

<p><a href="https://snap-one.github.io/docs-driverworks-api/#getnotificationattachmenturl">GetNotificationAttachmentURL</a></p>

<p><a href="https://snap-one.github.io/docs-driverworks-api/#getnotificationattachmentfile">GetNotificationAttachmentFile</a></p>

<p><a href="https://snap-one.github.io/docs-driverworks-api/#getnotificationattachmentbytes">GetNotificationAttachmentBytes</a></p>

<p>Each API has been engineered to deliver the file based on the location of where the file is stored. They are called when the Notification is triggered. Currently, there are three options for file storage: URL, File or Memory</p>

<p>Finally, the <a href="https://snap-one.github.io/docs-driverworks-api/#finishedwithnotificationattachment">FinishedWithNotificationAttachement</a> API has been included in the event that your driver needs to do any sort of clean-up with the stored .jpeg file.</p>

<p>To assist with implementation, please see the notification driver.c4z file in the Samples folder of this SDK.</p>

<h2 id='getnotificationattachmenturl'>GetNotificationAttachmentURL</h2>

<p>If the .jpeg file from the device is stored on the web or in a cloud, the GetNotificationAttachmentURL API should be included in your driver to return the URL of the file.</p>

<h3 id='example'>Example</h3><div class="highlight"><pre class="highlight lua tab-lua"><code><span class="k">function</span> <span class="nf">GetNotificationAttachmentURL</span><span class="p">()</span>
  <span class="k">return</span> <span class="s2">"http://10.12.80.4:80/snap1vga"</span>
<span class="k">end</span>
</code></pre></div>
<p>To assist with implementation, please see the notification driver.c4z file in the Samples folder of this SDK.</p>

<h2 id='getnotificationattachmentfile'>GetNotificationAttachmentFile</h2>
<p>If the .jpeg file is placed on the Control4 controller by the driver, the GetNotificationAttachmentFile API should be included in your driver to return the file.</p>
<h3 id='example'>Example</h3><div class="highlight"><pre class="highlight lua tab-lua"><code><span class="k">function</span> <span class="nf">GetNotificationAttachmentFile</span><span class="p">()</span>
    <span class="k">return</span> <span class="s2">"image.jpg"</span>
<span class="k">end</span>
</code></pre></div>
<p>To assist with implementation, please see the notification driver.c4z file in the Samples folder of this SDK.</p>

<h2 id='getnotificationattachmentbytes'>GetNotificationAttachmentBytes</h2>
<p>If the .jpeg file is stored in the memory of the device, the GetNotificationAttachmentBytes API should be included in your driver to return the file. Note that this API has the potential to block data if the driver takes too long to execute the function. If it takes more than one second, a log entry will be created in the director log warning that the driver took too long. This is also logged in the driver debug log file. The log entry for this is: </p>

<p><code>“The driver: \&lt;driver name\&gt;(\&lt;device id\&gt;) took more than 1 second to get the notification extractnotifcation bytes.”</code> </p>
<h3 id='example'>Example</h3><div class="highlight"><pre class="highlight lua tab-lua"><code>
<span class="k">function</span> <span class="nf">GetNotificationAttachmentBytes</span><span class="p">()</span>
  <span class="kd">local</span> <span class="n">imageData</span> <span class="o">=</span> <span class="err">???</span> <span class="c1">-- Get image from somewhere</span>

    <span class="k">return</span> <span class="n">C4</span><span class="p">:</span><span class="n">Base64Encode</span><span class="p">(</span><span class="n">imageData</span><span class="p">)</span>
<span class="k">end</span>
</code></pre></div>
<p>To assist with implementation, please see the notification driver.c4z file in the Samples folder of this SDK.</p>

<h2 id='finishedwithnotificationattachment'>FinishedWithNotificationAttachment</h2>
<p>This API has been included in the event that your driver needs to do any sort of clean-up with the stored .jpeg file. It also provides a notification when the original notification has been sent. This is an optional API and only recommended if cleanup is needed. For example, if it is desirable to remove a temporary image file from your system. </p>
<h3 id='example'>Example</h3><div class="highlight"><pre class="highlight lua tab-lua"><code><span class="k">function</span> <span class="nf">FinishedWithNotificationAttachment</span><span class="p">()</span>
  <span class="c1">-- do any cleanup required here.</span>
<span class="k">end</span>
</code></pre></div>
<p>To assist with implementation, please see the notification driver.c4z file in the Samples folder of this SDK.</p>

<h2 id='refresh-navigator'>Refresh Navigator</h2>
<p>The following is an example of how to be notified when the “Refresh Navigator” call is made. When bindings, device names, or device media has changed, a “Refresh Navigator” call is made. This event is an alert for the Navigators that any cached data about the project or media may now be invalid.</p>

<p>Specifically the event for “Refresh Navigator” is the “OnPIP” event.  To get this event,  we make use of the generic event registration calls:</p>

<p><a href="https://snap-one.github.io/docs-driverworks-api/#registersystemevent">RegisterSystemEvent</a>
<a href="https://snap-one.github.io/docs-driverworks-api/#unregistersystemevent">UnregisterSystemEvent</a>
<a href="https://snap-one.github.io/docs-driverworks-api/#unregisterallsystemevents">UnregisterAllSystemEvents</a></p>
<h3 id='example'>Example</h3>

<p><code>C4:RegisterSystemEvent(C4SystemEvents[&quot;OnPIP&quot;], 0)</code></p>

<p>The C4SystemEvents variable is the array of all event name to ID’s.</p>

<p>Use deviceId 0 to register for device specific events for all devices.  Some events are system wide and will be sent regardless of the device id that was registered, others use the device id to filter who gets what events.</p>

<p>Your driver will need to implement the “OnSystemEvent” method.</p>

<p><h3 id='example-2'>Example</h3><div class="highlight"><pre class="highlight lua tab-lua"><code><span class="k">function</span> <span class="nf">OnSystemEvent</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
  <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;System Event occurred - data: &quot;</span> <span class="o">..</span> <span class="n">data</span><span class="p">)</span>
<span class="k">end</span>
</code></pre></div>
<p>The “data” passed to the callback function is event specific and can be provided on an event by event basis as needed.  In most cases, it can be ignored.</p></p>

<p>See <a href="https://snap-one.github.io/docs-driverworks-api/#registering-for-system-events">Registering for System Events</a> for additional information.</p>
<h1 id='properties-interface'>Properties Interface</h1>

<h2 id='properties-table'>Properties Table</h2>

<p>The Lua Table ‘Properties’ contains the current value of this driver’s properties.  Although you can read from this table, and change properties’ values on the devices’ Properties page, to change the value of a device property programmatically, you should use C4: UpdateProperty.</p>

<p><h6 id='added-in-1-6-0'>Added in 1.6.0.</h6><h3 id='signature'>Signature</h3>
<p><code>Properties[strName]</code></p>
<h3 id='example'>Example</h3><div class="highlight"><pre class="highlight lua tab-lua"><code><span class="c1">--Use Properties in a comparison:</span>
<span class="k">if</span> <span class="p">(</span><span class="n">Properties</span><span class="p">[</span><span class="err">“</span><span class="n">CalculateWindShear</span><span class="err">”</span><span class="p">]</span> <span class="o">==</span> <span class="err">“</span><span class="kc">true</span><span class="err">”</span><span class="p">)</span> <span class="k">then</span>
        <span class="n">CalculateWindShear</span><span class="p">()</span>
<span class="k">end</span></p>

<p><span class="c1">--Print out all Properties:</span>
<span class="k">for</span> <span class="n">PropertyName</span><span class="p">,</span> <span class="n">PropertyValue</span> <span class="k">in</span> <span class="nb">pairs</span><span class="p">(</span><span class="n">Properties</span><span class="p">)</span> <span class="k">do</span> 
  <span class="nb">print</span><span class="p">(</span><span class="n">PropertyName</span><span class="p">,</span> <span class="n">PropertyValue</span><span class="p">)</span>
<span class="k">end</span>
</code></pre></div>
<h2 id='getprojectproperty'>GetProjectProperty</h2>
<p>GetProjectProperty takes a single string parameter from a list of property names. The API returns the value of that property, if it exists.</p>
<h6 id='added-in-os-3-0-0'>Added in OS 3.0.0</h6><h3 id='signature'>Signature</h3>
<p><code>C4:GetProjectProperty(propertyName)</code></p></p>

<table><thead>
<tr>
<th>Parameter</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>str</td>
<td>Name of Property. Includes the following:</td>
</tr>
</tbody></table>

<ul>
<li>ZipCode</li>
<li>Latitude</li>
<li>Longitude</li>
<li>CountryCode</li>
<li>CountryName</li>
<li>CityName</li>
<li>Use24HourClock</li>
<li>CIDRules</li>
<li>TemperatureScale</li>
<li>CustomColors</li>
<li>PushSettings</li>
<li>SSLOnly</li>
<li>DinRailPanel</li>
<li>DinRailArcFail</li>
<li>NominalVoltage</li>
<li>KeyCapFinish</li>
<li>BackLight</li>
<li>TextSize</li>
<li>TextAlignment</li>
<li>TopLEDOn</li>
<li>TopLEDOff</li>
<li>BottomLEDOn</li>
<li>BottomLEDOff</li>
<li>ToggleLEDOn</li>
<li>ToggleLEDOff</li>
</ul>

<h3 id='example'>Example</h3><div class="highlight"><pre class="highlight lua tab-lua"><code><span class="n">Use</span> <span class="n">Properties</span> <span class="k">in</span> <span class="n">a</span> <span class="n">comparison</span><span class="p">:</span>
<span class="k">if</span> <span class="p">(</span><span class="n">Properties</span><span class="p">[</span><span class="err">“</span><span class="n">CalculateWindShear</span><span class="err">”</span><span class="p">]</span> <span class="o">==</span> <span class="err">“</span><span class="kc">true</span><span class="err">”</span><span class="p">)</span> <span class="k">then</span>
        <span class="n">CalculateWindShear</span><span class="p">()</span>
<span class="k">end</span>

<span class="n">Print</span> <span class="n">out</span> <span class="n">all</span> <span class="n">Properties</span><span class="p">:</span>
<span class="k">for</span> <span class="n">PropertyName</span><span class="p">,</span> <span class="n">PropertyValue</span> <span class="k">in</span> <span class="nb">pairs</span><span class="p">(</span><span class="n">Properties</span><span class="p">)</span> <span class="k">do</span> 
  <span class="nb">print</span><span class="p">(</span><span class="n">PropertyName</span><span class="p">,</span> <span class="n">PropertyValue</span><span class="p">)</span>
<span class="k">end</span>
</code></pre></div>
<h2 id='onpropertychanged'>OnPropertyChanged</h2>
<p>Function called by Director when a property changes value.</p>
<h6 id='added-in-os-1-6-0'>Added in OS 1.6.0</h6><h3 id='signature'>Signature</h3>

<p><code>OnPropertyChanged(strName)</code></p>

<table><thead>
<tr>
<th>Parameter</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>str</td>
<td>Name of property that has changed.</td>
</tr>
</tbody></table>

<h3 id='usage-note'>Usage Note:</h3>

<p>The value of the property that has changed can be found with: <code>Properties[strName]</code>.  Note that OnPropertyChanged is not called when the Property has been changed by the driver calling the <a href="https://snap-one.github.io/docs-driverworks-api/#updateproperty">UpdateProperty</a> command, only when the Property is changed by the user from  the Properties Page.This function is called by Director when a property changes value.</p>

<h3 id='example'>Example</h3>

<p>An example function used to process property value changes.</p>

<div class="highlight"><pre class="highlight lua tab-lua"><code><span class="k">function</span> <span class="nf">OnPropertyChanged</span><span class="p">(</span><span class="n">strProperty</span><span class="p">)</span>
  <span class="n">propertyValue</span> <span class="o">=</span> <span class="n">Properties</span><span class="p">[</span><span class="n">strProperty</span><span class="p">]</span>
  <span class="nb">print</span><span class="p">(</span><span class="s2">"strProperty = "</span>  <span class="o">..</span> <span class="n">strProperty</span> <span class="o">..</span> <span class="s2">" changed to: "</span> <span class="o">..</span> <span class="n">propertyValue</span><span class="p">)</span>
  <span class="k">if</span> <span class="p">(</span><span class="n">strProperty</span> <span class="o">==</span> <span class="s2">"Security State"</span><span class="p">)</span> <span class="k">then</span>
    <span class="k">if</span> <span class="n">propertyValue</span> <span class="o">==</span> <span class="s2">"Disarmed"</span> <span class="k">then</span>
      <span class="c1">-- do stuff</span>
    <span class="k">elseif</span> <span class="n">propertyValue</span> <span class="o">==</span> <span class="s2">"Armed Stay"</span> <span class="k">then</span>
      <span class="c1">-- do stuff</span>
    <span class="k">elseif</span> <span class="n">propertyValue</span> <span class="o">==</span> <span class="s2">"Armed Away"</span> <span class="k">then</span>
      <span class="c1">-- do stuff</span>
    <span class="k">elseif</span> <span class="n">propertyValue</span> <span class="o">==</span> <span class="s2">"Alarm Activated"</span> <span class="k">then</span>
      <span class="c1">-- do stuff</span>
    <span class="k">end</span>
  <span class="k">elseif</span> <span class="p">(</span><span class="nb">string.find</span><span class="p">(</span><span class="n">strProperty</span><span class="p">,</span><span class="s2">"Zone"</span><span class="p">)</span> <span class="o">~=</span> <span class="kc">nil</span><span class="p">)</span> <span class="k">then</span>
    <span class="c1">-- do stuff</span>
  <span class="k">else</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">"No action performed for "</span> <span class="o">..</span> <span class="n">strProperty</span> <span class="o">..</span> <span class="s2">" which has been set to: "</span> <span class="o">..</span> <span class="n">Properties</span><span class="p">[</span><span class="n">strProperty</span><span class="p">])</span>
  <span class="k">end</span>
<span class="k">end</span>
</code></pre></div>

<h2 id='setpropertyattribs'>SetPropertyAttribs</h2>

<p>Function called from DriverWorks driver to display or hide Properties in Composer&#39;s Lua Properties page. This API should not be invoked during OnDriverInit.</p>

<p><h6 id='added-in-os-1-6-0'>Added in OS 1.6.0</h6><h3 id='signature'>Signature</h3>
<p><code>C4:SetPropertyAttribs(strName, int)</code></p></p>

<table><thead>
<tr>
<th>Parameter</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>str</td>
<td>Name of Property</td>
</tr>
</tbody></table>

<h3 id='returns'>Returns</h3>

<p><code>None</code></p>

<h4 id='example'>Example</h4>

<p>The example below will prevent the property named &quot;Resolution&quot; from being displayed in the Lua Property page for this driver.</p>

<p><code>C4:SetPropertyAttribs(&quot;Resolution&quot;, 1)</code></p>

<h2 id='updateproperty'>UpdateProperty</h2>

<p>Function called from DriverWorks driver to update driver properties. This API should not be invoked during OnDriverInit.</p>

<p><h6 id='added-in-os-1-6-0'>Added in OS 1.6.0</h6><h3 id='signature'>Signature</h3>
<p><code>C4:UpdateProperty(strName, strValue)</code></p></p>

<table><thead>
<tr>
<th>Parameter</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>str</td>
<td>Name of Property to update.</td>
</tr>
<tr>
<td>str</td>
<td>New value of Property.</td>
</tr>
</tbody></table>

<h3 id='returns'>Returns</h3>

<p><code>None</code></p>

<h3 id='examples'>Examples</h3>

<p>Examples of how the properties are updated by the driver. </p>

<p><code>C4:UpdateProperty(&quot;Security State&quot;,&quot;Armed &quot;..armMode)</code></p>

<p><code>C4:UpdateProperty(&quot;Security State&quot;,&quot;Disarmed&quot;)</code></p>

<h2 id='updatepropertylist'>UpdatePropertyList</h2>

<p>Function called from DriverWorks driver to update driver properties. This API should not be invoked during OnDriverInit.</p>

<p><h6 id='added-in-os-2-7-0'>Added in OS 2.7.0</h6><h6 id='the-strvalue-parameter-was-changed-to-strvaluelist-in-conjunction-with-os-3'>The strValue parameter was changed to strValueList in conjunction with OS 3.</h6><h6 id='the-strvaluedefault-parameter-was-added-in-conjunction-with-os-3'>The strValueDefault parameter was added in conjunction with OS 3.</h6><h3 id='signature'>Signature</h3>
<p><code>C4:UpdatePropertyList (strName, strValueList, strValueDefault) </code></p></p>

<table><thead>
<tr>
<th>Parameter</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>str</td>
<td>Name of Property to update.</td>
</tr>
<tr>
<td>str</td>
<td>New list for the property. This list needs to be a comma delimited list.</td>
</tr>
<tr>
<td>str</td>
<td>Optional but Recommended New Value of the property. This value needs to be included in the list.</td>
</tr>
</tbody></table>

<h3 id='returns'>Returns</h3>

<p><code>None</code></p>

<h3 id='example'>Example</h3>

<p><code>C4:UpdatePropertyList(&quot;Test Dynamic List No Default&quot;, &quot;Item 7,Item 8,Item 9&quot;, &quot;Item 8&quot;)</code></p>
<h1 id='proxy-interface'>Proxy Interface</h1>

<h2 id='getproxydevices'>GetProxyDevices</h2>

<p>Function that returns the proxy device id(ids if device has multiple proxies) associated with the current driver. This API should not be invoked during OnDriverInit.</p>

<p><h6 id='added-in-os-1-6-0'>Added in OS 1.6.0</h6><h3 id='signature'>Signature</h3>
<p><code>GetProxyDevices(strName)</code></p>
<h3 id='parameters'>Parameters</h3>
<p><code>None</code></p>
<h3 id='returns'>Returns</h3>
<table><thead>
<tr>
<th>Value</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>num</td>
<td>Proxy ID</td>
</tr>
</tbody></table>
<h3 id='example'>Example</h3><div class="highlight"><pre class="highlight plaintext"><code>local proxyId = C4:GetProxyDevices()
print(&quot;proxy is: &quot; .. proxyId)</p>

<p>prints: proxy is: 393
</code></pre></div>
<h2 id='getproxydevicesbyid'>GetProxyDevicesById</h2>
<p>Function that returns all associated proxies for a device. Return values are in ID format (numerical value). This API should not be invoked during OnDriverInit.</p>
<h6 id='added-in-os-1-6-0'>Added in OS 1.6.0</h6><h3 id='signature'>Signature</h3>
<p><code>GetProxyDevicesById()</code></p></p>

<table><thead>
<tr>
<th>Parameter</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>num</td>
<td>Device ID</td>
</tr>
</tbody></table>

<h3 id='returns'>Returns</h3>

<table><thead>
<tr>
<th>Value</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>num</td>
<td>Proxy ID</td>
</tr>
</tbody></table>

<h3 id='example'>Example</h3><div class="highlight"><pre class="highlight lua tab-lua"><code><span class="n">C4</span><span class="p">:</span><span class="n">GetProxyDevicesById</span><span class="p">(</span><span class="n">C4</span><span class="p">:</span><span class="n">GetDeviceID</span><span class="p">())</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">"dev1 is "</span> <span class="o">..</span> <span class="n">dev1</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">"dev2 is "</span> <span class="o">..</span> <span class="n">dev2</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">"dev3 is "</span> <span class="o">..</span> <span class="n">dev3</span><span class="p">)</span>
</code></pre></div>
<h2 id='getproxydevicesbyname'>GetProxyDevicesByName</h2>
<p>Function that returns the all proxy devices by proxy name. For example, if passed light.c4i it will return a list of all lights in the project. This API should not be invoked during OnDriverInit.</p>
<h6 id='added-in-os-1-6-0'>Added in OS 1.6.0</h6><h3 id='signature'>Signature</h3>

<p><code>C4:GetProxyDevicesByName()</code></p>

<table><thead>
<tr>
<th>Parameter</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>str</td>
<td>Driver name</td>
</tr>
</tbody></table>

<h3 id='returns'>Returns</h3>

<table><thead>
<tr>
<th>Value</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>str</td>
<td>Proxy name</td>
</tr>
</tbody></table>

<h3 id='example'>Example</h3><div class="highlight"><pre class="highlight lua tab-lua"><code><span class="kd">local</span> <span class="n">proxydevs</span> <span class="o">=</span> <span class="n">C4</span><span class="p">:</span><span class="n">GetDevicesByC4iName</span><span class="p">(</span><span class="s2">"light.c4i"</span><span class="p">)</span>
<span class="k">if</span> <span class="p">(</span><span class="n">proxydevs</span> <span class="o">~=</span> <span class="kc">nil</span><span class="p">)</span> <span class="k">then</span>
<span class="err"> </span> <span class="nb">print</span><span class="p">(</span><span class="s2">"Proxy Devices:"</span><span class="p">)</span>
<span class="err"> </span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span><span class="n">v</span> <span class="k">in</span> <span class="nb">pairs</span><span class="p">(</span><span class="n">proxydevs</span><span class="p">)</span> <span class="k">do</span> <span class="nb">print</span><span class="p">(</span><span class="n">k</span><span class="p">,</span><span class="n">v</span><span class="p">)</span> <span class="k">end</span>
<span class="k">end</span>
</code></pre></div>
<h2 id='getdevicesbyc4iname'>GetDevicesByC4iName</h2>
<p>Function that returns specific devices by .c4i (driver) name. For example, if passed <code>light_ip_control4_ldz-102-w-c4i </code>it will return a list of all Control4 Wireless dimmers in the project. This API should not be invoked during OnDriverInit.</p>
<h6 id='added-in-os-1-6-0'>Added in OS 1.6.0</h6><h3 id='signature'>Signature</h3>

<p><code>C4:GetDevicesByC4iName()</code></p>

<table><thead>
<tr>
<th>Parameter</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>str</td>
<td>Driver name</td>
</tr>
</tbody></table>

<h3 id='returns'>Returns</h3>

<table><thead>
<tr>
<th>Parameter</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>table</td>
<td>Table of device IDs.</td>
</tr>
</tbody></table>

<h3 id='example'>Example</h3><div class="highlight"><pre class="highlight lua tab-lua"><code><span class="kd">local</span> <span class="n">devs</span> <span class="o">=</span> <span class="n">C4</span><span class="p">:</span><span class="n">GetDevicesByC4iName</span><span class="p">(</span><span class="s2">"rf_internet.c4i"</span><span class="p">)</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">devs</span> <span class="o">~=</span> <span class="kc">nil</span><span class="p">)</span> <span class="k">then</span>
       <span class="nb">print</span><span class="p">(</span><span class="s2">"Devices:"</span><span class="p">)</span>
       <span class="k">for</span> <span class="n">k</span><span class="p">,</span><span class="n">v</span> <span class="k">in</span> <span class="nb">pairs</span><span class="p">(</span><span class="n">devs</span><span class="p">)</span> <span class="k">do</span> <span class="nb">print</span><span class="p">(</span><span class="n">k</span><span class="p">,</span><span class="n">v</span><span class="p">)</span> <span class="k">end</span>
    <span class="k">end</span>
</code></pre></div>
<h2 id='receivedfromproxy'>ReceivedFromProxy</h2>
<p>Function called by Director when a proxy bound to the specified binding sends a BindMessage to the DriverWorks driver. This API should not be invoked during OnDriverInit.</p>
<h6 id='added-in-os-1-6-0'>Added in OS 1.6.0</h6><h3 id='signature'>Signature</h3>

<p><code>ReceivedFromProxy(idBinding, strCommand, tParams)</code></p>

<table><thead>
<tr>
<th>Parameter</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>num</td>
<td>Binding ID of the proxy that sent a BindMessage to the DriverWorks driver.</td>
</tr>
<tr>
<td>str</td>
<td>Command that was sent</td>
</tr>
<tr>
<td>table</td>
<td>Lua table of received command parameters</td>
</tr>
</tbody></table>

<h3 id='returns'>Returns</h3>

<p><code>None</code></p>

<h3 id='examples'>Examples</h3><div class="highlight"><pre class="highlight lua tab-lua"><code><span class="k">function</span> <span class="nf">ReceivedFromProxy</span><span class="p">(</span><span class="n">idBinding</span><span class="p">,</span> <span class="n">strCommand</span><span class="p">,</span> <span class="n">tParams</span><span class="p">)</span>
 <span class="nb">print</span><span class="p">(</span><span class="s2">"ReceivedFromProxy ["</span> <span class="o">..</span> <span class="n">idBinding</span> <span class="o">..</span> <span class="s2">"]: "</span> <span class="o">..</span> <span class="n">strCommand</span><span class="p">)</span>
 <span class="k">if</span> <span class="p">(</span><span class="n">tParams</span> <span class="o">~=</span> <span class="kc">nil</span><span class="p">)</span> <span class="k">then</span>
      <span class="k">for</span> <span class="n">ParamName</span><span class="p">,</span> <span class="n">ParamValue</span> <span class="k">in</span> <span class="nb">pairs</span><span class="p">(</span><span class="n">tParams</span><span class="p">)</span> <span class="k">do</span>
           <span class="nb">print</span><span class="p">(</span><span class="n">ParamName</span><span class="p">,</span> <span class="n">ParamValue</span><span class="p">)</span>
      <span class="k">end</span>
 <span class="k">end</span>
<span class="k">end</span>
</code></pre></div>
<p>Map the idBinding to a variable for proxy. Evaluate the command coming in.  If its a simple command, get the command equivalent out of the CMDS table, otherwise call a function to process the command. </p>
<div class="highlight"><pre class="highlight lua tab-lua"><code><span class="k">function</span> <span class="nf">ReceivedFromProxy</span><span class="p">(</span><span class="n">idBinding</span><span class="p">,</span> <span class="n">strCommand</span><span class="p">,</span> <span class="n">tParams</span><span class="p">)</span>
   <span class="n">proxy</span> <span class="o">=</span> <span class="s2">"Undefined"</span>
   <span class="k">if</span> <span class="n">idBinding</span> <span class="o">==</span> <span class="mi">5001</span> <span class="k">then</span>
      <span class="n">proxy</span> <span class="o">=</span> <span class="s2">"Receiver"</span>
   <span class="k">elseif</span> <span class="n">idBinding</span> <span class="o">==</span> <span class="mi">5002</span> <span class="k">then</span>
      <span class="n">proxy</span> <span class="o">=</span> <span class="s2">"Tuner"</span>
   <span class="k">end</span>
   <span class="nb">print</span><span class="p">(</span><span class="s2">"ReceivedFromProxy ["</span> <span class="o">..</span> <span class="n">idBinding</span> <span class="o">..</span> <span class="s2">"]: "</span> <span class="o">..</span> <span class="n">strCommand</span> <span class="o">..</span> <span class="s2">" for "</span> <span class="o">..</span> <span class="n">proxy</span><span class="p">)</span>
   <span class="n">cmd</span> <span class="o">=</span> <span class="n">CMDS</span><span class="p">[</span><span class="n">strCommand</span><span class="p">]</span> 
   <span class="k">if</span> <span class="p">(</span><span class="n">cmd</span> <span class="o">~=</span> <span class="n">nill</span><span class="p">)</span> <span class="k">then</span>
     <span class="nb">print</span><span class="p">(</span>  <span class="s2">"Received from Proxy: "</span> <span class="o">..</span> <span class="n">strCommand</span> <span class="o">..</span> <span class="s2">"; Send to Device: "</span> <span class="o">..</span> <span class="n">cmd</span><span class="p">)</span>
     <span class="n">emit</span><span class="p">(</span><span class="n">cmd</span><span class="p">)</span>
   <span class="k">else</span>
     <span class="n">CommandInterpreter</span><span class="p">(</span><span class="n">strCommand</span><span class="p">,</span> <span class="n">tParams</span><span class="p">)</span>
  <span class="k">end</span>
<span class="k">end</span>
</code></pre></div>
<h2 id='sendtoproxy'>SendToProxy</h2>
<p>Function called from DriverWorks driver to send a Control4 BindMessage to the proxy bound to the specified binding. This API should not be invoked during OnDriverInit. </p>
<h6 id='added-in-os-1-6-0'>Added in OS 1.6.0</h6><h3 id='signature'>Signature</h3>

<p><code>C4:SendToProxy(idBinding, strCommand, tParams, strmessage)</code></p>

<p>or</p>

<p><code>C4:SendToProxy(idBinding, strCommand, strParam)</code></p>

<p>or</p>

<p><code>C4:SendToProxy(idBinding, strCommand, tParams, strmessage, allowEmptyValues)</code></p>

<table><thead>
<tr>
<th>Parameter</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>num</td>
<td>Binding ID for the proxy you wish to send to</td>
</tr>
<tr>
<td>str</td>
<td>Command to send to the proxy</td>
</tr>
<tr>
<td>table</td>
<td>Lua table containing parameters to the command.</td>
</tr>
<tr>
<td>str</td>
<td>COMMAND or NOTIFY – Overrides the default message for SendToProxy. See Note below.</td>
</tr>
<tr>
<td>bool</td>
<td>Optional. When set to TRUE will allow for an empty string to be sent as a parameter value.</td>
</tr>
</tbody></table>

<h3 id='usage-note'>Usage Note</h3>

<p>SendToProxy will send a NOTIFY if the paramater is equal to or more than a 1000 and a Command if it is less than a 1000.</p>

<h3 id='returns'>Returns</h3>

<p><code>None</code></p>

<h3 id='examples'>Examples</h3>

<p>Notify the attached contact binding that the contact has closed. Note that tParams is required, if there are no parameters, send an empty Lua table:</p>

<p><code>C4:SendToProxy(11, &quot;CLOSED&quot;,{}, &quot;NOTIFY&quot;)</code></p>

<p>Notify the attached thermostat binding that the temperature is now 76:</p>

<p><code>C4:SendToProxy(5001, &quot;TEMPERATURE_CHANGED&quot;, {TEMPERATURE = 76})</code></p>

<p>Send the ‘System Armed’ text to the attached security proxy Display Text:</p>

<p><code>C4:SendToProxy(5001, &quot;DISPLAY_TEXT&quot;, &quot;&lt;text&gt;SYSTEM ARMED&lt;/text&gt;&quot;)</code></p>

<p>Optional allowEmptyValues parameter set to True:</p>

<p><code>C4:SendToProxy(5001, &quot;ALLOWED_FAN_MODES_CHANGED&quot;, tParams, &quot;NOTIFY&quot;, true)</code></p>

<p>Optional allowEmptyValues parameter set to True and a table defined:</p>

<p><code>C4:SendToProxy(5001, &quot;ALLOWED_FAN_MODES_CHANGED&quot;, {MODES = &quot;&quot;}, &quot;NOTIFY&quot;, true)</code></p>

<p>Optional allowEmptyValues parameter set to True and an empty string:</p>

<p><code>C4:SendToProxy(5001, &quot;ALLOWED_FAN_MODES_CHANGED&quot;, &quot;&quot;, &quot;NOTIFY&quot;, true)</code></p>

<p>Optional allowEmptyValues parameter set to True and a number:</p>

<p><code>C4:SendToProxy(5001, &quot;ALLOWED_FAN_MODES_CHANGED&quot;, 213, &quot;NOTIFY&quot;)</code></p>

<p>Send the ‘System Armed’ text to the attached security proxy Display Text:</p>

<p><code>C4:SendToProxy(5001, &quot;DISPLAY_TEXT&quot;, &quot;&lt;text&gt;SYSTEM ARMED&lt;/text&gt;&quot;)</code></p>
<h1 id='registry-interface'>Registry Interface</h1>

<h2 id='introduction'>Introduction</h2>

<p>The Controller Registry APIs enables drivers to set, retrieve, and delete values that are stored in the Registry. The Registry consists of a database table stored in: /opt/control4/etc/registry.db.</p>

<p>The Registry associates a value with a well-known key. The registry is intended to store values that are global in nature. The Registry would be a good place for storing configuration data that pertains to all instances of a particular driver. Drivers SHOULD NOT use the registry to store state, or other data that are transient in nature.</p>

<p>The Registry APIs utilizes the same encoder/decoder used by the JSON APIs for Lua.  Drivers using these APIs can persist numbers, strings, booleans, or tables. When retrieved, values are decoded back into the original type.</p>

<h2 id='registrydeletevalue'>RegistryDeleteValue</h2>

<p>Removes a key/value pair from the Registry.</p>

<p><h6 id='available-from-2-10-4'>Available from 2.10.4</h6><h3 id='signature'>Signature</h3>
<p><code>C4:RegistryDeleteValue(key)</code></p></p>

<table><thead>
<tr>
<th>Parameter</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>key</td>
<td><code>number</code>: The key to be removed from the Registry</td>
</tr>
</tbody></table>

<h3 id='returns'>Returns</h3>

<p><code>None</code></p>

<h2 id='registrygetvalue'>RegistryGetValue</h2>

<p>Retrieves a value from the Registry.</p>

<p><h6 id='available-from-2-10-4'>Available from 2.10.4</h6><h3 id='signature'>Signature</h3>
<p><code>C4:RegistryGetValue(key)</code></p></p>

<table><thead>
<tr>
<th>Parameter</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>key</td>
<td><code>number</code>: The key applicable to the value being retrieved.</td>
</tr>
</tbody></table>

<h3 id='returns'>Returns</h3>

<p>Upon success, the API returns the value that was decoded from the Registry. The value can be any of the following: number, string ,boolean, table. Upon failure, the API returns nil.</p>

<h2 id='registrysetvalue'>RegistrySetValue</h2>

<p>Sets the value of a Registry key/value pair. The value is updated if the specified key/value pair exists. A key/value pair is created by the API if it does not exist. </p>

<p><h6 id='available-from-2-10-4'>Available from 2.10.4</h6><h3 id='signature'>Signature</h3>
<p><code>C4:RegistrySetValue(key, value)</code></p></p>

<table><thead>
<tr>
<th>Parameter</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>key</td>
<td><code>number</code>: The name of the key to which the specified value is associated.</td>
</tr>
<tr>
<td>value</td>
<td>The name of the key to which the specified value is associated.</td>
</tr>
</tbody></table>

<h3 id='returns'>Returns</h3>

<p>Upon success, the API returns the value that was decoded from the Registry. The value can be any of the following: number, string ,boolean, table. Upon failure, the API returns nil.</p>
<h1 id='scheduler-agent-interface'>Scheduler Agent Interface</h1>

<h2 id='overview'>Overview</h2>

<p>In conjunction with OS 3, drivers can now create, modify and delete scheduled events. These events appear in the Schedule Agent in ComposerPro. Once created, System programming can be created using the events. </p>

<p>Of note is the use of a unique namespace for the Scheduler APIs. Historically, API calls have been created in the same C4 namespace. For example: <code>C4:ApiName</code>. The Scheduler Agent APIs use their own namespace. For example: C4Scheduler:ApiName</p>

<p>As mentioned above, device drivers can now contain code to create, modify and delete scheduled events. A driver can only modify or delete events which were created by that driver. For example, consider that a driver has the need to create a simple, scheduled event which occurs on a single day. This event needs to occur on July 2nd, 2019. The Scheduler API AddSingleDayEntry can be used to accomplish this: </p>

<p><h3 id='example'>Example</h3><div class="highlight"><pre class="highlight lua tab-lua"><code><span class="k">function</span> <span class="nf">AddSingleDayEntry</span><span class="p">()</span>
 <span class="kd">local</span> <span class="n">name</span> <span class="o">=</span> <span class="s2">&quot;AddSingleDayEntry Scheduled Event&quot;</span>
 <span class="kd">local</span> <span class="n">start_time</span> <span class="o">=</span> <span class="p">{</span>
 <span class="n">year</span> <span class="o">=</span> <span class="mi">2019</span><span class="p">,</span>
 <span class="n">month</span> <span class="o">=</span> <span class="mi">7</span><span class="p">,</span>
 <span class="n">day</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span>
 <span class="n">hour</span> <span class="o">=</span> <span class="mi">21</span><span class="p">,</span>
 <span class="n">minute</span> <span class="o">=</span> <span class="mi">30</span>
 <span class="p">}</span></p>

<p><span class="kd">local</span> <span class="n">options</span> <span class="o">=</span> <span class="p">{</span>
 <span class="n">hidden</span> <span class="o">=</span> <span class="kc">false</span><span class="p">,</span>
 <span class="n">user_hidden</span> <span class="o">=</span> <span class="kc">false</span><span class="p">,</span>
 <span class="n">category</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
 <span class="n">enabled</span> <span class="o">=</span> <span class="kc">true</span><span class="p">,</span>
 <span class="n">locked</span> <span class="o">=</span> <span class="kc">false</span>
 <span class="p">}</span></p>

<p><span class="kd">local</span> <span class="n">eventId</span> <span class="o">=</span> <span class="n">C4Scheduler</span><span class="p">:</span><span class="n">AddSingleDayEntry</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">start_time</span><span class="p">,</span> <span class="n">options</span><span class="p">)</span>
<span class="k">end</span>
<span class="n">AddSingleDayEntry</span><span class="p">()</span>
</code></pre></div>
<p>This newly created Event can be used in ComposerPro programming.</p></p>

<p>Numerous date and time parameters are used by the Scheduler APIs. The acceptable ranges for those parameters are as follows:</p>

<p>Date Parameters:</p>

<ul>
<li>Year: Any year greater 1970.</li>
<li>Month: Value between 1 and 12, 1 being equal to January.</li>
<li>Day: Value between 1 and 31, </li>
<li>Hour: Value between 0 and 23</li>
<li>Minute: Value between 0 and 59</li>
</ul>

<p>Time Parameters</p>

<ul>
<li>Randomize time by +/-: 0-60 minutes</li>
<li>Sunrise / Sunset, Before / After: -360-360 minutes. Note that Before Sunrise and Sunset requires the use of a negative number.</li>
<li>Repeats -&gt; Daily -&gt; Every &lt;x&gt; day(s): 1-100 days</li>
<li>Repeats -&gt; Weekly -&gt; Every &lt;x&gt; weeks(s): 1-100 weeks</li>
<li>Repeats -&gt; Monthly -&gt; Every &lt;x&gt; months(s):  1-100 months</li>
<li>Repeats -&gt; Yearly -&gt; Every &lt;x&gt; day(s): 1-100 days</li>
</ul>
<h1 id='schedule-agent-add-event-interface'>Schedule Agent - Add Event Interface</h1>

<h2 id='addsingledayentry'>AddSingleDayEntry</h2>

<p>This API adds an event which occurs once.</p>

<p><h6 id='available-from-3-0-0'>Available from 3.0.0</h6><h3 id='signature'>Signature</h3>
<p><code>C4:Scheduler:AddSingleDayEntry(name, start_time, options)</code></p></p>

<table><thead>
<tr>
<th>Parameter</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>str</td>
<td>String value of the name of the event being added.</td>
</tr>
<tr>
<td>table</td>
<td>Optional table that includes: year, month, day, hour using the 24 hour clock, minute. Default  time is 12:00 AM</td>
</tr>
<tr>
<td>table</td>
<td>Table of additional, optional parameters that includes:</td>
</tr>
<tr>
<td></td>
<td>hidden - Boolean defaults to false.  True prevents the Event from displaying in the Scheduler Agent in ComposerPro</td>
</tr>
<tr>
<td></td>
<td><code>user_hidden</code> - Boolean defaults to false. Setting to true prevents the Event from displaying on Navigators.</td>
</tr>
<tr>
<td></td>
<td>category - String value available to the driver writer to use however they see fit. Can be used to categorize events.</td>
</tr>
<tr>
<td></td>
<td>enabled - Boolean defaults to true. Setting enabled to false will disable the Event.</td>
</tr>
<tr>
<td></td>
<td>locked - Boolean which defaults to false. Setting enabled to true will place the Event in a read only state.</td>
</tr>
</tbody></table>

<h3 id='returns'>Returns</h3>

<table><thead>
<tr>
<th>Value</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>value</td>
<td>The added Event ID value.</td>
</tr>
</tbody></table>

<h3 id='example'>Example</h3><div class="highlight"><pre class="highlight lua tab-lua"><code><span class="k">function</span> <span class="nf">AddSingleDayEntry</span><span class="p">()</span>
    <span class="kd">local</span> <span class="n">name</span> <span class="o">=</span> <span class="s2">"AddSingleDayEntry Scheduled Event"</span>

    <span class="kd">local</span> <span class="n">start_time</span> <span class="o">=</span> <span class="p">{</span>
    <span class="n">year</span> <span class="o">=</span> <span class="mi">2018</span><span class="p">,</span>
    <span class="n">month</span> <span class="o">=</span> <span class="mi">7</span><span class="p">,</span>
    <span class="n">day</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span>
    <span class="n">hour</span> <span class="o">=</span> <span class="mi">21</span><span class="p">,</span>
    <span class="n">minute</span> <span class="o">=</span> <span class="mi">30</span>
    <span class="p">}</span>

    <span class="kd">local</span> <span class="n">options</span> <span class="o">=</span> <span class="p">{</span>
    <span class="n">hidden</span> <span class="o">=</span> <span class="kc">false</span><span class="p">,</span>
    <span class="n">user_hidden</span> <span class="o">=</span> <span class="kc">false</span><span class="p">,</span>
    <span class="n">category</span> <span class="o">=</span> <span class="s2">""</span><span class="p">,</span>
    <span class="n">enabled</span> <span class="o">=</span> <span class="kc">true</span><span class="p">,</span>
    <span class="n">locked</span> <span class="o">=</span> <span class="kc">false</span>
    <span class="p">}</span>

    <span class="kd">local</span> <span class="n">eventId</span> <span class="o">=</span> <span class="n">C4Scheduler</span><span class="p">:</span><span class="n">AddSingleDayEntry</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">start_time</span><span class="p">,</span> <span class="n">options</span><span class="p">)</span>
<span class="k">end</span>
<span class="n">AddSingleDayEntry</span><span class="p">()</span>
</code></pre></div>
<h2 id='adddailyrepeatentry'>AddDailyRepeatEntry</h2>
<p>This API adds an event which occurs repetitively.</p>
<h6 id='available-from-3-0-0'>Available from 3.0.0</h6><h3 id='signature'>Signature</h3>

<p><code>C4Scheduler:AddDailyRepeatEntry(name, start_time, end_date, options)</code></p>

<table><thead>
<tr>
<th>Parameter</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>str</td>
<td>String value of the name of the event being added.</td>
</tr>
<tr>
<td>table</td>
<td>Optional table that includes: year, month, day, hour using the 24 hour clock.  Default  time is 12:00 AM</td>
</tr>
<tr>
<td>table</td>
<td>Table of additional, optional parameters that includes:</td>
</tr>
<tr>
<td></td>
<td>hidden - Boolean. Defaults to false.  True prevents the Event from displaying in the Scheduler Agent in ComposerPro.</td>
</tr>
<tr>
<td></td>
<td><code>user_hidden</code> - Boolean. Defaults to false. Setting to true prevents the Event from displaying on Navigators.</td>
</tr>
<tr>
<td></td>
<td>category - String value that is available to the driver writer to use however they see fit. Can be used to categorize events.</td>
</tr>
<tr>
<td></td>
<td>enabled - Boolean which defaults to true. Setting enabled to false will disable the Event.</td>
</tr>
<tr>
<td></td>
<td>locked - Boolean which defaults to false. Setting enabled to true will place the Event in a read only state.</td>
</tr>
</tbody></table>

<h3 id='returns'>Returns</h3>

<table><thead>
<tr>
<th>Value</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>value</td>
<td>The added Event ID value.</td>
</tr>
</tbody></table>

<h3 id='example'>Example</h3><div class="highlight"><pre class="highlight lua tab-lua"><code><span class="k">function</span> <span class="nf">AddDailyRepeatEntry</span><span class="p">()</span>
    <span class="kd">local</span> <span class="n">name</span> <span class="o">=</span> <span class="s2">"AddDailyRepeatEntry Scheduled Event"</span>

    <span class="kd">local</span> <span class="n">start_time</span> <span class="o">=</span> <span class="p">{</span>
    <span class="n">year</span> <span class="o">=</span> <span class="mi">2018</span><span class="p">,</span>
    <span class="n">month</span> <span class="o">=</span> <span class="mi">6</span><span class="p">,</span>
    <span class="n">day</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span>
    <span class="n">hour</span> <span class="o">=</span> <span class="mi">21</span><span class="p">,</span>
    <span class="n">minute</span> <span class="o">=</span> <span class="mi">30</span>
    <span class="p">}</span>

    <span class="kd">local</span> <span class="n">end_date</span> <span class="o">=</span> <span class="p">{</span>
    <span class="n">year</span> <span class="o">=</span> <span class="mi">2019</span><span class="p">,</span>
    <span class="n">month</span> <span class="o">=</span> <span class="mi">7</span><span class="p">,</span>
    <span class="n">day</span> <span class="o">=</span> <span class="mi">3</span>
    <span class="p">}</span>

    <span class="kd">local</span> <span class="n">options</span> <span class="o">=</span> <span class="p">{</span>
    <span class="n">hidden</span> <span class="o">=</span> <span class="kc">false</span><span class="p">,</span>
    <span class="n">user_hidden</span> <span class="o">=</span> <span class="kc">false</span><span class="p">,</span>
    <span class="n">category</span> <span class="o">=</span> <span class="s2">""</span><span class="p">,</span>
    <span class="n">enabled</span> <span class="o">=</span> <span class="kc">true</span><span class="p">,</span>
    <span class="n">locked</span> <span class="o">=</span> <span class="kc">false</span>
    <span class="p">}</span>

    <span class="kd">local</span> <span class="n">eventId</span> <span class="o">=</span> <span class="n">C4Scheduler</span><span class="p">:</span><span class="n">AddDailyRepeatEntry</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">start_time</span><span class="p">,</span> <span class="n">end_date</span><span class="p">,</span> <span class="n">options</span><span class="p">)</span>
<span class="k">end</span>
<span class="n">AddDailyRepeatEntry</span><span class="p">()</span>
</code></pre></div>
<h2 id='adddailyrepeatrandomoffsetentry'>AddDailyRepeatRandomOffsetEntry</h2>
<p>This API adds an event which occurs repetitively and can be offset by a range of 60 minutes.</p>
<h6 id='available-from-3-0-0'>Available from 3.0.0</h6><h3 id='signature'>Signature</h3>

<p><code>C4Scheduler:AddDailyRepeatRandomOffsetEntry(name, random_range_minutes, start_time, end_date, options)</code></p>

<table><thead>
<tr>
<th>Parameter</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>str</td>
<td>String value of the name of the event being added.</td>
</tr>
<tr>
<td>table</td>
<td>Random range of minutes. number = number of minutes, range = (1-60)</td>
</tr>
<tr>
<td>table</td>
<td>start time includes year, month, day, hour using 24 hour clock. minute (optional)  The default  time is 12:00 AM.</td>
</tr>
<tr>
<td>table</td>
<td>end date. optional. includes: year, month, day</td>
</tr>
<tr>
<td>table</td>
<td>Table of additional, optional parameters that includes:</td>
</tr>
<tr>
<td></td>
<td>hidden - Boolean. Defaults to false. Setting to true prevents the Event from displaying in the Scheduler Agent in ComposerPro</td>
</tr>
<tr>
<td></td>
<td><code>user_hidden</code> - Boolean. Defaults to false. Setting user hidden to true prevents the Event from displaying on Navigators.</td>
</tr>
<tr>
<td></td>
<td>category - String value that is available to the driver writer to use however they see fit. Can be used to categorize events.</td>
</tr>
<tr>
<td></td>
<td>enabled - Boolean which defaults to true. Setting enabled to false will disable the Event.</td>
</tr>
<tr>
<td></td>
<td>locked - Boolean which defaults to false. Setting enabled to true will place the Event in a read only state.</td>
</tr>
</tbody></table>

<h3 id='returns'>Returns</h3>

<table><thead>
<tr>
<th>Valuer</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>value</td>
<td>The added Event ID value.</td>
</tr>
</tbody></table>

<h3 id='example'>Example</h3><div class="highlight"><pre class="highlight lua tab-lua"><code><span class="k">function</span> <span class="nf">AddDailyRepeatRandomOffsetEntry</span><span class="p">()</span>
    <span class="kd">local</span> <span class="n">name</span> <span class="o">=</span> <span class="s2">"AddDailyRepeatRandomOffsetEntry Scheduled Event"</span>
    <span class="kd">local</span> <span class="n">random_range_minutes</span> <span class="o">=</span> <span class="mi">12</span>

    <span class="kd">local</span> <span class="n">start_time</span> <span class="o">=</span> <span class="p">{</span>
    <span class="n">year</span> <span class="o">=</span> <span class="mi">2018</span><span class="p">,</span>
    <span class="n">month</span> <span class="o">=</span> <span class="mi">6</span><span class="p">,</span>
    <span class="n">day</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span>
    <span class="n">hour</span> <span class="o">=</span> <span class="mi">21</span><span class="p">,</span>
    <span class="n">minute</span> <span class="o">=</span> <span class="mi">30</span>
    <span class="p">}</span>

    <span class="kd">local</span> <span class="n">end_date</span> <span class="o">=</span> <span class="p">{</span>
    <span class="n">year</span> <span class="o">=</span> <span class="mi">2019</span><span class="p">,</span>
    <span class="n">month</span> <span class="o">=</span> <span class="mi">7</span><span class="p">,</span>
    <span class="n">day</span> <span class="o">=</span> <span class="mi">3</span>
    <span class="p">}</span>

    <span class="kd">local</span> <span class="n">options</span> <span class="o">=</span> <span class="p">{</span>
    <span class="n">hidden</span> <span class="o">=</span> <span class="kc">false</span><span class="p">,</span>
    <span class="n">user_hidden</span> <span class="o">=</span> <span class="kc">false</span><span class="p">,</span>
    <span class="n">category</span> <span class="o">=</span> <span class="s2">""</span><span class="p">,</span>
    <span class="n">enabled</span> <span class="o">=</span> <span class="kc">true</span><span class="p">,</span>
    <span class="n">locked</span> <span class="o">=</span> <span class="kc">false</span>
    <span class="p">}</span>

    <span class="kd">local</span> <span class="n">eventId</span> <span class="o">=</span> <span class="n">C4Scheduler</span><span class="p">:</span><span class="n">AddDailyRepeatRandomOffsetEntry</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">random_range_minutes</span><span class="p">,</span> <span class="n">start_time</span><span class="p">,</span> <span class="n">end_date</span><span class="p">,</span> <span class="n">options</span><span class="p">)</span>
<span class="k">end</span>
<span class="n">AddDailyRepeatRandomOffsetEntry</span><span class="p">()</span>
</code></pre></div>
<h2 id='adddailyrepeatxdaysentry'>AddDailyRepeatXDaysEntry</h2>
<p>This API adds an event which occurs repetitively, on a set number of days.</p>
<h6 id='available-from-3-0-0'>Available from 3.0.0</h6><h3 id='signature'>Signature</h3>

<p><code>C4Scheduler:AddRepeatXDaysEntry(name, every_num_days, start_time, end_date, options)</code></p>

<table><thead>
<tr>
<th>Parameter</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>str</td>
<td>String value of the name of the event being added.</td>
</tr>
<tr>
<td>table</td>
<td>every number days includes, number, number of days, range (1-100)</td>
</tr>
<tr>
<td>table</td>
<td>start time includes year, month, day, hour using 24 hour clock. minute is optional  The default time is 12:00 AM.</td>
</tr>
<tr>
<td>table</td>
<td>end date. optional. includes: year, month, day</td>
</tr>
<tr>
<td>table</td>
<td>Table of additional, optional parameters that includes:</td>
</tr>
<tr>
<td></td>
<td>hidden - Boolean. Defaults to false. Setting to true prevents the Event from displaying in the Scheduler Agent in ComposerPro</td>
</tr>
<tr>
<td></td>
<td><code>user_hidden</code> - Boolean. Defaults to false. Setting user hidden to true prevents the Event from displaying on Navigators.</td>
</tr>
<tr>
<td></td>
<td>category - String value that is available to the driver writer to use however they see fit. Can be used to categorize events.</td>
</tr>
<tr>
<td></td>
<td>enabled - Boolean which defaults to true. Setting enabled to false will disable the Event.</td>
</tr>
<tr>
<td></td>
<td>locked - Boolean which defaults to false. Setting enabled to true will place the Event in a read only state.</td>
</tr>
</tbody></table>

<h3 id='returns'>Returns</h3>

<table><thead>
<tr>
<th>Parameter</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>value</td>
<td>The added Event ID value.</td>
</tr>
</tbody></table>

<h3 id='example'>Example</h3><div class="highlight"><pre class="highlight lua tab-lua"><code><span class="k">function</span> <span class="nf">AddDailyRepeatXDaysEntry</span><span class="p">()</span>
    <span class="kd">local</span> <span class="n">name</span> <span class="o">=</span> <span class="s2">"AddDailyRepeatXDaysEntry Scheduled Event"</span>
    <span class="kd">local</span> <span class="n">every_num_days</span> <span class="o">=</span> <span class="mi">20</span>

    <span class="kd">local</span> <span class="n">start_time</span> <span class="o">=</span> <span class="p">{</span>
    <span class="n">year</span> <span class="o">=</span> <span class="mi">2018</span><span class="p">,</span>
    <span class="n">month</span> <span class="o">=</span> <span class="mi">6</span><span class="p">,</span>
    <span class="n">day</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span>
    <span class="n">hour</span> <span class="o">=</span> <span class="mi">21</span><span class="p">,</span>
    <span class="n">minute</span> <span class="o">=</span> <span class="mi">30</span>
    <span class="p">}</span>

    <span class="kd">local</span> <span class="n">end_date</span> <span class="o">=</span> <span class="p">{</span>
    <span class="n">year</span> <span class="o">=</span> <span class="mi">2019</span><span class="p">,</span>
    <span class="n">month</span> <span class="o">=</span> <span class="mi">7</span><span class="p">,</span>
    <span class="n">day</span> <span class="o">=</span> <span class="mi">3</span>
    <span class="p">}</span>

    <span class="kd">local</span> <span class="n">options</span> <span class="o">=</span> <span class="p">{</span>
    <span class="n">hidden</span> <span class="o">=</span> <span class="kc">false</span><span class="p">,</span>
    <span class="n">user_hidden</span> <span class="o">=</span> <span class="kc">false</span><span class="p">,</span>
    <span class="n">category</span> <span class="o">=</span> <span class="s2">""</span><span class="p">,</span>
    <span class="n">enabled</span> <span class="o">=</span> <span class="kc">true</span><span class="p">,</span>
    <span class="n">locked</span> <span class="o">=</span> <span class="kc">false</span>
    <span class="p">}</span>

    <span class="kd">local</span> <span class="n">eventId</span> <span class="o">=</span> <span class="n">C4Scheduler</span><span class="p">:</span><span class="n">AddDailyRepeatXDaysEntry</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">every_num_days</span><span class="p">,</span> <span class="n">start_time</span><span class="p">,</span> <span class="n">end_date</span><span class="p">,</span> <span class="n">options</span><span class="p">)</span>
<span class="k">end</span>

<span class="n">AddDailyRepeatXDaysEntry</span><span class="p">()</span>
</code></pre></div>
<h2 id='adddailysunriseentry'>AddDailySunriseEntry</h2>
<p>This API adds an event which occurs daily at sunrise. Sunrise time is based data provided by Director.</p>
<h6 id='available-from-3-0-0'>Available from 3.0.0</h6><h3 id='signature'>Signature</h3>

<p><code>C4Scheduler:AddDailySunriseEntry(name, start_time, end_date, options)</code></p>

<table><thead>
<tr>
<th>Parameter</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>str</td>
<td>String value of the name of the event being added.</td>
</tr>
<tr>
<td>table</td>
<td>start time includes year, month, day, hour using 24 hour clock. minute is optional  The default time is 12:00 AM.</td>
</tr>
<tr>
<td>table</td>
<td>end date. optional. includes: year, month, day</td>
</tr>
<tr>
<td>table</td>
<td>Table of additional, optional parameters that includes:</td>
</tr>
<tr>
<td></td>
<td>hidden - Boolean. Defaults to false. Setting to true prevents the Event from displaying in the Scheduler Agent in ComposerPro</td>
</tr>
<tr>
<td></td>
<td><code>user_hidden</code> - Boolean. Defaults to false. Setting user hidden to true prevents the Event from displaying on Navigators.</td>
</tr>
<tr>
<td></td>
<td>category - String value that is available to the driver writer to use however they see fit. Can be used to categorize events.</td>
</tr>
<tr>
<td></td>
<td>enabled - Boolean which defaults to true. Setting enabled to false will disable the Event.</td>
</tr>
<tr>
<td></td>
<td>locked - Boolean which defaults to false. Setting enabled to true will place the Event in a read only state.</td>
</tr>
</tbody></table>

<h3 id='returns'>Returns</h3>

<table><thead>
<tr>
<th>Valuer</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>value</td>
<td>The added Event ID value.</td>
</tr>
</tbody></table>

<h3 id='example'>Example</h3><div class="highlight"><pre class="highlight lua tab-lua"><code><span class="k">function</span> <span class="nf">AddDailySunriseEntry</span><span class="p">()</span>
    <span class="kd">local</span> <span class="n">name</span> <span class="o">=</span> <span class="s2">"AddDailySunriseEntry Scheduled Event"</span>

    <span class="kd">local</span> <span class="n">start_time</span> <span class="o">=</span> <span class="p">{</span>
    <span class="n">year</span> <span class="o">=</span> <span class="mi">2018</span><span class="p">,</span>
    <span class="n">month</span> <span class="o">=</span> <span class="mi">6</span><span class="p">,</span>
    <span class="n">day</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span>
    <span class="p">}</span>

    <span class="kd">local</span> <span class="n">end_date</span> <span class="o">=</span> <span class="p">{</span>
    <span class="n">year</span> <span class="o">=</span> <span class="mi">2019</span><span class="p">,</span>
    <span class="n">month</span> <span class="o">=</span> <span class="mi">7</span><span class="p">,</span>
    <span class="n">day</span> <span class="o">=</span> <span class="mi">3</span>
    <span class="p">}</span>

    <span class="kd">local</span> <span class="n">options</span> <span class="o">=</span> <span class="p">{</span>
    <span class="n">hidden</span> <span class="o">=</span> <span class="kc">false</span><span class="p">,</span>
    <span class="n">user_hidden</span> <span class="o">=</span> <span class="kc">false</span><span class="p">,</span>
    <span class="n">category</span> <span class="o">=</span> <span class="s2">""</span><span class="p">,</span>
    <span class="n">enabled</span> <span class="o">=</span> <span class="kc">true</span><span class="p">,</span>
    <span class="n">locked</span> <span class="o">=</span> <span class="kc">false</span>
    <span class="p">}</span>

    <span class="kd">local</span> <span class="n">eventId</span> <span class="o">=</span> <span class="n">C4Scheduler</span><span class="p">:</span><span class="n">AddDailySunriseEntry</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">start_time</span><span class="p">,</span> <span class="n">end_date</span><span class="p">,</span> <span class="n">options</span><span class="p">)</span>
<span class="k">end</span>
<span class="n">AddDailySunriseEntry</span><span class="p">()</span>

</code></pre></div>
<h2 id='adddailysunriseoffsetentry'>AddDailySunriseOffsetEntry</h2>
<p>This API adds an event which occurs daily at sunset and can be offset by a range of 360 minutes. Use a negative number for pre-sunrise and a positive number for post-sunrise. Sunrise time is based data provided by Director</p>
<h6 id='available-from-3-0-0'>Available from 3.0.0</h6><h3 id='signature'>Signature</h3>

<p><code>C4Scheduler:AddDailySunriseOffsetEntry(name, offset_minutes, start_time, end_date, options)</code></p>

<table><thead>
<tr>
<th>Parameter</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>str</td>
<td>String value of the name of the event being added.</td>
</tr>
<tr>
<td>table</td>
<td>offset minutes includes: number, number of minutes, range (-360 - 360)</td>
</tr>
<tr>
<td>table</td>
<td>start time includes year, month, day, hour using 24 hour clock. minute is optional  The default time is 12:00 AM.</td>
</tr>
<tr>
<td>table</td>
<td>end date. optional. includes: year, month, day</td>
</tr>
<tr>
<td>table</td>
<td>Table of additional, optional parameters that includes:</td>
</tr>
<tr>
<td></td>
<td>hidden - Boolean. Defaults to false. Setting to true prevents the Event from displaying in the Scheduler Agent in ComposerPro</td>
</tr>
<tr>
<td></td>
<td><code>user_hidden</code> - Boolean. Defaults to false. Setting user hidden to true prevents the Event from displaying on Navigators.</td>
</tr>
<tr>
<td></td>
<td>category - String value that is available to the driver writer to use however they see fit. Can be used to categorize events.</td>
</tr>
<tr>
<td></td>
<td>enabled - Boolean which defaults to true. Setting enabled to false will disable the Event.</td>
</tr>
<tr>
<td></td>
<td>locked - Boolean which defaults to false. Setting enabled to true will place the Event in a read only state.</td>
</tr>
</tbody></table>

<h3 id='returns'>Returns</h3>

<table><thead>
<tr>
<th>Value</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>value</td>
<td>The added Event ID value.</td>
</tr>
</tbody></table>

<h3 id='example'>Example</h3><div class="highlight"><pre class="highlight lua tab-lua"><code><span class="k">function</span> <span class="nf">AddDailySunriseOffsetEntry</span><span class="p">()</span>
    <span class="kd">local</span> <span class="n">name</span> <span class="o">=</span> <span class="s2">"AddDailySunriseOffsetEntry Scheduled Event"</span>
    <span class="kd">local</span> <span class="n">offset_range_minutes</span> <span class="o">=</span> <span class="mi">12</span>

    <span class="kd">local</span> <span class="n">start_time</span> <span class="o">=</span> <span class="p">{</span>
    <span class="n">year</span> <span class="o">=</span> <span class="mi">2018</span><span class="p">,</span>
    <span class="n">month</span> <span class="o">=</span> <span class="mi">6</span><span class="p">,</span>
    <span class="n">day</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span>
    <span class="n">hour</span> <span class="o">=</span> <span class="mi">21</span><span class="p">,</span>
    <span class="n">minute</span> <span class="o">=</span> <span class="mi">30</span>
    <span class="p">}</span>

    <span class="kd">local</span> <span class="n">end_date</span> <span class="o">=</span> <span class="p">{</span>
    <span class="n">year</span> <span class="o">=</span> <span class="mi">2019</span><span class="p">,</span>
    <span class="n">month</span> <span class="o">=</span> <span class="mi">7</span><span class="p">,</span>
    <span class="n">day</span> <span class="o">=</span> <span class="mi">3</span>
    <span class="p">}</span>

    <span class="kd">local</span> <span class="n">options</span> <span class="o">=</span> <span class="p">{</span>
    <span class="n">hidden</span> <span class="o">=</span> <span class="kc">false</span><span class="p">,</span>
    <span class="n">user_hidden</span> <span class="o">=</span> <span class="kc">false</span><span class="p">,</span>
    <span class="n">category</span> <span class="o">=</span> <span class="s2">""</span><span class="p">,</span>
    <span class="n">enabled</span> <span class="o">=</span> <span class="kc">true</span><span class="p">,</span>
    <span class="n">locked</span> <span class="o">=</span> <span class="kc">false</span>
    <span class="p">}</span>

    <span class="kd">local</span> <span class="n">eventId</span> <span class="o">=</span> <span class="n">C4Scheduler</span><span class="p">:</span><span class="n">AddDailySunriseOffsetEntry</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">offset_range_minutes</span><span class="p">,</span> <span class="n">start_time</span><span class="p">,</span> <span class="n">end_date</span><span class="p">,</span> <span class="n">options</span><span class="p">)</span>
<span class="k">end</span>
<span class="n">AddDailySunriseOffsetEntry</span><span class="p">()</span>
</code></pre></div>
<h2 id='adddailysunriserandomoffsetentry'>AddDailySunriseRandomOffsetEntry</h2>
<p>This API adds an event which occurs daily at sunrise and can be randomized by a range of 60 minutes. Sunrise time is based data provided by Director.</p>
<h6 id='available-from-3-0-0'>Available from 3.0.0</h6><h3 id='signature'>Signature</h3>

<p><code>C4Scheduler:AddDailySunriseRandomOffsetEntry(name, random_range_minutes, start_time, end_date, options)</code></p>

<table><thead>
<tr>
<th>Parameter</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>str</td>
<td>String value of the name of the event being added.</td>
</tr>
<tr>
<td>table</td>
<td>Random range of minutes. number = number of minutes, range = (1-60)</td>
</tr>
<tr>
<td>table</td>
<td>start time includes year, month, day, hour using 24 hour clock. minute is optional  The default time is 12:00 AM.</td>
</tr>
<tr>
<td>table</td>
<td>end date. optional. includes: year, month, day</td>
</tr>
<tr>
<td>table</td>
<td>Table of additional, optional parameters that includes:</td>
</tr>
<tr>
<td></td>
<td>hidden - Boolean. Defaults to false. Setting to true prevents the Event from displaying in the Scheduler Agent in ComposerPro</td>
</tr>
<tr>
<td></td>
<td><code>user_hidden</code> - Boolean. Defaults to false. Setting user hidden to true prevents the Event from displaying on Navigators.</td>
</tr>
<tr>
<td></td>
<td>category - String value that is available to the driver writer to use however they see fit. Can be used to categorize events.</td>
</tr>
<tr>
<td></td>
<td>enabled - Boolean which defaults to true. Setting enabled to false will disable the Event.</td>
</tr>
<tr>
<td></td>
<td>locked - Boolean which defaults to false. Setting enabled to true will place the Event in a read only state.</td>
</tr>
</tbody></table>

<h3 id='returns'>Returns</h3>

<table><thead>
<tr>
<th>Value</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>value</td>
<td>The added Event ID value.</td>
</tr>
</tbody></table>

<h3 id='example'>Example</h3><div class="highlight"><pre class="highlight lua tab-lua"><code><span class="k">function</span> <span class="nf">AddDailySunriseRandomOffsetEntry</span><span class="p">()</span>
    <span class="kd">local</span> <span class="n">name</span> <span class="o">=</span> <span class="s2">"AddDailySunriseRandomOffsetEntry Scheduled Event"</span>
    <span class="kd">local</span> <span class="n">random_range_minutes</span> <span class="o">=</span> <span class="mi">13</span>

    <span class="kd">local</span> <span class="n">start_time</span> <span class="o">=</span> <span class="p">{</span>
    <span class="n">year</span> <span class="o">=</span> <span class="mi">2018</span><span class="p">,</span>
    <span class="n">month</span> <span class="o">=</span> <span class="mi">6</span><span class="p">,</span>
    <span class="n">day</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span>
    <span class="n">hour</span> <span class="o">=</span> <span class="mi">21</span><span class="p">,</span>
    <span class="n">minute</span> <span class="o">=</span> <span class="mi">30</span>
    <span class="p">}</span>

    <span class="kd">local</span> <span class="n">end_date</span> <span class="o">=</span> <span class="p">{</span>
    <span class="n">year</span> <span class="o">=</span> <span class="mi">2019</span><span class="p">,</span>
    <span class="n">month</span> <span class="o">=</span> <span class="mi">7</span><span class="p">,</span>
    <span class="n">day</span> <span class="o">=</span> <span class="mi">3</span>
    <span class="p">}</span>

    <span class="kd">local</span> <span class="n">options</span> <span class="o">=</span> <span class="p">{</span>
    <span class="n">hidden</span> <span class="o">=</span> <span class="kc">false</span><span class="p">,</span>
    <span class="n">user_hidden</span> <span class="o">=</span> <span class="kc">false</span><span class="p">,</span>
    <span class="n">category</span> <span class="o">=</span> <span class="s2">""</span><span class="p">,</span>
    <span class="n">enabled</span> <span class="o">=</span> <span class="kc">true</span><span class="p">,</span>
    <span class="n">locked</span> <span class="o">=</span> <span class="kc">false</span>
    <span class="p">}</span>

    <span class="kd">local</span> <span class="n">eventId</span> <span class="o">=</span> <span class="n">C4Scheduler</span><span class="p">:</span><span class="n">AddDailySunriseRandomOffsetEntry</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">random_range_minutes</span><span class="p">,</span> <span class="n">start_time</span><span class="p">,</span> <span class="n">end_date</span><span class="p">,</span> <span class="n">options</span><span class="p">)</span>
<span class="k">end</span>
<span class="n">AddDailySunriseRandomOffsetEntry</span><span class="p">()</span>
</code></pre></div>
<h2 id='adddailysunsetentry'>AddDailySunsetEntry</h2>
<p>This API adds an event which occurs daily at sunset. Sunset time is based data provided by Director.</p>
<h6 id='available-from-3-0-0'>Available from 3.0.0</h6><h3 id='signature'>Signature</h3>

<p><code>C4Scheduler:AddDailySunsetEntry(name, start_time, end_date, options</code></p>

<table><thead>
<tr>
<th>Parameter</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>str</td>
<td>String value of the name of the event being added.</td>
</tr>
<tr>
<td>table</td>
<td>start time includes year, month, day, hour using 24 hour clock. minute is optional  The default time is 12:00 AM.</td>
</tr>
<tr>
<td>table</td>
<td>end date. optional. includes: year, month, day</td>
</tr>
<tr>
<td>table</td>
<td>Table of additional, optional parameters that includes:</td>
</tr>
<tr>
<td></td>
<td>hidden - Boolean. Defaults to false. Setting to true prevents the Event from displaying in the Scheduler Agent in ComposerPro</td>
</tr>
<tr>
<td></td>
<td><code>user_hidden</code> - Boolean. Defaults to false. Setting user hidden to true prevents the Event from displaying on Navigators.</td>
</tr>
<tr>
<td></td>
<td>category - String value that is available to the driver writer to use however they see fit. Can be used to categorize events.</td>
</tr>
<tr>
<td></td>
<td>enabled - Boolean which defaults to true. Setting enabled to false will disable the Event.</td>
</tr>
<tr>
<td></td>
<td>locked - Boolean which defaults to false. Setting enabled to true will place the Event in a read only state.</td>
</tr>
</tbody></table>

<h3 id='returns'>Returns</h3>

<table><thead>
<tr>
<th>Value</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>value</td>
<td>The added Event ID value.</td>
</tr>
</tbody></table>

<h3 id='example'>Example</h3><div class="highlight"><pre class="highlight lua tab-lua"><code><span class="k">function</span> <span class="nf">AddDailySunsetEntry</span><span class="p">()</span>
    <span class="kd">local</span> <span class="n">name</span> <span class="o">=</span> <span class="s2">"AddDailySunsetEntry Scheduled Event"</span>

    <span class="kd">local</span> <span class="n">start_time</span> <span class="o">=</span> <span class="p">{</span>
    <span class="n">year</span> <span class="o">=</span> <span class="mi">2018</span><span class="p">,</span>
    <span class="n">month</span> <span class="o">=</span> <span class="mi">6</span><span class="p">,</span>
    <span class="n">day</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span>
    <span class="n">hour</span> <span class="o">=</span> <span class="mi">21</span><span class="p">,</span>
    <span class="n">minute</span> <span class="o">=</span> <span class="mi">30</span>
    <span class="p">}</span>

    <span class="kd">local</span> <span class="n">end_date</span> <span class="o">=</span> <span class="p">{</span>
    <span class="n">year</span> <span class="o">=</span> <span class="mi">2019</span><span class="p">,</span>
    <span class="n">month</span> <span class="o">=</span> <span class="mi">7</span><span class="p">,</span>
    <span class="n">day</span> <span class="o">=</span> <span class="mi">3</span>
    <span class="p">}</span>

    <span class="kd">local</span> <span class="n">options</span> <span class="o">=</span> <span class="p">{</span>
    <span class="n">hidden</span> <span class="o">=</span> <span class="kc">false</span><span class="p">,</span>
    <span class="n">user_hidden</span> <span class="o">=</span> <span class="kc">false</span><span class="p">,</span>
    <span class="n">category</span> <span class="o">=</span> <span class="s2">""</span><span class="p">,</span>
    <span class="n">enabled</span> <span class="o">=</span> <span class="kc">true</span><span class="p">,</span>
    <span class="n">locked</span> <span class="o">=</span> <span class="kc">false</span>
    <span class="p">}</span>

    <span class="kd">local</span> <span class="n">eventId</span> <span class="o">=</span> <span class="n">C4Scheduler</span><span class="p">:</span><span class="n">AddDailySunsetEntry</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">start_time</span><span class="p">,</span> <span class="n">end_date</span><span class="p">,</span> <span class="n">options</span><span class="p">)</span>
<span class="k">end</span>
<span class="n">AddDailySunsetEntry</span><span class="p">()</span>
</code></pre></div>
<h2 id='adddailysunsetoffsetentry'>AddDailySunsetOffsetEntry</h2>
<p>This API adds an event which occurs daily at sunset and can be offset by a range of 360 minutes. Use a negative number for pre-sunset and a positive number for post sunset. Sunset time is based data provided by Director.</p>
<h6 id='available-from-3-0-0'>Available from 3.0.0</h6><h3 id='signature'>Signature</h3>

<p><code>C4Scheduler:AddDailySunsetOffsetEntry(name, offset_minutes, start_time, end_date, options)</code></p>

<table><thead>
<tr>
<th>Parameter</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>str</td>
<td>String value of the name of the event being added.</td>
</tr>
<tr>
<td>table</td>
<td>offset minutes includes: number, number of minutes, range (-360 - 360)</td>
</tr>
<tr>
<td>table</td>
<td>start time includes year, month, day, hour using 24 hour clock. minute is optional  The default time is 12:00 AM.</td>
</tr>
<tr>
<td>table</td>
<td>end date. optional. includes: year, month, day</td>
</tr>
<tr>
<td>table</td>
<td>Table of additional, optional parameters that includes:</td>
</tr>
<tr>
<td></td>
<td>hidden - Boolean. Defaults to false. Setting to true prevents the Event from displaying in the Scheduler Agent in ComposerPro</td>
</tr>
<tr>
<td></td>
<td><code>user_hidden</code> - Boolean. Defaults to false. Setting user hidden to true prevents the Event from displaying on Navigators.</td>
</tr>
<tr>
<td></td>
<td>category - String value that is available to the driver writer to use however they see fit. Can be used to categorize events.</td>
</tr>
<tr>
<td></td>
<td>enabled - Boolean which defaults to true. Setting enabled to false will disable the Event.</td>
</tr>
<tr>
<td></td>
<td>locked - Boolean which defaults to false. Setting enabled to true will place the Event in a read only state.</td>
</tr>
</tbody></table>

<h3 id='returns'>Returns</h3>

<table><thead>
<tr>
<th>Parameter</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>value</td>
<td>The added Event ID value.</td>
</tr>
</tbody></table>

<h3 id='example'>Example</h3><div class="highlight"><pre class="highlight lua tab-lua"><code><span class="k">function</span> <span class="nf">AddDailySunsetOffsetEntry</span><span class="p">()</span>
    <span class="kd">local</span> <span class="n">name</span> <span class="o">=</span> <span class="s2">"AddDailySunsetOffsetEntry Scheduled Event"</span>
    <span class="kd">local</span> <span class="n">offset_minutes</span> <span class="o">=</span> <span class="mi">12</span>

    <span class="kd">local</span> <span class="n">start_time</span> <span class="o">=</span> <span class="p">{</span>
    <span class="n">year</span> <span class="o">=</span> <span class="mi">2018</span><span class="p">,</span>
    <span class="n">month</span> <span class="o">=</span> <span class="mi">6</span><span class="p">,</span>
    <span class="n">day</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span>
    <span class="n">hour</span> <span class="o">=</span> <span class="mi">21</span><span class="p">,</span>
    <span class="n">minute</span> <span class="o">=</span> <span class="mi">30</span>
    <span class="p">}</span>

    <span class="kd">local</span> <span class="n">end_date</span> <span class="o">=</span> <span class="p">{</span>
    <span class="n">year</span> <span class="o">=</span> <span class="mi">2019</span><span class="p">,</span>
    <span class="n">month</span> <span class="o">=</span> <span class="mi">7</span><span class="p">,</span>
    <span class="n">day</span> <span class="o">=</span> <span class="mi">3</span>
    <span class="p">}</span>

    <span class="kd">local</span> <span class="n">options</span> <span class="o">=</span> <span class="p">{</span>
    <span class="n">hidden</span> <span class="o">=</span> <span class="kc">false</span><span class="p">,</span>
    <span class="n">user_hidden</span> <span class="o">=</span> <span class="kc">false</span><span class="p">,</span>
    <span class="n">category</span> <span class="o">=</span> <span class="s2">""</span><span class="p">,</span>
    <span class="n">enabled</span> <span class="o">=</span> <span class="kc">true</span><span class="p">,</span>
    <span class="n">locked</span> <span class="o">=</span> <span class="kc">false</span>
    <span class="p">}</span>

    <span class="kd">local</span> <span class="n">eventId</span> <span class="o">=</span> <span class="n">C4Scheduler</span><span class="p">:</span><span class="n">AddDailySunsetOffsetEntry</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">offset_minutes</span><span class="p">,</span> <span class="n">start_time</span><span class="p">,</span> <span class="n">end_date</span><span class="p">,</span> <span class="n">options</span><span class="p">)</span>
<span class="k">end</span>
<span class="n">AddDailySunsetOffsetEntry</span><span class="p">()</span>
</code></pre></div>
<h2 id='adddailysunsetrandomoffsetentry'>AddDailySunsetRandomOffsetEntry</h2>
<p>This API adds an event which occurs daily at sunset and can be randomized by a range of 60 minutes. Sunset time is based data provided by Director.</p>
<h6 id='available-from-3-0-0'>Available from 3.0.0</h6><h3 id='signature'>Signature</h3>

<p><code>C4:Scheduler:AddDailySunsetRandomOffsetEntry(name, random_range_minutes, start_time, end_date, options)</code></p>

<table><thead>
<tr>
<th>Parameter</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>str</td>
<td>String value of the name of the event being added.</td>
</tr>
<tr>
<td>table</td>
<td>Random range of minutes. number = number of minutes, range = (1-60)</td>
</tr>
<tr>
<td>table</td>
<td>start time includes year, month, day, hour using 24 hour clock. minute is optional  The default time is 12:00 AM.</td>
</tr>
<tr>
<td>table</td>
<td>end date. optional. includes: year, month, day</td>
</tr>
<tr>
<td>table</td>
<td>Table of additional, optional parameters that includes:</td>
</tr>
<tr>
<td></td>
<td>hidden - Boolean. Defaults to false. Setting to true prevents the Event from displaying in the Scheduler Agent in ComposerPro</td>
</tr>
<tr>
<td></td>
<td><code>user_hidden</code> - Boolean. Defaults to false. Setting user hidden to true prevents the Event from displaying on Navigators.</td>
</tr>
<tr>
<td></td>
<td>category - String value that is available to the driver writer to use however they see fit. Can be used to categorize events.</td>
</tr>
<tr>
<td></td>
<td>enabled - Boolean which defaults to true. Setting enabled to false will disable the Event.</td>
</tr>
<tr>
<td></td>
<td>locked - Boolean which defaults to false. Setting enabled to true will place the Event in a read only state.</td>
</tr>
</tbody></table>

<h3 id='returns'>Returns</h3>

<table><thead>
<tr>
<th>Parameter</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>value</td>
<td>The added Event ID value.</td>
</tr>
</tbody></table>

<h3 id='example'>Example</h3><div class="highlight"><pre class="highlight lua tab-lua"><code><span class="k">function</span> <span class="nf">AddDailySunsetRandomOffsetEntry</span><span class="p">()</span>
    <span class="kd">local</span> <span class="n">name</span> <span class="o">=</span> <span class="s2">"AddDailySunsetRandomOffsetEntry Scheduled Event"</span>
    <span class="kd">local</span> <span class="n">random_range_minutes</span> <span class="o">=</span> <span class="mi">13</span>

    <span class="kd">local</span> <span class="n">start_time</span> <span class="o">=</span> <span class="p">{</span>
    <span class="n">year</span> <span class="o">=</span> <span class="mi">2018</span><span class="p">,</span>
    <span class="n">month</span> <span class="o">=</span> <span class="mi">6</span><span class="p">,</span>
    <span class="n">day</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span>
    <span class="n">hour</span> <span class="o">=</span> <span class="mi">21</span><span class="p">,</span>
    <span class="n">minute</span> <span class="o">=</span> <span class="mi">30</span>
    <span class="p">}</span>

    <span class="kd">local</span> <span class="n">end_date</span> <span class="o">=</span> <span class="p">{</span>
    <span class="n">year</span> <span class="o">=</span> <span class="mi">2019</span><span class="p">,</span>
    <span class="n">month</span> <span class="o">=</span> <span class="mi">7</span><span class="p">,</span>
    <span class="n">day</span> <span class="o">=</span> <span class="mi">3</span>
    <span class="p">}</span>

    <span class="kd">local</span> <span class="n">options</span> <span class="o">=</span> <span class="p">{</span>
    <span class="n">hidden</span> <span class="o">=</span> <span class="kc">false</span><span class="p">,</span>
    <span class="n">user_hidden</span> <span class="o">=</span> <span class="kc">false</span><span class="p">,</span>
    <span class="n">category</span> <span class="o">=</span> <span class="s2">""</span><span class="p">,</span>
    <span class="n">enabled</span> <span class="o">=</span> <span class="kc">true</span><span class="p">,</span>
    <span class="n">locked</span> <span class="o">=</span> <span class="kc">false</span>
    <span class="p">}</span>

    <span class="kd">local</span> <span class="n">eventId</span> <span class="o">=</span> <span class="n">C4Scheduler</span><span class="p">:</span><span class="n">AddDailySunsetRandomOffsetEntry</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">random_range_minutes</span><span class="p">,</span> <span class="n">start_time</span><span class="p">,</span> <span class="n">end_date</span><span class="p">,</span> <span class="n">options</span><span class="p">)</span>
<span class="k">end</span>
<span class="n">AddDailySunsetRandomOffsetEntry</span><span class="p">()</span>
</code></pre></div>
<h2 id='addendofmonthentry'>AddEndOfMonthEntry</h2>
<p>This API adds an event which occurs at the end of the month defined in the start table.</p>
<h6 id='available-from-3-0-0'>Available from 3.0.0</h6><h3 id='signature'>Signature</h3>

<p><code>C4Scheduler:AddEndOfMonthEntry(name, start_time, options)</code></p>

<table><thead>
<tr>
<th>Parameter</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>str</td>
<td>String value of the name of the event being added.</td>
</tr>
<tr>
<td>table</td>
<td>start time includes year, month, day, hour using 24 hour clock. minute is optional  The default time is 12:00 AM.</td>
</tr>
<tr>
<td>table</td>
<td>Table of additional, optional parameters that includes:</td>
</tr>
<tr>
<td></td>
<td>hidden - Boolean. Defaults to false. Setting to true prevents the Event from displaying in the Scheduler Agent in ComposerPro</td>
</tr>
<tr>
<td></td>
<td><code>user_hidden</code> - Boolean. Defaults to false. Setting user hidden to true prevents the Event from displaying on Navigators.</td>
</tr>
<tr>
<td></td>
<td>category - String value that is available to the driver writer to use however they see fit. Can be used to categorize events.</td>
</tr>
<tr>
<td></td>
<td>enabled - Boolean which defaults to true. Setting enabled to false will disable the Event.</td>
</tr>
<tr>
<td></td>
<td>locked - Boolean which defaults to false. Setting enabled to true will place the Event in a read only state.</td>
</tr>
</tbody></table>

<h3 id='returns'>Returns</h3>

<table><thead>
<tr>
<th>Value</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>value</td>
<td>The added Event ID value.</td>
</tr>
</tbody></table>

<h3 id='example'>Example</h3><div class="highlight"><pre class="highlight lua tab-lua"><code><span class="k">function</span> <span class="nf">AddEndOfMonthEntry</span><span class="p">()</span>
    <span class="kd">local</span> <span class="n">name</span> <span class="o">=</span> <span class="s2">"AddEndOfMonthEntry Scheduled Event"</span>

    <span class="kd">local</span> <span class="n">start_time</span> <span class="o">=</span> <span class="p">{</span>
    <span class="n">year</span> <span class="o">=</span> <span class="mi">2018</span><span class="p">,</span>
    <span class="n">month</span> <span class="o">=</span> <span class="mi">6</span><span class="p">,</span>
    <span class="n">hour</span> <span class="o">=</span> <span class="mi">21</span><span class="p">,</span>
    <span class="n">minute</span> <span class="o">=</span> <span class="mi">30</span>
    <span class="p">}</span>

    <span class="kd">local</span> <span class="n">options</span> <span class="o">=</span> <span class="p">{</span>
    <span class="n">hidden</span> <span class="o">=</span> <span class="kc">false</span><span class="p">,</span>
    <span class="n">user_hidden</span> <span class="o">=</span> <span class="kc">false</span><span class="p">,</span>
    <span class="n">category</span> <span class="o">=</span> <span class="s2">""</span><span class="p">,</span>
    <span class="n">enabled</span> <span class="o">=</span> <span class="kc">true</span><span class="p">,</span>
    <span class="n">locked</span> <span class="o">=</span> <span class="kc">false</span>
    <span class="p">}</span>

    <span class="kd">local</span> <span class="n">eventId</span> <span class="o">=</span> <span class="n">C4Scheduler</span><span class="p">:</span><span class="n">AddEndOfMonthEntry</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">start_time</span><span class="p">,</span> <span class="n">options</span><span class="p">)</span>
<span class="k">end</span>
<span class="n">AddEndOfMonthEntry</span><span class="p">()</span>
</code></pre></div>
<h2 id='addendofmonthrepeatentry'>AddEndOfMonthRepeatEntry</h2>
<p>This API adds an event which occurs at the end of every month.</p>
<h6 id='available-from-3-0-0'>Available from 3.0.0</h6><h3 id='signature'>Signature</h3>

<p><code>C4Scheduler:AddEndOfMonthRepeatEntry(name, start_time, end_date, options</code></p>

<table><thead>
<tr>
<th>Parameter</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>str</td>
<td>String value of the name of the event being added.</td>
</tr>
<tr>
<td>table</td>
<td>start time includes year, month, day, hour using 24 hour clock. minute is optional  The default time is 12:00 AM.</td>
</tr>
<tr>
<td>table</td>
<td>end date. optional. includes: year, month, day</td>
</tr>
<tr>
<td>table</td>
<td>Table of additional, optional parameters that includes:</td>
</tr>
<tr>
<td></td>
<td>hidden - Boolean. Defaults to false. Setting to true prevents the Event from displaying in the Scheduler Agent in ComposerPro</td>
</tr>
<tr>
<td></td>
<td><code>user_hidden</code> - Boolean. Defaults to false. Setting user hidden to true prevents the Event from displaying on Navigators.</td>
</tr>
<tr>
<td></td>
<td>category - String value that is available to the driver writer to use however they see fit. Can be used to categorize events.</td>
</tr>
<tr>
<td></td>
<td>enabled - Boolean which defaults to true. Setting enabled to false will disable the Event.</td>
</tr>
<tr>
<td></td>
<td>locked - Boolean which defaults to false. Setting enabled to true will place the Event in a read only state.</td>
</tr>
</tbody></table>

<h3 id='returns'>Returns</h3>

<table><thead>
<tr>
<th>Value</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>value</td>
<td>The added Event ID value.</td>
</tr>
</tbody></table>

<h3 id='example'>Example</h3><div class="highlight"><pre class="highlight lua tab-lua"><code><span class="k">function</span> <span class="nf">AddEndOfMonthRepeatEntry</span><span class="p">()</span>
    <span class="kd">local</span> <span class="n">name</span> <span class="o">=</span> <span class="s2">"AddEndOfMonthRepeatEntry Scheduled Event"</span>

    <span class="kd">local</span> <span class="n">start_time</span> <span class="o">=</span> <span class="p">{</span>
    <span class="n">year</span> <span class="o">=</span> <span class="mi">2018</span><span class="p">,</span>
    <span class="n">month</span> <span class="o">=</span> <span class="mi">6</span><span class="p">,</span>
    <span class="n">hour</span> <span class="o">=</span> <span class="mi">21</span><span class="p">,</span>
    <span class="n">minute</span> <span class="o">=</span> <span class="mi">30</span>
    <span class="p">}</span>

    <span class="kd">local</span> <span class="n">end_date</span> <span class="o">=</span> <span class="p">{</span>
    <span class="n">year</span> <span class="o">=</span> <span class="mi">2019</span><span class="p">,</span>
    <span class="n">month</span> <span class="o">=</span> <span class="mi">7</span><span class="p">,</span>
    <span class="n">day</span> <span class="o">=</span> <span class="mi">3</span>
    <span class="p">}</span>

    <span class="kd">local</span> <span class="n">options</span> <span class="o">=</span> <span class="p">{</span>
    <span class="n">hidden</span> <span class="o">=</span> <span class="kc">false</span><span class="p">,</span>
    <span class="n">user_hidden</span> <span class="o">=</span> <span class="kc">false</span><span class="p">,</span>
    <span class="n">category</span> <span class="o">=</span> <span class="s2">""</span><span class="p">,</span>
    <span class="n">enabled</span> <span class="o">=</span> <span class="kc">true</span><span class="p">,</span>
    <span class="n">locked</span> <span class="o">=</span> <span class="kc">false</span>
    <span class="p">}</span>

    <span class="kd">local</span> <span class="n">eventId</span> <span class="o">=</span> <span class="n">C4Scheduler</span><span class="p">:</span><span class="n">AddEndOfMonthRepeatEntry</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">start_time</span><span class="p">,</span> <span class="n">end_date</span><span class="p">,</span> <span class="n">options</span><span class="p">)</span>
<span class="k">end</span>
<span class="n">AddEndOfMonthRepeatEntry</span><span class="p">()</span>
</code></pre></div>
<h2 id='addnthweekdayofmonthentry'>AddNthWeekdayOfMonthEntry</h2>
<p>This API adds an event which occurs at the designated (Nth) day of every week in relation to that days occurrence in a month. For example, an event that occurs on the second Tuesday of the month of May.</p>
<h6 id='available-from-3-0-0'>Available from 3.0.0</h6><h3 id='signature'>Signature</h3>

<p><code>C4Scheduler:AddNthWeekdayOfMonthEntry(name, period, weekday, start_time, options)</code></p>

<table><thead>
<tr>
<th>Parameter</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>str</td>
<td>String value of the name of the event being added.</td>
</tr>
<tr>
<td>str</td>
<td>Period values of: FIRST, SECOND, THIRD, FOURTH, LAST</td>
</tr>
<tr>
<td>str</td>
<td>Weekday values of: SUNDAY, MONDAY, TUESDAY, WEDNESDAY, THURSDAY, FRIDAY, SATURDAY</td>
</tr>
<tr>
<td>table</td>
<td>start time includes year, month, day, hour using 24 hour clock. minute is optional  The default time is 12:00 AM.</td>
</tr>
<tr>
<td>table</td>
<td>Table of additional, optional parameters that includes:</td>
</tr>
<tr>
<td></td>
<td>hidden - Boolean. Defaults to false. Setting to true prevents the Event from displaying in the Scheduler Agent in ComposerPro</td>
</tr>
<tr>
<td></td>
<td><code>user_hidden</code> - Boolean. Defaults to false. Setting user hidden to true prevents the Event from displaying on Navigators.</td>
</tr>
<tr>
<td></td>
<td>category - String value that is available to the driver writer to use however they see fit. Can be used to categorize events.</td>
</tr>
<tr>
<td></td>
<td>enabled - Boolean which defaults to true. Setting enabled to false will disable the Event.</td>
</tr>
<tr>
<td></td>
<td>locked - Boolean which defaults to false. Setting enabled to true will place the Event in a read only state.</td>
</tr>
</tbody></table>

<h3 id='returns'>Returns</h3>

<table><thead>
<tr>
<th>Value</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>value</td>
<td>The added Event ID value.</td>
</tr>
</tbody></table>

<h3 id='examples'>Examples</h3><div class="highlight"><pre class="highlight lua tab-lua"><code><span class="k">function</span> <span class="nf">AddNthWeekdayOfMonthEntry</span><span class="p">()</span>
    <span class="kd">local</span> <span class="n">name</span> <span class="o">=</span> <span class="s2">"AddNthWeekdayOfMonthEntry Scheduled Event"</span>
    <span class="kd">local</span> <span class="n">period</span> <span class="o">=</span> <span class="s2">"SECOND"</span>
    <span class="kd">local</span> <span class="n">week_day</span> <span class="o">=</span> <span class="s2">"MONDAY"</span>

    <span class="kd">local</span> <span class="n">start_time</span> <span class="o">=</span> <span class="p">{</span>
    <span class="n">year</span> <span class="o">=</span> <span class="mi">2018</span><span class="p">,</span>
    <span class="n">month</span> <span class="o">=</span> <span class="mi">6</span><span class="p">,</span>
    <span class="n">hour</span> <span class="o">=</span> <span class="mi">8</span><span class="p">,</span>
    <span class="n">minute</span> <span class="o">=</span> <span class="mi">15</span>
    <span class="p">}</span>

    <span class="kd">local</span> <span class="n">options</span> <span class="o">=</span> <span class="p">{</span>
    <span class="n">hidden</span> <span class="o">=</span> <span class="kc">false</span><span class="p">,</span>
    <span class="n">user_hidden</span> <span class="o">=</span> <span class="kc">false</span><span class="p">,</span>
    <span class="n">category</span> <span class="o">=</span> <span class="s2">""</span><span class="p">,</span>
    <span class="n">enabled</span> <span class="o">=</span> <span class="kc">true</span><span class="p">,</span>
    <span class="n">locked</span> <span class="o">=</span> <span class="kc">false</span>
    <span class="p">}</span>

    <span class="kd">local</span> <span class="n">eventId</span> <span class="o">=</span> <span class="n">C4Scheduler</span><span class="p">:</span><span class="n">AddNthWeekdayOfMonthEntry</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">period</span><span class="p">,</span> <span class="n">week_day</span><span class="p">,</span> <span class="n">start_time</span><span class="p">,</span> <span class="n">options</span><span class="p">)</span>
<span class="k">end</span>
<span class="n">AddNthWeekdayOfMonthEntry</span><span class="p">()</span>
</code></pre></div>
<h2 id='addnthweekdayofmonthrepeatentry'>AddNthWeekdayOfMonthRepeatEntry</h2>
<p>This API adds a repetitive event which occurs at the designated (Nth) day of every week in relation to that days occurrence in a month. For example, an event that occurs on the second Tuesday of every month.</p>
<h6 id='available-from-3-0-0'>Available from 3.0.0</h6><h3 id='signature'>Signature</h3>

<p><code>C4Scheduler:AddNthWeekdayOfMonthRepeatEntry(name, period, weekday, start_time, end_date, options)</code></p>

<table><thead>
<tr>
<th>Parameter</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>str</td>
<td>String value of the name of the event being added.</td>
</tr>
<tr>
<td>str</td>
<td>Period values of: FIRST, SECOND, THIRD, FOURTH, LAST</td>
</tr>
<tr>
<td>str</td>
<td>Weekday values of: SUNDAY, MONDAY, TUESDAY, WEDNESDAY, THURSDAY, FRIDAY, SATURDAY</td>
</tr>
<tr>
<td>table</td>
<td>start time includes year, month, day, hour using 24 hour clock. minute is optional  The default time is 12:00 AM.</td>
</tr>
<tr>
<td>table</td>
<td>end date. optional. includes: year, month, day</td>
</tr>
<tr>
<td>table</td>
<td>Table of additional, optional parameters that includes:</td>
</tr>
<tr>
<td></td>
<td>hidden - Boolean. Defaults to false. Setting to true prevents the Event from displaying in the Scheduler Agent in ComposerPro</td>
</tr>
<tr>
<td></td>
<td><code>user_hidden</code> - Boolean. Defaults to false. Setting user hidden to true prevents the Event from displaying on Navigators.</td>
</tr>
<tr>
<td></td>
<td>category - String value that is available to the driver writer to use however they see fit. Can be used to categorize events.</td>
</tr>
<tr>
<td></td>
<td>enabled - Boolean which defaults to true. Setting enabled to false will disable the Event.</td>
</tr>
<tr>
<td></td>
<td>locked - Boolean which defaults to false. Setting enabled to true will place the Event in a read only state.</td>
</tr>
</tbody></table>

<h3 id='returns'>Returns</h3>

<table><thead>
<tr>
<th>Value</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>value</td>
<td>The added Event ID value.</td>
</tr>
</tbody></table>

<h3 id='examples'>Examples</h3><div class="highlight"><pre class="highlight lua tab-lua"><code><span class="k">function</span> <span class="nf">AddNthWeekdayOfMonthRepeatEntry</span><span class="p">()</span>
    <span class="kd">local</span> <span class="n">name</span> <span class="o">=</span> <span class="s2">"AddNthWeekdayOfMonthRepeatEntry Scheduled Event"</span>
    <span class="kd">local</span> <span class="n">period</span> <span class="o">=</span> <span class="s2">"SECOND"</span>
    <span class="kd">local</span> <span class="n">week_day</span> <span class="o">=</span> <span class="s2">"MONDAY"</span>

    <span class="kd">local</span> <span class="n">start_time</span> <span class="o">=</span> <span class="p">{</span>
    <span class="n">year</span> <span class="o">=</span> <span class="mi">2018</span><span class="p">,</span>
    <span class="n">month</span> <span class="o">=</span> <span class="mi">6</span><span class="p">,</span>
    <span class="n">hour</span> <span class="o">=</span> <span class="mi">21</span><span class="p">,</span>
    <span class="n">minute</span> <span class="o">=</span> <span class="mi">30</span>
    <span class="p">}</span>

    <span class="kd">local</span> <span class="n">end_date</span> <span class="o">=</span> <span class="p">{</span>
    <span class="n">year</span> <span class="o">=</span> <span class="mi">2019</span><span class="p">,</span>
    <span class="n">month</span> <span class="o">=</span> <span class="mi">7</span><span class="p">,</span>
    <span class="n">day</span> <span class="o">=</span> <span class="mi">3</span>
    <span class="p">}</span>

    <span class="kd">local</span> <span class="n">options</span> <span class="o">=</span> <span class="p">{</span>
    <span class="n">hidden</span> <span class="o">=</span> <span class="kc">false</span><span class="p">,</span>
    <span class="n">user_hidden</span> <span class="o">=</span> <span class="kc">false</span><span class="p">,</span>
    <span class="n">category</span> <span class="o">=</span> <span class="s2">""</span><span class="p">,</span>
    <span class="n">enabled</span> <span class="o">=</span> <span class="kc">true</span><span class="p">,</span>
    <span class="n">locked</span> <span class="o">=</span> <span class="kc">false</span>
    <span class="p">}</span>

    <span class="kd">local</span> <span class="n">eventId</span> <span class="o">=</span> <span class="n">C4Scheduler</span><span class="p">:</span><span class="n">AddNthWeekdayOfMonthRepeatEntry</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">period</span><span class="p">,</span> <span class="n">week_day</span><span class="p">,</span> <span class="n">start_time</span><span class="p">,</span> <span class="n">end_date</span><span class="p">,</span> <span class="n">options</span><span class="p">)</span>
<span class="k">end</span>
<span class="n">AddNthWeekdayOfMonthRepeatEntry</span><span class="p">()</span>
</code></pre></div>
<h2 id='adddaysoftheweekentry'>AddDaysOfTheWeekEntry</h2>
<p>This API adds an event which occurs on defined days of the week.</p>
<h6 id='available-from-3-0-0'>Available from 3.0.0</h6><h3 id='signature'>Signature</h3>

<p><code>C4:Scheduler:AddDaysOfTheWeekEntry(name, days_of_the_week, start_time, end_date, options)</code></p>

<table><thead>
<tr>
<th>Parameter</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>str</td>
<td>String value of the name of the event being added.</td>
</tr>
<tr>
<td>str</td>
<td>Weekday values of: SUNDAY, MONDAY, TUESDAY, WEDNESDAY, THURSDAY, FRIDAY, SATURDAY</td>
</tr>
<tr>
<td>table</td>
<td>start time includes year, month, day, hour using 24 hour clock. minute is optional  The default time is 12:00 AM.</td>
</tr>
<tr>
<td>table</td>
<td>end date. optional. includes: year, month, day</td>
</tr>
<tr>
<td>table</td>
<td>Table of additional, optional parameters that includes:</td>
</tr>
<tr>
<td></td>
<td>hidden - Boolean. Defaults to false. Setting to true prevents the Event from displaying in the Scheduler Agent in ComposerPro</td>
</tr>
<tr>
<td></td>
<td><code>user_hidden</code> - Boolean. Defaults to false. Setting user hidden to true prevents the Event from displaying on Navigators.</td>
</tr>
<tr>
<td></td>
<td>category - String value that is available to the driver writer to use however they see fit. Can be used to categorize events.</td>
</tr>
<tr>
<td></td>
<td>enabled - Boolean which defaults to true. Setting enabled to false will disable the Event.</td>
</tr>
<tr>
<td></td>
<td>locked - Boolean which defaults to false. Setting enabled to true will place the Event in a read only state.</td>
</tr>
</tbody></table>

<h3 id='returns'>Returns</h3>

<table><thead>
<tr>
<th>Valuer</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>value</td>
<td>The added Event ID value.</td>
</tr>
</tbody></table>

<h3 id='examples'>Examples</h3><div class="highlight"><pre class="highlight lua tab-lua"><code><span class="k">function</span> <span class="nf">AddDaysOfTheWeekEntry</span><span class="p">()</span>
    <span class="kd">local</span> <span class="n">name</span> <span class="o">=</span> <span class="s2">"AddDaysOfTheWeekEntry Scheduled Event"</span>
    <span class="kd">local</span> <span class="n">days_of_the_week</span> <span class="o">=</span> <span class="p">{</span><span class="s2">"MONDAY"</span><span class="p">,</span> <span class="s2">"WEDNESDAY"</span><span class="p">,</span> <span class="s2">"FRIDAY"</span><span class="p">}</span>

    <span class="kd">local</span> <span class="n">start_time</span> <span class="o">=</span> <span class="p">{</span>
    <span class="n">year</span> <span class="o">=</span> <span class="mi">2018</span><span class="p">,</span>
    <span class="n">month</span> <span class="o">=</span> <span class="mi">6</span><span class="p">,</span>
    <span class="n">day</span> <span class="o">=</span> <span class="mi">12</span><span class="p">,</span>
    <span class="n">hour</span> <span class="o">=</span> <span class="mi">8</span><span class="p">,</span>
    <span class="n">minute</span> <span class="o">=</span> <span class="mi">15</span>
    <span class="p">}</span>

    <span class="kd">local</span> <span class="n">options</span> <span class="o">=</span> <span class="p">{</span>
    <span class="n">hidden</span> <span class="o">=</span> <span class="kc">false</span><span class="p">,</span>
    <span class="n">user_hidden</span> <span class="o">=</span> <span class="kc">false</span><span class="p">,</span>
    <span class="n">category</span> <span class="o">=</span> <span class="s2">""</span><span class="p">,</span>
    <span class="n">enabled</span> <span class="o">=</span> <span class="kc">true</span><span class="p">,</span>
    <span class="n">locked</span> <span class="o">=</span> <span class="kc">false</span>
    <span class="p">}</span>

    <span class="kd">local</span> <span class="n">eventId</span> <span class="o">=</span> <span class="n">C4Scheduler</span><span class="p">:</span><span class="n">AddDaysOfTheWeekEntry</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">days_of_the_week</span><span class="p">,</span> <span class="n">start_time</span><span class="p">,</span> <span class="n">options</span><span class="p">)</span>
<span class="k">end</span>
<span class="n">AddDaysOfTheWeekEntry</span><span class="p">()</span>
</code></pre></div>
<h2 id='addeveryxmonthsentry'>AddEveryXMonthsEntry</h2>
<p>This API adds an event which occurs set number of months. For example, an event that occurs every 4 months.</p>
<h6 id='available-from-3-0-0'>Available from 3.0.0</h6><h3 id='signature'>Signature</h3>

<p><code>C4:Scheduler:AddEveryXMonthsEntry(name, num_months, start_time, end_date, options</code></p>

<table><thead>
<tr>
<th>Parameter</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>str</td>
<td>String value of the name of the event being added.</td>
</tr>
<tr>
<td>table</td>
<td>number of months. range (1-100)</td>
</tr>
<tr>
<td>table</td>
<td>start time includes year, month, day, hour using 24 hour clock. Minute is optional  The default time is 12:00 AM.</td>
</tr>
<tr>
<td>table</td>
<td>end date. optional. includes: year, month, day</td>
</tr>
<tr>
<td>table</td>
<td>Table of additional, optional parameters that includes:</td>
</tr>
<tr>
<td></td>
<td>hidden - Boolean. Defaults to false. Setting to true prevents the Event from displaying in the Scheduler Agent in ComposerPro</td>
</tr>
<tr>
<td></td>
<td><code>user_hidden</code> - Boolean. Defaults to false. Setting user hidden to true prevents the Event from displaying on Navigators.</td>
</tr>
<tr>
<td></td>
<td>category - String value that is available to the driver writer to use however they see fit. Can be used to categorize events.</td>
</tr>
<tr>
<td></td>
<td>enabled - Boolean which defaults to true. Setting enabled to false will disable the Event.</td>
</tr>
<tr>
<td></td>
<td>locked - Boolean which defaults to false. Setting enabled to true will place the Event in a read only state.</td>
</tr>
</tbody></table>

<h3 id='returns'>Returns</h3>

<table><thead>
<tr>
<th>Value</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>value</td>
<td>The added Event ID value.</td>
</tr>
</tbody></table>

<h3 id='examples'>Examples</h3><div class="highlight"><pre class="highlight lua tab-lua"><code><span class="k">function</span> <span class="nf">AddEveryXMonthsEntry</span><span class="p">()</span>
    <span class="kd">local</span> <span class="n">name</span> <span class="o">=</span> <span class="s2">"AddEveryXMonthsEntry Scheduled Event"</span>
    <span class="kd">local</span> <span class="n">num_months</span> <span class="o">=</span> <span class="mi">3</span>

    <span class="kd">local</span> <span class="n">start_time</span> <span class="o">=</span> <span class="p">{</span>
    <span class="n">year</span> <span class="o">=</span> <span class="mi">2018</span><span class="p">,</span>
    <span class="n">month</span> <span class="o">=</span> <span class="mi">6</span><span class="p">,</span>
    <span class="n">day</span> <span class="o">=</span> <span class="mi">12</span><span class="p">,</span>
    <span class="n">hour</span> <span class="o">=</span> <span class="mi">8</span><span class="p">,</span>
    <span class="n">minute</span> <span class="o">=</span> <span class="mi">15</span>
    <span class="p">}</span>

    <span class="kd">local</span> <span class="n">options</span> <span class="o">=</span> <span class="p">{</span>
    <span class="n">hidden</span> <span class="o">=</span> <span class="kc">false</span><span class="p">,</span>
    <span class="n">user_hidden</span> <span class="o">=</span> <span class="kc">false</span><span class="p">,</span>
    <span class="n">category</span> <span class="o">=</span> <span class="s2">""</span><span class="p">,</span>
    <span class="n">enabled</span> <span class="o">=</span> <span class="kc">true</span><span class="p">,</span>
    <span class="n">locked</span> <span class="o">=</span> <span class="kc">false</span>
    <span class="p">}</span>

    <span class="kd">local</span> <span class="n">eventId</span> <span class="o">=</span> <span class="n">C4Scheduler</span><span class="p">:</span><span class="n">AddEveryXMonthsEntry</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">num_months</span><span class="p">,</span> <span class="n">start_time</span><span class="p">,</span> <span class="n">options</span><span class="p">)</span>
<span class="k">end</span>
<span class="n">AddEveryXMonthsEntry</span><span class="p">()</span>
</code></pre></div>
<h2 id='addsetdayseveryxweeksentry'>AddSetDaysEveryXWeeksEntry</h2>
<p>This API adds an event which occurs on the same day(s) of the week over a defined period of weeks. For example, an event that occurs every Tuesday and Wednesday - every three weeks</p>
<h6 id='available-from-3-0-0'>Available from 3.0.0</h6><h3 id='signature'>Signature</h3>

<p><code>C4:Scheduler:AddSetDaysEveryXWeeksEntry(name, days_of_the_week, num_weeks, start_time, end_date, options)</code></p>

<table><thead>
<tr>
<th>Parameter</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>str</td>
<td>String value of the name of the event being added.</td>
</tr>
<tr>
<td>str</td>
<td>Weekday values of: SUNDAY, MONDAY, TUESDAY, WEDNESDAY, THURSDAY, FRIDAY, SATURDAY</td>
</tr>
<tr>
<td>num</td>
<td>Value between 1 and 100. Number of week between the event occurring</td>
</tr>
<tr>
<td>table</td>
<td>start time includes year, month, day, hour using 24 hour clock. Minute is optional  The default time is 12:00 AM.</td>
</tr>
<tr>
<td>table</td>
<td>end date. optional. includes: year, month, day</td>
</tr>
<tr>
<td>table</td>
<td>Table of additional, optional parameters that includes:</td>
</tr>
<tr>
<td></td>
<td>hidden - Boolean. Defaults to false. Setting to true prevents the Event from displaying in the Scheduler Agent in ComposerPro</td>
</tr>
<tr>
<td></td>
<td><code>user_hidden</code> - Boolean. Defaults to false. Setting user hidden to true prevents the Event from displaying on Navigators.</td>
</tr>
<tr>
<td></td>
<td>category - String value that is available to the driver writer to use however they see fit. Can be used to categorize events.</td>
</tr>
<tr>
<td></td>
<td>enabled - Boolean which defaults to true. Setting enabled to false will disable the Event.</td>
</tr>
<tr>
<td></td>
<td>locked - Boolean which defaults to false. Setting enabled to true will place the Event in a read only state.</td>
</tr>
</tbody></table>

<h3 id='returns'>Returns</h3>

<table><thead>
<tr>
<th>Value</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>value</td>
<td>The added Event ID value.</td>
</tr>
</tbody></table>

<h3 id='examples'>Examples</h3><div class="highlight"><pre class="highlight lua tab-lua"><code><span class="k">function</span> <span class="nf">AddSetDaysEveryXWeeksEntry</span><span class="p">()</span>
    <span class="kd">local</span> <span class="n">name</span> <span class="o">=</span> <span class="s2">"AddSetDaysEveryXWeeksEntry Scheduled Event"</span>
    <span class="kd">local</span> <span class="n">days_of_week</span> <span class="o">=</span> <span class="p">{</span><span class="s2">"MONDAY"</span><span class="p">,</span> <span class="s2">"WEDNESDAY"</span><span class="p">,</span> <span class="s2">"FRIDAY"</span><span class="p">}</span>
    <span class="kd">local</span> <span class="n">num_weeks</span> <span class="o">=</span> <span class="mi">3</span>

    <span class="kd">local</span> <span class="n">start_time</span> <span class="o">=</span> <span class="p">{</span>
    <span class="n">year</span> <span class="o">=</span> <span class="mi">2018</span><span class="p">,</span>
    <span class="n">month</span> <span class="o">=</span> <span class="mi">6</span><span class="p">,</span>
    <span class="n">day</span> <span class="o">=</span> <span class="mi">12</span><span class="p">,</span>
    <span class="n">hour</span> <span class="o">=</span> <span class="mi">8</span><span class="p">,</span>
    <span class="n">minute</span> <span class="o">=</span> <span class="mi">15</span>
<span class="p">}</span>

    <span class="kd">local</span> <span class="n">options</span> <span class="o">=</span> <span class="p">{</span>
    <span class="n">hidden</span> <span class="o">=</span> <span class="kc">false</span><span class="p">,</span>
    <span class="n">user_hidden</span> <span class="o">=</span> <span class="kc">false</span><span class="p">,</span>
    <span class="n">category</span> <span class="o">=</span> <span class="s2">""</span><span class="p">,</span>
    <span class="n">enabled</span> <span class="o">=</span> <span class="kc">true</span><span class="p">,</span>
    <span class="n">locked</span> <span class="o">=</span> <span class="kc">false</span>
    <span class="p">}</span>

    <span class="kd">local</span> <span class="n">eventId</span> <span class="o">=</span> <span class="n">C4Scheduler</span><span class="p">:</span><span class="n">AddSetDaysEveryXWeeksEntry</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">days_of_week</span><span class="p">,</span> <span class="n">num_weeks</span><span class="p">,</span> <span class="n">start_time</span><span class="p">)</span>
<span class="k">end</span>
<span class="n">AddSetDaysEveryXWeeksEntry</span><span class="p">()</span>
</code></pre></div>
<h2 id='addsetdayseveryxyearsentry'>AddSetDaysEveryXYearsEntry</h2>
<p>This API adds an event which occurs set number of years. For example, an event that occurs every 4 years.</p>
<h6 id='available-from-3-0-0'>Available from 3.0.0</h6><h3 id='signature'>Signature</h3>

<p><code>C4:Scheduler:AddEveryXYearsEntry(name, num_years, start_time, end_date, options)</code></p>

<table><thead>
<tr>
<th>Parameter</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>str</td>
<td>String value of the name of the event being added.</td>
</tr>
<tr>
<td>table</td>
<td>number of years. range: (1-100)</td>
</tr>
<tr>
<td>table</td>
<td>start time includes year, month, day, hour using 24 hour clock. Minute is optional  The default time is 12:00 AM.</td>
</tr>
<tr>
<td>table</td>
<td>end date. optional. includes: year, month, day</td>
</tr>
<tr>
<td>table</td>
<td>Table of additional, optional parameters that includes:</td>
</tr>
<tr>
<td>table</td>
<td>Table of additional, optional parameters that includes:</td>
</tr>
<tr>
<td></td>
<td>hidden - Boolean. Defaults to false. Setting to true prevents the Event from displaying in the Scheduler Agent in ComposerPro</td>
</tr>
<tr>
<td></td>
<td><code>user_hidden</code> - Boolean. Defaults to false. Setting user hidden to true prevents the Event from displaying on Navigators.</td>
</tr>
<tr>
<td></td>
<td>category - String value that is available to the driver writer to use however they see fit. Can be used to categorize events.</td>
</tr>
<tr>
<td></td>
<td>enabled - Boolean which defaults to true. Setting enabled to false will disable the Event.</td>
</tr>
<tr>
<td></td>
<td>locked - Boolean which defaults to false. Setting enabled to true will place the Event in a read only state.</td>
</tr>
</tbody></table>

<h3 id='returns'>Returns</h3>

<table><thead>
<tr>
<th>Value</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>value</td>
<td>The added Event ID value.</td>
</tr>
</tbody></table>

<p><h3 id='examples'>Examples</h3><div class="highlight"><pre class="highlight lua tab-lua"><code><span class="k">function</span> <span class="nf">AddEveryXYearsEntry</span><span class="p">()</span>
    <span class="kd">local</span> <span class="n">name</span> <span class="o">=</span> <span class="s2">&quot;AddEveryXYearsEntry Scheduled Event&quot;</span>
    <span class="kd">local</span> <span class="n">num_years</span> <span class="o">=</span> <span class="mi">3</span></p>

<p><span class="kd">local</span> <span class="n">start_time</span> <span class="o">=</span> <span class="p">{</span>
    <span class="n">year</span> <span class="o">=</span> <span class="mi">2018</span><span class="p">,</span>
    <span class="n">month</span> <span class="o">=</span> <span class="mi">6</span><span class="p">,</span>
    <span class="n">day</span> <span class="o">=</span> <span class="mi">5</span><span class="p">,</span>
    <span class="n">hour</span> <span class="o">=</span> <span class="mi">21</span><span class="p">,</span>
    <span class="n">minute</span> <span class="o">=</span> <span class="mi">30</span>
    <span class="p">}</span></p>

<p><span class="kd">local</span> <span class="n">options</span> <span class="o">=</span> <span class="p">{</span>
    <span class="n">hidden</span> <span class="o">=</span> <span class="kc">false</span><span class="p">,</span>
    <span class="n">user_hidden</span> <span class="o">=</span> <span class="kc">false</span><span class="p">,</span>
    <span class="n">category</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
    <span class="n">enabled</span> <span class="o">=</span> <span class="kc">true</span><span class="p">,</span>
    <span class="n">locked</span> <span class="o">=</span> <span class="kc">false</span>
    <span class="p">}</span></p>

<p><span class="kd">local</span> <span class="n">eventId</span> <span class="o">=</span> <span class="n">C4Scheduler</span><span class="p">:</span><span class="n">AddEveryXYearsEntry</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">num_years</span><span class="p">,</span> <span class="n">start_time</span><span class="p">)</span>
<span class="k">end</span>
<span class="n">AddEveryXYearsEntry</span><span class="p">()</span>
</code></pre></div></p>
<h1 id='schedule-agent-delete-event-interface'>Schedule Agent - Delete Event Interface</h1>

<h2 id='deleteentrybyid'>DeleteEntryByID</h2>

<p>Deletes and Event based on the Event ID value passed. A driver can only delete events which were created by that driver.</p>

<p><h6 id='available-from-3-0-0'>Available from 3.0.0</h6><h3 id='signature'>Signature</h3>
<p><code>C4:Scheduler:DeleteEntryByID (event_id)</code></p></p>

<table><thead>
<tr>
<th>Parameter</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>num</td>
<td>ID value of the name of the event being deleted.</td>
</tr>
</tbody></table>

<h2 id='deleteentrybyname'>DeleteEntryByName</h2>

<p>Deletes and Event based on the Event Name value passed. A driver can only delete events which were created by that driver.</p>

<p><h6 id='available-from-3-0-0'>Available from 3.0.0</h6><h3 id='signature'>Signature</h3>
<p><code>C4Scheduler:DeleteEntryByName(name)</code></p></p>

<table><thead>
<tr>
<th>Parameter</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>str</td>
<td>Value of the name of the event being deleted.</td>
</tr>
</tbody></table>
<h1 id='schedule-agent-get-event-interface'>Schedule Agent - Get Event Interface</h1>

<h2 id='getentries'>GetEntries</h2>

<p>Deletes an Event based on the Event ID value passed. A driver can only delete events which were created by that driver.</p>

<p><h6 id='available-from-3-0-0'>Available from 3.0.0</h6><h3 id='signature'>Signature</h3>
<p><code>C4Scheduler:GetEntries()</code></p></p>

<table><thead>
<tr>
<th>Parameter</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>Value</td>
<td>Description</td>
</tr>
<tr>
<td>table</td>
<td>ID/Name key value pairs. The entries returned are only entries created by the driver. For example:</td>
</tr>
</tbody></table>

<div class="highlight"><pre class="highlight lua tab-lua"><code><span class="p">{</span>
 <span class="mi">1</span>  <span class="n">entry1name</span>
 <span class="mi">2</span>  <span class="n">entry2name</span>
 <span class="mi">3</span>  <span class="n">entry3name</span>
 <span class="mi">4</span>  <span class="n">entry4name</span>
<span class="p">}</span>   
</code></pre></div>

<h2 id='getentry'>GetEntry</h2>

<p>The entry returned can only be an entry created by the driver.</p>

<p><h6 id='available-from-3-0-0'>Available from 3.0.0</h6><h3 id='signature'>Signature</h3>
<p><code>C4Scheduler:GetEntry(event_id) </code></p></p>

<table><thead>
<tr>
<th>Parameter</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>num</td>
<td>ID number of the event.</td>
</tr>
</tbody></table>

<h3 id='returns'>Returns</h3>

<table><thead>
<tr>
<th>Value</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>table</td>
<td>Enabled - true/false</td>
</tr>
<tr>
<td>Description</td>
<td>&lt;string&gt;</td>
</tr>
<tr>
<td>Eventid</td>
<td>&lt;event id&gt;</td>
</tr>
<tr>
<td><code>creator_state</code></td>
<td>&lt;string&gt;</td>
</tr>
<tr>
<td>hidden</td>
<td>true/false</td>
</tr>
<tr>
<td>creatorid</td>
<td>&lt;creator id&gt;</td>
</tr>
<tr>
<td>category</td>
<td>&lt;string&gt;</td>
</tr>
<tr>
<td>locked</td>
<td>true/false</td>
</tr>
<tr>
<td>xml</td>
<td>&lt;xml string&gt; (see example below)</td>
</tr>
<tr>
<td><code>user_hidden</code></td>
<td>true/false</td>
</tr>
</tbody></table>

<p> </p>

<p><h3 id='example'>Example</h3><div class="highlight"><pre class="highlight xml tab-xml"><code>Sample XML – Varies depending on the settings of the event
<span class="nt">&lt;entry&gt;</span>
    <span class="nt">&lt;eventid&gt;</span>10<span class="nt">&lt;/eventid&gt;</span>
    <span class="nt">&lt;description&gt;</span>AddDailyRepeatRandomOffsetEntry Scheduled Event<span class="nt">&lt;/description&gt;</span>
    <span class="nt">&lt;category&gt;</span>daily_repeat<span class="nt">&lt;/category&gt;</span>
    <span class="nt">&lt;enabled&gt;</span>False<span class="nt">&lt;/enabled&gt;</span>
    <span class="nt">&lt;locked&gt;</span>True<span class="nt">&lt;/locked&gt;</span>
    <span class="nt">&lt;creatorid&gt;</span>6<span class="nt">&lt;/creatorid&gt;</span>
    <span class="nt">&lt;creatorstate&gt;&lt;/creatorstate&gt;</span>
    <span class="nt">&lt;hidden&gt;</span>False<span class="nt">&lt;/hidden&gt;</span>
    <span class="nt">&lt;user_hidden&gt;</span>True<span class="nt">&lt;/user_hidden&gt;</span>
    <span class="nt">&lt;start&gt;</span>
        <span class="nt">&lt;offset&gt;</span>0<span class="nt">&lt;/offset&gt;</span>
        <span class="nt">&lt;offset_minutes&gt;</span>1293<span class="nt">&lt;/offset_minutes&gt;</span>
        <span class="nt">&lt;start_date&gt;</span>
            <span class="nt">&lt;start_day&gt;</span>2<span class="nt">&lt;/start_day&gt;</span>
            <span class="nt">&lt;start_month&gt;</span>7<span class="nt">&lt;/start_month&gt;</span>
            <span class="nt">&lt;start_year&gt;</span>2018<span class="nt">&lt;/start_year&gt;</span>
            <span class="nt">&lt;start_period&gt;</span>0<span class="nt">&lt;/start_period&gt;</span>
            <span class="nt">&lt;start_weekday&gt;</span>0<span class="nt">&lt;/start_weekday&gt;</span>
        <span class="nt">&lt;/start_date&gt;</span>
        <span class="nt">&lt;randomize&gt;</span>12<span class="nt">&lt;/randomize&gt;</span>
    <span class="nt">&lt;/start&gt;</span>
    <span class="nt">&lt;repeat&gt;</span>
        <span class="nt">&lt;frequency&gt;</span>1<span class="nt">&lt;/frequency&gt;</span>
        <span class="nt">&lt;rate&gt;</span>1<span class="nt">&lt;/rate&gt;</span>
        <span class="nt">&lt;daymask&gt;</span>0<span class="nt">&lt;/daymask&gt;</span>
        <span class="nt">&lt;end_date&gt;</span>
            <span class="nt">&lt;end_month&gt;</span>9<span class="nt">&lt;/end_month&gt;</span>
            <span class="nt">&lt;end_day&gt;</span>23<span class="nt">&lt;/end_day&gt;</span>
            <span class="nt">&lt;end_year&gt;</span>2019<span class="nt">&lt;/end_year&gt;</span>
        <span class="nt">&lt;/end_date&gt;</span>
    <span class="nt">&lt;/repeat&gt;</span>
<span class="nt">&lt;/entry&gt;</span>
</code></pre></div></p>
<h1 id='schedule-agent-modify-event-interface'>Schedule Agent - Modify Event Interface</h1>

<h2 id='modifysingledayentry'>ModifySingleDayEntry</h2>

<p>Modifies the Event based on the Event ID passed. This API uses the parameters found in the Single Day Entry API for convenience. A driver can only modify events which were created by that driver.</p>

<p><h6 id='available-from-3-0-0'>Available from 3.0.0</h6><h3 id='signature'>Signature</h3>
<p><code>C4Scheduler:ModifySingleDayEntry(name, start_time, options)</code></p></p>

<table><thead>
<tr>
<th>Parameter</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>str</td>
<td>String value of the name of the event being modified.</td>
</tr>
<tr>
<td>table</td>
<td>Includes year, month, day, hour using 24 hour clock. Minute is optional  The default time is 12:00 AM.</td>
</tr>
<tr>
<td>table</td>
<td>Table of additional, optional parameters that includes:</td>
</tr>
<tr>
<td></td>
<td>hidden - Boolean. Defaults to false. Setting to true prevents the Event from displaying in the Scheduler Agent in ComposerPro</td>
</tr>
<tr>
<td></td>
<td><code>user_hidden</code> - Boolean. Defaults to false. Setting user hidden to true prevents the Event from displaying on Navigators.</td>
</tr>
<tr>
<td></td>
<td>category - String value that is available to the driver writer to use however they see fit. Can be used to categorize events.</td>
</tr>
<tr>
<td></td>
<td>enabled - Boolean which defaults to true. Setting enabled to false will disable the Event.</td>
</tr>
<tr>
<td></td>
<td>locked - Boolean which defaults to false. Setting enabled to true will place the Event in a read only state.</td>
</tr>
</tbody></table>

<h3 id='returns'>Returns</h3>

<table><thead>
<tr>
<th>Value</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>True</td>
<td>Successful</td>
</tr>
<tr>
<td>False</td>
<td>Modification failed</td>
</tr>
</tbody></table>

<h2 id='modifydailyrepeatentry'>ModifyDailyRepeatEntry</h2>

<p>Modifies the Event based on the Event ID passed. This API uses the parameters found in the Daily Repeat Entry API for convenience. A driver can only modify events which were created by that driver.</p>

<p><h6 id='available-from-3-0-0'>Available from 3.0.0</h6><h3 id='signature'>Signature</h3>
<p><code>C4Scheduler:ModifyDailyRepeatEntry(event_id, name, start_time, end_date, options)</code></p></p>

<table><thead>
<tr>
<th>Parameter</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>str</td>
<td>String value of the name of the event being modified.</td>
</tr>
<tr>
<td>table</td>
<td>Includes year, month, day, hour using 24 hour clock. Minute is optional. The default time is 12:00 AM.</td>
</tr>
<tr>
<td>table</td>
<td>Table of additional, optional parameters that includes:</td>
</tr>
<tr>
<td></td>
<td>hidden - Boolean. Defaults to false. Setting to true prevents the Event from displaying in the Scheduler Agent in ComposerPro</td>
</tr>
<tr>
<td></td>
<td><code>user_hidden</code> - Boolean. Defaults to false. Setting user hidden to true prevents the Event from displaying on Navigators.</td>
</tr>
<tr>
<td></td>
<td>category - String value that is available to the driver writer to use however they see fit. Can be used to categorize events.</td>
</tr>
<tr>
<td></td>
<td>enabled - Boolean which defaults to true. Setting enabled to false will disable the Event.</td>
</tr>
<tr>
<td></td>
<td>locked - Boolean which defaults to false. Setting enabled to true will place the Event in a read only state.</td>
</tr>
</tbody></table>

<h3 id='returns'>Returns</h3>

<table><thead>
<tr>
<th>Value</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>True</td>
<td>Successful</td>
</tr>
<tr>
<td>False</td>
<td>Modification failed</td>
</tr>
</tbody></table>

<h2 id='modifydailyrepeatrandomoffsetentry'>ModifyDailyRepeatRandomOffsetEntry</h2>

<p>Modifies the Event based on the Event ID passed. This API uses the parameters found in the Daily Repeat Random Offset Entry API for convenience.  A driver can only modify events which were created by that driver.</p>

<p><h6 id='available-from-3-0-0'>Available from 3.0.0</h6><h3 id='signature'>Signature</h3>
<p><code>C4Scheduler:ModifyDailyRepeatRandomOffsetEntry(name, random_range_minutes, start_time, end_date, options)</code></p></p>

<table><thead>
<tr>
<th>Parameter</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>str</td>
<td>String value of the name of the event being modified.</td>
</tr>
<tr>
<td>table</td>
<td>Random range of minutes. number = number of minutes, range = (1-60)</td>
</tr>
<tr>
<td>table</td>
<td>start time includes year, month, day, hour using 24 hour clock. Minute is optional. The default time is 12:00 AM.</td>
</tr>
<tr>
<td>table</td>
<td>end date. optional. includes: year, month, day</td>
</tr>
<tr>
<td>table</td>
<td>Table of additional, optional parameters that includes:</td>
</tr>
<tr>
<td></td>
<td>hidden - Boolean. Defaults to false. Setting to true prevents the Event from displaying in the Scheduler Agent in ComposerPro</td>
</tr>
<tr>
<td></td>
<td><code>user_hidden</code> - Boolean. Defaults to false. Setting user hidden to true prevents the Event from displaying on Navigators.</td>
</tr>
<tr>
<td></td>
<td>category - String value that is available to the driver writer to use however they see fit. Can be used to categorize events.</td>
</tr>
<tr>
<td></td>
<td>enabled - Boolean which defaults to true. Setting enabled to false will disable the Event.</td>
</tr>
<tr>
<td></td>
<td>locked - Boolean which defaults to false. Setting enabled to true will place the Event in a read only state.</td>
</tr>
</tbody></table>

<h3 id='returns'>Returns</h3>

<table><thead>
<tr>
<th>Value</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>True</td>
<td>Successful</td>
</tr>
<tr>
<td>False</td>
<td>Modification failed</td>
</tr>
</tbody></table>

<h2 id='modifydailyrepeatxdaysentry'>ModifyDailyRepeatXDaysEntry</h2>

<p>Modifies the Event based on the Event ID passed. This API uses the parameters found in the Daily Repeat X Days Entry API for convenience.  A driver can only modify events which were created by that driver.</p>

<p><h6 id='available-from-3-0-0'>Available from 3.0.0</h6><h3 id='signature'>Signature</h3>
<p><code>C4Scheduler:ModifyDailyRepeatXDaysEntry(name, every_num_days, start_time, end_date, options)</code></p></p>

<table><thead>
<tr>
<th>Parameter</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>str</td>
<td>String value of the name of the event being modified.</td>
</tr>
<tr>
<td>table</td>
<td>every number days includes, number, number of days, range (1-100)</td>
</tr>
<tr>
<td>table</td>
<td>start time includes year, month, day, hour using 24 hour clock. Minute is optional. The default time is 12:00 AM.</td>
</tr>
<tr>
<td>table</td>
<td>end date. optional. includes: year, month, day</td>
</tr>
<tr>
<td>table</td>
<td>Table of additional, optional parameters that includes:</td>
</tr>
<tr>
<td></td>
<td>hidden - Boolean. Defaults to false. Setting to true prevents the Event from displaying in the Scheduler Agent in ComposerPro</td>
</tr>
<tr>
<td></td>
<td><code>user_hidden</code> - Boolean. Defaults to false. Setting user hidden to true prevents the Event from displaying on Navigators.</td>
</tr>
<tr>
<td></td>
<td>category - String value that is available to the driver writer to use however they see fit. Can be used to categorize events.</td>
</tr>
<tr>
<td></td>
<td>enabled - Boolean which defaults to true. Setting enabled to false will disable the Event.</td>
</tr>
<tr>
<td></td>
<td>locked - Boolean which defaults to false. Setting enabled to true will place the Event in a read only state.</td>
</tr>
</tbody></table>

<h3 id='returns'>Returns</h3>

<table><thead>
<tr>
<th>Value</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>True</td>
<td>Successful</td>
</tr>
<tr>
<td>False</td>
<td>Modification failed</td>
</tr>
</tbody></table>

<h2 id='modifydailysunriseentry'>ModifyDailySunriseEntry</h2>

<p>Modifies the Event based on the Event ID passed. This API uses the parameters found in the Daily Sunrise Entry API for convenience.  A driver can only modify events which were created by that driver.</p>

<p><h6 id='available-from-3-0-0'>Available from 3.0.0</h6><h3 id='signature'>Signature</h3>
<p><code>C4Scheduler:ModifyDailySunriseEntry(name, start_time, end_date, options</code></p></p>

<table><thead>
<tr>
<th>Parameter</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>str</td>
<td>String value of the name of the event being modified.</td>
</tr>
<tr>
<td>table</td>
<td>start time includes year, month, day, hour using 24 hour clock. Minute is optional. The default time is 12:00 AM.</td>
</tr>
<tr>
<td>table</td>
<td>end date. optional. includes: year, month, day</td>
</tr>
<tr>
<td>table</td>
<td>Table of additional, optional parameters that includes:</td>
</tr>
<tr>
<td></td>
<td>hidden - Boolean. Defaults to false. Setting to true prevents the Event from displaying in the Scheduler Agent in ComposerPro</td>
</tr>
<tr>
<td></td>
<td><code>user_hidden</code> - Boolean. Defaults to false. Setting user hidden to true prevents the Event from displaying on Navigators.</td>
</tr>
<tr>
<td></td>
<td>category - String value that is available to the driver writer to use however they see fit. Can be used to categorize events.</td>
</tr>
<tr>
<td></td>
<td>enabled - Boolean which defaults to true. Setting enabled to false will disable the Event.</td>
</tr>
<tr>
<td></td>
<td>locked - Boolean which defaults to false. Setting enabled to true will place the Event in a read only state.</td>
</tr>
</tbody></table>

<h3 id='returns'>Returns</h3>

<table><thead>
<tr>
<th>Value</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>True</td>
<td>Successful</td>
</tr>
<tr>
<td>False</td>
<td>Modification failed</td>
</tr>
</tbody></table>

<h2 id='modifydailysunriseoffsetentry'>ModifyDailySunriseOffsetEntry</h2>

<p>Modifies the Event based on the Event ID passed. This API uses the parameters found in the Daily Sunrise Offset Entry API for convenience. A driver can only modify events which were created by that driver</p>

<p><h6 id='available-from-3-0-0'>Available from 3.0.0</h6><h3 id='signature'>Signature</h3>
<p><code>C4Scheduler:ModifyDailySunriseOffsetEntry(name, offset_minutes, start_time, end_date, options)</code></p></p>

<table><thead>
<tr>
<th>Parameter</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>str</td>
<td>String value of the name of the event being modified.</td>
</tr>
<tr>
<td>table</td>
<td>offset minutes includes: number, number of minutes, range (-360 - 360)</td>
</tr>
<tr>
<td>table</td>
<td>start time includes year, month, day, hour using 24 hour clock. Minute is optional. The default time is 12:00 AM.</td>
</tr>
<tr>
<td>table</td>
<td>end date. optional. includes: year, month, day</td>
</tr>
<tr>
<td>table</td>
<td>Table of additional, optional parameters that includes:</td>
</tr>
<tr>
<td></td>
<td>hidden - Boolean. Defaults to false. Setting to true prevents the Event from displaying in the Scheduler Agent in ComposerPro</td>
</tr>
<tr>
<td></td>
<td><code>user_hidden</code> - Boolean. Defaults to false. Setting user hidden to true prevents the Event from displaying on Navigators.</td>
</tr>
<tr>
<td></td>
<td>category - String value that is available to the driver writer to use however they see fit. Can be used to categorize events.</td>
</tr>
<tr>
<td></td>
<td>enabled - Boolean which defaults to true. Setting enabled to false will disable the Event.</td>
</tr>
<tr>
<td></td>
<td>locked - Boolean which defaults to false. Setting enabled to true will place the Event in a read only state.</td>
</tr>
</tbody></table>

<h3 id='returns'>Returns</h3>

<table><thead>
<tr>
<th>Value</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>True</td>
<td>Successful</td>
</tr>
<tr>
<td>False</td>
<td>Modification failed</td>
</tr>
</tbody></table>

<h2 id='modifydailysunriserandomoffsetentry'>ModifyDailySunriseRandomOffsetEntry</h2>

<p>Modifies the Event based on the Event ID passed. This API uses the parameters found in the Daily Sunrise Random Offset Entry API for convenience. A driver can only modify events which were created by that driver.</p>

<p><h6 id='available-from-3-0-0'>Available from 3.0.0</h6><h3 id='signature'>Signature</h3>
<p><code>C4Scheduler:ModifyDailySunriseRandomOffsetEntry(name, random_range_minutes, start_time, end_date, options)</code></p></p>

<table><thead>
<tr>
<th>Parameter</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>str</td>
<td>String value of the name of the event being modified.</td>
</tr>
<tr>
<td>table</td>
<td>Random range of minutes. number = number of minutes, range = (1-60)</td>
</tr>
<tr>
<td>table</td>
<td>start time includes year, month, day, hour using 24 hour clock. Minute is optional. The default time is 12:00 AM.</td>
</tr>
<tr>
<td>table</td>
<td>end date. optional. includes: year, month, day</td>
</tr>
<tr>
<td>table</td>
<td>Table of additional, optional parameters that includes:</td>
</tr>
<tr>
<td></td>
<td>hidden - Boolean. Defaults to false. Setting to true prevents the Event from displaying in the Scheduler Agent in ComposerPro</td>
</tr>
<tr>
<td></td>
<td><code>user_hidden</code> - Boolean. Defaults to false. Setting user hidden to true prevents the Event from displaying on Navigators.</td>
</tr>
<tr>
<td></td>
<td>category - String value that is available to the driver writer to use however they see fit. Can be used to categorize events.</td>
</tr>
<tr>
<td></td>
<td>enabled - Boolean which defaults to true. Setting enabled to false will disable the Event.</td>
</tr>
<tr>
<td></td>
<td>locked - Boolean which defaults to false. Setting enabled to true will place the Event in a read only state.</td>
</tr>
</tbody></table>

<h3 id='returns'>Returns</h3>

<table><thead>
<tr>
<th>Value</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>True</td>
<td>Successful</td>
</tr>
<tr>
<td>False</td>
<td>Modification failed</td>
</tr>
</tbody></table>

<h2 id='modifydailysunsetentry'>ModifyDailySunsetEntry</h2>

<p>Modifies the Event based on the Event ID passed. This API uses the parameters found in theDaily Sunset Entry API for convenience. A driver can only modify events which were created by that driver.</p>

<p><h6 id='available-from-3-0-0'>Available from 3.0.0</h6><h3 id='signature'>Signature</h3>
<p><code>C4Scheduler:ModifyDailySunsetEntry(name, start_time, end_date, options</code></p></p>

<table><thead>
<tr>
<th>Parameter</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>str</td>
<td>String value of the name of the event being modified.</td>
</tr>
<tr>
<td>table</td>
<td>start time includes year, month, day, hour using 24 hour clock. Minute is optional. The default time is 12:00 AM.</td>
</tr>
<tr>
<td>table</td>
<td>end date. optional. includes: year, month, day</td>
</tr>
<tr>
<td>table</td>
<td>Table of additional, optional parameters that includes:</td>
</tr>
<tr>
<td></td>
<td>hidden - Boolean. Defaults to false. Setting to true prevents the Event from displaying in the Scheduler Agent in ComposerPro</td>
</tr>
<tr>
<td></td>
<td><code>user_hidden</code> - Boolean. Defaults to false. Setting user hidden to true prevents the Event from displaying on Navigators.</td>
</tr>
<tr>
<td></td>
<td>category - String value that is available to the driver writer to use however they see fit. Can be used to categorize events.</td>
</tr>
<tr>
<td></td>
<td>enabled - Boolean which defaults to true. Setting enabled to false will disable the Event.</td>
</tr>
<tr>
<td></td>
<td>locked - Boolean which defaults to false. Setting enabled to true will place the Event in a read only state.</td>
</tr>
</tbody></table>

<h3 id='returns'>Returns</h3>

<table><thead>
<tr>
<th>Value</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>True</td>
<td>Successful</td>
</tr>
<tr>
<td>False</td>
<td>Modification failed</td>
</tr>
</tbody></table>

<h2 id='modifydailysunsetoffsetentry'>ModifyDailySunsetOffsetEntry</h2>

<p>This API allows you to modify the Daily Sunset Offset Entry event. Use a negative number for before sunset and a positive number for number of minutes after sunset. Modifies the Event based on the Event ID passed. This API uses the parameters found in the  Daily Sunset Offset Entry API for convenience. A driver can only modify events which were created by that driver.</p>

<p><h6 id='available-from-3-0-0'>Available from 3.0.0</h6><h3 id='signature'>Signature</h3>
<p><code>C4Scheduler:ModifyDailySunsetOffsetEntry(name, offset_minutes, start_time, end_date, options)</code></p></p>

<table><thead>
<tr>
<th>Parameter</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>str</td>
<td>String value of the name of the event being modified.</td>
</tr>
<tr>
<td>table</td>
<td>offset minutes includes: number, number of minutes, range (-360 - 360)</td>
</tr>
<tr>
<td>table</td>
<td>start time includes year, month, day, hour using 24 hour clock. Minute is optional. The default time is 12:00 AM.</td>
</tr>
<tr>
<td>table</td>
<td>end date. optional. includes: year, month, day</td>
</tr>
<tr>
<td>table</td>
<td>Table of additional, optional parameters that includes:</td>
</tr>
<tr>
<td></td>
<td>hidden - Boolean. Defaults to false. Setting to true prevents the Event from displaying in the Scheduler Agent in ComposerPro</td>
</tr>
<tr>
<td></td>
<td><code>user_hidden</code> - Boolean. Defaults to false. Setting user hidden to true prevents the Event from displaying on Navigators.</td>
</tr>
<tr>
<td></td>
<td>category - String value that is available to the driver writer to use however they see fit. Can be used to categorize events.</td>
</tr>
<tr>
<td></td>
<td>enabled - Boolean which defaults to true. Setting enabled to false will disable the Event.</td>
</tr>
<tr>
<td></td>
<td>locked - Boolean which defaults to false. Setting enabled to true will place the Event in a read only state.</td>
</tr>
</tbody></table>

<h3 id='returns'>Returns</h3>

<table><thead>
<tr>
<th>Value</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>True</td>
<td>Successful</td>
</tr>
<tr>
<td>False</td>
<td>Modification failed</td>
</tr>
</tbody></table>

<h2 id='modifydailysunsetrandomoffsetentry'>ModifyDailySunsetRandomOffsetEntry</h2>

<p>Modifies the Event based on the Event ID passed. This API uses the parameters found in the Daily Sunset Random Offset Entry API for convenience. A driver can only modify events which were created by that driver.</p>

<p><h6 id='available-from-3-0-0'>Available from 3.0.0</h6><h3 id='signature'>Signature</h3>
<p><code>C4Scheduler:ModifyDailySunsetRandomOffsetEntry(name, random_range_minutes, start_time, end_date, options)</code></p></p>

<table><thead>
<tr>
<th>Parameter</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>str</td>
<td>String value of the name of the event being modified.</td>
</tr>
<tr>
<td>table</td>
<td>Random range of minutes. number = number of minutes, range = (1-60)</td>
</tr>
<tr>
<td>table</td>
<td>start time includes year, month, day, hour using 24 hour clock. Minute is optional. The default time is 12:00 AM.</td>
</tr>
<tr>
<td>table</td>
<td>end date. optional. includes: year, month, day</td>
</tr>
<tr>
<td>table</td>
<td>Table of additional, optional parameters that includes:</td>
</tr>
<tr>
<td></td>
<td>hidden - Boolean. Defaults to false. Setting to true prevents the Event from displaying in the Scheduler Agent in ComposerPro</td>
</tr>
<tr>
<td></td>
<td><code>user_hidden</code> - Boolean. Defaults to false. Setting user hidden to true prevents the Event from displaying on Navigators.</td>
</tr>
<tr>
<td></td>
<td>category - String value that is available to the driver writer to use however they see fit. Can be used to categorize events.</td>
</tr>
<tr>
<td></td>
<td>enabled - Boolean which defaults to true. Setting enabled to false will disable the Event.</td>
</tr>
<tr>
<td></td>
<td>locked - Boolean which defaults to false. Setting enabled to true will place the Event in a read only state.</td>
</tr>
</tbody></table>

<h3 id='returns'>Returns</h3>

<table><thead>
<tr>
<th>Value</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>True</td>
<td>Successful</td>
</tr>
<tr>
<td>False</td>
<td>Modification failed</td>
</tr>
</tbody></table>

<h2 id='modifyendofmonthentry'>ModifyEndOfMonthEntry</h2>

<p>Modifies the Event based on the Event ID passed. This API uses the parameters found in the End of Month API for convenience. A driver can only modify events which were created by that driver.</p>

<p><h6 id='available-from-3-0-0'>Available from 3.0.0</h6><h3 id='signature'>Signature</h3>
<p><code>C4Scheduler:ModifyEndOfMonthEntry(name, start_time, options)</code></p></p>

<table><thead>
<tr>
<th>Parameter</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>str</td>
<td>String value of the name of the event being modified.</td>
</tr>
<tr>
<td>table</td>
<td>start time includes year, month, day, hour using 24 hour clock. Minute is optional. The default time is 12:00 AM.</td>
</tr>
<tr>
<td>table</td>
<td>Table of additional, optional parameters that includes:</td>
</tr>
<tr>
<td></td>
<td>hidden - Boolean. Defaults to false. Setting to true prevents the Event from displaying in the Scheduler Agent in ComposerPro</td>
</tr>
<tr>
<td></td>
<td><code>user_hidden</code> - Boolean. Defaults to false. Setting user hidden to true prevents the Event from displaying on Navigators.</td>
</tr>
<tr>
<td></td>
<td>category - String value that is available to the driver writer to use however they see fit. Can be used to categorize events.</td>
</tr>
<tr>
<td></td>
<td>enabled - Boolean which defaults to true. Setting enabled to false will disable the Event.</td>
</tr>
<tr>
<td></td>
<td>locked - Boolean which defaults to false. Setting enabled to true will place the Event in a read only state.</td>
</tr>
</tbody></table>

<h3 id='returns'>Returns</h3>

<table><thead>
<tr>
<th>Value</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>True</td>
<td>Successful</td>
</tr>
<tr>
<td>False</td>
<td>Modification failed</td>
</tr>
</tbody></table>

<h2 id='modifyendofmonthrepeatentry'>ModifyEndOfMonthRepeatEntry</h2>

<p>Modifies the Event based on the Event ID passed. This API uses the parameters found in the End of Month Repeat Entry API for convenience. A driver can only modify events which were created by that driver</p>

<p><h6 id='available-from-3-0-0'>Available from 3.0.0</h6><h3 id='signature'>Signature</h3>
<p><code>C4Scheduler:ModifyEndOfMonthRepeatEntry(name, start_time, end_date, options)</code></p></p>

<table><thead>
<tr>
<th>Parameter</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>str</td>
<td>String value of the name of the event being modified.</td>
</tr>
<tr>
<td>table</td>
<td>start time includes year, month, day, hour using 24 hour clock. Minute is optional. The default time is 12:00 AM.</td>
</tr>
<tr>
<td>table</td>
<td>end date. optional. includes: year, month, day</td>
</tr>
<tr>
<td>table</td>
<td>Table of additional, optional parameters that includes:</td>
</tr>
<tr>
<td></td>
<td>hidden - Boolean. Defaults to false. Setting to true prevents the Event from displaying in the Scheduler Agent in ComposerPro</td>
</tr>
<tr>
<td></td>
<td><code>user_hidden</code> - Boolean. Defaults to false. Setting user hidden to true prevents the Event from displaying on Navigators.</td>
</tr>
<tr>
<td></td>
<td>category - String value that is available to the driver writer to use however they see fit. Can be used to categorize events.</td>
</tr>
<tr>
<td></td>
<td>enabled - Boolean which defaults to true. Setting enabled to false will disable the Event.</td>
</tr>
<tr>
<td></td>
<td>locked - Boolean which defaults to false. Setting enabled to true will place the Event in a read only state.</td>
</tr>
</tbody></table>

<h3 id='returns'>Returns</h3>

<table><thead>
<tr>
<th>Value</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>True</td>
<td>Successful</td>
</tr>
<tr>
<td>False</td>
<td>Modification failed</td>
</tr>
</tbody></table>

<h2 id='modifynthweekdayofmonthentry'>ModifyNthWeekdayOfMonthEntry</h2>

<p>Modifies the Event based on the Event ID passed. This API uses the parameters found in the Nth Weekday of Month Entry API for convenience. A driver can only modify events which were created by that driver</p>

<p><h6 id='available-from-3-0-0'>Available from 3.0.0</h6><h3 id='signature'>Signature</h3>
<p><code>C4Scheduler:ModifyNthWeekdayOfMonthEntry(name, period, weekday, start_time, options)</code></p></p>

<table><thead>
<tr>
<th>Parameter</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>str</td>
<td>String value of the name of the event being modified.</td>
</tr>
<tr>
<td>str</td>
<td>Period values of: FIRST, SECOND, THIRD, FOURTH, LAST</td>
</tr>
<tr>
<td>str</td>
<td>Weekday values of: SUNDAY, MONDAY, TUESDAY, WEDNESDAY, THURSDAY, FRIDAY, SATURDAY</td>
</tr>
<tr>
<td>table</td>
<td>start time includes year, month, day, hour using 24 hour clock. Minute is optional. The default time is 12:00 AM.</td>
</tr>
<tr>
<td>table</td>
<td>Table of additional, optional parameters that includes:</td>
</tr>
<tr>
<td></td>
<td>hidden - Boolean. Defaults to false. Setting to true prevents the Event from displaying in the Scheduler Agent in ComposerPro</td>
</tr>
<tr>
<td></td>
<td><code>user_hidden</code> - Boolean. Defaults to false. Setting user hidden to true prevents the Event from displaying on Navigators.</td>
</tr>
<tr>
<td></td>
<td>category - String value that is available to the driver writer to use however they see fit. Can be used to categorize events.</td>
</tr>
<tr>
<td></td>
<td>enabled - Boolean which defaults to true. Setting enabled to false will disable the Event.</td>
</tr>
<tr>
<td></td>
<td>locked - Boolean which defaults to false. Setting enabled to true will place the Event in a read only state.</td>
</tr>
</tbody></table>

<h3 id='returns'>Returns</h3>

<table><thead>
<tr>
<th>Value</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>True</td>
<td>Successful</td>
</tr>
<tr>
<td>False</td>
<td>Modification failed</td>
</tr>
</tbody></table>

<h2 id='modifynthweekdayofmonthrepeatentry'>ModifyNthWeekdayOfMonthRepeatEntry</h2>

<p>Modifies the Event based on the Event ID passed. This API uses the parameters found in the Nth Weekday of Month Entry Repeat API for convenience. A driver can only modify events which were created by that driver.</p>

<p><h6 id='available-from-3-0-0'>Available from 3.0.0</h6><h3 id='signature'>Signature</h3>
<p><code>C4Scheduler:ModifyNthWeekdayOfMonthRepeatEntry(name, period, weekday, start_time, end_date, options)</code></p></p>

<table><thead>
<tr>
<th>Parameter</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>str</td>
<td>String value of the name of the event being modified.</td>
</tr>
<tr>
<td>str</td>
<td>Period values of: FIRST, SECOND, THIRD, FOURTH, LAST</td>
</tr>
<tr>
<td>str</td>
<td>Weekday values of: SUNDAY, MONDAY, TUESDAY, WEDNESDAY, THURSDAY, FRIDAY, SATURDAY</td>
</tr>
<tr>
<td>table</td>
<td>start time includes year, month, day, hour using 24 hour clock. Minute is optional. The default time is 12:00 AM.</td>
</tr>
<tr>
<td>table</td>
<td>Table of additional, optional parameters that includes:</td>
</tr>
<tr>
<td></td>
<td>hidden - Boolean. Defaults to false. Setting to true prevents the Event from displaying in the Scheduler Agent in ComposerPro</td>
</tr>
<tr>
<td></td>
<td><code>user_hidden</code> - Boolean. Defaults to false. Setting user hidden to true prevents the Event from displaying on Navigators.</td>
</tr>
<tr>
<td></td>
<td>category - String value that is available to the driver writer to use however they see fit. Can be used to categorize events.</td>
</tr>
<tr>
<td></td>
<td>enabled - Boolean which defaults to true. Setting enabled to false will disable the Event.</td>
</tr>
<tr>
<td></td>
<td>locked - Boolean which defaults to false. Setting enabled to true will place the Event in a read only state.</td>
</tr>
</tbody></table>

<h3 id='returns'>Returns</h3>

<table><thead>
<tr>
<th>Value</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>True</td>
<td>Successful</td>
</tr>
<tr>
<td>False</td>
<td>Modification failed</td>
</tr>
</tbody></table>

<h2 id='modifydaysoftheweekentry'>ModifyDaysOfTheWeekEntry</h2>

<p>Modifies the Event based on the Event ID passed. This API uses the parameters found in the Days of the Week Entry API for convenience. A driver can only modify events which were created by that driver.</p>

<p><h6 id='available-from-3-0-0'>Available from 3.0.0</h6><h3 id='signature'>Signature</h3>
<p><code>C4Scheduler:ModifyDaysOfTheWeekEntry(name, days_of_the_week, start_time, end_date, options)</code></p></p>

<table><thead>
<tr>
<th>Parameter</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>str</td>
<td>String value of the name of the event being modified.</td>
</tr>
<tr>
<td>str</td>
<td>Weekday values of: SUNDAY, MONDAY, TUESDAY, WEDNESDAY, THURSDAY, FRIDAY, SATURDAY</td>
</tr>
<tr>
<td>table</td>
<td>start time includes year, month, day, hour using 24 hour clock. Minute is optional. The default time is 12:00 AM.</td>
</tr>
<tr>
<td>table</td>
<td>end date. optional. includes: year, month, day</td>
</tr>
<tr>
<td>table</td>
<td>Table of additional, optional parameters that includes:</td>
</tr>
<tr>
<td></td>
<td>hidden - Boolean. Defaults to false. Setting to true prevents the Event from displaying in the Scheduler Agent in ComposerPro</td>
</tr>
<tr>
<td></td>
<td><code>user_hidden</code> - Boolean. Defaults to false. Setting user hidden to true prevents the Event from displaying on Navigators.</td>
</tr>
<tr>
<td></td>
<td>category - String value that is available to the driver writer to use however they see fit. Can be used to categorize events.</td>
</tr>
<tr>
<td></td>
<td>enabled - Boolean which defaults to true. Setting enabled to false will disable the Event.</td>
</tr>
<tr>
<td></td>
<td>locked - Boolean which defaults to false. Setting enabled to true will place the Event in a read only state.</td>
</tr>
</tbody></table>

<h3 id='returns'>Returns</h3>

<table><thead>
<tr>
<th>Value</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>True</td>
<td>Successful</td>
</tr>
<tr>
<td>False</td>
<td>Modification failed</td>
</tr>
</tbody></table>

<h2 id='modifyeveryxmonthsentry'>ModifyEveryXMonthsEntry</h2>

<p>Modifies the Event based on the Event ID passed. This API uses the parameters found in the Every X Months Entry API for convenience. A driver can only modify events which were created by that driver.</p>

<p><h6 id='available-from-3-0-0'>Available from 3.0.0</h6><h3 id='signature'>Signature</h3>
<p><code>C4Scheduler:ModifyEveryXMonthsEntry(name, num_months, start_time, end_date, options)</code></p></p>

<table><thead>
<tr>
<th>Parameter</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>str</td>
<td>String value of the name of the event being modified.</td>
</tr>
<tr>
<td>table</td>
<td>number of months. range (1-100)</td>
</tr>
<tr>
<td>table</td>
<td>start time includes year, month, day, hour using 24 hour clock. Minute is optional. The default time is 12:00 AM.</td>
</tr>
<tr>
<td>table</td>
<td>end date. optional. includes: year, month, day</td>
</tr>
<tr>
<td>table</td>
<td>Table of additional, optional parameters that includes:</td>
</tr>
<tr>
<td></td>
<td>hidden - Boolean. Defaults to false. Setting to true prevents the Event from displaying in the Scheduler Agent in ComposerPro</td>
</tr>
<tr>
<td></td>
<td><code>user_hidden</code> - Boolean. Defaults to false. Setting user hidden to true prevents the Event from displaying on Navigators.</td>
</tr>
<tr>
<td></td>
<td>category - String value that is available to the driver writer to use however they see fit. Can be used to categorize events.</td>
</tr>
<tr>
<td></td>
<td>enabled - Boolean which defaults to true. Setting enabled to false will disable the Event.</td>
</tr>
<tr>
<td></td>
<td>locked - Boolean which defaults to false. Setting enabled to true will place the Event in a read only state.</td>
</tr>
</tbody></table>

<h3 id='returns'>Returns</h3>

<table><thead>
<tr>
<th>Value</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>True</td>
<td>Successful</td>
</tr>
<tr>
<td>False</td>
<td>Modification failed</td>
</tr>
</tbody></table>

<h2 id='modifyeveryxyearsentry'>ModifyEveryXYearsEntry</h2>

<p>Modifies the Event based on the Event ID passed. This API uses the parameters found in the Every X Years Entry API for convenience. A driver can only modify events which were created by that driver.</p>

<p><h6 id='available-from-3-0-0'>Available from 3.0.0</h6><h3 id='signature'>Signature</h3>
<p><code>C4Scheduler:ModifyEveryXYearsEntry(name, num_years, start_time, end_date, options</code></p></p>

<table><thead>
<tr>
<th>Parameter</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>str</td>
<td>String value of the name of the event being modified.</td>
</tr>
<tr>
<td>table</td>
<td>number of years. range (1-100)</td>
</tr>
<tr>
<td>table</td>
<td>start time includes year, month, day, hour using 24 hour clock. Minute is optional. The default time is 12:00 AM.</td>
</tr>
<tr>
<td>table</td>
<td>end date. optional. includes: year, month, day</td>
</tr>
<tr>
<td>table</td>
<td>Table of additional, optional parameters that includes:</td>
</tr>
<tr>
<td></td>
<td>hidden - Boolean. Defaults to false. Setting to true prevents the Event from displaying in the Scheduler Agent in ComposerPro</td>
</tr>
<tr>
<td></td>
<td><code>user_hidden</code> - Boolean. Defaults to false. Setting user hidden to true prevents the Event from displaying on Navigators.</td>
</tr>
<tr>
<td></td>
<td>category - String value that is available to the driver writer to use however they see fit. Can be used to categorize events.</td>
</tr>
<tr>
<td></td>
<td>enabled - Boolean which defaults to true. Setting enabled to false will disable the Event.</td>
</tr>
<tr>
<td></td>
<td>locked - Boolean which defaults to false. Setting enabled to true will place the Event in a read only state.</td>
</tr>
</tbody></table>

<h3 id='returns'>Returns</h3>

<table><thead>
<tr>
<th>Value</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>True</td>
<td>Successful</td>
</tr>
<tr>
<td>False</td>
<td>Modification failed</td>
</tr>
</tbody></table>

<h2 id='modifysetdayseveryxweeksentry'>ModifySetDaysEveryXWeeksEntry</h2>

<p>Modifies the Event based on the Event ID passed. This API uses the parameters found in the Set Days Every X Weeks Entry API for convenience. A driver can only modify events which were created by that driver</p>

<p><h6 id='available-from-3-0-0'>Available from 3.0.0</h6><h3 id='signature'>Signature</h3>
<p><code>C4Scheduler:ModifySetDaysEveryXWeeksEntry(name, days_of_the_week, num_weeks, start_time, end_date, options)</code></p></p>

<table><thead>
<tr>
<th>Parameter</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>str</td>
<td>String value of the name of the event being modified.</td>
</tr>
<tr>
<td>str</td>
<td>Weekday values of: SUNDAY, MONDAY, TUESDAY, WEDNESDAY, THURSDAY, FRIDAY, SATURDAY</td>
</tr>
<tr>
<td>num</td>
<td>Value between 1 and 100. Number of week between the event occurring</td>
</tr>
<tr>
<td>table</td>
<td>start time includes year, month, day, hour using 24 hour clock. Minute is optional. The default time is 12:00 AM.</td>
</tr>
<tr>
<td>table</td>
<td>end date. optional. includes: year, month, day</td>
</tr>
<tr>
<td>table</td>
<td>Table of additional, optional parameters that includes:</td>
</tr>
<tr>
<td></td>
<td>hidden - Boolean. Defaults to false. Setting to true prevents the Event from displaying in the Scheduler Agent in ComposerPro</td>
</tr>
<tr>
<td></td>
<td><code>user_hidden</code> - Boolean. Defaults to false. Setting user hidden to true prevents the Event from displaying on Navigators.</td>
</tr>
<tr>
<td></td>
<td>category - String value that is available to the driver writer to use however they see fit. Can be used to categorize events.</td>
</tr>
<tr>
<td></td>
<td>enabled - Boolean which defaults to true. Setting enabled to false will disable the Event.</td>
</tr>
<tr>
<td></td>
<td>locked - Boolean which defaults to false. Setting enabled to true will place the Event in a read only state.</td>
</tr>
</tbody></table>

<h3 id='returns'>Returns</h3>

<table><thead>
<tr>
<th>Value</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>True</td>
<td>Successful</td>
</tr>
<tr>
<td>False</td>
<td>Modification failed</td>
</tr>
</tbody></table>

<h2 id='modifyname'>ModifyName</h2>

<p>Modifies the name of an Event. A driver can only modify events which were created by that driver.</p>

<p><h6 id='available-from-3-0-0'>Available from 3.0.0</h6><h3 id='signature'>Signature</h3>
<p><code>C4Scheduler:ModifyName(event_id, name)</code></p></p>

<table><thead>
<tr>
<th>Parameter</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>num</td>
<td>Number value of the Event.</td>
</tr>
<tr>
<td>str</td>
<td>String of Event name.</td>
</tr>
</tbody></table>

<h2 id='modifyoptions'>ModifyOptions</h2>

<p>Modifies the options of an Event. A driver can only modify events which were created by that driver.</p>

<p><h6 id='available-from-3-0-0'>Available from 3.0.0</h6><h3 id='signature'>Signature</h3>
<p><code>C4Scheduler:ModifyStartDate(event_id, options)</code></p></p>

<table><thead>
<tr>
<th>Parameter</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>num</td>
<td>Number value of the Event.</td>
</tr>
<tr>
<td>table</td>
<td>Table of additional, optional parameters that includes:</td>
</tr>
<tr>
<td></td>
<td>hidden - Boolean. Defaults to false. Setting to true prevents the Event from displaying in the Scheduler Agent in ComposerPro</td>
</tr>
<tr>
<td></td>
<td>category - String value that is available to the driver writer to use however they see fit. Can be used to categorize events.</td>
</tr>
<tr>
<td></td>
<td>bool - Defaults to true. Setting enabled to false will disable the Event.</td>
</tr>
<tr>
<td></td>
<td>bool  - Defaults to false. Setting enabled to true will place the Event in a read only state.</td>
</tr>
</tbody></table>

<h2 id='modifystartdate'>ModifyStartDate</h2>

<p>Modifies the Start Date of an Event. A driver can only modify events which were created by that driver.</p>

<p><h6 id='available-from-3-0-0'>Available from 3.0.0</h6><h3 id='signature'>Signature</h3>
<p><code>C4Scheduler:ModifyStartDate(event_id, year, month, day)</code></p></p>

<table><thead>
<tr>
<th>Parameter</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>num</td>
<td>Number value of the Event.</td>
</tr>
<tr>
<td>num</td>
<td>Number value of the year.</td>
</tr>
<tr>
<td>num</td>
<td>Number value of the month.</td>
</tr>
<tr>
<td>num</td>
<td>Number value of the day.</td>
</tr>
</tbody></table>

<h2 id='modifystarttime'>ModifyStartTime</h2>

<p>Modifies the Start Time of an Event. A driver can only modify events which were created by that driver.</p>

<p><h6 id='available-from-3-0-0'>Available from 3.0.0</h6><h3 id='signature'>Signature</h3>
<p><code>C4Scheduler:ModifyStartDate(event_id, hour, minute)</code></p></p>

<table><thead>
<tr>
<th>Parameter</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>num</td>
<td>Number value of the Event.</td>
</tr>
<tr>
<td>num</td>
<td>Number value of the hour.</td>
</tr>
<tr>
<td>num</td>
<td>Number value of the minute.</td>
</tr>
</tbody></table>
<h1 id='serial-and-network-interface'>Serial and Network Interface</h1>

<h2 id='createnetworkconnection'>CreateNetworkConnection</h2>

<p>Function that defines a dynamic Network Connection so no Connection XML is required. Further (port-specific configuration) can be accomplished through the use of the <a href="https://snap-one.github.io/docs-driverworks-api/#netportoptions">NetPortOptions</a> API. Connections are actually made using the <a href="https://snap-one.github.io/docs-driverworks-api/#netconnect">NetConnect</a> API. This API should not be invoked during OnDriverInit.</p>

<p><h6 id='available-from-1-6-0'>Available from 1.6.0.</h6><h3 id='signature'>Signature</h3>
<p><code>C4:CreateNetworkConnection (idBinding, strAddress, strConnectionType)</code></p></p>

<table><thead>
<tr>
<th>Parameter</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>num</td>
<td>id of the Network Binding to create.</td>
</tr>
<tr>
<td>str</td>
<td>Network address or hostname that this network connection will use.</td>
</tr>
<tr>
<td>str</td>
<td>Optional string designating connection type</td>
</tr>
</tbody></table>

<h3 id='returns'>Returns</h3>

<p><code>None</code></p>

<h3 id='usage-notes'>Usage Notes</h3>

<p>This is an alternative to having the connection section in the XML that creates the network connection</p>

<p>This binding parameter is used for other network calls: OnNetworkStatusChanged, <a href="https://snap-one.github.io/docs-driverworks-api/#netconnect">C4:NetConnect</a> &amp; <a href="https://snap-one.github.io/docs-driverworks-api/#netdisconnect">C4:NetDisconnect</a>. Note that all Binding ID values must be unique. Duplication of Binding IDs is not permitted within the same system. Binding Ranges include:</p>

<ul>
<li>Control Bindings  = 1 -&gt; 999</li>
<li>Video Inputs      = 1000 -&gt; 1099</li>
<li>Video Outputs     = 2000 -&gt; 2999</li>
<li>Audio Inputs      = 3000 -&gt; 3099</li>
<li>Audio Outputs     = 4000 -&gt; 4999</li>
<li>Proxy Bindings    = 5000 -&gt; 5999</li>
<li>Network Bindings  = 6000 -&gt; 6999</li>
<li>Room Bindings = 7000 -&gt; 7999</li>
<li>Power Manager = 8000 -&gt; 8999</li>
</ul>

<h3 id='example'>Example</h3>

<p><code>C4:CreateNetworkConnection (6000, &quot;196.120.10.10&quot;, &quot;SSL&quot;)</code></p>

<h2 id='getbindingaddress'>GetBindingAddress</h2>

<p>Returns a physical (IP) address of a network binding. This API should not be invoked during OnDriverInit</p>

<p><h6 id='available-from-1-6-0'>Available from 1.6.0.</h6><h3 id='signature'>Signature</h3>
<p><code>C4: GetBindingAddress (idBinding)</code></p></p>

<table><thead>
<tr>
<th>Parameter</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>num</td>
<td>Binding value.</td>
</tr>
</tbody></table>

<h3 id='returns'>Returns</h3>

<table><thead>
<tr>
<th>Value</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>str</td>
<td>Network address or hostname that this network connection will use.</td>
</tr>
<tr>
<td>int</td>
<td>IP address of a network binding</td>
</tr>
</tbody></table>

<h2 id='getboundconsumerdevices'>GetBoundConsumerDevices</h2>

<p>Call to retrieve the devices bound to (the consumers of) a binding provided (an output binding) by this device. This API should not be invoked during OnDriverInit.</p>

<p><h6 id='available-from-1-6-0'>Available from 1.6.0.</h6><h3 id='signature'>Signature</h3>
<p><code>C4:GetBoundConsumerDevices ()</code></p></p>

<table><thead>
<tr>
<th>Parameter</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>num</td>
<td>The id of the device to check the bindings on.</td>
</tr>
<tr>
<td>num</td>
<td>Binding ID.</td>
</tr>
</tbody></table>

<h3 id='usage-note'>Usage Note</h3>

<p>Note that for devices with a protocol and one or more proxy devices, the device id should be that of the proxy (not the lua protocol device id).  A device id of 0 will use the current device id.</p>

<h3 id='returns'>Returns</h3>

<p>null if no bindings or a table of device id/device name pairs of bound devices.</p>

<h3 id='examples'>Examples</h3>

<p>First get the proxy device id to check  on.  In this case, the 0 means this device, and the 5001 is the proxy id for the receiver.  </p>

<p><code>C4:GetBoundConsumerDevices(0, 5001)</code></p>

<div class="highlight"><pre class="highlight lua tab-lua"><code><span class="k">if</span> <span class="p">(</span><span class="n">devs</span> <span class="o">~=</span> <span class="kc">nil</span><span class="p">)</span> <span class="k">then</span>
 <span class="k">for</span> <span class="n">id</span><span class="p">,</span><span class="n">name</span> <span class="k">in</span> <span class="nb">pairs</span><span class="p">(</span><span class="n">devs</span><span class="p">)</span> <span class="k">do</span>
   <span class="c1">--should be only one</span>
   <span class="n">g_recProxyId</span> <span class="o">=</span> <span class="n">id</span>
 <span class="k">end</span>
<span class="k">end</span>
</code></pre></div>

<p>Now that we have the device id of the receiver proxy device, check to see what is bound to binding id 2000: </p>

<p><code>C4:GetBoundConsumerDevices(g_recProxyId, 2000)</code></p>

<div class="highlight"><pre class="highlight lua tab-lua"><code><span class="k">if</span> <span class="p">(</span><span class="n">devs</span> <span class="o">~=</span> <span class="kc">nil</span><span class="p">)</span> <span class="k">then</span>
 <span class="k">for</span> <span class="n">id</span><span class="p">,</span><span class="n">name</span> <span class="k">in</span> <span class="nb">pairs</span><span class="p">(</span><span class="n">devs</span><span class="p">)</span> <span class="k">do</span>
   <span class="nb">print</span> <span class="p">(</span><span class="s2">"id "</span> <span class="o">..</span> <span class="n">id</span> <span class="o">..</span> <span class="s2">" name "</span> <span class="o">..</span> <span class="n">name</span><span class="p">)</span>
 <span class="k">end</span>
<span class="k">end</span>

</code></pre></div><div class="highlight"><pre class="highlight lua tab-lua"><code><span class="n">Output</span><span class="p">:</span>
<span class="n">id</span> <span class="mi">19</span> <span class="n">name</span> <span class="n">Television</span>
<span class="n">id</span> <span class="mi">67</span> <span class="n">name</span> <span class="n">Television2</span>
</code></pre></div>

<h2 id='getboundproviderdevice'>GetBoundProviderDevice</h2>

<p>Call to retrieve what device is attached to an input binding of the specified device. This API should not be invoked during OnDriverInit.</p>

<p><h6 id='available-from-1-6-0'>Available from 1.6.0.</h6><h3 id='signature'>Signature</h3>
<p><code>C4:GetBoundProviderDevices()</code></p></p>

<table><thead>
<tr>
<th>Parameter</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>num</td>
<td>The id of the device to check the bindings on.</td>
</tr>
<tr>
<td>num</td>
<td>Binding ID.</td>
</tr>
</tbody></table>

<h3 id='usage-note'>Usage Note</h3>

<p>Note that for devices with a protocol and one or more proxy devices, the device id should be that of the proxy (not the lua protocol device id).  A device id of 0 will use the current device id.</p>

<h3 id='returns'>Returns</h3>

<p>null if no bindings or a table of device id/device name pairs of bound devices.</p>

<h3 id='example'>Example</h3>

<p>First get the proxy device id to check on. In this case, the 0 means this device and the 5001 is the proxy ID for the receiver. </p>

<p><code>C4:GetBoundConsumerDevices(0,5001)</code></p>

<div class="highlight"><pre class="highlight lua tab-lua"><code><span class="k">if</span> <span class="p">(</span><span class="n">devs</span> <span class="o">~=</span> <span class="kc">nil</span><span class="p">)</span> <span class="k">then</span>
<span class="k">for</span> <span class="n">id</span><span class="p">,</span><span class="n">name</span> <span class="k">in</span> <span class="nb">pairs</span><span class="p">(</span><span class="n">devs</span><span class="p">)</span> <span class="k">do</span>
<span class="c1">--should be only on g_recProxyId = id</span>
<span class="k">end</span>
<span class="k">end</span>
<span class="c1">-- the id 1011 is the video 2 input for this device</span>
<span class="n">id</span> <span class="o">=</span> <span class="n">C4</span><span class="p">:</span><span class="n">GetBoundProviderDevice</span><span class="p">(</span><span class="n">g_recProxyId</span><span class="p">,</span> <span class="mi">1011</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">"Id is "</span> <span class="o">..</span> <span class="n">id</span><span class="p">)</span>
</code></pre></div><div class="highlight"><pre class="highlight lua tab-lua"><code><span class="n">Output</span><span class="p">:</span>
<span class="n">Id</span> <span class="n">is</span> <span class="mi">44</span>
</code></pre></div>

<h2 id='getcontrollernetworkaddress'>GetControllerNetworkAddress</h2>

<p>Function that returns the address of the master controller in a project. This API should not be invoked during OnDriverInit.</p>

<p><h6 id='available-from-1-6-0'>Available from 1.6.0.</h6><h3 id='signature'>Signature</h3>
<p><code>C4:GetBoundConsumerDevices()</code></p>
<h3 id='parameters'>Parameters</h3>
<p><code>None</code></p>
<h3 id='returns'>Returns</h3>
<table><thead>
<tr>
<th>Value</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>str</td>
<td>Network address of the master controller in IP format</td>
</tr>
</tbody></table></p>

<h2 id='getdevicedisplayname'>GetDeviceDisplayName</h2>

<p>Returns the name of the device as shown in Composer. This API should not be invoked during OnDriverInit</p>

<p><h6 id='available-from-1-6-0'>Available from 1.6.0.</h6><h3 id='signature'>Signature</h3>
<p><code>C4:GetDeviceDisplayName ()</code></p></p>

<table><thead>
<tr>
<th>Parameter</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>num</td>
<td>ID Value of a device. Optional</td>
</tr>
</tbody></table>

<h3 id='returns'>Returns</h3>

<table><thead>
<tr>
<th>Value</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>str</td>
<td>Name of device.</td>
</tr>
</tbody></table>

<h2 id='getdevicemac'>GetDeviceMAC</h2>

<p>Returns the MAC Address associated with a device that has already been identified in the Control4 Project. The API uses address resolution protocol (ARP) queries to lookup MAC hardware addresses. It will return a value of nil if the MAC address is not found in the controller&#39;s ARP tables. Considerations when using GetDeviceMAC include:</p>

<ol>
<li>If a device responds to a search protocol (SSDP/SDDP/DDDP), a high probability exists that there will be an entry for the device in the ARP tables.</li>
<li>If a device doesn&#39;t respond to a search protocol, establishing a connection to the device is usually sufficient to ensure that there&#39;s an entry in the ARP tables.</li>
<li>If a device goes to sleep or is otherwise offline for any reason, then there is a low probability that there will be an entry in the ARP tables.</li>
</ol>

<p><h6 id='available-from-2-10-0'>Available from 2.10.0</h6><h3 id='signature'>Signature</h3>
<p><code>C4:GetDeviceMAC ()</code></p></p>

<table><thead>
<tr>
<th>Parameter</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>num</td>
<td>Network Binding ID value for the identified device</td>
</tr>
</tbody></table>

<h3 id='returns'>Returns</h3>

<p>Single MAC address.</p>

<h3 id='example'>Example</h3><div class="highlight"><pre class="highlight lua tab-lua"><code><span class="kd">local</span> <span class="n">mac</span> <span class="o">=</span><span class="err"> </span><span class="n">C4</span><span class="p">:</span><span class="n">GetDeviceMAC</span><span class="p">(</span><span class="mi">6001</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">mac</span><span class="p">)</span>
</code></pre></div><div class="highlight"><pre class="highlight lua tab-lua"><code> <span class="n">The</span> <span class="n">output</span> <span class="n">would</span> <span class="n">appear</span> <span class="n">as</span><span class="p">:</span>

 <span class="mi">28</span><span class="p">:</span><span class="mi">39</span><span class="p">:</span><span class="mi">5</span><span class="n">E</span><span class="p">:</span><span class="mi">45</span><span class="p">:</span><span class="mi">1</span><span class="n">F</span><span class="p">:</span><span class="n">F7</span>
</code></pre></div>
<h2 id='getdiscoveryinfo'>GetDiscoveryInfo</h2>
<p>Returns a table that contains the device&#39;s discovery information.</p>
<h6 id='available-from-2-10-0'>Available from 2.10.0</h6><h3 id='signature'>Signature</h3>

<p><code>C4:GetDiscoveryInfo(idBinding)</code></p>

<table><thead>
<tr>
<th>Parameter</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>num</td>
<td>Network Binding ID value for the identified device</td>
</tr>
</tbody></table>

<h3 id='returns'>Returns</h3>

<p>Table that contains the discovery information.</p>

<h3 id='example'>Example</h3><div class="highlight"><pre class="highlight lua tab-lua"><code><span class="n">info</span> <span class="o">=</span><span class="err"> </span><span class="n">C4</span><span class="p">:</span><span class="n">GetDiscoveryInfo</span><span class="p">(</span><span class="mi">6001</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="n">info</span><span class="p">[</span><span class="s2">"uuid"</span><span class="p">])</span>
</code></pre></div>
<p>Usage Note: Return table values are based on the discovery mechanism of the device. Values included in the return table can include:</p>

<ul>
<li>uuid // SDDP DDDP UPNP</li>
<li>host // SDDP</li>
<li>ip // SDDP DDDP UPNP</li>
<li>type // SDDP DDDP UPNP</li>
<li>driver // SDDP     </li>
<li>manufacturer // SDDP UPNP</li>
<li>model // SDDP DDDP UPNP</li>
<li>primary_proxy // SDDP</li>
<li>proxies_ // SDDP</li>
<li>make_ // DDDP</li>
<li>sdk_class_ // DDDP</li>
<li>name_ // UPNP</li>
<li>description_ // UPNP</li>
<li>location_ // UPNP</li>
</ul>

<p>Note that C4:GetDiscoveryInfo() is not available at the time that OnDriverLateInit() is executed when Director is starting. Director doesn&#39;t startup it&#39;s discovery mechanism until well after late initialize, so providing discovery info at that point is not possible. It is recommended recommendation here is to listen for the <a href="https://snap-one.github.io/docs-driverworks-api/#registering-for-system-events">OnSDDPDeviceStatus (#78)</a> system event. This event includes the UUID by which the device was identified, and a boolean indicating whether the device is online. It&#39;s either that or set a timer and poll until GetDiscoveryInfo returns what you&#39;re looking for.</p>

<p>SDDP is a royalty-free technology that enables your device to be automatically detected by and added into customers’ Control4 systems. SDDP greatly reduces the potential for mistakes and time required for installations. Our 3,500+ dealers much prefer (and seek out) products with SDDP. SDDP is very simple to implement and we can assist you as needed.</p>

<h2 id='getmynetworkaddress'>GetMyNetworkAddress</h2>
<p>API that returns the bound address of the &quot;device.&quot; For example, in the case of a single network binding, GetMyNetworkAddress returns the address of the device that&#39;s connected to the driver. This API should not be invoked during OnDriverInit.</p>
<h6 id='available-from-1-6-0'>Available from 1.6.0.</h6><h3 id='signature'>Signature</h3>

<p><code>C4:GetMyNetworkAddress</code></p>

<h2 id='getnetworkbindingsbydevice'>GetNetworkBindingsByDevice</h2>

<p>Function that returns network binding information for a device. </p>

<p><h6 id='available-from-3-0-0'>Available from 3.0.0</h6><h3 id='signature'>Signature</h3>
<p><code>C4:GetNetworkBindingsByDevice()</code></p></p>

<table><thead>
<tr>
<th>Parameter</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>num</td>
<td>The id of the device returning network binding information.</td>
</tr>
</tbody></table>

<h3 id='usage-note'>Usage Note</h3>

<p>Note that for devices with a protocol and one or more proxy devices, the device id should be that of the proxy (not the .lua protocol device id). A device id of 0 will use the current device id.</p>

<h3 id='returns'>Returns</h3>

<p>Network Binding information for the device.</p>

<h3 id='example'>Example</h3>

<p><code>C4:GetNetworkBindingsByDevice(20)</code></p>

<p>Returns:</p>

<div class="highlight"><pre class="highlight lua tab-lua"><code><span class="n">deviceid</span><span class="p">:</span> <span class="mi">20</span>
<span class="nb">type</span><span class="p">:</span> <span class="mi">1</span>
<span class="n">autobind</span><span class="p">:</span> <span class="kc">false</span>
<span class="n">class</span><span class="p">:</span> <span class="n">RS_232</span>
<span class="mi">1</span><span class="p">:</span> <span class="n">Serial3X</span>
<span class="n">rank</span><span class="p">:</span> <span class="mi">0</span>
<span class="n">bindingid</span><span class="p">:</span> <span class="mi">15</span>
<span class="n">binding_info</span><span class="p">:</span> 
<span class="n">flags</span><span class="p">:</span> <span class="mi">0</span>
<span class="n">isbound</span><span class="p">:</span> <span class="kc">false</span>
<span class="n">name</span><span class="p">:</span> <span class="n">SERIAL</span> <span class="mi">3</span>
<span class="n">provider</span><span class="p">:</span> <span class="kc">true</span>

<span class="n">deviceid</span><span class="p">:</span> <span class="mi">20</span>
<span class="nb">type</span><span class="p">:</span> <span class="mi">1</span>
<span class="n">autobind</span><span class="p">:</span> <span class="kc">false</span>
<span class="n">class</span><span class="p">:</span> <span class="n">IR_OUT</span>
<span class="mi">1</span><span class="p">:</span> <span class="n">Serial4X</span>
<span class="n">rank</span><span class="p">:</span> <span class="mi">0</span>
<span class="n">bindingid</span><span class="p">:</span> <span class="mi">401</span>
<span class="n">binding_info</span><span class="p">:</span> 
<span class="n">flags</span><span class="p">:</span> <span class="mi">0</span>
<span class="n">isbound</span><span class="p">:</span> <span class="kc">false</span>
<span class="n">name</span><span class="p">:</span> <span class="n">IR</span> <span class="n">OUT</span> <span class="mi">2</span>
<span class="n">provider</span><span class="p">:</span> <span class="kc">true</span>
</code></pre></div>

<h2 id='getnetworkconnections'>GetNetworkConnections</h2>

<p>Function that returns a table containing all of the device connections as well as data for each individual connection.</p>

<p><h6 id='available-from-3-0-0'>Available from 3.0.0</h6><h3 id='signature'>Signature</h3>
<p><code>C4:GetNetworkBindingsByDevice()</code></p></p>

<table><thead>
<tr>
<th>Parameter</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>table</td>
<td>Table containing connection information for the device and Information for each connection.</td>
</tr>
</tbody></table>

<h3 id='usage-note'>Usage Note</h3>

<p>Note that table data will vary based on device. Below are examples of each of the connection types supported by the function. Note the type table element. This is a numeric value between 0 and 8. The values are:</p>

<ul>
<li>0 = unknown</li>
<li>1 = UUID</li>
<li>2 = Internet Protocol (IP)</li>
<li>3 = Zigbee</li>
<li>4 = HOSTNAME</li>
<li>5 = Secure Socket layer (SSL)</li>
<li>6 = SSL_HOSTNAME</li>
<li>7 = Unix Domain Socket</li>
<li>8 = ZWave</li>
</ul>

<h3 id='returns'>Returns</h3>

<p>Network Binding information for the device.</p>

<h3 id='examples'>Examples</h3>

<p>The examples shown to the right return tables for each connection type:</p>

<p>Home Controller using a <strong>UUID</strong> connection. Note the state of 1 which indicates an active connection:</p>

<div class="highlight"><pre class="highlight lua tab-lua"><code><span class="n">UUID</span>
<span class="n">firmware</span><span class="p">:</span><span class="err">  </span>
<span class="n">address</span><span class="p">:</span><span class="err"> </span> <span class="mi">127</span><span class="p">.</span><span class="mi">0</span><span class="p">.</span><span class="mi">0</span><span class="p">.</span><span class="mi">1</span>
<span class="nb">type</span><span class="p">:</span><span class="err"> </span> <span class="mi">1</span>
<span class="n">bindingid</span><span class="p">:</span><span class="err"> </span> <span class="mi">6001</span>
<span class="n">deviceid</span><span class="p">:</span><span class="err"> </span> <span class="mi">63</span>
<span class="n">state</span><span class="p">:</span><span class="err"> </span> <span class="mi">1</span>
<span class="n">gateway</span><span class="p">:</span><span class="err">  </span>
<span class="n">name</span><span class="p">:</span><span class="err"> </span> <span class="n">Home</span> <span class="n">Controller</span> <span class="n">EA5</span>
<span class="n">port</span><span class="p">:</span><span class="err"> </span> <span class="mi">5116</span>
</code></pre></div>

<p>Control4 8-Channel Relay using an <strong>IP</strong> connection. Note the state of 0 which indicates as inactive connection:</p>

<div class="highlight"><pre class="highlight lua tab-lua"><code><span class="n">IP</span>
<span class="n">address</span><span class="p">:</span><span class="err">  </span>
<span class="nb">type</span><span class="p">:</span><span class="err"> </span> <span class="mi">2</span>
<span class="n">state</span><span class="p">:</span><span class="err"> </span> <span class="mi">0</span>
<span class="n">deviceid</span><span class="p">:</span><span class="err"> </span> <span class="mi">43</span>
<span class="n">firmware</span><span class="p">:</span><span class="err">  </span>
<span class="n">gateway</span><span class="p">:</span><span class="err">  </span>
<span class="n">name</span><span class="p">:</span><span class="err"> </span> <span class="mi">8</span><span class="o">-</span><span class="n">Channel</span> <span class="n">Relay</span> <span class="n">P1S3</span>
<span class="n">bindingid</span><span class="p">:</span><span class="err"> </span> <span class="mi">6001</span>
</code></pre></div>

<p>Control4 Configurable Keypad using a <strong>Zigbee</strong> connection:</p>

<div class="highlight"><pre class="highlight lua tab-lua"><code><span class="n">Zigbee</span>
<span class="n">firmware</span><span class="p">:</span><span class="err"> </span> <span class="mi">4</span><span class="p">.</span><span class="mi">1</span><span class="p">.</span><span class="mi">22</span>
<span class="n">address</span><span class="p">:</span><span class="err"> </span> <span class="mi">000</span><span class="n">fff000077f532</span>
<span class="nb">type</span><span class="p">:</span><span class="err"> </span> <span class="mi">3</span>
<span class="n">bindingid</span><span class="p">:</span><span class="err"> </span> <span class="mi">6001</span>
<span class="n">deviceid</span><span class="p">:</span><span class="err"> </span> <span class="mi">75</span>
<span class="n">state</span><span class="p">:</span><span class="err"> </span> <span class="mi">1</span>
<span class="n">gateway</span><span class="p">:</span><span class="err">  </span>
<span class="n">name</span><span class="p">:</span><span class="err"> </span> <span class="n">Configurable</span> <span class="n">Keypad</span>
<span class="n">port</span><span class="p">:</span><span class="err"> </span> <span class="mi">7900</span>
</code></pre></div>

<p>HOSTNAME - A <strong>HOSTNAME</strong> connection type returns a valid URL such as:</p>

<p><code>http://control4.com</code></p>

<p>A driver that uses an <strong>SSL</strong> connection:</p>

<div class="highlight"><pre class="highlight lua tab-lua"><code><span class="n">SSL</span>
<span class="n">address</span><span class="p">:</span><span class="err"> </span> <span class="mi">192</span><span class="p">.</span><span class="mi">168</span><span class="p">.</span><span class="mi">1</span><span class="p">.</span><span class="mi">123</span>
<span class="nb">type</span><span class="p">:</span><span class="err"> </span> <span class="mi">5</span>
<span class="n">state</span><span class="p">:</span><span class="err"> </span> <span class="mi">1</span>
<span class="n">deviceid</span><span class="p">:</span><span class="err"> </span> <span class="mi">216</span>
<span class="n">firmware</span><span class="p">:</span><span class="err">  </span>
<span class="n">gateway</span><span class="p">:</span><span class="err">  </span>
<span class="n">name</span><span class="p">:</span><span class="err"> </span> <span class="n">Driver</span> <span class="n">Properties</span>
<span class="n">bindingid</span><span class="p">:</span><span class="err"> </span> <span class="mi">6001</span>
</code></pre></div>

<p>SSL HOSTNAME - An SSL HOSTNAME connection type returns a valid, secure URL such as:</p>

<p><code>https://control4.com</code></p>

<p>UNIX DOMAIN SOCKET - A Unix Domain Socket connection type returns connection information between processes executing on the same Host, such as Director.</p>

<p><strong>Z-Wave</strong> Dimmer: </p>

<div class="highlight"><pre class="highlight lua tab-lua"><code><span class="n">Z</span><span class="o">-</span><span class="n">Wave</span>
<span class="n">device_lights</span><span class="p">:</span><span class="err"> </span> <span class="n">green</span>
<span class="n">network_status</span><span class="p">:</span><span class="err"> </span> <span class="n">online</span>
<span class="n">state</span><span class="p">:</span><span class="err"> </span> <span class="mi">1</span>
<span class="n">firmware</span><span class="p">:</span><span class="err">  </span>
<span class="nb">type</span><span class="p">:</span><span class="err"> </span> <span class="mi">8</span>
<span class="n">uuid</span><span class="p">:</span><span class="err"> </span> <span class="n">zwave</span><span class="p">:</span><span class="n">cd94eba9</span><span class="p">:</span><span class="mi">11</span>
<span class="n">security_status</span><span class="p">:</span><span class="err"> </span> <span class="n">notSupported</span>
<span class="n">address</span><span class="p">:</span><span class="err"> </span> <span class="n">cd94eba9</span><span class="p">:</span><span class="mi">11</span>
<span class="n">driver_enabled</span><span class="p">:</span><span class="err"> </span> <span class="mi">1</span>
<span class="n">deviceid</span><span class="p">:</span><span class="err"> </span> <span class="mi">25</span>
<span class="n">wake_status</span><span class="p">:</span><span class="err"> </span> <span class="n">awake</span>
<span class="n">device_status</span><span class="p">:</span><span class="err"> </span> <span class="n">ready</span>
<span class="n">gateway</span><span class="p">:</span><span class="err">  </span>
<span class="n">name</span><span class="p">:</span><span class="err"> </span> <span class="n">Leviton</span> <span class="n">Z</span><span class="o">-</span><span class="n">Wave</span> <span class="n">DZPD3</span> <span class="n">Lamp</span> <span class="n">Dimmer</span> <span class="n">Module</span>
<span class="n">port</span><span class="p">:</span><span class="err"> </span> <span class="mi">0</span>
</code></pre></div>

<h2 id='getproxydevicesbyid'>GetProxyDevicesbyID</h2>

<p>Returns the Proxy ID value when passed a Device ID value. This API should not be invoked during OnDriverInit.</p>

<p><h6 id='available-from-1-6-0'>Available from 1.6.0</h6><h3 id='signature'>Signature</h3>
<p><code>C4:GetProxyDevicesbyID (idDevice)</code></p></p>

<table><thead>
<tr>
<th>Parameter</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>num</td>
<td>ID value of a device. Optional</td>
</tr>
</tbody></table>

<h3 id='returns'>Returns</h3>

<table><thead>
<tr>
<th>Value</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>num</td>
<td>Proxy ID value</td>
</tr>
</tbody></table>

<h3 id='usage-note'>Usage Note</h3>

<p>Usage Note: If parameter passed is zero (0), this function will return the current Proxy ID for the driver selected in the Composer Project. If multiple proxies are associated with a device, the first Proxy ID displayed will be the first proxy as displayed in the Composer device tree.</p>

<h2 id='getserialsettings'>GetSerialSettings</h2>

<p>Returns the &lt;serialsettings&gt; string from the driver that is connected to the provided control binding. The control binding should be an RS232 provider binding. This API should not be invoked during OnDriverInit.</p>

<p><h6 id='available-from-1-6-0'>Available from 1.6.0</h6><h3 id='signature'>Signature</h3>
<p><code>C4:GetSerialSettings (idBinding)</code></p></p>

<table><thead>
<tr>
<th>Parameter</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>num</td>
<td>Control Binding Value</td>
</tr>
</tbody></table>

<h3 id='returns'>Returns</h3>

<table><thead>
<tr>
<th>Value</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>str</td>
<td>Serial Settings Data in string format.</td>
</tr>
</tbody></table>

<h2 id='receivedfromserial'>ReceivedFromSerial</h2>

<p>Function which dumps the data received from serial (hex format) for inspection via print.  It then evaluates the response for specific delimiters and extracts the necessary components which are then used to do something. This API should not be invoked during OnDriverInit.</p>

<p><h6 id='available-from-1-6-0'>Available from 1.6.0</h6><h3 id='signature'>Signature</h3>
<p><code>C4:ReceivedFromSerial(idBinding, strData)</code></p></p>

<table><thead>
<tr>
<th>Parameter</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>num</td>
<td>ID of the serial interface the data was received on</td>
</tr>
<tr>
<td>str</td>
<td>Data received from the serial interface</td>
</tr>
</tbody></table>

<h3 id='returns'>Returns</h3>

<p><code>None</code></p>

<h3 id='usage-note'>Usage Note</h3>

<p>Serial data received may contain NULL characters. NULL (‘\0’) is a valid character and Lua strings handle embedded NULL characters. Serial data received may only include part of a protocol command from the connected device. It is the driver’s responsibility to re-constitute and parse the commands received from the device.</p>

<h3 id='example'>Example</h3><div class="highlight"><pre class="highlight lua tab-lua"><code><span class="k">function</span> <span class="nf">ReceivedFromSerial</span><span class="p">(</span><span class="n">idBinding</span><span class="p">,</span> <span class="n">strData</span><span class="p">)</span>
   <span class="nb">print</span><span class="p">(</span><span class="s2">"Received something from serial on binding "</span> <span class="o">..</span> <span class="n">idBinding</span><span class="p">)</span>
   <span class="n">hexdump</span><span class="p">(</span><span class="n">strData</span><span class="p">)</span>
   <span class="n">responseCount</span><span class="o">=</span><span class="mi">0</span>
   <span class="n">l_string</span> <span class="o">=</span> <span class="n">strData</span>
   <span class="k">for</span> <span class="n">w</span> <span class="k">in</span> <span class="nb">string.gmatch</span><span class="p">(</span><span class="n">strData</span><span class="p">,</span> <span class="s2">"!1(...)"</span><span class="p">)</span> <span class="k">do</span>
      <span class="n">retType</span> <span class="o">=</span> <span class="n">w</span>
      <span class="n">responseCount</span><span class="o">=</span><span class="n">responseCount</span> <span class="o">+</span><span class="mi">1</span>
      <span class="n">delimPos</span> <span class="o">=</span> <span class="nb">string.find</span><span class="p">(</span><span class="n">l_string</span><span class="p">,</span><span class="n">tohex</span><span class="p">(</span><span class="s2">"1A"</span><span class="p">))</span>
      <span class="n">retValue</span> <span class="o">=</span> <span class="nb">string.sub</span><span class="p">(</span><span class="n">l_string</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span> <span class="nb">tonumber</span><span class="p">(</span><span class="n">delimPos</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
      <span class="n">l_string</span> <span class="o">=</span> <span class="nb">string.sub</span><span class="p">(</span><span class="n">l_string</span><span class="p">,</span><span class="n">delimPos</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
      <span class="n">sendNotify</span><span class="p">()</span>
   <span class="k">end</span>
<span class="k">end</span>
</code></pre></div>
<h2 id='receivedfromnetwork'>ReceivedFromNetwork</h2>
<p>Function which combines the data received from the network into a variable for processing when the connection status changes. This API should not be invoked during OnDriverInit.</p>
<h6 id='available-from-1-6-0'>Available from 1.6.0</h6><h3 id='signature'>Signature</h3>

<p><code>C4:ReceivedFromNetwork(idBinding, nPort, strData) </code></p>

<table><thead>
<tr>
<th>Parameter</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>num</td>
<td>Binding ID of the interface the data was received from</td>
</tr>
<tr>
<td>num</td>
<td>Network Port the data was received on</td>
</tr>
<tr>
<td>str</td>
<td>Network data from the specified binding and port</td>
</tr>
</tbody></table>

<h3 id='returns'>Returns</h3>

<p><code>None</code></p>

<h3 id='usage-note'>Usage Note</h3>

<p>Network data received may contain NULL characters. NULL (‘\0’) is a valid character and Lua strings handle embedded NULL characters.Network data received may only include part of a protocol command from the connected device. It is the driver’s responsibility to re-constitute and parse the commands received from the device.</p>

<h3 id='example'>Example</h3><div class="highlight"><pre class="highlight lua tab-lua"><code><span class="k">function</span> <span class="nf">ReceivedFromNetwork</span><span class="p">(</span><span class="n">idBinding</span><span class="p">,</span> <span class="n">nPort</span><span class="p">,</span> <span class="n">strData</span><span class="p">)</span>
  <span class="c1">-- Save up things coming back on HTTP port, process when done     </span>
    <span class="n">sending</span> <span class="n">to</span> <span class="n">us</span><span class="o">...</span>
  <span class="n">g_Receivebuffer</span> <span class="o">=</span> <span class="n">g_Receivebuffer</span> <span class="o">..</span> <span class="n">strData</span>
<span class="k">end</span>
</code></pre></div>
<h2 id='setbindingaddress'>SetBindingAddress</h2>
<p>Function that allows a TCP/IP device, with an existing connection, to use a different IP Address for connection purposes. This API can be used with both statically created connections (XML) as well as dynamically created ones. It is recommended that the NetConnect API is called after SetBindingAddress. This API should not be invoked during OnDriverInit.</p>
<h6 id='available-from-2-8-0'>Available from 2.8.0</h6><h3 id='signature'>Signature</h3>

<p><code>C4:SetBindingAddress(idBinding, strIPaddress) </code></p>

<table><thead>
<tr>
<th>Parameter</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>num</td>
<td>Binding ID of the existing network binding</td>
</tr>
<tr>
<td>str</td>
<td>New IP address for the connection</td>
</tr>
</tbody></table>

<h3 id='returns'>Returns</h3>

<p><code>None</code></p>

<h3 id='example'>Example</h3>

<p><code>C4:SetBindingAddress(6002, &#39;192.168.1.225&#39;)</code></p>

<h2 id='setbindingstatus'>SetBindingStatus</h2>

<p>Function that enables a Lua driver to explicitly set the &quot;connected&quot; state for a connection binding. This can particularly useful for connection bindings that aren&#39;t persistent (i.e., always connected), such as HTTP. Such non-persistent connections are marked as Offline (yellow) in the Network Tools windows in Composer. The C4:SetBindingStatus function enables a driver to manage the &quot;connected&quot; state of a connection binding, effectively overriding the default behavior provided by Director</p>

<p><h6 id='available-from-2-10-0'>Available from 2.10.0</h6><h3 id='signature'>Signature</h3>
<p><code>C4:SetBindingStatus(idBinding, strStatus)</code></p></p>

<table><thead>
<tr>
<th>Parameter</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>num</td>
<td>Binding ID of the existing network binding</td>
</tr>
<tr>
<td>str</td>
<td>String that specifies the status to set.</td>
</tr>
</tbody></table>

<h3 id='usage-note'>Usage Note</h3>

<p>The string parameter can be one of the following values: unknown: This is the default if there have been no prior calls to <code>C4:SetBindingStatus</code> or if the value of the status parameter is anything other than &quot;online&quot; or &quot;offline&quot;.</p>

<h3 id='returns'>Returns</h3>

<p><code>None</code></p>

<h3 id='example'>Example</h3>

<p><code>C4:SetBindingStatus(6001, &quot;online&quot;) </code></p>

<h2 id='sendbroadcast'>SendBroadcast</h2>

<p>Function that enables a Lua driver to send network broadcast messages. The function opens a UDP connection, sets the <code>SO_BROADCAST</code> socket option and then sends a specified payload to the directed broadcast address. For example, 192.168.1.255. If the directed broadcast address is unavailable for any reason then the limited broadcast address is used instead, for example: 255.255.255.255.</p>

<p>This function must be used judiciously as there are network performance implications associated with its use. Network broadcasting requires that the router send the message to every device connected to the network. Overuse of this function can cause significant performance problems that affect the entire network.</p>

<p><h6 id='available-from-2-10-0'>Available from 2.10.0</h6><h3 id='signature'>Signature</h3>
<p><code>C4:SendBroadcast(payload, port))</code></p></p>

<table><thead>
<tr>
<th>Parameter</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>str</td>
<td>Payload of the message to be broadcast</td>
</tr>
<tr>
<td>num</td>
<td>Port identifying the port to which the payload is broadcast.</td>
</tr>
</tbody></table>

<h3 id='returns'>Returns</h3>

<p><code>None</code></p>

<h3 id='usage-note'>Usage Note:</h3>

<p>There are some limitations associated with network broadcasting. These include the inability for it to work beyond the local network. Messages are not broadcast to the Internet, for example. Also, there is no confirmation that the message was received.</p>

<h3 id='example'>Example</h3>

<p><code>C4:SendBroadcast(&quot;This is a message, 42) </code></p>

<h2 id='sendtodevice'>SendToDevice</h2>

<p>Function called from DriverWorks driver to send a Control4 CommandMessage to the specified Control4 device driver. This API should not be invoked during OnDriverInit.</p>

<p><h6 id='available-from-1-6-0'>Available from 1.6.0</h6><h3 id='signature'>Signature</h3>
<p><code>C4:SendToDevice(idDevice, strCommand, tParams, AllowEmptyValues logCommand))</code></p></p>

<table><thead>
<tr>
<th>Parameter</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>num</td>
<td>Device ID of the driver you wish to send the command to.</td>
</tr>
<tr>
<td>str</td>
<td>Command to be sent</td>
</tr>
<tr>
<td>table</td>
<td>Lua table of parameters for the command.</td>
</tr>
<tr>
<td>bool</td>
<td>allowEmptyValues (T/F) Optional. Defaults to False. TRUE will allow for an empty string to be sent as a parameter value.</td>
</tr>
<tr>
<td>bool</td>
<td>logCommand Defaults to True.  False prevents this API’s content from being logged.</td>
</tr>
</tbody></table>

<h3 id='usage-note'>Usage Note</h3>

<p>The logCommand parameter may be useful if sensitive data is being passed through the API and it is desirable for that data to not appear in logs.</p>

<h3 id='returns'>Returns</h3>

<p><code>None</code></p>

<h3 id='usage-note-2'>Usage Note:</h3>

<p>There are some limitations associated with network broadcasting. These include the inability for it to work beyond the local network. Messages are not broadcast to the Internet, for example. Also, there is no confirmation that the message was received.</p>

<h3 id='example'>Example</h3>

<p>Toggles the Light registered with the system as device 41:</p>

<div class="highlight"><pre class="highlight lua tab-lua"><code><span class="n">C4</span><span class="p">:</span><span class="n">SendToDevice</span><span class="p">(</span><span class="mi">41</span><span class="p">,</span><span class="s2">"TOGGLE"</span><span class="p">,{})</span>
<span class="c1">-- Ramps the Light registered with the system as device 41 to 60% over 3 seconds:</span>
<span class="n">C4</span><span class="p">:</span><span class="n">SendToDevice</span><span class="p">(</span><span class="mi">41</span><span class="p">,</span><span class="s2">"RAMP_TO_LEVEL"</span><span class="p">,</span> <span class="p">{</span><span class="n">LEVEL</span> <span class="o">=</span> <span class="mi">60</span><span class="p">,</span> <span class="n">TIME</span> <span class="o">=</span> <span class="mi">3000</span><span class="p">})</span>
</code></pre></div>

<h2 id='sendtonetwork'>SendToNetwork</h2>

<p>Function which sends an HTTP request to a network binding / port. This API should not be invoked during OnDriverInit.</p>

<p><h6 id='available-from-1-6-0'>Available from 1.6.0</h6><h3 id='signature'>Signature</h3>
<p><code>C4:SendToNetwork(idBinding, nPort, strData)</code></p></p>

<table><thead>
<tr>
<th>Parameter</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>num</td>
<td>Binding ID of the network interface to send on</td>
</tr>
<tr>
<td>num</td>
<td>Network port to send on</td>
</tr>
<tr>
<td>str</td>
<td>Data to send out the specified network interface</td>
</tr>
</tbody></table>

<h3 id='returns'>Returns</h3>

<p><code>None</code></p>

<h3 id='usage-note'>Usage Note:</h3>

<p>Data to be sent can contain NULL characters. NULL (‘\0’) is a valid character and Lua strings handle embedded NULL characters. </p>

<h3 id='example'>Example</h3>

<p><code>C4:SendToNetwork(6001, 80, g_URLPacket)</code></p>

<h2 id='sendtoserial'>SendToSerial</h2>

<p>Simple function which sends the command out serial port on binding 1 and adds the \r terminator to the end of the command being sent. This API should not be invoked during OnDriverInit.</p>

<p><h6 id='available-from-1-6-0'>Available from 1.6.0</h6><h3 id='signature'>Signature</h3>
<p><code>C4:SendToSerial(idBinding, strData)</code></p></p>

<table><thead>
<tr>
<th>Parameter</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>num</td>
<td>Binding ID of the network interface to send on</td>
</tr>
<tr>
<td>str</td>
<td>Data to send out the specified network interface</td>
</tr>
</tbody></table>

<h3 id='returns'>Returns</h3>

<p><code>None</code></p>

<h3 id='usage-note'>Usage Note:</h3>

<p>Serial data to be sent can contain NULL characters. NULL (‘\0’) is a valid character and Lua strings handle embedded NULL characters</p>

<h3 id='example'>Example</h3><div class="highlight"><pre class="highlight lua tab-lua"><code><span class="k">function</span> <span class="nf">emit</span><span class="p">(</span><span class="n">strCommand</span><span class="p">)</span>
   <span class="nb">print</span><span class="p">(</span><span class="s2">"Emit: "</span> <span class="o">..</span> <span class="n">strCommand</span><span class="p">)</span>
   <span class="n">C4</span><span class="p">:</span><span class="n">SendToSerial</span><span class="p">(</span><span class="s2">"1"</span><span class="p">,</span> <span class="n">strCommand</span> <span class="o">..</span> <span class="s2">"</span><span class="se">\r</span><span class="s2">"</span><span class="p">)</span>
<span class="k">end</span>
</code></pre></div>
<h2 id='sendwol'>SendWOL</h2>
<p>Function that enables a Lua driver to broadcast a Wake-On-Lan magic packet. </p>
<h6 id='available-from-2-10-0'>Available from 2.10.0</h6><h3 id='signature'>Signature</h3>

<p><code>C4:SendWOL(macAddress, port) </code></p>

<table><thead>
<tr>
<th>Parameter</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>macAdress</td>
<td>MAC address of the device.</td>
</tr>
<tr>
<td>num</td>
<td>Optional. ID of the port the WOL magic packet is broadcast. If omitted, the WOL default port 9 is used.</td>
</tr>
</tbody></table>

<h3 id='usage-note'>Usage Note</h3>

<p>The MAC address parameter can be formatted in one of two ways: 
Using a colon character (:) to delineate the six numeric values. For example: 00:0a:95:9d:68:16 
or
Using no delimiter: 000a959d6816</p>

<h3 id='returns'>Returns</h3>

<p><code>None</code></p>

<h3 id='usage-note-2'>Usage Note:</h3>

<p>Although using WOL can be useful for devices that do not provide a full network stack when powered off, there are some limitations:
- Many network devices do not support Wake-On-Lan.
- Requires that the MAC address of the destination device is known.
- Does not work over WiFi.
- Does not work beyond the local network (i.e., the Internet).
- Does not provide confirmation that the intended device received the message.</p>

<h3 id='examples'>Examples</h3>

<p><code>C4:SendWOL(&quot;00:0a:95:9d:68:16&quot;)</code></p>

<p>In the example above, the port argument is omitted. The WOL magic packet is broadcast on port 9 which is default.</p>

<p><code>C4:SendWOL(&quot;000a959d6816&quot;, 42)</code></p>

<p>The example above broadcasts the WOL magic packet on port 42.</p>

<h2 id='netconnect'>NetConnect</h2>

<p>Function used to tell the system to make a connection (static or dynamic). Connections are created using the <a href="https://snap-one.github.io/docs-driverworks-api/#createnetworkconnection">CreateNetworkConnection</a> API. Further, port-specific configuration can be configured for a connection through the <a href="https://snap-one.github.io/docs-driverworks-api/#netportoptions">NetPortOptions</a> API. This API should not be invoked during OnDriverInit.</p>

<p><h6 id='available-from-1-6-0'>Available from 1.6.0</h6><h3 id='signature'>Signature</h3>
<p><code>C4:NetConnect(idBinding, nPort, strIPType,)</code></p></p>

<table><thead>
<tr>
<th>Parameter</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>num</td>
<td>Binding ID of the network interface</td>
</tr>
<tr>
<td>num</td>
<td>Network port to connect to. If NetPortOptions API is used with NetConnect, the remaining parameters are ignored.</td>
</tr>
<tr>
<td>str</td>
<td>IP Type. Optional. TCP is assumed or UDP or MULTICAST</td>
</tr>
</tbody></table>

<h3 id='returns'>Returns</h3>

<p><code>None</code></p>

<h3 id='examples'>Examples</h3>

<p><code> C4:NetConnect(6001, 80, UDP)</code></p>

<h2 id='netdisconnect'>NetDisconnect</h2>

<p>Function called from DriverWorks driver to disconnect from a specific idBinding and nPort. This API should not be invoked during OnDriverInit.</p>

<p><h6 id='available-from-1-6-0'>Available from 1.6.0</h6><h3 id='signature'>Signature</h3>
<p><code>C4:NetDisconnect(idBinding, nPort)</code></p></p>

<table><thead>
<tr>
<th>Parameter</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>num</td>
<td>Binding ID of the network interface to disconnect from</td>
</tr>
<tr>
<td>num</td>
<td>Network port.</td>
</tr>
</tbody></table>

<h3 id='returns'>Returns</h3>

<p><code>None</code></p>

<h2 id='netportoptions'>NetPortOptions</h2>

<p>Function to configure a connection&#39;s Port settings.  The use of this API is contingent upon the use of the <a href="https://snap-one.github.io/docs-driverworks-api/#createnetworkconnection">CreateNetworkConnection</a> and <a href="https://snap-one.github.io/docs-driverworks-api/#createnetworkconnection">NetConnect</a> APIs. Connections are created using the CreateNetworkConnection API and Connections are made using the NetConnect API. This API should not be invoked during OnDriverInit.</p>

<p><h6 id='available-from-2-8-0'>Available from 2.8.0</h6><h3 id='signature'>Signature</h3>
<p><code>C4:NetPortOptions(idBinding, nPort, strIPType,tPortParams)</code></p></p>

<table><thead>
<tr>
<th>Parameter</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>num</td>
<td>Binding ID of the network interface to disconnect from</td>
</tr>
<tr>
<td>num</td>
<td>Network port.</td>
</tr>
<tr>
<td>str</td>
<td>Network Connection type. For example, TCP/SSL or UDP.</td>
</tr>
<tr>
<td>table</td>
<td>lua table of Key/Value pairs that contain all of the parameters for the specific Port. These parameters include:</td>
</tr>
</tbody></table>

<ul>
<li><p>AUTO CONNECT - Corresponds to the <code>&lt;auto_connect&gt;</code> setting defined in the .c4i file. Specifies that Director should automatically attempt the connectIon.</p></li>
<li><p>MONITOR CONNECTION - Corresponds to the <code>&lt;monitor_connection&gt;</code> setting defined in the .c4i file. Specifies that Director should monitor the connectIon by periodically polling. Director invokes the OnPoll method for a driver to inform the driver that it should poll the connectIon.</p></li>
<li><p>KEEP CONNECTION - Corresponds to the <code>&lt;keep_connectIon&gt;</code> setting defined in the .c4i file. Specifies that Director should automatically attempt to reestablish a connectIon if it drops.</p></li>
<li><p>KEEP ALIVE - Corresponds to the <code>&lt;keep_alive&gt;</code> setting defined in the .c4i file. Specifies that Director should enable TCP keep-alive for the connectIon.</p></li>
<li><p>DELIMITER - String Delimiter to separate messages. If no delimiter is specified, packets are delivered as they are received.</p></li>
<li><p>CERTIFICATE - Path to the  certificate to use for the connection. The path is relative to the driver’s .c4z location.</p></li>
<li><p>PRIVATE KEY - Path to the private key to use for the connection. The path is relative to the driver’s .c4z location.</p></li>
<li><p>MIRROR UDP PORT - The use of the mirror udp port parameter defaults to false. Setting this to true will use the value assigned in the nPort parameter of the  NetPortOptions function (which is the destination port) as the source port value. Meaning that the data packets will be sent from and received on port  values that are the same. Note that MIRROR UPD PORT is only available through Port Options on Dynamically created connections. Statically created connection do not support he use of MIRROR UPD PORT being set to true.</p></li>
<li><p>PROTECTED - If the “protected” value is “True”, then Director will invoke the following callback to retrieve the password from the driver:</p>

<p><code>function GetPrivateKeyPassword(Binding, Port)</code>
 <code>return “TheKey”</code>
  <code>end</code></p></li>
<li><p>CACERTFILE - Path to the CA (certificate authority) certificate to use for the connection. The path is relative to the driver’s C4Z location.</p></li>
<li><p>VERIFY MODE - Specifies the verification mode to use for the connection. The verify mode corresponds to those supported by OpenSSL. A detailed description of the verification modes can be found here: https://www.openssl.org. Note that Control4 currently supports only the peer verification mode (SSL VERIFY PEER). Values include: none and peer. Note that if this property is omitted, then Director defaults to use no verification (“none”).</p></li>
<li><p>VERIFY METHOD - Specifies the method to use for establishing the connection. A detailed description of the various methods can be found at https://www.openssl.org Valid values include: sslv2, sslv23, sslv3, tlsv1 &amp;  tlsv1_1_. Note that if this property is omitted, then Director defaults to using sslv23 (which is the OpenSSL default).</p></li>
<li><p>suppressconnectionevents - true or false to suppress connections. For more information see: <a href="https://snap-one.github.io/docs-driverworks-api/#suppressing-system-events">Suppressing System Events</a></p></li>
</ul>

<p>To the right is a sample tPortParams table using default values:</p>

<div class="highlight"><pre class="highlight lua tab-lua"><code><span class="kd">local</span> <span class="n">tPortParams</span> <span class="o">=</span><span class="err"> </span> <span class="p">{</span>
<span class="err">  </span> <span class="n">AUTO_CONNECT</span> <span class="o">=</span> <span class="kc">false</span><span class="p">,</span>
<span class="err">  </span> <span class="n">MONITOR_CONNECTION</span> <span class="o">=</span> <span class="kc">true</span><span class="p">,</span>
<span class="err">  </span> <span class="n">KEEP_CONNECTION</span> <span class="o">=</span> <span class="kc">true</span><span class="p">,</span>
<span class="err">  </span> <span class="n">KEEP_ALIVE</span> <span class="o">=</span> <span class="kc">true</span><span class="p">,</span>
<span class="err">  </span> <span class="n">DELIMITER</span> <span class="o">=</span> <span class="s2">""</span><span class="p">,</span>
<span class="err">  </span> <span class="n">CERTIFICATE</span> <span class="o">=</span> <span class="s1">'./client.pem'</span><span class="p">,</span>
<span class="err">  </span> <span class="n">PRIVATE_KEY</span> <span class="o">=</span> <span class="s1">'./client_key.pem'</span><span class="p">,</span>
<span class="err">  </span> <span class="n">MIRROR_UDP_PORT</span> <span class="o">=</span> <span class="kc">false</span><span class="p">,</span>
<span class="err">  </span> <span class="n">PROTECTED</span> <span class="o">=</span> <span class="kc">false</span><span class="p">,</span>
<span class="err">   </span><span class="n">CACERTFILE</span> <span class="o">=</span> <span class="s1">'./root.pem'</span><span class="p">,</span>
<span class="err">  </span> <span class="n">VERIFY_MODE</span> <span class="o">=</span> <span class="s1">'none'</span><span class="p">,</span>
<span class="err">  </span> <span class="n">METHOD</span> <span class="o">=</span> <span class="s1">'tlsv1'</span><span class="p">,</span>
<span class="err">  </span> <span class="n">SUPPRESS_CONNECTION_EVENTS</span> <span class="o">=</span> <span class="kc">false</span>
<span class="p">}</span>
</code></pre></div><h3 id='usage-note'>Usage Note</h3>
<p>UDP Connection: The use of the mirror udp port parameter defaults to false. Setting this to true will use the value assigned in the nPort parameter of the NetPortOptions function (which is the destination port) as the source port value. Meaning that the data packets will be sent from and received on port values that are the same.</p>
<h3 id='returns'>Returns</h3>
<p><code>None</code></p>

<h2 id='onbindingvalidate'>OnBindingValidate</h2>
<p>The OnBindingValidate API supports validation by a driver before Director adds a new binding. This enables drivers to reject bindings that aren&#39;t valid due to some internal, dynamic state.</p>
<h6 id='available-from-1-6-0'>Available from 1.6.0</h6><h3 id='signature'>Signature</h3>
<p><code>OnBindingValidate(idBinding, strClass) </code></p>

<table><thead>
<tr>
<th>Parameter</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>num</td>
<td>ID of the network binding being validated</td>
</tr>
<tr>
<td>str</td>
<td>Class of the Binding.</td>
</tr>
</tbody></table>

<h2 id='onconnectionstatuschanged'>OnConnectionStatusChanged</h2>
<p>Function based on this return from the system used to process communication.</p>
<h6 id='available-from-1-6-0'>Available from 1.6.0</h6><h3 id='signature'>Signature</h3>
<p><code>OnConnectionStatusChanged(idBinding, nPort, strStatus) </code></p>

<table><thead>
<tr>
<th>Parameter</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>num</td>
<td>ID of the network binding whose status has changed</td>
</tr>
<tr>
<td>num</td>
<td>Port number whose status has changed</td>
</tr>
<tr>
<td>str</td>
<td>Status: “OFFLINE” or “ONLINE”</td>
</tr>
</tbody></table>
<h3 id='example'>Example</h3><div class="highlight"><pre class="highlight lua tab-lua"><code><span class="k">function</span> <span class="nf">OnConnectionStatusChanged</span><span class="p">(</span><span class="n">idBinding</span><span class="p">,</span> <span class="n">nPort</span><span class="p">,</span> <span class="n">strStatus</span><span class="p">)</span>
  <span class="k">if</span> <span class="p">(</span><span class="n">idBinding</span> <span class="o">==</span> <span class="mi">6001</span><span class="p">)</span> <span class="k">then</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">strStatus</span> <span class="o">==</span> <span class="s2">"ONLINE"</span><span class="p">)</span> <span class="k">then</span>
      <span class="c1">-- Connect was successful.  Send URL packet.</span>
      <span class="c1">-- Other actions…</span>
      <span class="c1">-- Send 'queued' HTTP request to WeatherBug:</span>
      <span class="n">C4</span><span class="p">:</span><span class="n">SendToNetwork</span><span class="p">(</span><span class="mi">6001</span><span class="p">,</span> <span class="mi">80</span><span class="p">,</span> <span class="n">g_URLPacket</span><span class="p">)</span>
    <span class="k">else</span>
      <span class="c1">-- OFFLINE... This means the receive buffer is full and ready to  </span>
    <span class="n">process</span><span class="o">...</span>
      <span class="c1">-- Other actions…</span>
    <span class="k">end</span>
  <span class="k">end</span>
<span class="k">end</span>
</code></pre></div>

<h2 id='onnetworkbindingchanged'>OnNetworkBindingChanged</h2>

<p>Function called by Director when a network connection has been addressed (‘identified’ on Network Connections Page) or unaddressed (‘disconnect’).</p>

<p><h6 id='available-from-1-6-0'>Available from 1.6.0</h6><h3 id='signature'>Signature</h3>
<p><code>C4:OnNetworkBindingChanged(idBinding, bIsBound)</code></p></p>

<table><thead>
<tr>
<th>Parameter</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>num</td>
<td>ID of the network binding whose status has changed</td>
</tr>
<tr>
<td>bool</td>
<td>Whether the network binding has a bound address</td>
</tr>
</tbody></table>

<h2 id='sample-tcp-connection'>Sample TCP Connection</h2>

<p>To the right is a sample of a Driver&#39;s Connection XML. It shows the XML entries required for a static TCP type connection:</p>

<div class="highlight"><pre class="highlight xml tab-xml"><code><span class="nt">&lt;connection&gt;</span>
    <span class="nt">&lt;id&gt;</span>6001<span class="nt">&lt;/id&gt;</span>
    <span class="nt">&lt;connectionname&gt;</span>TCP<span class="nt">&lt;/connectionname&gt;</span>
    <span class="nt">&lt;type&gt;</span>4<span class="nt">&lt;/type&gt;</span>
    <span class="nt">&lt;hidden&gt;</span>True<span class="nt">&lt;/hidden&gt;</span>
    <span class="nt">&lt;consumer&gt;</span>True<span class="nt">&lt;/consumer&gt;</span>
    <span class="nt">&lt;classes&gt;</span>
        <span class="nt">&lt;class&gt;</span>
            <span class="nt">&lt;classname&gt;</span>TCP<span class="nt">&lt;/classname&gt;</span>
            <span class="nt">&lt;ports&gt;</span>
                <span class="nt">&lt;port&gt;</span>
                    <span class="nt">&lt;number&gt;</span>6700<span class="nt">&lt;/number&gt;</span>
                    <span class="nt">&lt;suppress_connection_events&gt;</span>True<span class="nt">&lt;/suppress_connection_events&gt;</span>
                    <span class="nt">&lt;auto_connect&gt;</span>True<span class="nt">&lt;/auto_connect&gt;</span>
                    <span class="nt">&lt;monitor_connection&gt;</span>True<span class="nt">&lt;/monitor_connection&gt;</span>
                    <span class="nt">&lt;keep_connection&gt;</span>True<span class="nt">&lt;/keep_connection&gt;</span>
                    <span class="nt">&lt;keep_alive&gt;</span>True<span class="nt">&lt;/keep_alive&gt;</span>
                    <span class="nt">&lt;delimiter&gt;</span>0d0a<span class="nt">&lt;/delimiter&gt;</span>
                <span class="nt">&lt;/port&gt;</span>
            <span class="nt">&lt;/ports&gt;</span>
        <span class="nt">&lt;/class&gt;</span>
    <span class="nt">&lt;/classes&gt;</span>
<span class="nt">&lt;/connection&gt;</span>
</code></pre></div>

<p>In the example above we see the following XML elements:</p>

<ul>
<li>&lt;id&gt; - This is the connection&#39;s unique ID value.</li>
<li>&lt;connectionname&gt; - Reflects the type of connection the XML supports.</li>
<li>&lt;type&gt; - The type value of 4 is used for all network connections.</li>
<li>&lt;hidden&gt; - The hidden value indicates if the connection will be displayed in ComposerPro. In this example, the connection will be visible in ComposerPro.</li>
<li>&lt;consumer&gt; - The consumer value of true is used for all network connections.</li>
</ul>

<p>In the example above, this is followed by the class section of the XML which contains the classname element. Note that the class name element is the same as the connectionname value.</p>

<p>This is followed by all of the port specific information for the connection. This is all that is required to configure a static, TCP connection for your driver.</p>

<p>If a dynamic connection is desired, the port information needs to reside within a table (tPortParams) inside the driver. The following is a sample of a the same connection as above, however it is created dynamically:</p>

<div class="highlight"><pre class="highlight lua tab-lua"><code><span class="kd">local</span> <span class="n">tPortParams</span> <span class="o">=</span> <span class="p">{</span>
<span class="err">   </span><span class="n">SUPPRESS_CONNECTION_EVENTS</span> <span class="o">=</span> <span class="kc">true</span><span class="p">,</span>
<span class="err">   </span><span class="n">AUTO_CONNECT</span> <span class="o">=</span> <span class="kc">true</span><span class="p">,</span>
<span class="err">   </span><span class="n">MONITOR_CONNECTION</span> <span class="o">=</span> <span class="kc">true</span><span class="p">,</span>
<span class="err">   </span><span class="n">KEEP_CONNECTION</span> <span class="o">=</span> <span class="kc">true</span><span class="p">,</span>
<span class="err">   </span><span class="n">KEEP_ALIVE</span> <span class="o">=</span> <span class="kc">true</span><span class="p">,</span>
<span class="err">   </span><span class="n">DELIMITER</span> <span class="o">=</span> <span class="s2">"0d0a"</span>
<span class="p">}</span>
<span class="n">C4</span><span class="p">:</span><span class="n">CreateNetworkConnection</span> <span class="p">(</span><span class="mi">6001</span><span class="p">,</span> <span class="s1">'192.168.1.100'</span><span class="p">,</span> <span class="s2">"TCP"</span><span class="p">)</span>
<span class="n">C4</span><span class="p">:</span><span class="n">NetPortOptions</span><span class="p">(</span><span class="mi">6001</span><span class="p">,</span> <span class="mi">6700</span><span class="p">,</span> <span class="s2">"TCP"</span><span class="p">,</span> <span class="n">tPortParams</span><span class="p">)</span>
<span class="n">C4</span><span class="p">:</span><span class="n">NetConnect</span><span class="p">(</span><span class="mi">6001</span><span class="p">,</span> <span class="mi">6700</span><span class="p">)</span>
</code></pre></div>

<p>This connection is created using the CreateNetworkConnection API:</p>

<p><code>C4:CreateNetworkConnection (6001, &#39;192.168.1.100&#39;, &quot;TCP&quot;)</code></p>

<p>This connection&#39;s port parameters are sent using the NetPortOptions API:</p>

<p><code>C4:NetPortOptions(6001, 6700, &quot;TCP&quot;, tPortParams)</code></p>

<p>Finally, the connection is made using the <a href="https://snap-one.github.io/docs-driverworks-api/#netconnect">NetConnect</a> API The use of the NetConnect API is required for the new connection to be made.</p>

<h2 id='sample-ssl-multi-port-connection'>Sample SSL (Multi-Port) Connection</h2>

<p>To the right is a sample of a Driver&#39;s Connection XML. It shows the XML entries required for a static SSL type connection using two ports (443 and 444):</p>

<div class="highlight"><pre class="highlight xml tab-xml"><code><span class="nt">&lt;connection&gt;</span>
    <span class="nt">&lt;id&gt;</span>6001<span class="nt">&lt;/id&gt;</span>
    <span class="nt">&lt;facing&gt;</span>6<span class="nt">&lt;/facing&gt;</span>
    <span class="nt">&lt;connectionname&gt;</span>Hopper Control Connection<span class="nt">&lt;/connectionname&gt;</span>
    <span class="nt">&lt;type&gt;</span>4<span class="nt">&lt;/type&gt;</span>
    <span class="nt">&lt;consumer&gt;</span>True<span class="nt">&lt;/consumer&gt;</span>
    <span class="nt">&lt;classes&gt;</span>
        <span class="nt">&lt;class&gt;</span>
            <span class="nt">&lt;classname&gt;</span>SSL<span class="nt">&lt;/classname&gt;</span>
            <span class="nt">&lt;ports&gt;</span>
                <span class="nt">&lt;port&gt;</span>
                    <span class="nt">&lt;number&gt;</span>443<span class="nt">&lt;/number&gt;</span>
                    <span class="nt">&lt;auto_connect&gt;</span>False<span class="nt">&lt;/auto_connect&gt;</span>
                    <span class="nt">&lt;monitor_connection&gt;</span>False<span class="nt">&lt;/monitor_connection&gt;</span>
                    <span class="nt">&lt;keep_connection&gt;</span>False<span class="nt">&lt;/keep_connection&gt;</span>
                    <span class="nt">&lt;delimiter&gt;</span>0d<span class="nt">&lt;/delimiter&gt;</span>
                    <span class="nt">&lt;certificate&gt;</span>./DISH.cert<span class="nt">&lt;/certificate&gt;</span>
                    <span class="nt">&lt;private_key</span> <span class="na">protected =</span> <span class="s">"True"</span><span class="nt">&gt;</span>./DISH.cert<span class="nt">&lt;/private_key&gt;</span>
                    <span class="nt">&lt;cacert&gt;</span>./DISH.cert<span class="nt">&lt;/cacert&gt;</span>
                <span class="nt">&lt;/port&gt;</span>
                <span class="nt">&lt;port&gt;</span>
                    <span class="nt">&lt;number&gt;</span>444<span class="nt">&lt;/number&gt;</span>
                    <span class="nt">&lt;auto_connect&gt;</span>False<span class="nt">&lt;/auto_connect&gt;</span>
                    <span class="nt">&lt;monitor_connection&gt;</span>False<span class="nt">&lt;/monitor_connection&gt;</span>
                    <span class="nt">&lt;keep_connection&gt;</span>False<span class="nt">&lt;/keep_connection&gt;</span>
                    <span class="nt">&lt;delimiter&gt;</span>0d<span class="nt">&lt;/delimiter&gt;</span>
                    <span class="nt">&lt;certificate&gt;</span>./DISH.cert<span class="nt">&lt;/certificate&gt;</span>
                    <span class="nt">&lt;private_key</span> <span class="na">protected =</span> <span class="s">"True"</span><span class="nt">&gt;</span>./DISH.cert<span class="nt">&lt;/private_key&gt;</span>
                    <span class="nt">&lt;cacert&gt;</span>./DISH.cert<span class="nt">&lt;/cacert&gt;</span>
                <span class="nt">&lt;/port&gt;</span>
            <span class="nt">&lt;/ports&gt;</span>
        <span class="nt">&lt;/class&gt;</span>
    <span class="nt">&lt;/classes&gt;</span>
<span class="nt">&lt;/connection&gt;</span>
</code></pre></div>

<p>This connection using the first port is created using the <a href="https://snap-one.github.io/docs-driverworks-api/#createnetworkconnection">CreateNetworkConnection</a> API:</p>

<p><code>C4:CreateNetworkConnection (6001, &#39;192.168.1.100&#39;, &quot;SSL&quot;)</code></p>

<p>This connection&#39;s port parameters are sent using the <a href="https://snap-one.github.io/docs-driverworks-api/#netportoptions">NetPortOptions</a> API:</p>

<p><code>C4:NetPortOptions(6001, 443, &quot;SSL&quot;, tPortParams)</code></p>

<p>Finally, the connection is actually made using the <a href="https://snap-one.github.io/docs-driverworks-api/#netconnect">NetConnect</a> API. The use of the NectConnect API is required for the new connection to be made:</p>

<p><code>C4:NetConnect(6001, 443)</code></p>

<p>This connection using the second port is created using the <a href="https://snap-one.github.io/docs-driverworks-api/#createnetworkconnection">CreateNetworkConnection</a> API:</p>

<p><code>tPortParams[&quot;AUTO_CONNECT&quot;] = false</code></p>

<p>This connection&#39;s port parameters are sent using the <a href="https://snap-one.github.io/docs-driverworks-api/#netportoptions">NetPortOptions</a> API:</p>

<p><code>C4:NetPortOptions(6001, 444, &quot;SSL&quot;, tPortParams)</code></p>

<p>Finally, the connection is made using the NetConnect API The use of the <a href="https://snap-one.github.io/docs-driverworks-api/#netconnect">NectConnect</a> API is required for the new connection to be made:</p>

<p><code>C4:NetConnect(6001, 444)</code></p>
<h1 id='server-socket-interface'>Server Socket Interface</h1>

<h2 id='overview'>Overview</h2>

<p>This section describes the Server Sockets feature delivered in the 2.1.0 (and later) release of Control4’s System Software.  The Server Sockets interface is a lightweight way for drivers to be to accept incoming socket connections, and process them easily.</p>

<h2 id='createserver'>CreateServer</h2>

<p>Creates a Server Socket, that listens on port nPort, and sends messages to the driver upon receipt of the delimiter, strDelimiter (or upon timeout). This API should not be invoked during OnDriverInit.</p>

<p><h6 id='available-from-2-10-0'>Available from 2.10.0</h6><h3 id='signature'>Signature</h3>
<p><code>C4:CreateServer(nPort, strDelimiter, bUseUDP) </code></p></p>

<table><thead>
<tr>
<th>Parameter</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>num</td>
<td>TCP Socket to listen for connections on. See note below for additional port information.</td>
</tr>
<tr>
<td>str</td>
<td>Optional: Delimiter to separate messages. If no delimiter is specified, packets are delivered as they are received.</td>
</tr>
<tr>
<td>bool</td>
<td>bUseUDP: When True, the server socket connection is a UDP server socket. The default is TCP.</td>
</tr>
</tbody></table>

<h3 id='returns'>Returns</h3>

<p><code>None</code></p>

<h3 id='usage-note'>Usage Note</h3>

<p>The Listening socket may accept multiple connections, which can be active at the same time. See note below for additional port information.</p>

<h3 id='examples'>Examples</h3>

<p>Server Sockets Interface:</p>

<p><code>C4:CreateServer(5080, &quot;\r\n&quot;)</code></p>

<p>Creates a Listening Socket Server on port 8080, with no delimiter (packets will be sent as received):</p>

<p><code>C4:CreateServer(8080)</code></p>

<p>To the right is an example that creates a UDP server socket connection:</p>

<div class="highlight"><pre class="highlight lua tab-lua"><code><span class="n">C4</span><span class="p">:</span><span class="n">CreateServer</span><span class="p">(</span><span class="mi">600</span><span class="p">,</span> <span class="s2">""</span><span class="p">,</span> <span class="kc">true</span><span class="p">)</span>
<span class="k">function</span> <span class="nf">OnServerDataIn</span><span class="p">(</span><span class="n">nHandle</span><span class="p">,</span> <span class="n">strData</span><span class="p">)</span>
 <span class="nb">print</span><span class="p">(</span><span class="s2">"OnServerDataIn"</span> <span class="o">..</span> <span class="n">nHandle</span> <span class="o">..</span> <span class="s2">": "</span> <span class="o">..</span> <span class="n">strData</span><span class="p">)</span>
<span class="k">end</span>
</code></pre></div>

<p>Prior to operating system 2.9.0, it was not possible to specify a port in the C4:CreateServer API that was guaranteed to be safe. While the system could choose a port for you, the caller could not get that port to pass to clients for use. The end result was that driver writers would create drivers that would steal ports from Director or from each other.</p>

<p>Beginning with 2.9.0, callbacks have been modified or added (OnServerStatusChanged) where needed to allow getting the ephemeral port from the C4:CreateServer API and to get the IP address of a client connecting to the server created with C4:CreateServer. It is still possible to pass 0 for the port to have the OS select an available port for you. In the first example to the right, <code>C4:CreateServer</code> is specifying an ephemeral Port:</p>

<div class="highlight"><pre class="highlight lua tab-lua"><code>
<span class="k">function</span> <span class="nf">run</span><span class="p">()</span>
    <span class="n">dbg</span><span class="p">(</span><span class="s2">"run called"</span><span class="p">)</span>
    <span class="n">C4</span><span class="p">:</span><span class="n">CreateServer</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="s1">'</span><span class="se">\n</span><span class="s1">'</span><span class="p">,</span> <span class="kc">false</span><span class="p">)</span>
<span class="k">end</span>

<span class="n">OnServerStatusChannged</span> <span class="n">Callback</span> <span class="n">to</span> <span class="n">Get</span> <span class="n">the</span> <span class="n">Correct</span> <span class="n">Port</span><span class="p">:</span>

<span class="k">function</span> <span class="nf">OnServerStatusChanged</span><span class="p">(</span><span class="n">nPort</span><span class="p">,</span> <span class="n">strStatus</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">"OnServerStatusChanged port: "</span> <span class="o">..</span> <span class="n">nPort</span> <span class="o">..</span> <span class="s2">" status: "</span> <span class="o">..</span> <span class="n">strStatus</span><span class="p">)</span>
<span class="k">end</span>
</code></pre></div>

<p>Next, <a href="https://snap-one.github.io/docs-driverworks-api/#onserverconnectionstatuschanged">OnServerConnectionStatusChanged</a> now Reports Client IP:</p>

<div class="highlight"><pre class="highlight lua tab-lua"><code><span class="k">function</span> <span class="nf">OnServerConnectionStatusChanged</span><span class="p">(</span><span class="n">nHash</span><span class="p">,</span> <span class="n">nPort</span><span class="p">,</span> <span class="n">strStatus</span><span class="p">,</span> <span class="n">strIP</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">"OnServerConnectionStatusChanged hash: "</span> <span class="o">..</span> <span class="n">nHash</span> <span class="o">..</span> <span class="s2">" port: "</span> <span class="o">..</span> <span class="n">nPort</span> <span class="o">..</span> <span class="s2">" status: "</span> <span class="o">..</span> <span class="n">strStatus</span> <span class="o">..</span> <span class="s2">" ip: "</span> <span class="o">..</span> <span class="n">strIP</span><span class="p">)</span>
<span class="k">end</span>
</code></pre></div>

<p>The last example to the right shows executing the Lua code in an example driver with output to a console:</p>

<div class="highlight"><pre class="highlight lua tab-lua"><code><span class="n">Property</span> <span class="n">Changed</span><span class="p">:</span> <span class="n">Driver</span> <span class="n">Status</span>
<span class="n">run</span> <span class="n">called</span>
<span class="n">Driver</span> <span class="n">enabled</span>
<span class="n">OnServerStatusChanged</span> <span class="n">port</span><span class="p">:</span> <span class="mi">53319</span> <span class="n">status</span><span class="p">:</span> <span class="n">ONLINE</span>
<span class="n">OnServerConnectionStatusChanged</span> <span class="n">hash</span><span class="p">:</span> <span class="mi">162938911</span> <span class="n">port</span><span class="p">:</span> <span class="mi">53319</span> <span class="n">status</span><span class="p">:</span> <span class="n">ONLINE</span> <span class="n">ip</span><span class="p">:</span> <span class="mi">192</span><span class="p">.</span><span class="mi">168</span><span class="p">.</span><span class="mi">200</span><span class="p">.</span><span class="mi">100</span>
<span class="n">OnServerDataIn</span> <span class="n">hash</span><span class="p">:</span> <span class="mi">162938911</span> <span class="n">data</span><span class="p">:</span> <span class="n">lkasjdfl</span> <span class="n">ip</span><span class="p">:</span> <span class="mi">192</span><span class="p">.</span><span class="mi">168</span><span class="p">.</span><span class="mi">200</span><span class="p">.</span><span class="mi">100</span>
</code></pre></div>

<h2 id='destroyserver'>DestroyServer</h2>

<p>Destroys any Server Sockets. This API should not be invoked during OnDriverInit.</p>

<p><h6 id='available-from-2-10-0'>Available from 2.10.0</h6><h3 id='signature'>Signature</h3>
<p><code>C4:DestroyServer(nPort)</code></p></p>

<table><thead>
<tr>
<th>Parameter</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>num</td>
<td>TCP Port to stop listening on (Should be the same as initially given)</td>
</tr>
</tbody></table>

<h3 id='examples'>Examples</h3>

<p>This function stops listening on all ports: </p>

<p><code>C4:DestroyServer()</code></p>

<p>This function stops listening on port 8080: </p>

<p><code>C4:DestroyServer(8080)</code></p>

<h2 id='onserverconnectionstatuschanged'>OnServerConnectionStatusChanged</h2>

<p>This function gets called when Server Socket connection status has changed.</p>

<p><h6 id='available-from-2-10-0'>Available from 2.10.0</h6><h3 id='signature'>Signature</h3>
<p><code>OnServerConnectionStatusChanged(nHandle, nPort, strStatus) </code></p></p>

<table><thead>
<tr>
<th>Parameter</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>num</td>
<td>Server Socket handle. May be used to respond to this instance of a connection on the port, or to close this connection.</td>
</tr>
<tr>
<td>num</td>
<td>Port for Socket Connection</td>
</tr>
<tr>
<td>str</td>
<td>Status of the connection. Valid values include: ONLINE, OFFLINE</td>
</tr>
</tbody></table>

<h3 id='returns'>Returns</h3>

<p><code>None</code></p>

<h3 id='example'>Example</h3>

<p>This function prints the current status as it changes to the Lua Output window.</p>

<div class="highlight"><pre class="highlight lua tab-lua"><code><span class="k">function</span> <span class="nf">OnServerConnectionStatusChanged</span><span class="p">(</span><span class="n">nHandle</span><span class="p">,</span> <span class="n">nPort</span><span class="p">,</span> <span class="n">strStatus</span><span class="p">)</span>
  <span class="k">if</span> <span class="p">(</span><span class="n">strStatus</span> <span class="o">==</span> <span class="s2">"ONLINE"</span><span class="p">)</span> <span class="k">then</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">"Server Connection Established: "</span> <span class="o">..</span> <span class="n">nHandle</span><span class="p">)</span>
  <span class="k">else</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">"Server Connection Disconnected: "</span> <span class="o">..</span> <span class="n">nHandle</span><span class="p">)</span>
  <span class="k">end</span>
<span class="k">end</span>
</code></pre></div>

<h2 id='onserverdatain'>OnServerDataIn</h2>

<p>This function gets called when data is coming in on an open Server Socket.</p>

<p><h6 id='available-from-2-10-0'>Available from 2.10.0</h6><h3 id='signature'>Signature</h3>
<p><code>OnServerDataIn(nHandle, strData, strclientAddress, strPort</code></p></p>

<table><thead>
<tr>
<th>Parameter</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>num</td>
<td>Server Socket handle received in OnServerConnectionStatusChanged. Used to reply or disconnect this Server Socket.</td>
</tr>
<tr>
<td>str</td>
<td>Data received</td>
</tr>
<tr>
<td>str</td>
<td>IP of the remote client. For TCP servers this is the remote IP address of the connected client.</td>
</tr>
<tr>
<td></td>
<td>For UDP servers this is the IP address of the sender.</td>
</tr>
<tr>
<td>num</td>
<td>Port of the remote client. For TCP servers this is the remote port number of the connected client.</td>
</tr>
<tr>
<td></td>
<td>For UDP servers this is the port number of the sender.</td>
</tr>
</tbody></table>

<h3 id='returns'>Returns</h3>

<p><code>None</code></p>

<h3 id='example'>Example</h3>

<p>This example prints the incoming data from an open Server Socket (assumes the data is ASCII printable)</p>

<div class="highlight"><pre class="highlight lua tab-lua"><code><span class="k">function</span> <span class="nf">OnServerDataIn</span><span class="p">(</span><span class="n">nHandle</span><span class="p">,</span> <span class="n">strData</span><span class="p">,</span> <span class="n">strclientAddress</span><span class="p">,</span> <span class="n">strPort</span><span class="p">)</span>
  <span class="nb">print</span><span class="p">(</span><span class="s2">"Received Data on Handle: "</span> <span class="o">..</span> <span class="n">nHandle</span> <span class="o">..</span> <span class="s2">": "</span> <span class="o">..</span> <span class="n">strData</span> <span class="o">..</span> <span class="s2">":"</span>  <span class="n">strclientAddress</span>  <span class="s2">": "</span>  <span class="n">strPort</span><span class="p">))</span>
<span class="k">end</span>
</code></pre></div>

<h2 id='serversend'>ServerSend</h2>

<p>This function is used to send data over an open Server Socket connection. This API should not be invoked during OnDriverInit.</p>

<p><h6 id='available-from-2-10-0'>Available from 2.10.0</h6><h3 id='signature'>Signature</h3>
<p><code>C4:ServerSend(nHandle, strData)</code>   </p></p>

<table><thead>
<tr>
<th>Parameter</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>num</td>
<td>Server Socket handle received in OnServerConnectionStatusChanged. Replies to or disconnects this same Server Socket.</td>
</tr>
<tr>
<td>str</td>
<td>Data to be sent over the open Server Socket connection.</td>
</tr>
</tbody></table>

<h3 id='returns'>Returns</h3>

<p><code>None</code></p>

<h3 id='example'>Example</h3>

<p>This function shows sending data over a Server Socket:</p>

<p><code>C4:ServerSend(nHandle, strData)</code></p>

<h2 id='servercloseclient'>ServerCloseClient</h2>

<p>Close a previously open Server Socket connection. This API should not be invoked during OnDriverInit.</p>

<p><h6 id='available-from-2-10-0'>Available from 2.10.0</h6><h3 id='signature'>Signature</h3>
<p><code>C4:ServerCloseClient(nHandle)</code></p></p>

<table><thead>
<tr>
<th>Parameter</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>num</td>
<td>Server Socket handle received in <a href="https://snap-one.github.io/docs-driverworks-api/#onserverconnectionstatuschanged">OnServerConnectionStatusChanged</a>.</td>
</tr>
</tbody></table>

<h3 id='returns'>Returns</h3>

<p><code>None</code></p>

<h3 id='example'>Example</h3>

<p>This function closes the server socket previously received.</p>

<p><code>C4:ServerCloseClient(nHandle)</code></p>
<h1 id='timer-interface'>Timer Interface</h1>

<h2 id='settimer'>SetTimer</h2>

<p>Creates and starts timer. This API should not be invoked during OnDriverInit.</p>

<p><h6 id='available-from-1-6-0'>Available from 1.6.0.</h6><h3 id='signature'>Signature</h3>
<p><code>C4:SetTimer(nDelay, fCallback, bRepeat)</code></p></p>

<table><thead>
<tr>
<th>Parameter</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>num</td>
<td>Numeric value in milliseconds which is the desired timer delay. This value must be greater than 0.</td>
</tr>
<tr>
<td>func</td>
<td>The function to be called when the timer fires.  The function signature for non-repeating timers is: function(timer)</td>
</tr>
<tr>
<td>bool</td>
<td>bRepeat Optional parameter that, if provided and set to true, the timer will fire repeatedly until canceled.</td>
</tr>
</tbody></table>

<p>The function signature for repeating timers is: function(oTimer, nSkips). timer is the same C4LuaTimer object that is returned from this function. skips (repeating timers only) indicates how many times director skipped calling the function. This can happen if the timer is set up to fire rapidly, but director was too busy to serve the timer in a timely manner. </p>

<p>For instance, if the timer was set up for 250ms and director was busy for 600ms before serving the timer, skips would be set to 2, indicating that it missed serving the timer twice since the last time it was served or since it was first started.</p>

<h3 id='returns'>Returns</h3>

<p>C4LuaTimer object with the following method(s):</p>

<p><code>oTimer:Cancel()</code> - This function cancels the timer.</p>

<h3 id='usage-note'>Usage Note</h3>

<p>These timers do not trigger a call into the global OnTimerExpired function. To avoid potentially overwhelming Director with fast repeating timers, the C4:SetTimer() API will skip serving timers if it gets behind. If the timer handler cares, it will receive a second argument “skips” with the number of callbacks that director was not able to serve in a timely manner. This means that it is not guaranteed that if you set up a timer to fire 10 times a second, that your callback will actually get called back 10 times per second. It may get called fewer times than that if Director cannot keep up. If your driver needs to know, it can look at that new skips argument. This allows for much better scalability if some driver were to (accidentally) set a repeating timer with a very small value (e.g. 1ms, 10ms, 100ms). Prior to this change it was possible to permanently “lock up” director in such a case, which also could look like a memory leak as timers would get scheduled as a faster pace than were able to be served.</p>

<h3 id='examples'>Examples</h3>

<p>The first example to the right shows creating a Repeating Timer:</p>

<div class="highlight"><pre class="highlight lua tab-lua"><code><span class="c1">-- Repeating timer example (once a second):</span>

<span class="err">    </span> <span class="kd">local</span> <span class="n">cnt</span> <span class="o">=</span> <span class="mi">0</span>
<span class="err">    </span> <span class="kd">local</span> <span class="n">rt</span> <span class="o">=</span> <span class="n">C4</span><span class="p">:</span><span class="n">SetTimer</span><span class="p">(</span><span class="mi">1000</span><span class="p">,</span> <span class="k">function</span><span class="p">(</span><span class="n">timer</span><span class="p">,</span> <span class="n">skips</span><span class="p">)</span>
<span class="err">        </span> <span class="c1">-- timer is the same as what C4:SetTimer() returned</span>
<span class="err">        </span> <span class="nb">print</span><span class="p">(</span><span class="s2">"Timer fired, skips: "</span> <span class="o">..</span> <span class="n">skips</span><span class="p">)</span>
<span class="err">        </span> <span class="n">cnt</span> <span class="o">=</span> <span class="n">cnt</span> <span class="o">+</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">skips</span>
<span class="err">        </span> <span class="k">if</span> <span class="p">(</span><span class="n">cnt</span> <span class="o">&gt;</span> <span class="mi">9</span><span class="p">)</span> <span class="k">then</span>
<span class="err">            </span> <span class="nb">print</span><span class="p">(</span><span class="s2">"Canceling the timer now"</span><span class="p">)</span>
<span class="err">            </span> <span class="n">timer</span><span class="p">:</span><span class="n">Cancel</span><span class="p">()</span>
<span class="err">        </span> <span class="k">end</span>
<span class="err">    </span> <span class="k">end</span><span class="p">,</span> <span class="kc">true</span><span class="p">)</span>
<span class="err">    </span> <span class="c1">-- If you wish to cancel the timer at any time (even before it fired):</span>
<span class="err">    </span> <span class="c1">--rt:Cancel()</span>
</code></pre></div>

<p>The second example shows creating a Simple Timer:</p>

<div class="highlight"><pre class="highlight lua tab-lua"><code><span class="c1">-- Simple timer (once a second)</span>

<span class="err">    </span> <span class="kd">local</span> <span class="n">t</span> <span class="o">=</span> <span class="n">C4</span><span class="p">:</span><span class="n">SetTimer</span><span class="p">(</span><span class="mi">1000</span><span class="p">,</span> <span class="k">function</span><span class="p">(</span><span class="n">timer</span><span class="p">)</span>
<span class="err">        </span> <span class="c1">-- timer is the same as what C4:SetTimer() returned</span>
<span class="err">        </span> <span class="nb">print</span><span class="p">(</span><span class="s2">"Timer fired"</span><span class="p">)</span>
<span class="err">    </span> <span class="k">end</span><span class="p">)</span>
<span class="err">    </span> <span class="c1">-- If you wish to cancel the timer before it fired:</span>
<span class="err">    </span> <span class="c1">--t:Cancel()</span>
</code></pre></div>

<p>This function replaces the need to write awkward constructs involving the OnTimerExpired entry point and tracking timer handles such as shown in the final code sample:</p>

<div class="highlight"><pre class="highlight lua tab-lua"><code><span class="n">g_cnt</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">g_timer</span> <span class="o">=</span> <span class="n">C4</span><span class="p">:</span><span class="n">AddTimer</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="s2">"SECONDS"</span><span class="p">,</span> <span class="kc">true</span><span class="p">)</span>

<span class="k">function</span> <span class="nf">OnTimerExpired</span><span class="p">(</span><span class="n">idTimer</span><span class="p">)</span>
<span class="err">      </span> <span class="k">if</span> <span class="p">(</span><span class="n">idTimer</span> <span class="o">==</span> <span class="n">g_timer</span><span class="p">)</span> <span class="k">then</span>
<span class="err">             </span> <span class="nb">print</span><span class="p">(</span><span class="s2">"Timer fired"</span><span class="p">)</span>
<span class="err">             </span> <span class="n">g_cnt</span> <span class="o">=</span> <span class="n">g_cnt</span> <span class="o">+</span> <span class="mi">1</span>
<span class="err">       </span><span class="k">if</span> <span class="p">(</span><span class="n">g_cnt</span> <span class="o">&gt;</span> <span class="mi">9</span><span class="p">)</span> <span class="k">then</span>
<span class="err">              </span><span class="n">g_timer</span> <span class="o">=</span> <span class="n">C4</span><span class="p">:</span><span class="n">KillTimer</span><span class="p">(</span><span class="n">g_timer</span><span class="p">)</span>
<span class="err">       </span><span class="k">end</span>
<span class="k">end</span>
</code></pre></div>

<h2 id='gettime'>GetTime</h2>

<p>This API enables Lua drivers to retrieve the number of milliseconds since the epoch (1 January 1970 00:00:00 UT). 
See: <a href="https://en.wikipedia.org/wiki/Epoch_(computing)" title="Epoch Date in Computing">https://en.wikipedia.org/wiki/Epoch_(computing)</a></p>

<p>This API was added in conjunction with O.S. 3.2.3.</p>

<h3 id='signature'>Signature</h3>

<p><code>C4:GetTime()</code></p>
<h1 id='url-interface'>URL Interface</h1>

<h2 id='overview'>Overview</h2>

<p>This API Interface replaces the following APIs:</p>

<p><code>C4:urlGet()</code>
<code>C4:urlPost()</code>
<code>C4:urlPut()</code>
<code>C4:urlDelete()</code>
<code>C4:urlCustom()</code></p>

<p>C4:url() utilizes a more flexible callback-based object interface. A call to this function returns a C4LuaUrl object that can be set up with various callback functions and options. Once set up, a call to its methods: Get(), Post(), Put(), Delete(), or Custom() initiates the transfer.</p>

<h6 id='available-from-2-10-5'>Available from 2.10.5</h6>

<p>To the right is a basic example of how this interface can be used:</p>

<div class="highlight"><pre class="highlight lua tab-lua"><code><span class="kd">local</span> <span class="n">t</span> <span class="o">=</span> <span class="n">C4</span><span class="p">:</span><span class="n">url</span><span class="p">()</span>
 <span class="p">:</span><span class="n">OnDone</span><span class="p">(</span>
  <span class="k">function</span><span class="p">(</span><span class="n">transfer</span><span class="p">,</span> <span class="n">responses</span><span class="p">,</span> <span class="n">errCode</span><span class="p">,</span> <span class="n">errMsg</span><span class="p">)</span>
   <span class="k">if</span> <span class="p">(</span><span class="n">errCode</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">then</span>
    <span class="kd">local</span> <span class="n">lresp</span> <span class="o">=</span> <span class="n">responses</span><span class="p">[</span><span class="o">#</span><span class="n">responses</span><span class="p">]</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">"OnDone: transfer succeeded ("</span> <span class="o">..</span> <span class="o">#</span><span class="n">responses</span> <span class="o">..</span> <span class="s2">" responses received), last response code: "</span> <span class="o">..</span> <span class="n">lresp</span><span class="p">.</span><span class="n">code</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">hdr</span><span class="p">,</span><span class="n">val</span> <span class="k">in</span> <span class="nb">pairs</span><span class="p">(</span><span class="n">lresp</span><span class="p">.</span><span class="n">headers</span><span class="p">)</span> <span class="k">do</span>
     <span class="nb">print</span><span class="p">(</span><span class="s2">"OnDone: "</span> <span class="o">..</span> <span class="n">hdr</span> <span class="o">..</span> <span class="s2">" = "</span> <span class="o">..</span> <span class="n">val</span><span class="p">)</span>
    <span class="k">end</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">"OnDone: body of last response: "</span> <span class="o">..</span><span class="nb">tostring</span><span class="p">(</span><span class="n">lresp</span><span class="p">.</span><span class="n">body</span><span class="p">))</span>
   <span class="k">else</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">errCode</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="k">then</span>
     <span class="nb">print</span><span class="p">(</span><span class="s2">"OnDone: transfer was aborted"</span><span class="p">)</span>
    <span class="k">else</span>
     <span class="nb">print</span><span class="p">(</span><span class="s2">"OnDone: transfer failed with error "</span> <span class="o">..</span> <span class="n">errCode</span> <span class="o">..</span> <span class="s2">": "</span> <span class="o">..</span> <span class="n">errMsg</span> <span class="o">..</span> <span class="s2">" ("</span> <span class="o">..</span> <span class="o">#</span><span class="n">responses</span> <span class="o">..</span> <span class="s2">" responses completed)"</span><span class="p">)</span>
    <span class="k">end</span>
   <span class="k">end</span>
  <span class="k">end</span><span class="p">)</span>
 <span class="p">:</span><span class="n">SetOptions</span><span class="p">({</span>
  <span class="p">[</span><span class="s2">"fail_on_error"</span><span class="p">]</span> <span class="o">=</span> <span class="kc">false</span><span class="p">,</span>
  <span class="p">[</span><span class="s2">"timeout"</span><span class="p">]</span> <span class="o">=</span> <span class="mi">30</span><span class="p">,</span>
  <span class="p">[</span><span class="s2">"connect_timeout"</span><span class="p">]</span> <span class="o">=</span> <span class="mi">10</span>
 <span class="p">})</span>
 <span class="p">:</span><span class="n">Get</span><span class="p">(</span><span class="s2">"http://www.example.com"</span><span class="p">,</span> <span class="p">{</span> <span class="p">[</span><span class="s2">"Expect"</span><span class="p">]</span> <span class="o">=</span> <span class="s2">"100-continue"</span> <span class="p">})</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">"scheduled url transfer with id "</span> <span class="o">..</span> <span class="n">t</span><span class="p">:</span><span class="n">TicketId</span><span class="p">())</span>
</code></pre></div>

<p>The C4LuaUrl Object that is returned supports the APIs defined in this section.</p>

<h2 id='cancel'>Cancel</h2>

<p>Cancels a transfer that has been started by a call to the <a href="https://snap-one.github.io/docs-driverworks-api/#get">Get()</a>, <a href="https://snap-one.github.io/docs-driverworks-api/#post">Post()</a>, <a href="https://snap-one.github.io/docs-driverworks-api/#put">Put(</a>), <a href="https://snap-one.github.io/docs-driverworks-api/#delete">Delete()</a>, or <a href="https://snap-one.github.io/docs-driverworks-api/#custom">Custom()</a> methods. The C4LuaUrl object cannot be re-used after canceling a transfer.  A new instance will need to be created by a call to <a href="https://snap-one.github.io/docs-driverworks-api/#url-interface">C4:url()</a>.</p>

<p><h6 id='available-from-2-10-5'>Available from 2.10.5</h6><h3 id='signature'>Signature</h3>
<p><code>C4:Cancel()</code></p>
<h3 id='parameters'>Parameters</h3>
<p><code>None</code></p>
<h3 id='returns'>Returns</h3>
<p>Returns a reference to itself.</p></p>

<h2 id='custom'>Custom</h2>

<p>Starts a HTTP transfer with a custom request method as specified by the method argument.</p>

<p><h6 id='available-from-2-10-5'>Available from 2.10.5</h6><h3 id='signature'>Signature</h3>
<p><code>C4:Custom(url, method data, headers)</code></p></p>

<table><thead>
<tr>
<th>Parameter</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>url</td>
<td>String of the URL to perform the PUT method on.</td>
</tr>
<tr>
<td>str</td>
<td>String of the request method.</td>
</tr>
<tr>
<td>str</td>
<td>String of the request body to be sent.</td>
</tr>
<tr>
<td>table</td>
<td>A table of request headers and values to be sent.</td>
</tr>
</tbody></table>

<h2 id='delete'>Delete</h2>

<p>Starts a HTTP DELETE transfer.</p>

<p><h6 id='available-from-2-10-5'>Available from 2.10.5</h6><h3 id='signature'>Signature</h3>
<p><code>C4:Delete(url, data, headers)</code></p></p>

<table><thead>
<tr>
<th>Parameter</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>url</td>
<td>String of the URL to perform the DELETE method on.</td>
</tr>
<tr>
<td>table</td>
<td>A table of request headers and values to be sent.</td>
</tr>
</tbody></table>

<h3 id='returns'>Returns</h3>

<p>A reference to itself.</p>

<h2 id='get'>Get</h2>

<p>Starts a HTTP GET transfer.</p>

<p><h6 id='available-from-2-10-5'>Available from 2.10.5</h6><h3 id='signature'>Signature</h3>
<p><code>C4:Get(url, headers)</code></p></p>

<table><thead>
<tr>
<th>Parameter</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>url</td>
<td>String of the URL to perform the  GET E method on.</td>
</tr>
<tr>
<td>table</td>
<td>A table of request headers and values to be sent.</td>
</tr>
</tbody></table>

<h3 id='returns'>Returns</h3>

<p>A reference to itself.</p>

<h2 id='onbody'>OnBody</h2>

<p>Sets a callback function that will be called each time a response body has finished transferring. This function is called after the callback functions set by <a href="https://snap-one.github.io/docs-driverworks-api/#onheaders">OnHeaders()</a> and <a href="https://snap-one.github.io/docs-driverworks-api/#onbodychunk">OnBodyChunk()</a> but before the callback function set by <a href="https://snap-one.github.io/docs-driverworks-api/#ondone">OnDone()</a>. Note that this method can only be called before a transfer was started.</p>

<p><h6 id='available-from-2-10-5'>Available from 2.10.5</h6><h3 id='signature'>Signature</h3>
<p><code>C4:OnBody(func)</code></p></p>

<table><thead>
<tr>
<th>Parameter</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>func</td>
<td>A callback function of type func (transfer, response). Returning true from this function aborts the transfer.</td>
</tr>
</tbody></table>

<h3 id='usage-note'>Usage Note</h3>

<p>The transfer argument is the C4LuaUrl object that was created by the call to <a href="https://snap-one.github.io/docs-driverworks-api/#url-interface">C4:url()</a>.</p>

<h3 id='returns'>Returns</h3>

<p>A reference to itself.</p>

<p>The response table contains the following keys:</p>

<table><thead>
<tr>
<th>Key</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>code</td>
<td>num</td>
<td>The status code of the response, e.g. 200, 404,...</td>
</tr>
<tr>
<td>headers</td>
<td>table</td>
<td>A table of all received headers and their value(s)</td>
</tr>
<tr>
<td>body</td>
<td>str</td>
<td>The entire response body as a string. This key is absent if a callback was set with OnBodyChunk().</td>
</tr>
</tbody></table>

<p>The same response table will be passed to the callback set by <a href="https://snap-one.github.io/docs-driverworks-api/#ondone">OnDone()</a>.  Any modifications to this table will persist, but not affect the transfer in any way.</p>

<h2 id='onbodychunk'>OnBodychunk</h2>

<p>Sets a callback function that will be called each time a chunk of the response body has transferred.  This does not necessarily correlate to chunks in the context of the HTTP &quot;chunked&quot; transfer encoding. This function may be called multiple times for each response, following the callback function set by OnHeaders() and before the callback function set by <a href="https://snap-one.github.io/docs-driverworks-api/#onbody">OnBody()</a> and <a href="https://snap-one.github.io/docs-driverworks-api/#ondone">OnDone()</a>. Note that this method can only be called before a transfer was started. This callback function is not needed for most use-cases.</p>

<p><h6 id='available-from-2-10-5'>Available from 2.10.5</h6><h3 id='signature'>Signature</h3>
<p><code>C4:OnBodyChunk(func)</code></p></p>

<table><thead>
<tr>
<th>Parameter</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>func</td>
<td>A callback function of type func (transfer, response, chunk). Returning true from this function aborts the transfer.</td>
</tr>
</tbody></table>

<h3 id='usage-note'>Usage Note</h3>

<p>The transfer argument is the C4LuaUrl object that was created by the call to <a href="https://snap-one.github.io/docs-driverworks-api/#url-interface">C4:url()</a>.</p>

<h3 id='returns'>Returns</h3>

<p>A reference to itself.</p>

<p>The response table contains the following keys:</p>

<table><thead>
<tr>
<th>Key</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>code</td>
<td>num</td>
<td>The status code of the response, e.g. 200, 404,...</td>
</tr>
<tr>
<td>headers</td>
<td>table</td>
<td>A table of all received headers and their value(s)</td>
</tr>
</tbody></table>

<p>The same response table will be passed to the callbacks set by <a href="https://snap-one.github.io/docs-driverworks-api/#onbody">OnBody()</a> and <a href="https://snap-one.github.io/docs-driverworks-api/#ondone">OnDone()</a>. Any modifications to this table will persist, but not affect the transfer in any way.</p>

<p>The chunk argument is a string of the received chunk of the response body.  By using the <a href="https://snap-one.github.io/docs-driverworks-api/#onbodychunk">OnBodyChunk()</a> callback, it is up to the driver process and/or store the data as needed.  In this case, the interface does not aggregate the response body, and it is not stored in the body key of the response table.</p>

<h2 id='ondone'>OnDone</h2>

<p>Sets a callback function that will be called when the entire transfer succeeded or failed.  It is only called once at the end of the entire transfer regardless of how many responses have been received. Note that this method can only be called before a transfer was started.</p>

<p><h6 id='available-from-2-10-5'>Available from 2.10.5</h6><h3 id='signature'>Signature</h3>
<p><code>C4:OnDone(func)</code></p></p>

<table><thead>
<tr>
<th>PArameter</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>func</td>
<td>A callback function of type func(transfer, responses, errCode, errMsg).</td>
</tr>
</tbody></table>

<h3 id='usage-note'>Usage Note</h3>

<p>The transfer argument is the C4LuaUrl object that was created by the call to <a href="https://snap-one.github.io/docs-driverworks-api/#url-interface">C4:url()</a>. The responses argument receives a table (array) of the response tables in the order that they were received.  These response tables are the same ones that were passed to the callback functions set by <a href="https://snap-one.github.io/docs-driverworks-api/#onheaders">OnHeaders()</a>, <a href="https://snap-one.github.io/docs-driverworks-api/#onbody">OnBody()</a>, and <a href="https://snap-one.github.io/docs-driverworks-api/#onbodychunk">OnBodyChunk()</a>.</p>

<p>If the transfer succeeded, the errCode argument will be 0 and errMsg will be nil.  If the transfer was aborted by one of the callback functions the errCode argument will be -1.  Otherwise, errCode will hold a number with an error code and the errMsg argument will contain a string with details.</p>

<p>Once the transfer has completed (or failed), the C4LuaUrl object cannot be re-used.  A new instance will need to be created by a call to <a href="https://snap-one.github.io/docs-driverworks-api/#url-interface">C4:url()</a>.</p>

<h3 id='returns'>Returns</h3>

<p>A reference to itself.</p>

<h2 id='onheaders'>OnHeaders</h2>

<p>Sets a callback function that will be called each time all of the headers of a response have been received but, before the response body has been received. This function may be called multiple times, e.g. due to redirects. Note that this method can only be called before a transfer was started.</p>

<p><h6 id='available-from-2-10-5'>Available from 2.10.5</h6><h3 id='signature'>Signature</h3>
<p><code>C4:OnHeaders(func)</code></p></p>

<table><thead>
<tr>
<th>Parameter</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>func</td>
<td>A callback function of type func (transfer, response, chunk). Returning true from this function aborts the transfer.</td>
</tr>
</tbody></table>

<h3 id='usage-note'>Usage Note</h3>

<p>The transfer argument is the C4LuaUrl object that was created by the call to <a href="https://snap-one.github.io/docs-driverworks-api/#url-interface">C4:url()</a>.</p>

<h3 id='returns'>Returns</h3>

<p>A reference to itself.</p>

<p>The response table contains the following keys:</p>

<table><thead>
<tr>
<th>Key</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>code</td>
<td>num</td>
<td>The status code of the response, e.g. 200, 404,...</td>
</tr>
<tr>
<td>headers</td>
<td>table</td>
<td>A table of all received headers and their value(s)</td>
</tr>
</tbody></table>

<p>The same response table will be passed to the callbacks set by the following:</p>

<p><a href="https://snap-one.github.io/docs-driverworks-api/#onbody">OnBody()</a></p>

<p><a href="https://snap-one.github.io/docs-driverworks-api/#onbodychunk">OnBodyChunk()</a></p>

<p><a href="https://snap-one.github.io/docs-driverworks-api/#ondone">OnDone()</a></p>

<p>Any modifications to this table will persist but not affect the transfer in any way.</p>

<h3 id='example'>Example</h3><div class="highlight"><pre class="highlight lua tab-lua"><code><span class="n">OnHeaders</span><span class="p">(</span>
    <span class="k">function</span><span class="p">(</span><span class="n">transfer</span><span class="p">,</span> <span class="n">response</span><span class="p">)</span>
        <span class="c1">-- transfer is the object returned by C4:url()</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">"OnHeaders: status code: "</span> <span class="o">..</span> <span class="n">response</span><span class="p">.</span><span class="n">code</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">hdr</span><span class="p">,</span><span class="n">val</span> <span class="k">in</span> <span class="nb">pairs</span><span class="p">(</span><span class="n">resp</span><span class="p">.</span><span class="n">headers</span><span class="p">)</span> <span class="k">do</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">"OnHeaders: header "</span> <span class="o">..</span> <span class="n">hdr</span> <span class="o">..</span> <span class="s2">" = "</span> <span class="o">..</span> <span class="n">val</span><span class="p">)</span>
        <span class="k">end</span>
        <span class="c1">-- return true -- to abort the transfer</span>
    <span class="k">end</span>
</code></pre></div>
<h2 id='post'>Post</h2>
<p>Starts a HTTP POST transfer.</p>
<h6 id='available-from-2-10-5'>Available from 2.10.5</h6><h3 id='signature'>Signature</h3>

<p><code>C4:Post(url, data, headers </code></p>

<table><thead>
<tr>
<th>Parameter</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>url</td>
<td>String of the URL to perform the POST method on.</td>
</tr>
<tr>
<td>str</td>
<td>String of the request body to be sent.</td>
</tr>
<tr>
<td>table</td>
<td>A table of request headers and values to be sent.</td>
</tr>
</tbody></table>

<h3 id='returns'>Returns</h3>

<p>A reference to itself.</p>

<h2 id='put'>Put</h2>

<p>Starts a HTTP POST transfer.</p>

<p><h6 id='available-from-3-0-0'>Available from 3.0.0</h6><h3 id='signature'>Signature</h3>
<p><code>C4:Put (url, data, headers </code></p></p>

<table><thead>
<tr>
<th>Parameter</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>url</td>
<td>String of the URL to perform the POST method on.</td>
</tr>
<tr>
<td>str</td>
<td>String of the request body to be sent.</td>
</tr>
<tr>
<td>table</td>
<td>A table of request headers and values to be sent.</td>
</tr>
</tbody></table>

<h3 id='returns'>Returns</h3>

<p>A reference to itself.</p>

<h3 id='usage-note'>Usage Note</h3>

<p>This API should only be used in conjunction with Control4 OS 3 and later.</p>

<h2 id='setoption'>SetOption</h2>

<p>Sets one option specified by name to value. Note that this method can only be called before a transfer was started. </p>

<p><h6 id='available-from-2-10-5'>Available from 2.10.5</h6><h3 id='signature'>Signature</h3>
<p><code>C4:SetOption(name, value)</code></p></p>

<table><thead>
<tr>
<th>Parameter</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>str</td>
<td>String value of the name of the parameter.</td>
</tr>
<tr>
<td>bool</td>
<td>Value - Boolean value (number or string) of the parameter.</td>
</tr>
</tbody></table>

<p>Below is a list of valid option names and their values</p>

<p><code>fail\_on\_error</code>
boolean:</p>

<p>Defaults to true.  If any response returns with an error code, the entire transfer fails with an error.  If set to false, allows the driver to e.g. read the HTTP response body of a 403 error response.</p>

<p><code>timeout</code>
number:</p>

<p>In seconds.  Defaults to 300 or whatever value was set through C4:urlSetTimeout().  This is how many seconds, total, the entire transfer is allowed to take.</p>

<p><code>connect\_timeout</code>
number:</p>

<p>In seconds. Defaults to 5.  This is how many seconds it is allowed to take to establish the connection to the host.</p>

<p><code>ssl\_verify\_host</code>
boolean:</p>

<p>Defaults to true.  Verify the host against the system&#39;s CA bundle when using the https protocol.</p>

<p><code>ssl\_verify\_peer</code>
boolean:</p>

<p>Defaults to true.  Verify the peer against the system&#39;s CA bundle when using the https protocol.</p>

<p><code>ssl\_cabundle</code>
string:</p>

<p>A filename relative to the .c4z that specifies a CA bundle to use instead of the system&#39;s.  It is not recommended to use this option except for very special use cases because CA bundles require regular updates.</p>

<p><code>ssl\_cert</code>
ssl_cert:</p>

<p>A filename relative to the .c4z that specifies a SSL client certificate to use for authentication to the host.</p>

<p><code>ssl\_cert\_type</code>
string:</p>

<p>Defaults to &quot;PEM&quot;.  The format of the SSL certificate that the file specified by the &quot;ssl_cert&quot; option is in.  Valid values are: &quot;PEM&quot; (default), &quot;DER&quot;, &quot;P12&quot;.</p>

<p><code>ssl\_key</code>
string:</p>

<p>A filename relative to the .c4z that specifies the private key for the client certificate specified by the &quot;ssl_cert&quot; option.</p>

<p><code>ssl\_passwd</code>
string:</p>

<p>If the private key specified by the &quot;ssl_key&quot; option is encrypted, this option specifies the password.</p>

<p><code>ssl\_cacerts</code>
table:</p>

<p>A table of filenames relative to the .c4z that specify additional certificates to be added to the CA bundle used to verify the host and/or peer.  This allows e.g. extending the CA bundle to be able to verify against self-signed or company-signed certificates.</p>

<h3 id='returns'>Returns</h3>

<p>A reference to itself.</p>

<h2 id='setoptions'>SetOptions</h2>

<p>This API is similar to the <a href="https://snap-one.github.io/docs-driverworks-api/#setoption">SetOption()</a> method, but allows the driver to pass in a table of options and their values. Note that this method can only be called before a transfer was started.</p>

<p><h6 id='available-from-2-10-5'>Available from 2.10.5</h6><h3 id='signature'>Signature</h3>
<p><code>C4:SetOptions(options)</code></p></p>

<table><thead>
<tr>
<th>Parameter</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>table</td>
<td>Table of options and their values:</td>
</tr>
</tbody></table>

<p>Below is a list of valid option names and their values</p>

<p><code>response_headers_duplicates</code>
boolean:</p>

<p>If set to true and duplicate response headers are received, the tHeader table will have an array of string values for this header. If set to false (default) and duplicate response headers are received, only the last header received will be saved to the tHeader table. This option defaults to false.</p>

<p><code>cookies_enable</code>
 boolean:</p>

<p>If set to true, enables the use of cookies.  If the <code>cookies_use_jar</code> option is set to true, this causes cookies to be stored in the driver&#39;s cookie jar. If set to false (default) and a Set-Cookie header is received, the cookie will neither be stored in the driver&#39;s cookie jar, nor will it be used with any redirect request that may automatically be performed. This option defaults to false.</p>

<p><code>cookies_use_jar</code>
boolean:</p>

<p>If set to true (default), uses cookies in the driver&#39;s cookie jar. If set to false, this transfer does not use any cookies that may be stored in the driver&#39;s cookie jar. This option defaults to true.</p>

<p><code>cookies_save_to_jar</code>
boolean:</p>

<p>If set to true (default), saves any new cookies to the driver&#39;s cookie jar. This may also delete expired cookies from the cookie jar.
If set to false, any cookies received from this transfer will not be saved to the jar.
This option defaults to true.</p>

<p><code>cookies_clear_session</code>
boolean:</p>

<p>If set to true, clears any &quot;session&quot; cookies (cookies with no expiration time) from this transfer prior to making the request.  This does not remove them from the driver&#39;s cookie jar, but if the <code>cookies_save_to_jar&quot;</code>option is set to true, it will remove them from the cookie jar once the transfer completes. If set to false (default), session cookies are used for this transfer. This option defaults to false.</p>

<h3 id='returns'>Returns</h3>

<p>A reference to itself.</p>

<h2 id='ticketid'>TicketId</h2>

<p>Returns the Ticket ID (a number) of a running transfer.  If the transfer is not running, the value 0 is returned.</p>

<p><h6 id='available-from-2-10-5'>Available from 2.10.5</h6><h3 id='signature'>Signature</h3>
<p><code>C4:TicketId() </code></p>
<h3 id='parameters'>Parameters</h3>
<p><code>None</code></p>
<h3 id='returns'>Returns</h3>
<table><thead>
<tr>
<th>Value</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>num</td>
<td>A number identifying the running transfer, otherwise 0.</td>
</tr>
</tbody></table></p>
<h1 id='variable-interface'>Variable Interface</h1>

<h2 id='addvariable'>AddVariable</h2>

<p>Function called from a DriverWorks driver to create a Control4 variable for the driver. Note that Variables need to be added in OnDriverInit. Programming attached to variables added after OnDriverInit may not work properly on Director restart.</p>

<p><h6 id='available-from-1-6-0'>Available from 1.6.0.</h6><h3 id='signature'>Signature</h3>
<p><code>C4:AddVariable(identifier, strValue, strVarType, [bReadOnly], [bHidden]) </code></p></p>

<table><thead>
<tr>
<th>Parameter</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>identifier</td>
<td>A string or number that uniquely identifies the variable to be added. If a number it must be greater than zero.</td>
</tr>
<tr>
<td>strValue</td>
<td>String. If strVartype equals “BOOL” then “1” = true, “0” = false. Note, that valid values are 0 and 1 and need to be passed as strings.</td>
</tr>
<tr>
<td>strVarType</td>
<td>String. See variable types below.</td>
</tr>
<tr>
<td>bReadOnly</td>
<td>Boolean. ReadOnly: Optional, defaults to FALSE</td>
</tr>
<tr>
<td>bHidden</td>
<td>Boolean. Hidden: Optional, defaults to FALSE.  A flag indicating whether the variable is hidden.</td>
</tr>
</tbody></table>

<h3 id='usage-notes'>Usage Notes</h3>

<p>There is no limit to the string length for a variable created using AddVariable. This can be done inside a driver programmatically or within Composer Pro.</p>

<p>Valid variable types are: </p>

<ul>
<li>BOOL: If strVartype equals “BOOL” then “1” = true, “0” = false. Note, that valid values are 0 and 1 and need to be passed as strings.</li>
<li>DEVICE: Device ID. </li>
<li>FLOAT: Sets to a floating point number.</li>
<li>INT: Sets to a whole number.</li>
<li>MEDIA: Supports selectable Media through ComposerPro. Note that the media data returned by the API is in XML format.</li>
<li>NUMBER: Sets to a Number.</li>
<li>ROOM:  Room ID for a specific room or another driver’s room variable.</li>
<li>STRING: Sets to a string value.</li>
</ul>

<p>While the following variable type can be successfully passed within the API, functionality will be supported in a future release.</p>

<ul>
<li>STATE</li>
<li>TIME</li>
<li>ULONG</li>
<li>XML</li>
<li>LEVEL</li>
<li>LIST</li>
</ul>

<h3 id='returns'>Returns</h3>

<table><thead>
<tr>
<th>Value</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>True</td>
<td>Indicates that the variable was added successfully.</td>
</tr>
<tr>
<td>ID</td>
<td>ID of the variable that was added.</td>
</tr>
<tr>
<td>False</td>
<td>Indicates that the variable could not be added. Failure generally occurs when either the name or ID is not unique.</td>
</tr>
</tbody></table>

<h3 id='usage-note'>Usage Note</h3>

<p>If the variable ID is identified by number, then this matches the value specified in the identifier argument.</p>

<h3 id='usage-note-2'>Usage Note</h3>

<p>Variables should always be added in the same order. Control4 Composer programming is based on VariableID’s, which are allocated in order during AddVariable calls. In other words, if you add a set of variables then later delete them and re-add different variables or in a different order, Composer programming will be incorrect.</p>

<p>When adding a variable by name (i.e.,identifier parameter is a string), the ID of the variable is computed. The default value of the first variable added by name is 1001, then 1002 for the second variable, and so forth. If the computed ID matches that of an existing variable, then the next available unique ID in the sequence is selected. For example, consider the following code to the right:</p>

<div class="highlight"><pre class="highlight lua tab-lua"><code><span class="kd">local</span> <span class="n">result</span><span class="p">,</span> <span class="n">id</span> <span class="o">=</span> <span class="n">C4</span><span class="p">:</span><span class="n">AddVariable</span><span class="p">(</span><span class="mi">1002</span><span class="p">,</span><span class="err"> </span><span class="s2">"Foo"</span><span class="p">,</span><span class="err"> </span><span class="s2">"STRING"</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">,</span> <span class="n">id</span><span class="p">)</span>
<span class="err"> </span>
<span class="n">result</span><span class="p">,</span> <span class="n">id</span> <span class="o">=</span> <span class="n">C4</span><span class="p">:</span><span class="n">AddVariable</span><span class="p">(</span><span class="s2">"Biz"</span><span class="p">,</span><span class="err"> </span><span class="s2">"Baz"</span><span class="p">,</span><span class="err"> </span><span class="s2">"STRING"</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">,</span> <span class="n">id</span><span class="p">)</span>
<span class="err"> </span>
<span class="n">result</span><span class="p">,</span> <span class="n">id</span> <span class="o">=</span> <span class="n">C4</span><span class="p">:</span><span class="n">AddVariable</span><span class="p">(</span><span class="s2">"Yaz"</span><span class="p">,</span><span class="err"> </span><span class="s2">"Yap"</span><span class="p">,</span><span class="err"> </span><span class="s2">"STRING"</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">,</span> <span class="n">id</span><span class="p">)</span>

<span class="n">Executing</span> <span class="n">this</span> <span class="n">code</span> <span class="n">prints</span> <span class="n">the</span> <span class="n">following</span><span class="p">:</span>

<span class="kc">true</span><span class="err"> </span> <span class="err"> </span> <span class="mi">1002</span>
<span class="kc">true</span><span class="err"> </span> <span class="err"> </span> <span class="mi">1001</span>
<span class="kc">true</span><span class="err"> </span> <span class="err"> </span> <span class="mi">1003</span>
</code></pre></div>

<p>Note that when adding the third variable (&quot;yaz&quot;), the computed ID is 1003. This occurs because on line 1 we added a variable with ID 1002. As a result, the next available ID is 1003.</p>

<p>When adding a variable by number (i.e., identifier is a number), the name of the variable is computed to be a string representation of the specified ID. Note that the computed name must be unique among all existing variables. The following code illustrates this problem:</p>

<div class="highlight"><pre class="highlight lua tab-lua"><code><span class="kd">local</span> <span class="n">result</span><span class="p">,</span> <span class="n">id</span> <span class="o">=</span> <span class="n">C4</span><span class="p">:</span><span class="n">AddVariable</span><span class="p">(</span><span class="s2">"1001"</span><span class="p">,</span><span class="err"> </span><span class="s2">"Foo"</span><span class="p">,</span><span class="err"> </span><span class="s2">"STRING"</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">,</span> <span class="n">id</span><span class="p">)</span>

<span class="n">result</span><span class="p">,</span> <span class="n">id</span> <span class="o">=</span> <span class="n">C4</span><span class="p">:</span><span class="n">AddVariable</span><span class="p">(</span><span class="mi">1001</span><span class="p">,</span><span class="err"> </span><span class="s2">"Bar"</span><span class="p">,</span><span class="err"> </span><span class="s2">"STRING"</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">,</span> <span class="n">id</span><span class="p">)</span>
<span class="err">﻿</span>
<span class="n">Executing</span> <span class="n">this</span> <span class="n">code</span> <span class="n">prints</span> <span class="n">the</span> <span class="n">following</span><span class="p">:</span>
<span class="kc">true</span><span class="p">,</span><span class="err"> </span> <span class="err"> </span> <span class="mi">1001</span>
<span class="kc">false</span>
</code></pre></div>

<p>The second call to C4:AddVariable fails because on line 1 we added a variable with name &quot;1001&quot;.</p>

<h2 id='deletevariable'>DeleteVariable</h2>

<p>Function called from a DriverWorks driver to delete a Control4 variable for the driver. This API should not be invoked during OnDriverInit</p>

<p><h6 id='available-from-1-6-0'>Available from 1.6.0.</h6><h3 id='signature'>Signature</h3>
<p><code>C4:DeleteVariable(identifier) </code>   </p></p>

<table><thead>
<tr>
<th>Parameter</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>str/num</td>
<td>A str or num that uniquely identifies the variable to be deleted.</td>
</tr>
</tbody></table>

<h3 id='usage-note'>Usage Note</h3>

<p>If string is used, then the variable is located by name. If the value is a number, then the variable is located by ID. In addition, the value of a numeric identifier must be 
 | greater than zero. </p>

<h3 id='returns'>Returns</h3>

<p><code>None</code></p>

<h3 id='example'>Example</h3>

<p>Deletes the device variable named Driver Variable&quot; from the Control4 system</p>

<p><code>C4:DeleteVariable(&quot;Driver Variable&quot;)</code></p>

<h2 id='driverworks-variable-table'>DriverWorks Variable Table</h2>

<p>The Lua Table ‘Variables’ contains the current value of this driver’s variables.  Although you can read directly from this table, to change the value of a device variable, you should use: <code>C4:SetVariable(strName, strValue)</code></p>

<p><h6 id='available-from-1-6-0'>Available from 1.6.0.</h6><h3 id='examples'>Examples</h3><div class="highlight"><pre class="highlight lua tab-lua"><code><span class="n">Use</span> <span class="n">Variables</span> <span class="k">in</span> <span class="n">a</span> <span class="n">comparison</span><span class="p">:</span>
<span class="k">if</span> <span class="p">(</span><span class="n">Variables</span><span class="p">[</span><span class="s2">&quot;Power State&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;OFF&quot;</span><span class="p">)</span> <span class="k">then</span>
    <span class="n">C4</span><span class="p">:</span><span class="n">SendToSerial</span><span class="p">(</span><span class="n">idSerialBinding</span><span class="p">,</span> <span class="s2">&quot;<strong>ON</strong>&quot;</span><span class="p">)</span>
    <span class="n">C4</span><span class="p">:</span><span class="n">SetVariable</span><span class="p">(</span><span class="s2">&quot;Power State&quot;</span><span class="p">,</span> <span class="s2">&quot;ON&quot;</span><span class="p">)</span>
<span class="k">end</span>
</code></pre></div>
<p>Print out all Variables:</p>
<div class="highlight"><pre class="highlight lua tab-lua"><code><span class="k">for</span> <span class="n">VariableName</span><span class="p">,</span> <span class="n">VariableValue</span> <span class="k">in</span> <span class="nb">pairs</span><span class="p">(</span><span class="n">Variables</span><span class="p">)</span> <span class="k">do</span> 
    <span class="nb">print</span><span class="p">(</span><span class="n">VariableName</span><span class="p">,</span> <span class="n">VariableValue</span><span class="p">)</span> 
<span class="k">end</span>
</code></pre></div>
<h2 id='getvariable'>GetVariable</h2>
<p>Function called by a DriverWorks driver to get the value of a variable. This API should not be invoked during OnDriverInit.</p>
<h6 id='available-from-1-6-0'>Available from 1.6.0.</h6><h3 id='signature'>Signature</h3>
<p><code>C4:GetVariable(idDevice, idVariable)</code>  </p></p>

<table><thead>
<tr>
<th>Parameter</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>num</td>
<td>Device ID of the device that owns the specified variable</td>
</tr>
<tr>
<td>num</td>
<td>Variable ID of the specified variable</td>
</tr>
</tbody></table>

<h3 id='returns'>Returns</h3>

<table><thead>
<tr>
<th>Value</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>str</td>
<td>String Value of the requested variable, nil if not found.</td>
</tr>
</tbody></table>

<h3 id='usage-note'>Usage Note</h3>

<p>User Variables belong to the Variable Agent, with a DeviceID of 100001.</p>

<h3 id='examples'>Examples</h3>

<p>Gets and prints the value of the HVAC mode and temperature variables of a Control4 Thermostat registered in the project as 
Device ID 84:</p>

<div class="highlight"><pre class="highlight lua tab-lua"><code><span class="nb">print</span><span class="p">(</span><span class="n">C4</span><span class="p">:</span><span class="n">GetVariable</span><span class="p">(</span><span class="mi">84</span><span class="p">,</span> <span class="mi">1000</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">C4</span><span class="p">:</span><span class="n">GetVariable</span><span class="p">(</span><span class="mi">84</span><span class="p">,</span> <span class="mi">1003</span><span class="p">))</span>
</code></pre></div>

<p>Gets and prints the User Variable registered with the project as variable 209:</p>

<div class="highlight"><pre class="highlight lua tab-lua"><code><span class="nb">print</span><span class="p">(</span><span class="n">C4</span><span class="p">:</span><span class="n">GetVariable</span><span class="p">(</span><span class="mi">100001</span><span class="p">,</span> <span class="mi">209</span><span class="p">))</span>
</code></pre></div>

<h2 id='getdevicevariable'>GetDeviceVariable</h2>

<p>Function called by a DriverWorks driver to get the value of another device&#39;s variable. This API should not be invoked during OnDriverInit.</p>

<p><h6 id='available-from-1-6-0'>Available from 1.6.0.</h6><h3 id='signature'>Signature</h3>
<p><code>C4:GetDeviceVariable(idDevice, idVariable)</code>    </p></p>

<table><thead>
<tr>
<th>Parameter</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>num</td>
<td>Device ID of the device that owns the specified variable</td>
</tr>
<tr>
<td>num</td>
<td>Variable ID of the specified variable</td>
</tr>
</tbody></table>

<h3 id='returns'>Returns</h3>

<table><thead>
<tr>
<th>Returns</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>str</td>
<td>String Value of the requested variable, nil if not found.</td>
</tr>
</tbody></table>

<h3 id='usage-note'>Usage Note</h3>

<p>User Variables belong to the Variable Agent, with a DeviceID of 100001.</p>

<h3 id='examples'>Examples</h3>

<p>Gets and prints the value of the HVAC mode and temperature variables of a Control4 Thermostat registered in the project as Device ID 84:</p>

<div class="highlight"><pre class="highlight lua tab-lua"><code><span class="nb">print</span><span class="p">(</span><span class="n">C4</span><span class="p">:</span><span class="n">GetDeviceVariable</span><span class="p">(</span><span class="mi">84</span><span class="p">,</span> <span class="mi">1000</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">C4</span><span class="p">:</span><span class="n">GetDeviceVariable</span><span class="p">(</span><span class="mi">84</span><span class="p">,</span> <span class="mi">1003</span><span class="p">))</span>
</code></pre></div>

<h2 id='setdevicevariable'>SetDeviceVariable</h2>

<p>Function called from a DriverWorks driver to set the value of another driver or device&#39;s variable. This API should not be invoked during OnDriverInit.</p>

<p><h6 id='available-from-1-6-0'>Available from 1.6.0.</h6><h3 id='signature'>Signature</h3>
<p><code>C4:SetDeviceVariable(DeviceID, variableID, strValue)</code>  </p></p>

<table><thead>
<tr>
<th>Parameter</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>num</td>
<td>ID value of the device</td>
</tr>
<tr>
<td>num</td>
<td>ID of variable to set</td>
</tr>
<tr>
<td>str</td>
<td>Value to set variable</td>
</tr>
</tbody></table>

<h3 id='returns'>Returns</h3>

<p><code>None</code></p>

<h3 id='usage-note'>Usage Note</h3>

<p>User Variables belong to the Variable Agent, with a DeviceID of 100001.</p>

<h3 id='examples'>Examples</h3>

<p>Sets the device variable value of the device with ID of 10 and variable ID of 1005 to 90:</p>

<p><code>C4:SetDeviceVariable(10, 1005, 90)</code></p>

<h2 id='setvariable'>SetVariable</h2>

<p>Function called from a DriverWorks driver to set the value of the current driver&#39;s variable. This API should not be invoked during OnDriverInit</p>

<p><h6 id='available-from-1-6-0'>Available from 1.6.0.</h6><h3 id='signature'>Signature</h3>
<p><code>C4:SetVariable(identifier, strValue)</code></p></p>

<table><thead>
<tr>
<th>Parameter</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>identifier</td>
<td>A string or number that uniquely identifies the variable to be added. If the identifier value is a string, then the variable is located by name. If the value is a number, then the variable is located by ID. In addition, the value of any numeric identifier must be greater than zero.</td>
</tr>
<tr>
<td>strValue</td>
<td>The value passed here is variable type dependent. See supported variable types in the <a href="https://snap-one.github.io/docs-driverworks-api/#addvariable">AddVariable</a> API.</td>
</tr>
</tbody></table>

<h3 id='returns'>Returns</h3>

<p><code>None</code></p>

<h3 id='examples'>Examples</h3>

<p>Sets the value of the device variable named “Driver Variable” to 90:</p>

<p><code>C4:SetVariable(&quot;Driver Variable&quot;, 90)</code></p>

<h2 id='onvariablechanged'>OnVariableChanged</h2>

<p>Function called by Director when one of this driver’s variables’ values is changed.</p>

<p><h6 id='available-from-1-6-0'>Available from 1.6.0.</h6><h3 id='signature'>Signature</h3>
<p><code>C4:OnVariableChanged(strName)</code> </p></p>

<table><thead>
<tr>
<th>Parameter</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>str</td>
<td>Name of variable that has changed</td>
</tr>
</tbody></table>

<h3 id='returns'>Returns</h3>

<p><code>None</code></p>

<h3 id='usage-notes'>Usage Notes</h3>

<p>OnVariableChanged is NOT called on a driver when it changes its own variable’s value. The value of the variable that has changed can be found with: Variables strName</p>

<h3 id='example'>Example</h3>

<p>This simple function prints to the Lua Output window in Composer when any variable on that device changes and includes the variable name and value.</p>

<div class="highlight"><pre class="highlight lua tab-lua"><code><span class="k">function</span> <span class="nf">OnVariableChanged</span><span class="p">(</span><span class="n">strName</span><span class="p">)</span>
  <span class="nb">print</span><span class="p">(</span><span class="s2">"Variable value changed - variable named: "</span> <span class="o">..</span> <span class="n">strName</span><span class="p">)</span>
  <span class="nb">print</span><span class="p">(</span><span class="s2">" ... new value is: "</span> <span class="o">..</span> <span class="n">Variables</span><span class="p">[</span><span class="n">strName</span><span class="p">])</span>
<span class="k">end</span>
</code></pre></div>

<h2 id='onwatchedvariablechanged'>OnWatchedVariableChanged</h2>

<p>Function called by Director when a Control4 variable changes value.</p>

<p><h6 id='available-from-1-6-0'>Available from 1.6.0.</h6><h3 id='signature'>Signature</h3>
<p><code>C4:OnWatchedVariableChanged(idDevice, idVariable, strValue)</code>   </p></p>

<table><thead>
<tr>
<th>Parameter</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>num</td>
<td>Device ID of the device that owns the changed variable</td>
</tr>
<tr>
<td>num</td>
<td>Variable ID of the changed variable</td>
</tr>
<tr>
<td>str</td>
<td>New value of variable that has changed</td>
</tr>
</tbody></table>

<h3 id='returns'>Returns</h3>

<p><code>None</code></p>

<h3 id='usage-note'>Usage Note</h3>

<p>Watched variables are variables that belong to other devices in the system, not variables that necessarily belong to a DriverWorks driver.</p>

<h3 id='example'>Example</h3>

<p>This example function prints the value of the device ID, variable ID, and variable value when any watched variable changes: </p>

<div class="highlight"><pre class="highlight lua tab-lua"><code><span class="k">function</span> <span class="nf">OnWatchedVariableChanged</span><span class="p">(</span><span class="n">idDevice</span><span class="p">,</span> <span class="n">idVariable</span><span class="p">,</span> <span class="n">strValue</span><span class="p">)</span>
  <span class="nb">print</span><span class="p">(</span><span class="s2">"Variable changed..."</span><span class="p">)</span>
  <span class="nb">print</span><span class="p">(</span><span class="s2">"  device: "</span> <span class="o">..</span> <span class="n">idDevice</span><span class="p">)</span>
  <span class="nb">print</span><span class="p">(</span><span class="s2">"  variable: "</span> <span class="o">..</span> <span class="n">idVariable</span><span class="p">)</span>
  <span class="nb">print</span><span class="p">(</span><span class="s2">"  value: "</span> <span class="o">..</span> <span class="n">strValue</span><span class="p">)</span>
  <span class="nb">print</span><span class="p">(</span><span class="s2">"-----------"</span><span class="p">)</span>
<span class="k">end</span>
</code></pre></div>

<h2 id='registervariablelistener'>RegisterVariableListener</h2>

<p>Function called from a DriverWorks driver to set a listener on a particular device’s variable.
When a listener is set on a variable, whenever the variable changes, the Lua <a href="https://snap-one.github.io/docs-driverworks-api/#onwatchedvariablechanged">OnWatchedVariableChanged</a> call is called.</p>

<p><h6 id='available-from-1-6-0'>Available from 1.6.0.</h6><h3 id='signature'>Signature</h3>
<p><code>C4:RegisterVariableListener(idDevice, idVariable) </code></p></p>

<table><thead>
<tr>
<th>Parameter</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>num</td>
<td>Device ID of the device that owns the changed variable</td>
</tr>
<tr>
<td>num</td>
<td>Variable ID of the changed variable</td>
</tr>
</tbody></table>

<h3 id='returns'>Returns</h3>

<p><code>None</code></p>

<h3 id='usage-notes'>Usage Notes</h3>

<p>User Variables belong to the Variable Agent, with a DeviceID of 100001. The <a href="https://snap-one.github.io/docs-driverworks-api/#onwatchedvariablechanged">OnWatchedVariableChanged</a> function will be called immediately after the listener is successfully set.</p>

<p>This API will fail if the variable does not exist.</p>

<h3 id='example'>Example</h3>

<p>This example watches the value of the temperature and HVAC mode variables on a Control4 Thermostat registered with the system as device 84.  It also registers to watch for changes to the user variable 209:</p>

<div class="highlight"><pre class="highlight lua tab-lua"><code><span class="n">C4</span><span class="p">:</span><span class="n">UnregisterVariableListener</span><span class="p">(</span><span class="mi">84</span><span class="p">,</span> <span class="mi">1000</span><span class="p">)</span>
<span class="n">C4</span><span class="p">:</span><span class="n">UnregisterVariableListener</span><span class="p">(</span><span class="mi">84</span><span class="p">,</span> <span class="mi">1003</span><span class="p">)</span> <span class="n">C4</span><span class="p">:</span><span class="n">UnregisterVariableListener</span><span class="p">(</span><span class="mi">100001</span><span class="p">,</span> <span class="mi">209</span><span class="p">)</span>
<span class="n">C4</span><span class="p">:</span><span class="n">RegisterVariableListener</span><span class="p">(</span><span class="mi">84</span><span class="p">,</span> <span class="mi">1000</span><span class="p">)</span>
<span class="n">C4</span><span class="p">:</span><span class="n">RegisterVariableListener</span><span class="p">(</span><span class="mi">84</span><span class="p">,</span> <span class="mi">1003</span><span class="p">)</span>
<span class="n">C4</span><span class="p">:</span><span class="n">RegisterVariableListener</span><span class="p">(</span><span class="mi">100001</span><span class="p">,</span> <span class="mi">209</span><span class="p">)</span>

<span class="k">function</span> <span class="nf">OnWatchedVariableChanged</span><span class="p">(</span><span class="n">idDevice</span><span class="p">,</span> <span class="n">idVariable</span><span class="p">,</span> <span class="n">strValue</span><span class="p">)</span>
  <span class="nb">print</span><span class="p">(</span><span class="s2">"Variable changed..."</span><span class="p">)</span>
  <span class="nb">print</span><span class="p">(</span><span class="s2">"  device: "</span> <span class="o">..</span> <span class="n">idDevice</span><span class="p">)</span>
  <span class="nb">print</span><span class="p">(</span><span class="s2">"  variable: "</span> <span class="o">..</span> <span class="n">idVariable</span><span class="p">)</span>
  <span class="nb">print</span><span class="p">(</span><span class="s2">"  value: "</span> <span class="o">..</span> <span class="n">strValue</span><span class="p">)</span>
  <span class="nb">print</span><span class="p">(</span><span class="s2">"-----------"</span><span class="p">)</span>
<span class="k">end</span>
</code></pre></div>

<h2 id='unregisterallvariablelisteners'>UnRegisterAllVariableListeners</h2>

<p>This API unregisters any/all previously registered variable listeners. It takes no arguments and returns nothing. </p>

<h3 id='signature'>Signature</h3>

<p><code>C4:UnregisterAllVariableListeners()</code></p>

<h2 id='unregistervariablelistener'>UnregisterVariableListener</h2>

<p>Function called from DriverWorks driver to remove a listener on a particular device&#39;s variable. Variable changes for the particular Device&#39;s Variable will no longer be reported. This API will not work if a variable has not been registered, added or does not exist.</p>

<p><h6 id='available-from-1-6-0'>Available from 1.6.0.</h6><h3 id='signature'>Signature</h3>
<p><code>C4:UnregisterVariableListener(idDevice, idVariable)</code></p></p>

<table><thead>
<tr>
<th>Parameter</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>num</td>
<td>Device ID of the device that owns the requested variable</td>
</tr>
<tr>
<td>num</td>
<td>Variable ID of the  requested variable</td>
</tr>
</tbody></table>

<h3 id='returns'>Returns</h3>

<p><code>None</code></p>

<h3 id='usage-notes'>Usage Notes</h3>

<p>User Variables belong to the Variable Agent, with a DeviceID of 100001.T</p>

<h3 id='example'>Example</h3>

<p>This stops the system from reporting variable value changes for the specified device and variables:</p>

<div class="highlight"><pre class="highlight lua tab-lua"><code><span class="n">C4</span><span class="p">:</span><span class="n">UnregisterVariableListener</span><span class="p">(</span><span class="mi">84</span><span class="p">,</span> <span class="mi">1000</span><span class="p">)</span>
<span class="n">C4</span><span class="p">:</span><span class="n">UnregisterVariableListener</span><span class="p">(</span><span class="mi">84</span><span class="p">,</span> <span class="mi">1003</span><span class="p">)</span>
<span class="n">C4</span><span class="p">:</span><span class="n">RegisterVariableListener</span><span class="p">(</span><span class="mi">100001</span><span class="p">,</span> <span class="mi">209</span>
</code></pre></div>

<h2 id='list-of-room-variables'>List of Room Variables</h2>

<p>To the right is an example of subscribing to the currently selected device and the navigator variables of the room.</p>

<div class="highlight"><pre class="highlight lua tab-lua"><code><span class="n">Variable_Current_Selected_Device</span> <span class="o">=</span> <span class="n">VARIABLE_ID_START</span><span class="p">,</span>
<span class="n">Variable_Current_Audio_Device</span><span class="p">,</span>
<span class="n">Variable_Current_Video_Device</span><span class="p">,</span>
<span class="n">Variable_Audio_Volume_Device</span><span class="p">,</span>
<span class="n">Variable_Video_Volume_Device</span><span class="p">,</span>
<span class="n">Variable_Current_Media</span><span class="p">,</span>
<span class="n">Variable_Current_Media_Type</span><span class="p">,</span>
<span class="n">Variable_Current_Audio_Path</span><span class="p">,</span>
<span class="n">Variable_Current_Video_Path</span><span class="p">,</span>
<span class="n">Variable_Current_Video_Audio_Path</span><span class="p">,</span>
<span class="n">Variable_Power_State</span><span class="p">,</span>
<span class="n">Variable_Current_Volume</span><span class="p">,</span>
<span class="n">Variable_Temperature_ID</span><span class="p">,</span>
<span class="n">Variable_Temperature_Control_ID</span><span class="p">,</span>
<span class="n">Variable_Security_ID</span><span class="p">,</span>
<span class="n">Variable_Current_Volume_Device</span><span class="p">,</span>
<span class="n">Variable_Has_Discrete_Volume</span><span class="p">,</span>
<span class="n">Variable_Has_Discrete_Mute</span><span class="p">,</span>
<span class="n">Variable_Is_Muted</span><span class="p">,</span>
<span class="n">Variable_In_Navigation</span><span class="p">,</span>
<span class="n">Variable_Use_Default_Volumes</span><span class="p">,</span>
<span class="n">Variable_Default_Audio_Volume</span><span class="p">,</span>
<span class="n">Variable_Default_Video_Volume</span><span class="p">,</span>
<span class="n">Variable_Volume_Linked</span><span class="p">,</span>
<span class="n">Variable_Linked_Room_List</span><span class="p">,</span>
<span class="n">Variable_Mute_Linked</span><span class="p">,</span>
<span class="n">Variable_RoomOff_Linked</span><span class="p">,</span>
<span class="n">Variable_Selections_Linked</span><span class="p">,</span>
<span class="n">Variable_Current_Linked_MediaID</span><span class="p">,</span>
<span class="n">Variable_Room_Hidden</span><span class="p">,</span>
<span class="n">Variable_Linked</span><span class="p">,</span>
<span class="n">Variable_Media_Info</span><span class="p">,</span>
<span class="n">Variable_Last_Device_Group</span><span class="p">,</span>
<span class="n">Variable_Available_Cameras</span><span class="p">,</span>
<span class="n">Variable_Pools</span><span class="p">,</span>
<span class="n">Variable_Scene_Is_Discrete_Volume</span><span class="p">,</span>
</code></pre></div><h3 id='example'>Example</h3><div class="highlight"><pre class="highlight lua tab-lua"><code><span class="n">roomId</span> <span class="o">=</span> <span class="n">C4</span><span class="p">:</span><span class="n">RoomGetId</span><span class="p">()</span>
<span class="c1">-- be notified when the currently selected device is changed</span>
<span class="n">C4</span><span class="p">:</span><span class="n">RegisterVariableListener</span><span class="p">(</span><span class="n">roomId</span><span class="p">,</span> <span class="mi">1000</span><span class="p">)</span>
<span class="c1">-- be notified when we are in nav or not</span>
<span class="n">C4</span><span class="p">:</span><span class="n">RegisterVariableListener</span><span class="p">(</span><span class="n">roomId</span><span class="p">,</span> <span class="mi">1019</span><span class="p">)</span>


<span class="k">function</span> <span class="nf">OnWatchedVariableChanged</span><span class="p">(</span><span class="n">idDevice</span><span class="p">,</span> <span class="n">idVariable</span><span class="p">,</span> <span class="n">strValue</span><span class="p">)</span> 
  <span class="nb">print</span><span class="p">(</span><span class="s2">"Variable changed..."</span><span class="p">)</span> 
  <span class="nb">print</span><span class="p">(</span><span class="s2">"  device: "</span> <span class="o">..</span> <span class="n">idDevice</span><span class="p">)</span> 
  <span class="nb">print</span><span class="p">(</span><span class="s2">"  variable: "</span> <span class="o">..</span> <span class="n">idVariable</span><span class="p">)</span> 
  <span class="nb">print</span><span class="p">(</span><span class="s2">"  value: "</span> <span class="o">..</span> <span class="n">strValue</span><span class="p">)</span> 
  <span class="nb">print</span><span class="p">(</span><span class="s2">"-----------"</span><span class="p">)</span> 
<span class="k">end</span> 


    <span class="n">C4</span><span class="p">:</span><span class="n">SendToDevice</span><span class="p">(</span><span class="n">roomId</span><span class="p">,</span> <span class="s2">"CONTROL4"</span><span class="p">,</span> <span class="n">tParams</span><span class="p">)</span> 
    <span class="n">C4</span><span class="p">:</span><span class="n">SendToDevice</span><span class="p">(</span><span class="n">roomId</span><span class="p">,</span> <span class="s2">"EXIT_NAVIGATION"</span><span class="p">,</span> <span class="n">tParams</span><span class="p">)</span> 
</code></pre></div><div class="highlight"><pre class="highlight lua tab-lua"><code><span class="c1">-- Example Output</span>

<span class="n">Variable</span> <span class="n">changed</span><span class="o">...</span>
<span class="n">device</span><span class="p">:</span> <span class="mi">5</span>
<span class="n">variable</span><span class="p">:</span> <span class="mi">1000</span>
<span class="n">value</span><span class="p">:</span> <span class="mi">7</span>

<span class="c1">-----------</span>

<span class="n">Variable</span> <span class="n">changed</span><span class="o">...</span>
<span class="n">device</span><span class="p">:</span> <span class="mi">5</span>
<span class="n">variable</span><span class="p">:</span> <span class="mi">1019</span>
<span class="n">value</span><span class="p">:</span> <span class="mi">1</span>

<span class="c1">-----------</span>

<span class="n">Variable</span> <span class="n">changed</span><span class="o">...</span>
<span class="n">device</span><span class="p">:</span> <span class="mi">5</span>
<span class="n">variable</span><span class="p">:</span> <span class="mi">1019</span>
<span class="n">value</span><span class="p">:</span> <span class="mi">0</span>
</code></pre></div>
<h1 id='web-service-interface'>Web Service Interface</h1>

<h2 id='overview'>Overview</h2>

<p>Webservice Authentication using Lua</p>

<p>Control4 drivers have the ability to perform Basic and Digest authentication with a web service using any of the  “*url”*APIs within this Interface. Authentication is achieved by passing the username and password within the string parameter used by each of the APIs.</p>

<p>Note: Starting with O.S 3, sample drivers are being delivered with the DriverWorks SDK. Included in the sample driver delivery is the generic-http driver which demonstrates how to do basic <a href="https://snap-one.github.io/docs-driverworks-api/#url-interface">C4:url</a> calls. The sample driver can be found at the root level of the SDK or DriverWorks SDK/Samples.</p>

<p>Also included in the Samples directory is an example websockets client driver.</p>

<h2 id='receivedasync'>ReceivedAsync</h2>

<p>This function is used in conjunction with <a href="https://snap-one.github.io/docs-driverworks-api/#get">urlGet</a> and <a href="https://snap-one.github.io/docs-driverworks-api/#post">urlPost</a>. It handles the data contained in the data ticket. As soon as data is returned from getUrl, Director will call this in the Lua code. This API should not be invoked during OnDriverInit.</p>

<p><h6 id='available-from-1-6-0'>Available from 1.6.0.</h6><h3 id='signature'>Signature</h3>
<p><code>function ReceivedAsync(ticketId, strData, responseCode, tHeaders, strError)</code></p>
<h3 id='parameters'>Parameters</h3>
<p><code>None</code></p>
<h3 id='returns'>Returns</h3>
<table><thead>
<tr>
<th>Parameter</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>num</td>
<td>Number representing the data ticket</td>
</tr>
<tr>
<td>str</td>
<td>String representing the data contained in the ticket</td>
</tr>
<tr>
<td>code</td>
<td>Response code</td>
</tr>
<tr>
<td>table</td>
<td>Lua table of response headers</td>
</tr>
<tr>
<td>str</td>
<td>String representing the error content</td>
</tr>
</tbody></table>
<h3 id='example'>Example</h3><div class="highlight"><pre class="highlight lua tab-lua"><code><span class="k">function</span> <span class="nf">ReceivedAsync</span><span class="p">(</span><span class="n">ticketId</span><span class="p">,</span> <span class="n">strData</span><span class="p">)</span>
<span class="err"> </span> <span class="n">callType</span> <span class="o">=</span> <span class="n">g_ticketToTypeMap</span><span class="p">[</span><span class="n">ticketId</span><span class="p">]</span>
<span class="err"> </span> <span class="c1">--print(&quot;ra - ct = &quot; .. callType .. &quot; id is &quot; .. ticketId .. &quot; data is&lt;&lt; &quot; .. strData .. &quot; &gt;&gt;&quot;)</span>
<span class="err"> </span> <span class="k">if</span> <span class="p">(</span><span class="n">callType</span> <span class="o">==</span> <span class="s2">&quot;root&quot;</span><span class="p">)</span> <span class="k">then</span>
<span class="err">       </span> <span class="n">g_shoutCastHtmlParsed</span> <span class="o">=</span> <span class="n">parsestr</span><span class="p">(</span><span class="n">strData</span><span class="p">)</span>
<span class="err"> </span> <span class="k">elseif</span> <span class="p">(</span><span class="n">callType</span> <span class="o">==</span> <span class="s2">&quot;playlist&quot;</span><span class="p">)</span> <span class="k">then</span>
<span class="err">               </span> <span class="n">stationUrl</span> <span class="o">=</span> <span class="n">GetStationUrlFromHtml</span><span class="p">(</span><span class="n">strData</span><span class="p">)</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">stationUrl</span><span class="p">)</span> <span class="k">then</span>
<span class="err">                  </span> <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Adding station &quot;</span> <span class="o">..</span> <span class="n">stationUrl</span><span class="p">)</span>
<span class="err">               </span> <span class="err">        </span> <span class="n">AddStationToDb</span><span class="p">(</span><span class="n">stationUrl</span><span class="p">,</span> <span class="n">ticketId</span><span class="p">)</span>
<span class="err">        </span> <span class="k">else</span>
<span class="err">   </span> <span class="err">           </span> <span class="c1">-- must have been a genre item they clicked on</span>
<span class="err">           </span> <span class="n">genreTable</span> <span class="o">=</span> <span class="n">parsestr</span><span class="p">(</span><span class="n">strData</span><span class="p">)</span>
<span class="err">           </span> <span class="n">ShowSubGenres</span><span class="p">(</span><span class="s2">&quot;Add Genre&quot;</span><span class="p">,</span> <span class="n">genreTable</span><span class="p">)</span>
<span class="err">               </span> <span class="k">end</span>
<span class="err"> </span> <span class="k">else</span>
<span class="err">   </span> <span class="err">           </span> <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;ReceivedAsync called with unexpected id of &quot;</span> <span class="o">..</span> <span class="n">ticketId</span><span class="p">)</span> <span class="c1">-- ..  and data of &quot; .. strData)</span>
<span class="err"> </span> <span class="k">end</span>
<span class="k">end</span>
</code></pre></div>
<h2 id='urlcancel'>urlCancel</h2>
<p>Function to cancel an ongoing transfer. Note that if a transfer is canceled, neither the ReceivedAsync() entry point nor the callback function specified in the <a href="https://snap-one.github.io/docs-driverworks-api/#url-interface">C4:url</a> call will be called.  Also, the ticketId is only valid from the point the C4:url function is called until either the <a href="https://snap-one.github.io/docs-driverworks-api/#receivedasync">ReceivedAsync()</a> entry point or the callback function was called. A call to C4:urlCancel() will also invalidate that ticketed. This API should not be invoked during OnDriverInit</p>
<h6 id='available-from-2-7-0'>Available from 2.7.0.</h6><h3 id='signature'>Signature</h3>
<p><code>C4:urlCancel(ticketId)</code></p></p>

<table><thead>
<tr>
<th>Parameter</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>num</td>
<td>Number representing the ticket ID value.</td>
</tr>
</tbody></table>

<h3 id='returns'>Returns</h3>

<table><thead>
<tr>
<th>Parameter</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>bool</td>
<td>True if the specified transfer was canceled.</td>
</tr>
</tbody></table>

<h3 id='usage-note'>Usage Note</h3>

<p>Control4 Web Service APIs, specifically those beginning with <a href="https://snap-one.github.io/docs-driverworks-api/#url-interface">C4:url</a>,  send the following default Headers with the HTTP(s) request:</p>

<div class="highlight"><pre class="highlight html tab-html"><code>Host: <span class="nt">&lt;DNS</span> <span class="na">name</span> <span class="na">or</span> <span class="na">IP</span> <span class="na">of</span> <span class="na">server</span><span class="nt">&gt;</span>,
Accept: "/",
Accept-Encoding: "deflate, gzip"
Connection: "close", is suggested and
</code></pre></div><h3 id='example'>Example</h3>
<p>To the right is an example that does a C4:urlGet() and waits only a maximum of one second for a response before canceling:</p>
<div class="highlight"><pre class="highlight lua tab-lua"><code><span class="kd">local</span> <span class="n">transferTicketId</span><span class="p">,</span> <span class="n">timer</span>
<span class="n">transferTicketId</span> <span class="o">=</span> <span class="n">C4</span><span class="p">:</span><span class="n">urlGet</span><span class="p">(</span><span class="s2">"http://www.example.com"</span><span class="p">,</span> <span class="p">{},</span> <span class="kc">true</span><span class="p">,</span> <span class="k">function</span><span class="p">(</span><span class="n">ticketId</span><span class="p">,</span> <span class="n">strData</span><span class="p">,</span> <span class="n">responseCode</span><span class="p">,</span> <span class="n">tHeaders</span><span class="p">,</span> <span class="n">strError</span><span class="p">)</span>
<span class="err">        </span><span class="k">if</span> <span class="p">(</span><span class="n">timer</span> <span class="o">~=</span> <span class="kc">nil</span><span class="p">)</span> <span class="k">then</span>
<span class="err">                  </span><span class="c1">-- Cancel the timer if the transfer completed first</span>
<span class="err">                  </span><span class="n">timer</span><span class="p">:</span><span class="n">Cancel</span><span class="p">()</span>
<span class="err">                  </span><span class="n">timer</span> <span class="o">=</span> <span class="kc">nil</span>
<span class="err">               </span> <span class="k">end</span>
<span class="err">               </span>
<span class="err">               </span> <span class="k">if</span> <span class="p">(</span><span class="n">strError</span> <span class="o">==</span> <span class="kc">nil</span><span class="p">)</span> <span class="k">then</span>
<span class="err">                         </span><span class="nb">print</span><span class="p">(</span><span class="s2">"C4:urlGet() completed with response code "</span> <span class="o">..</span> <span class="nb">tostring</span><span class="p">(</span><span class="n">responseCode</span><span class="p">))</span>
<span class="err">               </span> <span class="k">else</span>
<span class="err">                         </span><span class="nb">print</span><span class="p">(</span><span class="s2">"C4:urlGet() failed with error: "</span> <span class="o">..</span> <span class="n">strError</span><span class="p">)</span>
<span class="err">               </span> <span class="k">end</span>
<span class="k">end</span><span class="p">)</span>
<span class="n">timer</span> <span class="o">=</span> <span class="n">C4</span><span class="p">:</span><span class="n">SetTimer</span><span class="p">(</span><span class="mi">1000</span><span class="p">,</span> <span class="k">function</span><span class="p">(</span><span class="n">tmr</span><span class="p">)</span>
<span class="err">        </span><span class="kd">local</span> <span class="n">success</span> <span class="o">=</span> <span class="n">C4</span><span class="p">:</span><span class="n">urlCancel</span><span class="p">(</span><span class="n">transferTicketId</span><span class="p">)</span>
<span class="err">        </span><span class="nb">print</span><span class="p">(</span><span class="s2">"C4:urlGet() took too long, C4:urlCancel() returned "</span> <span class="o">..</span> <span class="nb">tostring</span><span class="p">(</span><span class="n">success</span><span class="p">))</span>
<span class="k">end</span><span class="p">)</span>
<span class="err"> </span>
<span class="cm">--[[
   Example output:
     If the timer expired before the transfer completed:
        C4:urlGet() took too long, C4:urlCancel() returned true
 
     If the transfer completed before the timer expired:
        C4:urlGet() completed with response code 200
--]]</span>

</code></pre></div>

<h2 id='urlcancelall'>urlCancelAll</h2>

<p>This method cancels all ongoing transfers and returns an array with the ticket ids of the transfers that were canceled. This API should not be invoked during OnDriverInit.</p>

<p><h6 id='available-from-2-8-1'>Available from 2.8.1.</h6><h3 id='signature'>Signature</h3>
<p><code>C4:urlCancelAll()</code></p>
<h3 id='parameters'>Parameters</h3>
<p><code>None</code></p>
<h3 id='returns'>Returns</h3>
<p><code>None</code></p>
<h3 id='usage-note'>Usage Note</h3>
<p>Control4 Web Service APIs, specifically those beginning with <a href="https://snap-one.github.io/docs-driverworks-api/#url-interface">C4:url</a>, send the following default Headers with the HTTP(s) request:</p>
<div class="highlight"><pre class="highlight lua tab-lua"><code><span class="n">Host</span><span class="p">:</span> <span class="o">&lt;</span><span class="n">DNS</span> <span class="n">name</span> <span class="ow">or</span> <span class="n">IP</span> <span class="n">of</span> <span class="n">server</span><span class="o">&gt;</span><span class="p">,</span>
<span class="n">Accept</span><span class="p">:</span> <span class="s2">&quot;/&quot;</span><span class="p">,</span>
<span class="n">Accept</span><span class="o">-</span><span class="n">Encoding</span><span class="p">:</span> <span class="s2">&quot;deflate, gzip&quot;</span>
<span class="n">Connection</span><span class="p">:</span> <span class="s2">&quot;close&quot;</span>
</code></pre></div>
<p>It is recommended that these Headers NOT be overwritten.</p></p>

<p>Note that a user-agent string is not included in the default Headers. However, including one within a driver is suggested as it makes diagnostics easier for servers.</p>

<h2 id='urlclearcookies'>urlClearCookies</h2>

<p>Function to clear all cookies from a driver&#39;s cookie jar.</p>

<p><h6 id='available-from-2-9-0'>Available from 2.9.0.</h6><h3 id='signature'>Signature</h3>
<p><code>C4:urlClearCookies() </code></p>
<h3 id='parameters'>Parameters</h3>
<p><code>None</code></p>
<h3 id='returns'>Returns</h3>
<table><thead>
<tr>
<th>Value</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>num</td>
<td>The number of cookies that were removed.</td>
</tr>
</tbody></table>
<h3 id='usage-note'>Usage Note</h3>
<p>Control4 Web Service APIs, specifically those beginning with <a href="https://snap-one.github.io/docs-driverworks-api/#url-interface">C4:url</a>, send the following default Headers with the HTTP(s) request:</p>
<div class="highlight"><pre class="highlight html tab-html"><code>Host: <span class="nt">&lt;DNS</span> <span class="na">name</span> <span class="na">or</span> <span class="na">IP</span> <span class="na">of</span> <span class="na">server</span><span class="nt">&gt;</span>,
Accept: &quot;/&quot;,
Accept-Encoding: &quot;deflate, gzip&quot;
Connection: &quot;close&quot;, is suggested and
</code></pre></div>
<p>It is recommend that these Headers NOT be overwritten.</p></p>

<p>Note that a user-agent string is not included in the default Headers. However, including one within a driver is suggested as it makes diagnostics easier for servers.</p>

<h2 id='urlclearsessioncookies'>urlClearSessionCookies</h2>

<p>Function to clear all session cookies from a driver&#39;s cookie jar.</p>

<p><h6 id='available-from-2-9-0'>Available from 2.9.0.</h6><h3 id='signature'>Signature</h3>
<p><code>C4:urlClearSessionCookies()</code></p>
<h3 id='parameters'>Parameters</h3>
<p><code>None</code></p>
<h3 id='returns'>Returns</h3>
<table><thead>
<tr>
<th>Value</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>num</td>
<td>The number of session cookies (cookies with no expiration time) that were removed</td>
</tr>
</tbody></table>
<h3 id='usage-note'>Usage Note</h3>
<p>Control4 Web Service APIs, specifically those beginning with <a href="https://snap-one.github.io/docs-driverworks-api/#url-interface">C4:url</a>, send the following default Headers with the HTTP(s) request:</p>
<div class="highlight"><pre class="highlight html tab-html"><code>Host: <span class="nt">&lt;DNS</span> <span class="na">name</span> <span class="na">or</span> <span class="na">IP</span> <span class="na">of</span> <span class="na">server</span><span class="nt">&gt;</span>,
Accept: &quot;/&quot;,
Accept-Encoding: &quot;deflate, gzip&quot;
Connection: &quot;close&quot;, is suggested and
</code></pre></div>
<p>It is recommend that these Headers NOT be overwritten.</p></p>

<p>Note that a user-agent string is not included in the default Headers. However, including one within a driver is suggested as it makes diagnostics easier for servers.</p>

<h2 id='urlgetcookies'>urlGetCookies</h2>

<p>Function to retrieve cookies from the driver&#39;s cookie jar filtered by a specific domain.</p>

<p><h6 id='available-from-2-9-0'>Available from 2.9.0.</h6><h3 id='signature'>Signature</h3>
<p><code>C4:urlGetCookies (domain)</code></p></p>

<table><thead>
<tr>
<th>Parameter</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>str</td>
<td>Optional. A specific domain.</td>
</tr>
</tbody></table>

<h3 id='returns'>Returns</h3>

<table><thead>
<tr>
<th>Value</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>table</td>
<td>Table of a map of domain names to a map of cookie names to cookie table objects.</td>
</tr>
</tbody></table>

<h3 id='usage-note'>Usage Note</h3>

<p>Each cookie table has the following fields defined:</p>

<ul>
<li>domain (str): The domain that this cookie belongs to</li>
<li>path (str): The path that this cookie belongs to</li>
<li>name (str): The name of this cookie</li>
<li>value (str): The value of this cookie</li>
<li>secure (boolean): If set to true, this cookie is only used for https requests</li>
<li>wildcard (boolean): If set to true, this cookie is used for any subdomains</li>
<li>expires (number): Expiration date/time in number of seconds since the Epoch.  If this value is 0, this is  session cookie.</li>
</ul>

<h3 id='usage-note-2'>Usage Note</h3>

<p>Control4 Web Service APIs, specifically those beginning with <a href="https://snap-one.github.io/docs-driverworks-api/#url-interface">C4:url</a>, send the following default Headers with the HTTP(s) request:</p>

<div class="highlight"><pre class="highlight html tab-html"><code>Host: <span class="nt">&lt;DNS</span> <span class="na">name</span> <span class="na">or</span> <span class="na">IP</span> <span class="na">of</span> <span class="na">server</span><span class="nt">&gt;</span>,
Accept: "/",
Accept-Encoding: "deflate, gzip"
Connection: "close", is suggested and
</code></pre></div>

<p>It is recommend that these Headers NOT be overwritten.</p>

<p>Note that a user-agent string is not included in the default Headers. However, including one within a driver is suggested as it makes diagnostics easier for servers.</p>

<h3 id='example'>Example</h3><div class="highlight"><pre class="highlight lua tab-lua"><code><span class="k">for</span> <span class="n">domain</span><span class="p">,</span><span class="n">cookies</span> <span class="k">in</span> <span class="nb">pairs</span><span class="p">(</span><span class="n">C4</span><span class="p">:</span><span class="n">urlGetCookies</span><span class="p">())</span> <span class="k">do</span>
<span class="err">  </span> <span class="err"> </span><span class="k">for</span> <span class="n">name</span><span class="p">,</span><span class="n">cookie</span> <span class="k">in</span> <span class="nb">pairs</span><span class="p">(</span><span class="n">cookies</span><span class="p">)</span> <span class="k">do</span>
<span class="err">  </span> <span class="err">   </span> <span class="err"> </span><span class="nb">print</span><span class="p">(</span><span class="s2">"cookie["</span> <span class="o">..</span> <span class="n">domain</span> <span class="o">..</span> <span class="s2">"]["</span> <span class="o">..</span> <span class="n">name</span> <span class="o">..</span> <span class="s2">"]: path: "</span> <span class="o">..</span> <span class="n">cookie</span><span class="p">.</span><span class="n">path</span> <span class="o">..</span> <span class="s2">" value: "</span> <span class="o">..</span> <span class="n">cookie</span><span class="p">.</span><span class="n">value</span><span class="p">)</span>
<span class="err">  </span> <span class="err"> </span><span class="k">end</span>
<span class="k">end</span>
</code></pre></div>
<h2 id='urlgetcookiesfordomain'>urlGetCookiesForDomain</h2>
<p>Function to retrieve cookies from the driver&#39;s cookie jar filtered by a specific domain.</p>
<h6 id='available-from-2-9-0'>Available from 2.9.0.</h6><h3 id='signature'>Signature</h3>

<p><code>C4:urlGetCookiesForDomain (domain)</code></p>

<table><thead>
<tr>
<th>Parameter</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>str</td>
<td>Optional. A specific domain.</td>
</tr>
</tbody></table>

<h3 id='returns'>Returns</h3>

<table><thead>
<tr>
<th>Value</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>table</td>
<td>Table of a map of domain names to a map of cookie names to cookie table objects. </td>
</tr>
</tbody></table>

<h3 id='usage-note'>Usage Note</h3>

<p>Each cookie table has the following fields defined:</p>

<ul>
<li> domain (str): The domain that this cookie belongs to</li>
<li>path (str): The path that this cookie belongs to</li>
<li>name (str): The name of this cookie</li>
<li>value (str): The value of this cookie</li>
<li>secure (boolean): If set to true, this cookie is only used for https requests</li>
<li>wildcard (boolean): If set to true, this cookie is used for any subdomains</li>
<li>expires (number): Expiration date/time in number of seconds since the Epoch.  If this value is 0, this is  session cookie.</li>
</ul>

<h3 id='usage-note-2'>Usage Note</h3>

<p>Control4 Web Service APIs, specifically those beginning with <a href="https://snap-one.github.io/docs-driverworks-api/#url-interface">C4:url</a>, send the following default Headers with the HTTP(s) request:</p>

<div class="highlight"><pre class="highlight html tab-html"><code>Host: <span class="nt">&lt;DNS</span> <span class="na">name</span> <span class="na">or</span> <span class="na">IP</span> <span class="na">of</span> <span class="na">server</span><span class="nt">&gt;</span>,
Accept: "/",
Accept-Encoding: "deflate, gzip"
Connection: "close", is suggested and
</code></pre></div>

<p>It is recommend that these Headers NOT be overwritten.</p>

<p>Note that a user-agent string is not included in the default Headers. However, including one within a driver is suggested as it makes diagnostics easier for servers.</p>

<h3 id='example'>Example</h3><div class="highlight"><pre class="highlight lua tab-lua"><code><span class="k">for</span> <span class="n">name</span><span class="p">,</span><span class="n">cookie</span> <span class="k">in</span> <span class="nb">pairs</span><span class="p">(</span><span class="n">C4</span><span class="p">:</span><span class="n">urlGetCookiesForDomain</span><span class="p">(</span><span class="s2">"example.com"</span><span class="p">))</span> <span class="k">do</span>
<span class="err">  </span> <span class="err"> </span><span class="nb">print</span><span class="p">(</span><span class="s2">"cookie["</span> <span class="o">..</span> <span class="n">cookie</span><span class="p">.</span><span class="n">domain</span> <span class="o">..</span> <span class="s2">"]["</span> <span class="o">..</span> <span class="n">name</span> <span class="o">..</span> <span class="s2">"]: path: "</span> <span class="o">..</span> <span class="n">cookie</span><span class="p">.</span><span class="n">path</span> <span class="o">..</span> <span class="s2">" value: "</span> <span class="o">..</span> <span class="n">cookie</span><span class="p">.</span><span class="n">value</span><span class="p">)</span>
<span class="k">end</span>

</code></pre></div>
<h2 id='urlgetoption'>urlGetOption</h2>
<p>Function to retrieve cookies from the driver&#39;s cookie jar filtered by a specific domain.</p>
<h6 id='available-from-2-9-0'>Available from 2.9.0.</h6><h3 id='signature'>Signature</h3>

<p><code>C4:urlGetOption (option)</code></p>

<table><thead>
<tr>
<th>Parameter</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>num</td>
<td>Returns the number of concurrent transfers allowed per hostbool</td>
</tr>
<tr>
<td>bool</td>
<td>Returns whether HTTP pipelining is enabled.</td>
</tr>
</tbody></table>

<h3 id='returns'>Returns</h3>

<p>Value of the option parameter passed</p>

<h3 id='usage-note'>Usage Note</h3>

<p>Control4 Web Service APIs, specifically those beginning with <a href="https://snap-one.github.io/docs-driverworks-api/#url-interface">C4:url</a>, send the following default Headers with the HTTP(s) request:</p>

<div class="highlight"><pre class="highlight html tab-html"><code>Host: <span class="nt">&lt;DNS</span> <span class="na">name</span> <span class="na">or</span> <span class="na">IP</span> <span class="na">of</span> <span class="na">server</span><span class="nt">&gt;</span>,
Accept: "/",
Accept-Encoding: "deflate, gzip"
Connection: "close"
</code></pre></div>

<p>It is recommend that these Headers NOT be overwritten.</p>

<p>Note that a user-agent string is not included in the default Headers. However, including one within a driver is suggested as it makes diagnostics easier for servers.</p>

<h2 id='urlgettickets'>urlGetTickets</h2>

<p>This method returns an array with the ticket ids of all ongoing transfers. This API should not be invoked during OnDriverInit.</p>

<p><h6 id='available-from-2-8-1'>Available from 2.8.1.</h6><h3 id='signature'>Signature</h3>
<p><code>C4:urlGetTickets()</code></p>
<h3 id='parameter'>Parameter</h3>
<p><code>None</code></p>
<h3 id='returns'>Returns</h3>
<p>Ticket IDs</p>
<h3 id='usage-note'>Usage Note</h3>
<p>Control4 Web Service APIs, specifically those beginning with <a href="https://snap-one.github.io/docs-driverworks-api/#url-interface">C4:url</a>, send the following default Headers with the HTTP(s) request:</p>
<div class="highlight"><pre class="highlight html tab-html"><code>Host: <span class="nt">&lt;DNS</span> <span class="na">name</span> <span class="na">or</span> <span class="na">IP</span> <span class="na">of</span> <span class="na">server</span><span class="nt">&gt;</span>,
Accept: &quot;/&quot;,
Accept-Encoding: &quot;deflate, gzip&quot;
Connection: &quot;close&quot;, is suggested and
</code></pre></div>
<p>It is recommend that these Headers NOT be overwritten.</p></p>

<p>Note that a user-agent string is not included in the default Headers. However, including one within a driver is suggested as it makes diagnostics easier for servers.</p>

<h2 id='urlsetoption'>urlSetOption</h2>

<p>This function changes the option specified in the option argument to the value provided. The options and their respective value parameters can be one of the two defined in the signature section below. This API should not be invoked during OnDriverInit.</p>

<p>NOTE: These options apply to both the &#39;legacy&#39; C4:urlGet / C4:urlPut / C4:urlPost commands, as well as the newer C4:url() functionality.</p>

<p><h6 id='available-from-2-8-1'>Available from 2.8.1.</h6><h3 id='signature'>Signature</h3>
<p><code>C4:urlSetOption(option, value)</code></p></p>

<p>There are 2 supported options: <code>max_host_connections</code>, and &#39;pipelining&#39;.</p>

<p><code>max_host_connections</code> parameter:</p>

<table><thead>
<tr>
<th>Parameter</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>num</td>
<td>Number of concurrent transfers allowed per host. Defaults to 1. NOTE: This must be a number from 1-5.  5 is the maximum number of connections allowed. Any numbers outside of this range will not be honored, and the current value will be kept. </td>
</tr>
</tbody></table>

<p>pipelining parameter:</p>

<table><thead>
<tr>
<th>Parameter</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>bool</td>
<td>pipelining. Sets whether HTTP pipelining should be enabled.</td>
</tr>
</tbody></table>

<h3 id='usage-notes'>Usage Notes</h3>

<p>Note that if the concurrent transfers value is being changed to anything other than 1, the &quot;pipelining&quot; option will automatically get disabled.</p>

<p>Note that If the pipelining boolean is being changed to true, the <code>max_host_connections</code> option will automatically be set. Changing this option will not have any effect until there are no active transfers running. Also, it will not apply to new transfers created until then. Once all transfers are completed, this setting will apply to any transfers created from that point on.  You can use the <a href="https://snap-one.github.io/docs-driverworks-api/#urlcancelall">C4:urlCancelAll()</a> method to cancel all transfers prior to setting this option, or you can use the <a href="https://snap-one.github.io/docs-driverworks-api/#urlgettickets">C4:urlGetTickets()</a> method to determine whether any transfers are currently pending.</p>

<h3 id='returns'>Returns</h3>

<p><code>None</code></p>

<h3 id='examples'>Examples</h3>

<p><code>C4:urlSetOption(&quot;max_host_connections&quot;, 1)</code></p>

<p><code>C4:urlSetOption(&quot;pipelining&quot;, true)</code></p>

<h2 id='urlsetproxy'>urlSetProxy</h2>

<p>This function is to set server related security information that may be needed in future related url calls. This API should not be invoked during OnDriverInit.</p>

<p><h6 id='available-from-1-6-0'>Available from 1.6.0.</h6><h3 id='signature'>Signature</h3>
<p><code>C4:urlSetProxy ()</code></p></p>

<table><thead>
<tr>
<th>Parameter</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>str</td>
<td>url to be used for supplied credentials bool</td>
</tr>
<tr>
<td>num</td>
<td>port corresponding to the url</td>
</tr>
<tr>
<td>str</td>
<td> username to be used for the url</td>
</tr>
<tr>
<td>str</td>
<td>password to be used for the urlfailOnHttpError (boolean) - True/False. Defaults to True.</td>
</tr>
</tbody></table>

<h3 id='returns'>Returns</h3>

<p><code>None</code></p>

<h2 id='usage-note'>Usage Note</h2>

<p>Control4 Web Service APIs, specifically those beginning with <a href="https://snap-one.github.io/docs-driverworks-api/#url-interface">C4:url</a>, send the following default Headers with the HTTP(s) request:</p>

<div class="highlight"><pre class="highlight html tab-html"><code>Host: <span class="nt">&lt;DNS</span> <span class="na">name</span> <span class="na">or</span> <span class="na">IP</span> <span class="na">of</span> <span class="na">server</span><span class="nt">&gt;</span>,
Accept: "/",
Accept-Encoding: "deflate, gzip"
Connection: "close", is suggested and
</code></pre></div>

<p>It is recommend that these Headers NOT be overwritten. Note that a user-agent string is not included in the default Headers. However, including one within a driver is suggested as it makes diagnostics easier for servers.</p>

<h3 id='examples'>Examples</h3>

<p><code>C4:urlSetProxy(&quot;www.mywebsite.com&quot;, 8080, &quot;me&quot;, &quot;mypassword&quot;)</code></p>

<h2 id='urlsettimeout'>urlSetTimeout</h2>

<p>This function is to set a maximum time value (in seconds) for a transfer operation to take place before a server time out occurs. The value passed in this API is dependent on driver/Director performance. For example, setting this value too low could result in a timeout occurring too quickly resulting in messages missed. Setting it too high could result in lag time and poor user experience. Control4 recommends an initial setting of 20 seconds and adjusting as needed. This API should not be invoked during OnDriverInit.</p>

<p><h6 id='available-from-1-6-0'>Available from 1.6.0.</h6><h3 id='signature'>Signature</h3>
<p><code>C4:urlSetTimeout(SECONDS) </code>   </p></p>

<table><thead>
<tr>
<th>Parameter</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>int</td>
<td> number of seconds allowed</td>
</tr>
</tbody></table>

<h3 id='returns'>Returns</h3>

<p><code>None</code></p>

<h2 id='usage-notes'>Usage Notes</h2>

<p>Starting with the release of OS 2.9.0, urlSetTimeout is optional as a driver no longer has to make this call explicitly. As of 2.9.0, Control4 imposes a 300 second overall timeout to all web requests by default.  A driver may however override this and call C4:urlSetTimeout() to revert back to the behavior described above. </p>

<p>Control4 Web Service APIs, specifically those beginning with C4:url, send the following default Headers with the HTTP(s) request:</p>

<div class="highlight"><pre class="highlight html tab-html"><code>Host: <span class="nt">&lt;DNS</span> <span class="na">name</span> <span class="na">or</span> <span class="na">IP</span> <span class="na">of</span> <span class="na">server</span><span class="nt">&gt;</span>,
Accept: "/",
Accept-Encoding: "deflate, gzip"
Connection: "close", is suggested and 
</code></pre></div>

<p>It is recommend that these Headers NOT be overwritten. Note that a user-agent string is not included in the default Headers. However, including one within a driver is suggested as it makes diagnostics easier for servers.</p>

<h3 id='example'>Example</h3>

<p><code>C4:urlSetTimeout(20)</code></p>
<h1 id='zigbee-interface'>Zigbee Interface</h1>

<h2 id='overview'>Overview</h2>

<p>DriverWorks and Zigbee Functionality </p>

<p>DriverWorks support for Zigbee functionality was originally delivered in release 1.6.1. This section has been included to provide information to Control 4 partners already using the Zigbee SDK. This information will support the development of DriverWorks Zigbee functionality so that partners using the Zigbee SDK can integrate into the Control 4 system.</p>

<p>Functionality provided in support of Zigbee functionality currently includes:</p>

<ul>
<li><p>Allowing DriverWorks driver developers to send data to and receive data from ZigBee devices using either EmberNet or ZigBee Pro</p></li>
<li><p>Allow ZigBee SDK developers the ability to update their ZigBee devices using DriverWorks. </p></li>
<li><p>Allow ZigBee SDK developers the ability to utilize the Control4 identification mechanism, but define their own ID strings.</p></li>
</ul>

<h2 id='updating-zigbee-device-firmware-using-driverworks'>Updating Zigbee Device firmware Using DriverWorks</h2>

<p>The ability to use DriverWorks drivers to update firmware on ZigBee devices has been implemented using two features:</p>

<ol>
<li>Support of encoded BLOB data (firmware) within the driver file</li>
<li>Functions to handle device requests and delivery of the firmware data.</li>
</ol>

<p><strong>Encoded BLOB Data in the Driver File </strong></p>

<p>DriverWorks supports the ability to store binary firmware data within the driver file. This data must be Base64 encoded. The encoded firmware data string information should reside at the beginning of the driver file as seen in the example to the right:</p>

<div class="highlight"><pre class="highlight xml tab-xml"><code><span class="nt">&lt;devicedata&gt;</span>
 <span class="nt">&lt;copyright&gt;</span>Copyright 2019 Control4 Corporation. All rights reserved.<span class="nt">&lt;/copyright&gt;</span>
   <span class="nt">&lt;largeblobs&gt;</span>
    <span class="nt">&lt;largeblob</span> <span class="na">name=</span><span class="s">"Blob1"</span><span class="nt">&gt;</span>VGhpcyBpcyBOaGUgRmlyc3QgQkxPQiENCg==<span class="nt">&lt;/largeblob&gt;</span>
   <span class="nt">&lt;largeblobname</span><span class="err">="Blob2"</span><span class="nt">&gt;</span>AAECAwQFBgclCQoLDA0ODwABAgMEBQYHCAkKCwwNDg8=<span class="nt">&lt;/largeblob&gt;</span>
  <span class="nt">&lt;/largeblobs&gt;</span>
 <span class="nt">&lt;config&gt;</span>
</code></pre></div>

<p>When ZigBee devices come on-line they can validate firmware versions with Director. If an update is available, the data is sent accordingly to the device. Drivers that wish to update their device’s firmware should do it in a sequential manner. The functions delivered in this SDK support this. It is possible to place the BLOB data in the Lua section of the driver. However, this requires a copy of the firmware data within every loaded driver used by the device. For example, if 15 devices use the driver, it will be necessary to maintain 15 copies of the firmware update data loaded in memory.</p>

<p><strong>Firmware Request Functions</strong></p>

<p>When a device requests a firmware update (the version of the firmware on the device is older than the firmware the driver has), the driver should request a &#39;reflash lock&#39; via <a href="https://snap-one.github.io/docs-driverworks-api/#requestreflashlock">RequestRefreshLock</a>. This allows the driver to ensure that it is the only driver updating a device at any time. This is required so that Director can manage multiple Zigbee drivers so that only one driver will be allowed to update at a time.  This ensures that device firmware updates don&#39;t overload the zigbee network.</p>

<p>The <a href="https://snap-one.github.io/docs-driverworks-api/#onreflashlockgranted">OnReflashLockGranted</a> function is called by Director when the driver has permission to update the firmware on the device.  This function ensures that the driver is the only device using the zigbee network to flash a device. This ensures that the delivery of the firmware update won’t be slowed down due to other firmware updates from other devices.</p>

<p>All reflash traffic is sent to the device using standard <a href="https://snap-one.github.io/docs-driverworks-api/#sendzigbeepacket">SendZigbeePacket</a> and <a href="https://snap-one.github.io/docs-driverworks-api/#onzigbeepacketin">OnZigbeePacketIn</a> commands/functions as described above.</p>

<h2 id='getblobbyname'>GetBlobByName</h2>

<p>Returns the un-encoded string containing the firmware update data of the specified BLOB (Binary Large Object). This API should not be invoked during OnDriverInit.</p>

<p><h6 id='available-from-1-6-0'>Available from 1.6.0.</h6><h3 id='signature'>Signature</h3>
<p><code>C4:(GetBlobByName)</code></p></p>

<table><thead>
<tr>
<th>Parameter</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>str</td>
<td>Name of the Binary Large Object to retrieve from the .c4i file.</td>
</tr>
</tbody></table>

<h3 id='returns'>Returns</h3>

<p>Binary data from the driver file.</p>

<h3 id='example'>Example</h3>

<p><code>C4:(&quot;Blob1&quot;)</code></p>

<h2 id='getzigbeeeuid'>GetZigbeeEUID</h2>

<p>Lua function called to retrieve a Zigbee device’s user ID. This API should not be invoked during OnDriverInit.</p>

<p><h6 id='available-from-1-6-0'>Available from 1.6.0.</h6><h3 id='signature'>Signature</h3>
<p><code>C4:GetZigbeeEUID()</code></p>
<h3 id='parameters'>Parameters</h3>
<p><code>None</code></p>
<h3 id='returns'>Returns</h3>
<table><thead>
<tr>
<th>Value</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>str</td>
<td>String representing the EUID value</td>
</tr>
</tbody></table></p>

<h2 id='keepreflashlock'>KeepReflashLock</h2>

<p>If a driver takes longer than a minute to upload the firmware data to the device, it should call C4:KeepReflashLock. This request will maintain the reflash lock while updating. If a driver does not call KeepReflashLock, the Reflash Lock will be revoked after approximately one minute. This API should not be invoked during OnDriverInit.</p>

<p><h6 id='available-from-1-6-0'>Available from 1.6.0.</h6><h3 id='signature'>Signature</h3>
<p><code>C4:KeepReflashLock()</code></p></p>

<h2 id='onreflashlockgranted'>OnReflashLockGranted</h2>

<p>Function called by Director when a Zigbee device grants communication access. Ensures that the driver is the only one currently granted permission to update the device.</p>

<p><h6 id='available-from-1-6-0'>Available from 1.6.0.</h6><h3 id='signature'>Signature</h3>
<p><code>OnReflashLockGranted()</code></p></p>

<h2 id='onreflashlockrevoked'>OnReflashLockRevoked</h2>

<p>Function called by Director when a driver loses permission to perform a device update.</p>

<p><h6 id='available-from-1-6-0'>Available from 1.6.0.</h6><h3 id='signature'>Signature</h3>
<p><code>OnReflashLockRevoked()</code></p></p>

<h2 id='onzigbeeonlinestatuschanged'>OnZigbeeOnlineStatusChanged</h2>

<p>This function gets called when the Online status of a Zigbee node changes.</p>

<p><h6 id='available-from-1-6-0'>Available from 1.6.0.</h6><h3 id='signature'>Signature</h3>
<p><code>OnZigbeeOnlineStatusChanged (strStatus, strVersion, strSkew)</code></p></p>

<table><thead>
<tr>
<th>Parameter</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>str</td>
<td>Status: OFFLINE, ONLINE, REBOOT, UNKNOWN</td>
</tr>
<tr>
<td>str</td>
<td>Version</td>
</tr>
<tr>
<td>str</td>
<td>Skew</td>
</tr>
</tbody></table>

<h3 id='example'>Example</h3><div class="highlight"><pre class="highlight lua tab-lua"><code><span class="k">function</span> <span class="nf">OnZigbeeOnlineStatusChanged</span> <span class="p">(</span><span class="n">strStatus</span><span class="p">,</span> <span class="n">strVersion</span><span class="p">,</span> <span class="n">strSkew</span><span class="p">)</span>
  <span class="nb">print</span><span class="p">(</span><span class="s2">"Zigbee Status Changed: "</span> <span class="o">..</span> <span class="n">strStatus</span><span class="p">)</span>
  <span class="n">gZigbeeStatus</span> <span class="o">=</span> <span class="n">strStatus</span>
<span class="k">end</span>
</code></pre></div>
<h2 id='sendzigbeepacket'>SendZigbeePacket</h2>
<p>This function sends a raw Zigbee packet to a Zigbee Binding. This functionality supports both the current Control 4 (EmberNet) as well as ZigBee Pro 1.1 transports. This API should not be invoked during OnDriverInit.</p>
<h6 id='available-from-1-6-0'>Available from 1.6.0.</h6><h3 id='signature'>Signature</h3>

<p><code>C4:SendZigbeePacket (strPacket,nProfileID, nClusterID, nGroupID, nSourceEndpoint, ndestinationEndpoint)</code></p>

<table><thead>
<tr>
<th>Parameter</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>str</td>
<td>ZigBee supported command packet containing user data.</td>
</tr>
<tr>
<td>num</td>
<td>Profile ID associated with the data packet</td>
</tr>
<tr>
<td>num</td>
<td>Source Cluster library ID included within the Profile</td>
</tr>
<tr>
<td>num</td>
<td>Zigbee device group ID</td>
</tr>
<tr>
<td>num</td>
<td>Endpoint designated as the source of the data packet delivery.</td>
</tr>
<tr>
<td>num</td>
<td>Endpoint designated as the recipient of the data packet delivery.</td>
</tr>
</tbody></table>

<h3 id='returns'>Returns</h3>

<p><code>None</code></p>

<h3 id='usage-note'>Usage Note</h3>

<p>The following parameters are ignored when using the Control 4 (Embernet) Zigbee stack: </p>

<ul>
<li>nProfileID</li>
<li>nClusterID</li>
<li>nGroupID</li>
<li>nSouceEndpoint</li>
<li>nDestinationEndpoint</li>
</ul>

<p>Packet data is still sent in the strPacket parameter. If using ZigBee Pro, all data (including strPacket) must conform to ZigBee Pro format. </p>

<h3 id='example'>Example</h3><div class="highlight"><pre class="highlight lua tab-lua"><code><span class="n">g_SequenceNumber</span><span class="o">=</span><span class="n">g_sequenceNumber</span> <span class="o">+</span> <span class="mi">1</span>
<span class="n">strPacket</span> <span class="o">=</span> <span class="s2">"0"</span> <span class="o">..</span> <span class="n">Chartype</span> <span class="o">..</span> <span class="nb">string.format</span><span class="p">(</span><span class="o">%</span><span class="mi">04</span><span class="n">x</span><span class="s2">",g_SequenceNumber) ..     c4.dm.lv 100"</span>
</code></pre></div>
<h2 id='onzigbeepacketin'>OnZigbeePacketIn</h2>
<p>Receives an unsolicited zigbee packet from the device or a response to a command that was sent.</p>
<h6 id='available-from-1-6-0'>Available from 1.6.0.</h6><h3 id='signature'>Signature</h3>

<p><code>OnZigbeePacketIn(strPacket,nProfileID, nClusterID, nGroupID, nSourceEndpoint, ndestinationEndpoint)</code></p>

<table><thead>
<tr>
<th>Parameter</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>str</td>
<td>ZigBee supported command packet containing user data.</td>
</tr>
<tr>
<td>num</td>
<td>Profile ID associated with the data packet</td>
</tr>
<tr>
<td>num</td>
<td>Source Cluster library ID included within the Profile</td>
</tr>
<tr>
<td>num</td>
<td>Zigbee device group ID</td>
</tr>
<tr>
<td>num</td>
<td>Endpoint designated as the source of the data packet delivery.</td>
</tr>
<tr>
<td>num</td>
<td>Endpoint designated as the recipient of the data packet delivery.</td>
</tr>
</tbody></table>

<h3 id='returns'>Returns</h3>

<p><code>None</code></p>

<h3 id='usage-note'>Usage Note</h3>

<p>The following parameters are ignored when using the Control 4 (Embernet) Zigbee stack: </p>

<ul>
<li>nProfileID</li>
<li>nClusterID</li>
<li>nGroupID</li>
<li>nSouceEndpoint</li>
<li>nDestinationEndpoint</li>
</ul>

<p>Packet data is still sent in the strPacket parameter. If using ZigBee Pro, all data (including strPacket) must conform to ZigBee Pro format. </p>

<h3 id='example'>Example</h3><div class="highlight"><pre class="highlight lua tab-lua"><code>
<span class="k">function</span> <span class="nf">OnZigbeePacketIn</span> <span class="p">(</span><span class="n">strPacket</span><span class="p">,</span> <span class="n">idProfileID</span><span class="p">,</span> <span class="n">idClusterID</span><span class="p">,</span>
  <span class="n">idGroupID</span><span class="p">,</span> <span class="n">sourceEndpoint</span><span class="p">,</span><span class="n">destinationEndpoint</span><span class="p">)</span>
  <span class="nb">print</span><span class="p">(</span><span class="s2">"OnZigbeePacketIn;"</span> <span class="o">..</span> <span class="n">strPacket</span><span class="p">)</span>
<span class="k">end</span>
</code></pre></div>
<h2 id='onzigbeepacketfailed'>OnZigbeePacketFailed</h2>
<p>Return function upon the unsuccessful delivery of a data packet. </p>
<h6 id='available-from-1-6-0'>Available from 1.6.0.</h6><h3 id='signature'>Signature</h3>

<p><code>OnZigbeePacketFailed (strPacket, nProfileID, nClusterID, nGroupID, nSourceEndpoint, ndestinationEndpoint)</code></p>

<table><thead>
<tr>
<th>Parameter</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>str</td>
<td>ZigBee supported command packet containing user data.</td>
</tr>
<tr>
<td>num</td>
<td>Profile ID associated with the data packet</td>
</tr>
<tr>
<td>num</td>
<td>Source Cluster library ID included within the Profile</td>
</tr>
<tr>
<td>num</td>
<td>Zigbee device group ID</td>
</tr>
<tr>
<td>num</td>
<td>Endpoint designated as the source of the data packet delivery.</td>
</tr>
<tr>
<td>num</td>
<td>Endpoint designated as the recipient of the data packet delivery.</td>
</tr>
</tbody></table>

<h3 id='returns'>Returns</h3>

<p><code>None</code></p>

<h3 id='usage-note'>Usage Note</h3>

<p>The following parameters are ignored when using the Control 4 (Embernet) Zigbee stack: </p>

<ul>
<li>nProfileID</li>
<li>nClusterID</li>
<li>nGroupID</li>
<li>nSouceEndpoint</li>
<li>nDestinationEndpoint</li>
</ul>

<p>Packet data is still sent in the strPacket parameter. If using ZigBee Pro, all data (including strPacket) must conform to ZigBee Pro format. </p>

<h3 id='example'>Example</h3><div class="highlight"><pre class="highlight lua tab-lua"><code><span class="k">function</span> <span class="nf">OnZigbeePacketFailed</span> <span class="p">(</span><span class="n">strPacket</span><span class="p">,</span> <span class="n">idProfileID</span><span class="p">,</span> <span class="n">idClusterID</span><span class="p">,</span> <span class="n">idGroupID</span><span class="p">,</span> <span class="n">sourceEndpoint</span><span class="p">,</span><span class="n">destinationEndpoint</span><span class="p">)</span>
  <span class="nb">print</span><span class="p">(</span><span class="s2">"OnZigbeePacketFailed;"</span> <span class="o">..</span> <span class="n">strPacket</span><span class="p">)</span>
<span class="k">end</span>
</code></pre></div>
<h2 id='onzigbeepacketsuccess'>OnZigbeePacketSuccess</h2>
<p>Return function upon the successful delivery of a data packet.</p>
<h6 id='available-from-1-6-0'>Available from 1.6.0.</h6><h3 id='signature'>Signature</h3>

<p><code>OnZigbeePacketSuccess(strPacket,nProfileID, nClusterID, nGroupID, nSourceEndpoint, ndestinationEndpoint)</code></p>

<table><thead>
<tr>
<th>Parameter</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>str</td>
<td>ZigBee supported command packet containing user data.</td>
</tr>
<tr>
<td>num</td>
<td>Profile ID associated with the data packet</td>
</tr>
<tr>
<td>num</td>
<td>Source Cluster library ID included within the Profile</td>
</tr>
<tr>
<td>num</td>
<td>Zigbee device group ID</td>
</tr>
<tr>
<td>num</td>
<td>Endpoint designated as the source of the data packet delivery.</td>
</tr>
<tr>
<td>num</td>
<td>Endpoint designated as the recipient of the data packet delivery.</td>
</tr>
</tbody></table>

<h3 id='returns'>Returns</h3>

<p><code>None</code></p>

<h3 id='usage-note'>Usage Note</h3>

<p>The following parameters are ignored when using the Control 4 (Embernet) Zigbee stack: </p>

<ul>
<li>nProfileID</li>
<li>nClusterID</li>
<li>nGroupID</li>
<li>nSouceEndpoint</li>
<li>nDestinationEndpoint</li>
</ul>

<p>Packet data is still sent in the strPacket parameter. If using ZigBee Pro, all data (including strPacket) must conform to ZigBee Pro format. </p>

<h3 id='example'>Example</h3><div class="highlight"><pre class="highlight lua tab-lua"><code><span class="k">function</span> <span class="nf">OnZigbeePacketSuccess</span> <span class="p">(</span><span class="n">strPacket</span><span class="p">,</span> <span class="n">idProfileID</span><span class="p">,</span> <span class="n">idClusterID</span><span class="p">,</span> <span class="n">idGroupID</span><span class="p">,</span> <span class="n">sourceEndpoint</span><span class="p">,</span><span class="n">destinationEndpoint</span><span class="p">)</span>
  <span class="nb">print</span><span class="p">(</span><span class="s2">"OnZigbeePacketSuccess;"</span><span class="o">..</span><span class="n">strPacket</span><span class="p">)</span>  
<span class="k">end</span>
</code></pre></div>
<h2 id='releasereflashlock'>ReleaseReflashLock</h2>
<p>Function to terminate the request for firmware data upon completion of update. This API should not be invoked during OnDriverInit.</p>
<h6 id='available-from-1-6-0'>Available from 1.6.0.</h6><h3 id='signature'>Signature</h3>

<p><code>C4:ReleaseReflashLock()</code></p>

<h2 id='requestreflashlock'>RequestReflashLock</h2>

<p>Function that requests permission of Director to update the device. The driver receives permission when it receives the OnReflashLockGranted call. This API should not be invoked during OnDriverInit.</p>

<p><h6 id='available-from-1-6-0'>Available from 1.6.0.</h6><h3 id='signature'>Signature</h3>
<p><code>C4:RequestReflashLock()</code></p></p>

      </div>
      <div class="dark-box">
          <div class="lang-selector">
                <a href="#" data-language-name="lua">lua</a>
          </div>
      </div>
    </div>
  </body>
</html>
